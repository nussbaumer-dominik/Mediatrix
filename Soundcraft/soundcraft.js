CHANNEL_EQ_PRESETS: "ПРЕСЕТЫ EQ", AUX_EQ_PRESETS: "ПРЕСЕТЫ AUX EQ", MASTER_EQ_PRESETS: "ПРЕСЕТЫ MASTER EQ", CHANNEL_DYN_PRESETS: "ПРЕСЕТЫ DYN", AUX_DYN_PRESETS: "ПРЕСЕТЫ AUX DYN", MASTER_DYN_PRESETS: "ПРЕСЕТЫ MASTER DYN", DELAY_FX_PRESETS: "ПРЕСЕТЫ DELAY FX", CHORUS_FX_PRESETS: "ПРЕСЕТЫ CHORUS FX", REVERB_FX_PRESETS: "ПРЕСЕТЫ REVERB FX", FILES: "ФАЙЛЫ", CONNECTING: "СОЕДИНЕНИЕ...", KEEP_TAPPING: "ЖМИТЕ ДАЛЬШЕ...", PLAYLISTS: "ПЛЕЙЛИСТЫ", PRESET_LOADED: "ПРЕСЕТ<br>{0}<br>ЗАГРУЖЕН", NO_PAN_ON_MONO_AUX: "НЕТ БАЛАНСА<br>ДЛЯ МОНО AUX",
  PARAM_GLOBAL: "{0} ПАРАМЕТРЫ (ГЛОБАЛЬНЫЕ)", CLEAR_ALL_SOLOS: "СБРОСИТЬ ВСЕ SOLO", SET_ALL_CHANNELS_TO: 'УСТАНОВИТЬ ВСЕ КАНАЛЫ В "{0}" ?', SAVED: "СОХРАНЕНО", REPLACE_PRESET: 'ЗАМЕНИТЬ ПРЕСЕТ "{0}"?', REPLACE_SNAPSHOT: 'ЗАМЕНИТЬ SNAPSHOT "{0}"?', FACTORY: "ЗАВОД", USER: "ПОЛЬЗ", DELETE_PRESET: 'УДАЛИТЬ ПРЕСЕТ "{0}" ?', BPM: "УВМ", OUT_OF_RANGE: "ВНЕ ПРЕДЕЛА", ERROR: "ОШИБКА", NO_ASSIGNED_SUBGROUP: "НЕТ НАЗНАЧЕННЫХ КАНАЛОВ В <br>ПОДГРУППЕ {0}", NO_ASSIGNED_VIEWGROUP: "НЕТ НАЗНАЧЕННЫХ КАНАЛОВ В <br>ВИЗУАЛЬНОЙ ГРУППЕ {0}", NO_ASSIGNED_MG: "НЕТ НАЗНАЧЕННЫХ КАНАЛОВ В <br>MUTE ГРУППЕ {0}",
  SAVE_TO_SHOW: "СОХРАНИТЬ В SHOW", MIXER_RESET: "СБРОС МИКШЕРА", SAVE_SHOW_WITH_NAME: "СОХРАНИТЬ ШОУ С ИМЕНЕМ:", NEW_SHOW_NAME: "НОВОЕ ИМЯ ДЛЯ ШОУ:", SHOW_ALREADY_EXISTS: "ШОУ УЖЕ СУЩЕСТВУЕТ", DELETE_SHOW: 'УДАЛИТЬ ШОУ "{0}"?', SAVE_SNAPSHOT_WITH_NAME: "СОХРАНИТЬ SNAPSHOT С ИМЕНЕМ:", NEW_SNAPSHOT_NAME: "НОВОЕ ИМЯ ДЛЯ SNAPSHOT:", DELETE_SNAPSHOT: 'УДАЛИТЬ SNAPSHOT "{0}"?', LOAD_THE_INITIAL_MIXER_STATE: "ВЫПОЛНИТЬ СБРОС ПАРАМЕТРОВ МИКШЕРА?", INITIAL_VALUES_LOADED: "СБРОС ВЫПОЛНЕН", GROUPS: "ГРУППЫ", THRESHOLD: "ПОРОГ", OUT: "ВЫХОД",
  IN: "ВХОД", SETTINGS: "НАСТРОЙКИ", DEMO_VERSION: "ДЕМО ВЕРСИЯ", CHANNEL: "КАНАЛ", SUPPORT: "ПОДДЕРЖКА", RENAME_CHANNEL: "ПЕРЕИМЕНОВАТЬ КАНАЛ ({0})", CENTER: "ЦЕНТР", SETUP: "НАСТРОЙКИ", JUMP_TO: "ПЕРЕЙТИ К", BACK: "НАЗАД", SAVE_PRESET_WITH_NAME: "СОХРАНИТЬ ПРЕСЕТ С ИМЕНЕМ:", RENAME_PRESET: "ПЕРЕИМЕНОВАТЬ ПРЕСЕТ:", NO_ACTIVE_SHOW: "НЕТ АКТИВНОГО ШОУ", ARE_YOU_SURE: "ВЫ УВЕРЕНЫ?", ABOUT: "ИНФО", MOUNTCHANGED: "USB НОСИТЕЛЬ СМЕНЁН", MOUNT: "ВСТАВЛЕН USB НАКОПИТЕЛЬ", UNMOUNT: "USB НАКОПИТЕЛЬ ИЗВЛЕЧЁН", SINGLE: "ОДИНОЧНЫЙ", MULTIPLE: "МНОЖЕСТВЕННЫЙ",
  LOCAL: "ЛОКАЛЬНЫЕ", GLOBAL: "ГЛОБАЛЬНЫЕ", NO_CONTROLS_FOR_THIS_CHANNEL: "НЕТ НАСТРОЕК ДЛЯ ЭТОГО КАНАЛА", CANCEL: "ОТМЕНА", RELOAD_UI: "ПЕРЕЗАПУСТИТЬ ПРОГРАММУ, ЧТОБЫ ИЗМЕНЕНИЯ ВСТУПИЛИ В СИЛУ?", BAD_BROWSER: "ВАШ БРАУЗЕР НЕ ПОДДЕРЖИВАЕТ НЕОБХОДИМЫЕ ТЕХНОЛОГИИ. ПОЖАЛУЙСТА, ИСПОЛЬЗУЙТЕ ДРУГОЙ БРАУЗЕР.", RECORDINGS: "Записи", READING: "Чтение...", MSGBTN_UPDATE: "ОБНОВИТЬ", MSGBTN_CANCEL: "ОТМЕНА", SHOWIMP_SUCCESS: "ИМПОРТ ЗАВЕРШЕН", IMPORT_SHOW_FROM_USB: "ИМПОРТ ШОУ С USB", NO_SHOW_SELECTED: "НЕ ВЫБРАНО ШОУ", IMPORT_SHOW: "ИМПОРТ ШОУ",
  LANGUAGE: "ЯЗЫК", CUE: "ОЧЕРЕДЬ", AUTO: "АВТО", FRAME_RATE: "ЧАСТОТА КАДРОВ", DISABLE_RESCALING: "ОТКЛЮЧИТЬ МАСШТАБИРОВАНИЕ", GUI_PERFORMANCE: "ПРОИЗВОДИТЕЛЬНОСТЬ", HEADPHONES_OUT: "ВЫХОД НАУШНИКОВ", BUTTON_FUNCTION: "ФУНКЦ. КНОПКИ", KINETIC_SCROLL: "ИНЕРЦИОННАЯ ПРОКРУТКА", FADER_GLOW: "ТОЛЩИНА ЛИНИЙ СЛАЙДЕРОВ", DISABLE_LED_METERS: "ОТКЛЮЧИТЬ ИНДИКАТОРЫ", MASTER_LOCK: "ЗАЩИТА MASTER КАНАЛА", HIDE_COMP_GATE: "СПРЯТАТЬ КОМПРЕССОР", HIDE_DB_MARKS: "СПРЯТАТЬ МАРКЕРЫ ДЕЦИБЕЛ", PIN_SO_FOR_AUX_FX_SENDS: "ПОКАЗЫВАТЬ ПРАВУЮ ПАНЕЛЬ ДЛЯ FX/AUX",
  PIN_SLIDEOUT_IN_MIX_MODE: "ВСЕГДА ПОКАЗЫВАТЬ ПРАВУЮ ПАНЕЛЬ", SOLO_MODE: "РЕЖИМ SOLO", SOLO_ROUTING: "ПУТЬ SOLO", HEADPHONES: "НАУШНИКИ", AUTOCLOSE_SLIDEOUT: "АВТОЗАКРЫТИЕ БОКОВОЙ ПАНЕЛИ", METER_QUANTISATION: "СЕКЦИОННЫЕ ИНДИКАТОРЫ", RECORD_MODE: "РЕЖИМ ЗАПИСИ", MIXER_SCROLLING: "ПРОКРУТКА МИКШЕРА", DIM_LED_METERS: "МЕНЕЕ ЯРКИЕ ИНДИКАТОРЫ", UTILITY: "УТИЛИТЫ", FINGER: "ПАЛЕЦ", FINGERS: "ПАЛЬЦА", IMPORT_ALL_PRESETS: "ИМПОРТ ВСЕХ ПРЕСЕТОВ", EXPORT_ALL_PRESETS: "ЭКСПОРТ ВСЕХ ПРЕСЕТОВ", NO_CONNECTION_TO_MIXER: "НЕТ СОЕДИНЕНИЯ", VERSION: "ВЕРСИЯ",
  COPY_TO_CLIPBOARD: "КОПИРОВАТЬ В БУФФЕР", SENSITIVITY: "ЧУВСТВИТЕЛЬНОСТЬ", CLEAR_FIXED: "ОЧИСТИТЬ FIXED", CLEAR_ALL: "ОЧИСТИТЬ ВСЕ", CLEAR_LIVE: "ОЧИСТИТЬ LIVE", NAME_SSID: "ИМЯ SSID", SUBNET_MASK: "МАСКА ПОДСЕТИ", WIRELESS_NETWORK: "БЕСПРОВОДНАЯ СЕТЬ", SECURITY_OPTIONS: "НАСТРОЙКИ БЕЗОПАСНОСТИ", LAN_IP_ADDRESS: "LAN IP АДРЕСС", ACCESS_LIMITING: "ОГРАНИЕЧНИЕ ДОСТУПА", PASSWORD: "ПАРОЛЬ", ACCESS: "ДОСТУП", ALLOW_ACCESS_FOR: "РАЗРЕШИТЬ ДОСТУП", MASTER_VOLUME: "ГРОМКОСТЬ MASTER", MASTER_PROCESSING: "ОБРАБОТКА MASTER", GLOBAL_SETTINGS: "ГЛОБАЛЬНЫЕ НАСТРОЙКИ",
  TRANSLATIONS_END: "-----"
};
langBase.pt = {
  lang: "PORTUGUÊS",
  APPLY: "APLICAR",
  ASSIGN_SUB_GROUP: "ENDEREÇAR AO SUB GRUPO {0}",
  ATTACK: "ATAQUE",
  AUX_MASTER_LEVELS: "NIVEIS AUX MASTER",
  AUX_SENDS_FOR: "ENVIO AUX:{0}",
  BANKS: "BANCOS",
  BASS_GAIN: "GANHO DE GRAVES",
  CHANNEL_SAFES: "CANAIS SEGUROS",
  FX_SENDS_X: "ENVIO FX:{0}",
  CHANNEL_PRESETS: "PRESETS DE CANAL",
  CLEAR_SOLO: "LIMPAR SOLO",
  CONFIGURATION: "CONFIGURAÇÃO",
  CONNECTED_DEVICE_NAME: "Nome do dispositivo conectado",
  COPY_SETTINGS: "DEFINIÇÕES DE CÓPIA",
  CURRENT_SHOW: "MOSTRAR ATUAL",
  DELAY_LENGTH: "Duração do DELAY ",
  DELETE: "EXCLUIR",
  DISABLE_STEREO_LINK: "Desabilitar o STEREO LINK",
  DOCUMENTATION: "DOCUMENTAÇÃO",
  EDIT: "EDITAR",
  EXPORT: "EXPORTAR",
  FAV_SHOW: "MOSTRA FAVORITO",
  FEEDBACK_AMOUNT: "FEEDBACK Imediato",
  FREQ: "FREQUENCIA",
  FX_MODE_DEFAULT: "FX  MODO PADRÃO",
  FX_RETURNS: "RETORNOS FX",
  FX_RETURNS_TO_AUX: "FX Retorna a",
  GAIN: "GANHO",
  GROUP: "GRUPO",
  HELP: "AJUDA",
  HF_DAMPING: "AMORTECIMENTO HF",
  HIGHPASS_FILTER: "FILTRO PASSA ALTA",
  IMPORT: "IMPORTAR",
  INPUT: "ENTRADA",
  LENGTH_SUBDIVISION: "SUBDIVISÃO LENGTH",
  LOCK: "BLOQUEIO",
  LOCKED: "BLOQUEADO",
  LOWPASS_FILTER: "filtro passa-baixa",
  MEDIA_FADER_BEFORE_CH1: "FADER mídia antes de CH1",
  MIX_GAIN: "GANHO DA MIX",
  MUTE: "MUDO",
  MUTE_ALL: "SILENCIE TUDO",
  MUTE_FX: "MUDO FX",
  MUTE_GROUP_BUTTON_ASSIGN: "ENDEREÇAR BOTAO DE GRUPO DE MUTE",
  MUTE_GROUPS: "GRUPO DE MUTE",
  MUTES: "MUTE",
  NETWORK: "REDE",
  NEW: "NOVO",
  NEW_SNAPSHOT: "NOVA CENA",
  NEXT_SNAPSHOT: "PRÓXIMA CENA",
  NORM: "NORMA  ",
  OFF: "DESLIGADO",
  ON: "LIGADO",
  ONLINE_SUPPORT: "SUPORTE ONLINE",
  PASTE_SETTINGS: "Colar configurações",
  PERMISSIONS: "PERMISSÕES",
  PERMIT: "PERMITIR",
  RECORD: "GRAVAR",
  RENAME: "RENOMEAR",
  RESET: "REINICIAR",
  RESET_CHANNEL: "REINICIAR CANAL",
  REVERB_TIME: "REVERB TEMPO",
  SAVE: "SALVAR",
  SAVE_AS: "SALVAR COMO",
  SNAPSHOTS: "CENAS",
  SPEED: "VELOCIDADE",
  SUB_GROUP_FADER_ASSIGN: "ENDEREÇAR FADER AO SUB GRUPO",
  SUB_GROUP_SPREAD: "SUB GRUPO SPREAD",
  SUB_GROUPS: "subgrupos",
  TOTAL_VIEW: "VISTA TOTAL",
  UNASSIGN_SUB_GROUP: "DESENDEREÇAR SUB GRUPO{0}",
  UPDATE_CURRENT_SNAPSHOT: "ATUALIZAÇÃO DA CENA",
  USB_MEDIA_FILES: "MÍDIA USB ARQUIVOS",
  VIEW_GROUP_BUTTON_ASSIGN: "ENDEREÇAR BOTAO GRUPO VIEW",
  VIEW_GROUPS: "VER GRUPOS",
  VIEWS: "VISTAS",
  SHOW_ALL_CHANNELS: "MOSTRE TODOS OS CANAIS",
  PLACE_AFTER_INPUTS: "LUGAR DEPOIS ENTRADAS",
  PLACE_BEFORE_INPUTS: "LUGAR ANTES DE ENTRADAS",
  MUTE_FX_CANCEL: "CANCELAR FX MUTE",
  MUTE_ALL_CANCEL: "CANCELAR TODOS OS MUTEs",
  MUTEGROUP_1_ACTIVATED: "MUTE GRUPO {0} LIGADO",
  MUTEGROUP_1_DEACTIVATED: "MUTE GRUPO {0} DESLIGADO",
  NO_SNAPSHOT: "SEM CENA",
  LOAD_NEXT_SNAPSHOT: "CARREGA PRÓXIMA CENA",
  CHANNEL_EQ_PRESETS: "PRESETS DE EQ DO CANAL",
  AUX_EQ_PRESETS: "PRESETS DE EQ DO AUX",
  MASTER_EQ_PRESETS: "PRESETS DE EQ DO MASTER",
  CHANNEL_DYN_PRESETS: "PRESETS DO CANAL DYN",
  AUX_DYN_PRESETS: "PRESETS DO AUX DYN",
  MASTER_DYN_PRESETS: "PRESTS DO MASTER DYN",
  DELAY_FX_PRESETS: "PRESETS DELAY FX",
  CHORUS_FX_PRESETS: "PRESETS CHORUS FX ",
  REVERB_FX_PRESETS: "PRESETS REVERB FX",
  ROOM_PRESETS: "PRESETS AMBIENCIA",
  DIGITECH_PRESETS: "PRESETS DIGITECH",
  UX_PRESETS: "OPÇÕES DE PRESETS (local)",
  FILES: "ARQUIVOS",
  CONNECTING: "Conectando ...",
  KEEP_TAPPING: "Continue a tocar ...",
  PRESET_LOADED: "PRESET<br>{0}<br>CARREGADO",
  NO_PAN_ON_MONO_AUX: "SEM PAN <br> no AUX mono ",
  PARAM_GLOBAL: "{{0} PARAMETROS (globais)",
  CLEAR_ALL_SOLOS: "DASABILITAR TODOS OS SOLOS",
  PRE: "PRÉ",
  SET_ALL_CHANNELS_TO: 'DEFINIR TODOS OS CANAIS PARA "{0} "?',
  SAVED: "SALVOU",
  REPLACE_PRESET: 'SUBSTITUIR PRESET "{0} "?',
  REPLACE_SNAPSHOT: 'SUBSTITUIR A CENA "{0} "?',
  FACTORY: "FÁBRICA",
  USER: "USUARIO",
  DELETE_PRESET: "EXCLUIR PRESET",
  OUT_OF_RANGE: "FORA DO RANGE",
  ERROR: "ERRO",
  NO_ASSIGNED_SUBGROUP: "SEM CANAIS DE ENTRADA ATRIBUIDOS <br>SUB GRUPO {0}",
  NO_ASSIGNED_VIEWGROUP: "SEM CANAIS DE ENTRADA ATRIBUIDOS <br>VIEW GRUPO {0}",
  NO_ASSIGNED_MG: "SEM CANAIS DE ENTRADA ATRIBUIDOS <br> GRUPO MUDO {0}",
  SAVE_TO_SHOW: "SALVAR NO SHOW",
  DASHBOARD: "PAINEL",
  INCOMPATIBLE_CHANNEL_TYPE: "TIPO DE CANAL INCOMPATIVEL",
  MIXER_RESET: "RESETAR MIXER",
  SAVE_SHOW_WITH_NAME: "SALVAR SHOW COM NOME:",
  NEW_SHOW_NAME: "NOME DO NOVO SHOW",
  SHOW_ALREADY_EXISTS: "SHOW JÁ EXISTE",
  DELETE_SHOW: 'EXCLUIR SHOW "{0}"?',
  SAVE_SNAPSHOT_WITH_NAME: "SALVAR SNAPSHOT COM NOME",
  NEW_SNAPSHOT_NAME: "NOVO NOME DO SNAPCHOT:",
  DELETE_SNAPSHOT: 'APAGAR SNAPSHOT "{0} "?',
  LOAD_THE_INITIAL_MIXER_STATE: "CARREGAR ESTADO INICIAL DO MIXER",
  ERR_DELETESHOW: "ERRO AO APAGAR SHOW",
  ERR_CREATESHOW: "ERRO AO CRIAR SHOW",
  ERR_LOADSHOW: "ERRO AO CARREGAR SHOW",
  ERR_SAVESHOW: "ERRO AO SALVAR PARAMETROS DO SHOW",
  ERR_RENAMESHOW: "ERRO AO RENOMEAR SHOW",
  ERR_SAVEINIT: "NÃO PODE salvar novamente * INIT * SNAPSHOT.",
  ERR_SAVESNAPSHOT: "ERRO AO SALVAR SNAPSHOT.",
  ERR_LOADSNAPSHOT: "ERRO AO CARREGAR SNAPSHOT.",
  ERR_DELETESNAPSHOT: "ERRO AO APAGAR SNAPSHOT.",
  ERR_RENAMEINIT: "Não é possível renomear * INIT * SNAPSHOT.",
  ERR_RENAMESNAPSHOT: "ERRO AO RENOMEAR SNAPSHOT.",
  ERR_DELETEPRESET: "ERRO AO APAGAR PRESET",
  ERR_WRITEPRESET: "ERRO AO ESCREVER PRESET",
  ERR_RENAMEPRESET: "ERRO AO RENOMEAR PRESET",
  INITIAL_VALUES_LOADED: "VALORES INICIAIS CARREGADOS",
  FX_EDIT: "EDITAR FX",
  GROUPS: "GRUPOS",
  OUT: "SAIDA",
  IN: "ENTRADA",
  BAND: "BANDA",
  SETTINGS: "CONFIGURAÇÕES",
  DEMO_VERSION: "VERSÃO DEMO",
  LINE_IN: "ENTRADA DE LINHA",
  LINE: "LINHA",
  MODE: "MODO",
  CHANNEL: "CANAL",
  SUPPORT: "SUPORTE",
  RENAME_CHANNEL: "RENOMEAR CANAL",
  CENTER: "CENTRO",
  SETUP: "CONFIGURAÇÃO",
  JUMP_TO: "PULE PARA",
  FUNCTIONS: "FUNÇÕES",
  BACK: "VOLTA",
  SAVE_PRESET_WITH_NAME: "SALVAR PRESET COM NOME:",
  RENAME_PRESET: "RENOMEAR PRESET",
  NO_ACTIVE_SHOW: "SHOW não selecionado",
  INPUTS: "ENTRADAS",
  ARE_YOU_SURE: "VOCÊ TEM CERTEZA?",
  ABOUT: "SOBRE",
  FIXED: "FIXO",
  MUTE_GROUP_X: "GRUPO DE MUTE {0}",
  MOUNTCHANGED: "MOLDURA ALTERADA",
  MOUNT: "USB INSERIDO",
  UNMOUNT: "USB REMOVIDO",
  DISABLED: "DESATIVADO",
  ENABLED: "HABILITADO",
  MULTIPLE: "MÚLTIPLO",
  LEVEL: "NÍVEL",
  TREBLE: "AGUDOS",
  MID: "MEDIOS",
  BASS: "GRAVES",
  NO_CONTROLS_FOR_THIS_CHANNEL: "SEM CONTROLES PARA ESTE CANAL",
  UNASSIGN_ME: "DESATRIBUIR ME",
  ASSIGN_ME: "ATRIBUIR ME",
  UNASSIGN_MY_OUT: "MY OUT' DESENDEREÇAR",
  ASSIGN_MY_OUT: "MY OUT' ENDEREÇAR",
  NO_SEND_LEVELS: "SENDS SEM NIVEL",
  CANCEL: "CANCELAR",
  RELOAD_UI: "RECARREGAR UI para que as alterações tenham efeito?",
  BAD_BROWSER: "ESTE navegador não suporta WebSockets. Use um navegador diferente.",
  AFS_FIXED_INFO: "modo de medição de realimentação. Certifique-se que <br>não  há outros sons vindos para as entradas, exceto o tom de realimentação do  microfone/alto-falantes.",
  RECORDINGS: "gravações",
  READING: "Leitura...",
  FIRMWARE_FOUND: "A imagem de atualização de firmware foi encontrado no dispositivo USB conectado. <br> Executar uma atualização do mixer?",
  FIRMWARE_UPDATED: "Atualização bem-sucedida. <br> Por favor, desligue a unidade por 10 segundos, religue novamente  e recarregue esta página. <br> Nota,  o seu dispositivo sem fio pode precisar de religação manual.",
  MSGBTN_UPDATE: "Atualizar",
  MSGBTN_CANCEL: "Cancelar",
  UPDATE_ALREADY: "A atualização foi tentada uma vez já. <br> Por favor, reinicie o dispositivo para retomar / tente novamente.",
  UPDATE_COMPLETED: "Sistema atualizado. Por favor, desligue e ligue o aparelho e recarregue a página para que a atualização tenha efeito.",
  UPDATE_ERROR: "Erro ao executar atualização.",
  REC_ERRSEQ: "Recorder: Erro ao escrever arquivo seqüencial para o USB (sem espaço?).",
  REC_ERRWRITE: "Recorder: Erro de escrita USB (sem espaço?).",
  REC_ERRNOSTICK: "Recorder: stick USB não está inserido no slot RECORD.",
  REC_ERRNOACCESS: "Recorder: Não é possível acessar um dispositivo USB para a escrita.",
  REC_ERRCREATE: "Recorder: Não é possível criar um arquivo no pendrive.",
  SHOWEXP_NOTFOUND: "Export / Import: Item não encontrado",
  SHOWEXP_USBNOTFOUND: "Dispositivo USB não encontrado",
  SHOWEXP_WRITEERR: "Exportação falhou: Não é possível acessar o dispositivo USB para a escrita",
  SHOWEXP_INTREADERR: "Exportação falhou: Erro ao ler a pasta de origem.",
  SHOWEXP_EXPFAILED: "Alguns arquivos não conseguiram ser exportados.",
  SHOWEXP_SUCCESS: "exportado com êxito",
  SHOWIMP_FAILED: "Alguns arquivos não conseguiram ser importados.",
  SHOWIMP_SUCCESS: "importação bem-sucedida",
  SHOWIMP_NOTFOUND: "Erro de importação: Fonte não encontrada",
  SHOWIMP_FILNOTFOUND: "Arquivos irrelevantes encontrados no USB",
  IMPORT_SHOW_FROM_USB: "Importar SHOW do USB",
  NO_SHOW_SELECTED: "NENHUM SHOW SELECIONADO",
  EXPORT_SHOW_TO_USB: "Exportar SHOW para o USB: {0}",
  IMPORT_SHOW: "Importar SHOW",
  EXPORT_SHOW: "Exportar SHOW",
  LANGUAGE: "LÍNGUA",
  NO_ME_CHANNELS: "Sem canais ME",
  NO_AUX_OUT: "SEM SAIDA AUX",
  ACCESS_LIMITING: "LIMITAR ACESSO",
  PASSWORD: "SENHA",
  ACCESS: "ACESSO",
  MONITOR_ACCESS_LIMIT: "Limitar o acesso (LOCAL)",
  ALLOW_ACCESS_FOR: "Permitir o acesso para",
  GLOBAL_SETTINGS: "CONFIGURAÇÕES GLOBAIS",
  MASTER_PROCESSING: "PROCESSAMENTO  DO MASTER",
  MASTER_VOLUME: "VOLUME DO MASTER",
  ACCOUNT: "CONTA",
  FRAME_RATE: "TAXA DE QUADROS",
  DISABLE_RETINA: "DESABILITAR RETINA",
  DISABLE_RESCALING: "DESABILITAR RESCALING",
  GUI_PERFORMANCE: "PERFORMANCE GRAFICA",
  HEADPHONES_OUT: "SAIDA DE FONES DE OUVIDO",
  BUTTON_FUNCTION: "BOTÃO DE FUNÇÃO",
  DISABLE_LED_METERS: "DESABILITAR VU DE LEDs",
  MASTER_LOCK: "TRAVAR MASTER",
  HIDE_COMP_GATE: "OCULTAR COMP/GATE",
  HIDE_DB_MARKS: "OCULTAR ESCALA DB",
  PIN_SO_FOR_AUX_FX_SENDS: "FIXAR SO PARA AUX/FX SENDS",
  PIN_SLIDEOUT_IN_MIX_MODE: "FIXAR SLIDEOUT NO MODO MIX",
  SOLO_MODE: "MODO SOLO",
  SOLO_ROUTING: "ENCAMINHAMENTO SOLO",
  HEADPHONES: "FONES DE OUVIDO",
  AUTOCLOSE_SLIDEOUT: "AUTO-FECHAMENTO SLIDEOUT",
  METER_QUANTISATION: "METER quantização",
  RECORD_MODE: "modo de gravação",
  UTILITY: "UTILIDADE",
  FINGER: "DEDO",
  FINGERS: "DEDOS",
  IMPORT_ALL_PRESETS: "IMPORTAR TODOS OS PRESETS",
  EXPORT_ALL_PRESETS: "EXPORTAR TODOS OS PRESETS",
  NO_CONNECTION_TO_MIXER: "Sem conexão com MIXER",
  VERSION: "VERSÃO",
  COPY_TO_CLIPBOARD: "COPIAR PARA ÁREA DE TRANSFERÊNCIA",
  COPYRIGHT_MSG: "Todas as marcas de terceiros são marcas comerciais de seus respectivos proprietários. Estas marcas são utilizados para identificar<br>sons de produtos que foram revisados na criação deste produto e uso dessas marcas não - <br>implica uma afiliação, endosso ou associação com Harman International Industries, Incorporated.",
  FILTER: "FILTRO",
  SENSITIVITY: "SENSIBILIDADE",
  CLEAR_FIXED: "LIMPAR FIXO",
  CLEAR_ALL: "LIMPAR TUDO",
  CLEAR_LIVE: "LIMPAR LIVE",
  NAME_SSID: "NOME SSID",
  SUBNET_MASK: "MÁSCARA SUBREDE",
  SSID_BROADCAST: "TRANSMISSÃO DO SSID",
  WIRELESS_NETWORK: "REDE SEM FIO",
  SECURITY_OPTIONS: "OPÇÕES DE SEGURANÇA",
  LAN_IP_ADDRESS: "Endereço IP da LAN",
  UP: "ACIMA",
  DOWN: "ABAIXO",
  HOTSPOT: "PONTO DE ACESSO",
  CLOSE: "FECHAR",
  COPY_MIX: "COPIAR MIX",
  NO_CONNECTION: "SEM CONEXAO",
  NO_CURRENT_SNAPSHOT: "SEM SNAPSHOT ATUAL",
  PATTERNED_BACKGROUND: "PLANO DE FUNDO PATENTEADO",
  ROUTING: "ENDEREÇAMENTO",
  INPUT_SOURCE: "FONTE DE ENTRADA",
  OUTPUT_DESTINATION: "DESTINO DE SAIDA",
  R: "R",
  RECORDING_DROPOUT: "GRAVAÇÃO DROPOUT",
  USB_REC_TOO_SLOW: "REC USB. MUITO DEVAGAR",
  RECORDER_IS_BUSY: "GRAVADOR ESTÁ OCUPADO",
  IMPORT_USER_CONFIG: "IPORTAR CONFIGURAÇÃO DE USUARIO",
  EXPORT_USER_CONFIG: "EXPORTAR CONFIGURAÇÃO DE USUARIO",
  OVERVIEW: "VISÃO GERAL",
  CHANNEL_SOURCE: "FONTE DO CANAL",
  CHANNEL_OUTPUT_DESTINATION: "DESTINO DE SAIDA DO CANAL",
  DISABLE_VU_INPUT_LEVEL: "DESABILITAR VU DA ENTRADA",
  DISABLE_VU_PEAK: "DESBILITAR PICO DO VU",
  SOLO_TYPE: "TIPO DE SOLO",
  WRONG_VALUE: "VALOR ERRADO",
  INPUT_DELAY: "DELAY DE ENTRADA",
  OUTPUT_DELAY: "DELAY DE SAIDA",
  PEDAL_FUNCTION: "função do pedal",
  CONFIG_WARNING: "Aviso:. Somente as configurações visuais / gráficas específicas para este dispositivo serão armazenados <br> Essas configurações não afetam a operação do mixer.",
  SET_TO_ZERO_DB: "COLOCAR EM ZERO DB",
  SET_OUTPUT_DELAY: "COLOCAR DELAY DA SAÍDA",
  MASTER_PRESETS: "PRESETS DO MASTER",
  SLAVE: "ESCRAVO",
  EXCEEDS_MAXIMUM_DELAY: "ULTRAPASSA DELAY MÁXIMO",
  START_STOP_PLAYER: "START / STOP PLAYER",
  START_STOP_RECORDING: "START / Parar a gravação",
  NONE: "NENHUM",
  ISOLATION: "ISOLAMENTO",
  MIC_GAIN: "GANHO DO MIC",
  CHANNELS: "CANAIS",
  MATRICES: "MATRIZES",
  HOLD: "SEGURAR",
  ISOLATE: "ISOLAR",
  DENSITY: "DENSIDADE",
  CASCADE: "CASCATA",
  CASCADE_MASTER: "CASCATA MASTER",
  SOUNDCHECK: "CHECAGEM DE SOM",
  DIRECT_OUT: "SAIDA DIRETA",
  LOCATE: "LOCALIZAR",
  ENABLE: "HABILITAR",
  NAME: "NOME",
  EMPTY: "VAZIO",
  SESSIONS: "SESSÕES",
  SPACE_REMAINING: "Espaço restante:",
  EDIT_CHANNEL: "EDITAR CANAL",
  RESET_ALL: "REINICIAR TUDO",
  DIRECT_OUTPUT: "SAIDA DIRETA",
  FADER_POSITION: "POSIÇÃO DO FADER",
  MASTER_CHANNEL_RANGE: "ALCANCE DO CANAL MASTER",
  IOSYS_PRESET_LOADING: "CARREGANDO PRESET IOSYS ",
  SWITCH_TO_MATRIX: "CHAVE PARA MATRIX",
  SWITCH_TO_AUX: "CHAVE PARA AUX",
  GATE_PRESETS: "PRESETS DO GATE  ",
  AFS_PRESETS: "PRESETS AFS 2",
  PRE_PROCESSING: "PROCESSAMENTO DO PRÉ",
  POST_PROCESSING: "PÓS-PROCESSAMENTO",
  ADDITIONAL_CHANNEL_DESTINATION: "saída direta",
  NO_PAN_ON_MONO_MATRIX: "SEM PAN <br> no MATRIX mono ",
  NO_USB_DEVICE_SELECTED: "Nenhum dispositivo USB SELECIONADO",
  GLOBAL_PRE_FADE_AUX_SEND_POINT: "PONTO GLOBAL AUX SEND",
  MOREME_PORTRAIT_MODE: "MOREME modo retrato",
  RESET_LOCAL_SETTINGS: "Redefinir as configurações LOCAIS",
  SYNC_SELECTED_CH: "SYNC ID DO CANAL SELECIONADO",
  MASTER_PASSWORD_PROTECTION: "PROTEÇÃO POR SENHA DO MASTER (GLOBAL) ",
  LOG_IN: "ENTRAR",
  LOG_OUT: "SAIR"
};
langBase.de = null;
langBase.fr = null;
langBase.es = null;
langBase.ru = null;
langBase.pt = null;
lang = langBase.en;

function ru_trans(a) {
  for (var b = a + "", c = a + "";;) {
    a = a.toUpperCase();
    a = a.replace(/NCE/g, "НСЕ");
    a = a.replace(/PROCE/g, "ПРОЦЕ");
    a = a.replace(/THIR/g, "СЁР");
    a = a.replace(/ENDO/g, "ЭНДО");
    a = a.replace(/THE/g, "ЗЕ");
    a = a.replace(/IGH/g, "АЙ");
    a = a.replace(/GAI/g, "ГЕЙ");
    a = a.replace(/SUB/g, "САБ");
    a = a.replace(/DY/g, "ДИ");
    a = a.replace(/SY/g, "CИ");
    a = a.replace(/AY/g, "ЭЙ");
    a = a.replace(/AI/g, "АЙ");
    a = a.replace(/ROU/g, "РУ");
    a = a.replace(/OU/g, "АУ");
    a = a.replace(/CH/g, "Ч");
    a = a.replace(/SH/g, "Ш");
    a = a.replace(/YA/g, "Я");
    a = a.replace(/YE/g,
      "E");
    a = a.replace(/YU/g, "Ю");
    a = a.replace(/OO/g, "У");
    a = a.replace(/AI/g, "ЭЙ");
    a = a.replace(/EQU/g, "ЭКВ");
    a = a.replace(/EQ/g, "ЭКВ");
    a = a.replace(/QU/g, "КВ");
    a = a.replace(/TY/g, "ТЫ");
    a = a.replace(/CC/g, "КЦ");
    a = a.replace(/TS/g, "Ц");
    a = a.replace(/DS/g, "ДЗ");
    a = a.replace(/ALL/g, "ОЛ");
    a = a.replace(/IDEN/g, "АЙДЕН");
    a = a.replace(/IDE/g, "АЙД");
    a = a.replace(/PH/g, "Ф");
    a = a.replace(/ISAT/g, "IZAT");
    a = a.replace(/TIONAL/g, "ЦИОНАЛ");
    a = a.replace(/TION/g, "ЦИЯ");
    a = a.replace(/CK/g, "К");
    a = a.replace(/OW/g, "ОУ");
    a = a.replace(/MIXE/g,
      "МИКШЕ");
    a = a.replace(/THI/g, "СИ");
    a = a.replace(/TH/g, "T");
    a = a.replace(/USE/g, "ЮЗЕ");
    a = a.replace(/RY/g, "РИ");
    a = a.replace(/FY/g, "ФАЙ");
    a = a.replace(/PY/g, "ПИ");
    a = a.replace(/PLY/g, "ПЛАЙ");
    a = a.replace(/LY/g, "ЛИ");
    a = a.replace(/CIA/g, "ЦИА");
    a = a.replace(/A/g, "А");
    a = a.replace(/B/g, "Б");
    a = a.replace(/C/g, "К");
    a = a.replace(/D/g, "Д");
    a = a.replace(/E/g, "Е");
    a = a.replace(/F/g, "Ф");
    a = a.replace(/G/g, "Г");
    a = a.replace(/H/g, "Х");
    a = a.replace(/I/g, "И");
    a = a.replace(/J/g, "ДЖ");
    a = a.replace(/K/g, "К");
    a = a.replace(/L/g, "Л");
    a = a.replace(/M/g,
      "М");
    a = a.replace(/N/g, "Н");
    a = a.replace(/O/g, "О");
    a = a.replace(/P/g, "П");
    a = a.replace(/Q/g, "КУ");
    a = a.replace(/R/g, "Р");
    a = a.replace(/S/g, "С");
    a = a.replace(/T/g, "Т");
    a = a.replace(/U/g, "У");
    a = a.replace(/V/g, "В");
    a = a.replace(/W/g, "В");
    a = a.replace(/X/g, "КС");
    a = a.replace(/Y/g, "Й");
    a = a.replace(/Z/g, "З");
    a = a.replace(/ТХ/g, "З");
    a = a.replace(/ДОУН/g, "ДАУН");
    a = a.replace(/ЛТ/g, "ЛЬТ");
    a = a.replace(/ЛД/g, "ЛЬД");
    a = a.replace(/ЛК/g, "ЛЬК");
    a = a.replace(/ЛС/g, "ЛЬС");
    if (a == b) break;
    b = a
  }
  for (b = a + "";;) {
    a = a.replace("<БР>", "<br>");
    if (a == b) break;
    b = a
  }
  "E" == c.substr(0, 1) && "Е" == a.substr(0, 1) && (a = "Э" + a.substr(1, a.length));
  return a
}

function encodedStr(a) {
  a = a.replace(/&/g, "&amp;");
  a = a.replace(/\</g, "&lt;");
  a = a.replace(/\>/g, "&gt;");
  a = a.replace(/"/g, "&quot;");
  return a = a.replace(/'/g, "&apos;")
}

function dumpTranslation(a) {
  print('<?xml version="1.0" encoding="utf-8"?>');
  print("<!DOCTYPE TS>");
  print('<TS version="2.0" sourcelanguage="en_GB">');
  print("<context>");
  print("    <name>Mixer</name>");
  var b = langBase.en;
  a = langBase[a];
  for (key in b) b.hasOwnProperty(key) && "lang" != key && (a.hasOwnProperty(key) ? (print("    <message>"), print("        <source>" + encodedStr(b[key]) + "</source>"), print("        <translation>" + encodedStr(a[key]) + "</translation>")) : (print("    <message>"), print("        <source>" +
    encodedStr(b[key]) + "</source>"), print('        <translation type="unfinished"></translation>')), print("    </message>"));
  print("</context>");
  print("</TS>")
}
var E_CABS2 = {
    0: "Fender Tweed Champ 1x8 Edge",
    1: "Fender Tweed Deluxe 1x12",
    2: "Fender Tweed Bassman 4x10",
    3: "Fender Blonde Bassman 2x12",
    4: "Fender Blackface Deluxe 1x12",
    5: "Fender Blackface Twin 2x12",
    6: "Marshall 4x12",
    7: "Marshall Greenback 4x12",
    8: "Johnson V30 4x12",
    9: "Hiwatt Fane 4x12",
    10: "Vht V30 4x12",
    11: "Vox Ac15 1x12 Center",
    12: "Vox Ac30 2x12",
    13: "Gsp2101 Speaker Compensation",
    14: "Digitech Bright Cab",
    15: "Digitech Solo Cab",
    16: "Digitech Rock Cab",
    17: "Digitech Altrock Cab",
    18: "Digitech Metal Cab",
    19: "Digitech Numetal Cab",
    20: "Acoustic Dreadnaught Cab",
    21: "Acoustic Jumbo Cab",
    22: "Direct Cab"
  },
  E_AMPS2 = {
    0: "Direct",
    32: "Digitech BlackBass",
    33: "Digitech Blues",
    34: "Digitech Brown Sound",
    36: "Digitech CleanTube",
    37: "Digitech Crunch",
    41: "Digitech GSP2101 CleanTube",
    42: "Digitech GSP2101 SaturatedTube",
    43: "Digitech HiGain",
    44: "Digitech Metal",
    45: "Digitech Monster",
    47: "Digitech Solo",
    49: "Digitech Stoner Rock",
    50: "Digitech Transistor",
    51: "Digitech TweedFace",
    1: "Carvin Legacy",
    2: "Matchless Cheiftain",
    3: "Fender BlackFace Deluxe",
    4: "Fender Blackface Twin",
    5: "Fender Brownface Bassman",
    6: "Fender Tweed Bassman",
    7: "Fender Tweed Champ",
    8: "Fender Tweed Deluxe",
    9: "Gibson GA40",
    10: "Hiwatt Custom 100",
    11: "Laney Supergroup",
    12: "Marshall JCM2000",
    13: "Marshall JCM800",
    14: "Marshall JCM900",
    15: "Marshall JTM45",
    16: "Marshall Master Volume",
    17: "Marshall Plexi",
    18: "Marshall Plexi Jumped",
    19: "Matchless DC30",
    20: "Mesa Dual Rectifier",
    21: "Mesa Mark IIC",
    22: "Mesa Mark IV",
    23: "Mesa Triple Rectifier",
    24: "Orange OR120",
    25: "Peavey 5150 II",
    26: "Randall RG100",
    27: "Roland Jazz Chorus",
    28: "Soldano SLO100",
    29: "Sunn 100S",
    30: "VOX AC15",
    31: "VOX AC30",
    52: "Acoustic Dreadnaught",
    53: "Acoustic Jumbo"
  };
IMG_TABLE = {
  "ui_about.png": {
    img: "imga_1.png",
    x: 1,
    y: 1,
    cw: 1024,
    ch: 748,
    dx: 0,
    dy: 0,
    ow: 1024,
    oh: 748,
    rot: !1
  },
  "TOPNAV-L.png": {
    img: "imga_1.png",
    x: 1,
    y: 751,
    cw: 601,
    ch: 75,
    dx: 0,
    dy: 0,
    ow: 601,
    oh: 75,
    rot: !1
  },
  "SCLOGO_B.png": {
    img: "imga_1.png",
    x: 1,
    y: 828,
    cw: 567,
    ch: 153,
    dx: 0,
    dy: 0,
    ow: 567,
    oh: 155,
    rot: !1
  },
  "TOPNAV-R-S.png": {
    img: "imga_1.png",
    x: 570,
    y: 828,
    cw: 430,
    ch: 75,
    dx: 0,
    dy: 0,
    ow: 430,
    oh: 75,
    rot: !1
  },
  "TOPNAV-R.png": {
    img: "imga_1.png",
    x: 570,
    y: 905,
    cw: 430,
    ch: 75,
    dx: 0,
    dy: 0,
    ow: 430,
    oh: 75,
    rot: !1
  },
  "TOPNAV-T3.png": {
    img: "imga_1.png",
    x: 604,
    y: 751,
    cw: 400,
    ch: 75,
    dx: 0,
    dy: 0,
    ow: 400,
    oh: 75,
    rot: !1
  },
  "DIGI_AM.png": {
    img: "imga_1.png",
    x: 1,
    y: 983,
    cw: 293,
    ch: 26,
    dx: 0,
    dy: 0,
    ow: 293,
    oh: 26,
    rot: !1
  },
  "dbx_logo.png": {
    img: "imga_1.png",
    x: 296,
    y: 983,
    cw: 276,
    ch: 40,
    dx: 0,
    dy: 0,
    ow: 276,
    oh: 40,
    rot: !1
  },
  "lex_cho.png": {
    img: "imga_1.png",
    x: 574,
    y: 982,
    cw: 252,
    ch: 36,
    dx: 0,
    dy: 0,
    ow: 252,
    oh: 36,
    rot: !1
  },
  "SO-TILE.png": {
    img: "imga_1.png",
    x: 70,
    y: 1011,
    cw: 224,
    ch: 10,
    dx: 0,
    dy: 0,
    ow: 224,
    oh: 10,
    rot: !1
  },
  "SO-L-BTN-OFF.png": {
    img: "imga_1.png",
    x: 828,
    y: 982,
    cw: 192,
    ch: 36,
    dx: 0,
    dy: 0,
    ow: 192,
    oh: 36,
    rot: !1
  },
  "M VU TILE2.png": {
    img: "imga_1.png",
    x: 1006,
    y: 751,
    cw: 10,
    ch: 120,
    dx: 0,
    dy: 0,
    ow: 10,
    oh: 120,
    rot: !1
  },
  "TOPNAV-T.png": {
    img: "imga_1.png",
    x: 1002,
    y: 873,
    cw: 10,
    ch: 75,
    dx: 0,
    dy: 0,
    ow: 10,
    oh: 75,
    rot: !1
  },
  "PEAK-ON.png": {
    img: "imga_1.png",
    x: 1002,
    y: 950,
    cw: 20,
    ch: 18,
    dx: 1,
    dy: 1,
    ow: 22,
    oh: 20,
    rot: !1
  },
  "PEAK-OFF.png": {
    img: "imga_1.png",
    x: 55,
    y: 1011,
    cw: 13,
    ch: 11,
    dx: 5,
    dy: 5,
    ow: 22,
    oh: 20,
    rot: !1
  },
  "M VU TILEH.png": {
    img: "imga_1.png",
    x: 42,
    y: 1011,
    cw: 11,
    ch: 12,
    dx: 0,
    dy: 0,
    ow: 11,
    oh: 12,
    rot: !1
  },
  "M VU TILE4.png": {
    img: "imga_1.png",
    x: 29,
    y: 1011,
    cw: 11,
    ch: 12,
    dx: 0,
    dy: 0,
    ow: 11,
    oh: 12,
    rot: !1
  },
  "M VU TILE5.png": {
    img: "imga_1.png",
    x: 16,
    y: 1011,
    cw: 11,
    ch: 12,
    dx: 0,
    dy: 0,
    ow: 11,
    oh: 12,
    rot: !1
  },
  "M VU TILE.png": {
    img: "imga_1.png",
    x: 4,
    y: 1011,
    cw: 10,
    ch: 12,
    dx: 0,
    dy: 0,
    ow: 10,
    oh: 12,
    rot: !1
  },
  "uix.png": {
    img: "imga_2.png",
    x: 1,
    y: 1,
    cw: 670,
    ch: 560,
    dx: 0,
    dy: 0,
    ow: 670,
    oh: 560,
    rot: !1
  },
  "SO-TOP.png": {
    img: "imga_2.png",
    x: 673,
    y: 1,
    cw: 224,
    ch: 546,
    dx: 0,
    dy: 0,
    ow: 224,
    oh: 546,
    rot: !1
  },
  "UI_SPLASH_D.png": {
    img: "imga_2.png",
    x: 1,
    y: 563,
    cw: 489,
    ch: 459,
    dx: 0,
    dy: 0,
    ow: 489,
    oh: 516,
    rot: !1
  },
  "M VU TILE3.png": {
    img: "imga_2.png",
    x: 899,
    y: 1,
    cw: 10,
    ch: 480,
    dx: 0,
    dy: 0,
    ow: 10,
    oh: 480,
    rot: !1
  },
  "SPKR-GREY.png": {
    img: "imga_2.png",
    x: 492,
    y: 563,
    cw: 391,
    ch: 412,
    dx: 13,
    dy: 0,
    ow: 416,
    oh: 442,
    rot: !1
  },
  "DYN-LED.png": {
    img: "imga_2.png",
    x: 492,
    y: 977,
    cw: 314,
    ch: 42,
    dx: 0,
    dy: 0,
    ow: 314,
    oh: 42,
    rot: !1
  },
  "BLANK-SC-TILE.png": {
    img: "imga_2.png",
    x: 911,
    y: 1,
    cw: 112,
    ch: 300,
    dx: 0,
    dy: 0,
    ow: 112,
    oh: 300,
    rot: !1
  },
  "BLANK-SC-TILE4.png": {
    img: "imga_2.png",
    x: 911,
    y: 303,
    cw: 112,
    ch: 300,
    dx: 0,
    dy: 0,
    ow: 112,
    oh: 300,
    rot: !1
  },
  "C-TILE.png": {
    img: "imga_2.png",
    x: 885,
    y: 605,
    cw: 112,
    ch: 264,
    dx: 0,
    dy: 0,
    ow: 112,
    oh: 264,
    rot: !1
  },
  "SO-L-BTN-TUR.png": {
    img: "imga_2.png",
    x: 808,
    y: 977,
    cw: 192,
    ch: 33,
    dx: 0,
    dy: 0,
    ow: 192,
    oh: 36,
    rot: !1
  },
  "EQ-AUX-LED.png": {
    img: "imga_2.png",
    x: 885,
    y: 871,
    cw: 133,
    ch: 42,
    dx: 0,
    dy: 0,
    ow: 133,
    oh: 42,
    rot: !1
  },
  "M-BOTTOM.png": {
    img: "imga_2.png",
    x: 885,
    y: 915,
    cw: 127,
    ch: 59,
    dx: 0,
    dy: 0,
    ow: 127,
    oh: 59,
    rot: !1
  },
  "SO_TILE.png": {
    img: "imga_2.png",
    x: 673,
    y: 549,
    cw: 112,
    ch: 10,
    dx: 0,
    dy: 0,
    ow: 112,
    oh: 10,
    rot: !1
  },
  "SO_TILE_.png": {
    img: "imga_2.png",
    x: 787,
    y: 549,
    cw: 112,
    ch: 10,
    dx: 0,
    dy: 0,
    ow: 112,
    oh: 10,
    rot: !1
  },
  "SO-SC-TILE.png": {
    img: "imga_2.png",
    x: 808,
    y: 1012,
    cw: 112,
    ch: 10,
    dx: 0,
    dy: 0,
    ow: 112,
    oh: 10,
    rot: !1
  },
  "PAN-SLIDER.png": {
    img: "imga_2.png",
    x: 885,
    y: 561,
    cw: 18,
    ch: 39,
    dx: 0,
    dy: 0,
    ow: 18,
    oh: 40,
    rot: !1
  },
  "lock.png": {
    img: "imga_2.png",
    x: 999,
    y: 605,
    cw: 16,
    ch: 20,
    dx: 11,
    dy: 9,
    ow: 38,
    oh: 38,
    rot: !1
  },
  "lock_3.png": {
    img: "imga_2.png",
    x: 999,
    y: 627,
    cw: 14,
    ch: 16,
    dx: 3,
    dy: 2,
    ow: 20,
    oh: 20,
    rot: !1
  },
  "BOLT_ICON.png": {
    img: "imga_2.png",
    x: 999,
    y: 645,
    cw: 12,
    ch: 16,
    dx: 2,
    dy: 0,
    ow: 16,
    oh: 16,
    rot: !1
  },
  "BOLT_ICON_W.png": {
    img: "imga_2.png",
    x: 999,
    y: 663,
    cw: 12,
    ch: 16,
    dx: 2,
    dy: 0,
    ow: 16,
    oh: 16,
    rot: !1
  },
  "picto_gr.png": {
    img: "imga_2.png",
    x: 999,
    y: 681,
    cw: 14,
    ch: 14,
    dx: 0,
    dy: 0,
    ow: 14,
    oh: 14,
    rot: !1
  },
  "picto_gr2.png": {
    img: "imga_2.png",
    x: 999,
    y: 681,
    cw: 14,
    ch: 14,
    dx: 0,
    dy: 0,
    ow: 14,
    oh: 14,
    rot: !1
  },
  "PEDAL-LIGHT-ON.png": {
    img: "imga_2.png",
    x: 999,
    y: 697,
    cw: 11,
    ch: 11,
    dx: 0,
    dy: 0,
    ow: 11,
    oh: 11,
    rot: !1
  },
  "lex_plate_clean.png": {
    img: "imga_3.png",
    x: 1,
    y: 1,
    cw: 400,
    ch: 90,
    dx: 0,
    dy: 0,
    ow: 400,
    oh: 90,
    rot: !1
  },
  "LEX-REV.png": {
    img: "imga_3.png",
    x: 403,
    y: 1,
    cw: 400,
    ch: 90,
    dx: 0,
    dy: 0,
    ow: 400,
    oh: 90,
    rot: !1
  },
  "LEX-RM.png": {
    img: "imga_3.png",
    x: 1,
    y: 93,
    cw: 400,
    ch: 90,
    dx: 0,
    dy: 0,
    ow: 400,
    oh: 90,
    rot: !1
  },
  "LEX-DB.png": {
    img: "imga_3.png",
    x: 403,
    y: 93,
    cw: 400,
    ch: 90,
    dx: 0,
    dy: 0,
    ow: 400,
    oh: 90,
    rot: !1
  },
  "LEX-DA.png": {
    img: "imga_3.png",
    x: 1,
    y: 185,
    cw: 400,
    ch: 90,
    dx: 0,
    dy: 0,
    ow: 400,
    oh: 90,
    rot: !1
  },
  "LEX-CH.png": {
    img: "imga_3.png",
    x: 403,
    y: 185,
    cw: 400,
    ch: 90,
    dx: 0,
    dy: 0,
    ow: 400,
    oh: 90,
    rot: !1
  },
  "DIGICAB_A2.png": {
    img: "imga_3.png",
    x: 1,
    y: 277,
    cw: 391,
    ch: 150,
    dx: 13,
    dy: 0,
    ow: 416,
    oh: 150,
    rot: !1
  },
  "DIGIAMP_A.png": {
    img: "imga_3.png",
    x: 394,
    y: 277,
    cw: 345,
    ch: 139,
    dx: 0,
    dy: 0,
    ow: 345,
    oh: 139,
    rot: !1
  },
  "AMP-GREY.png": {
    img: "imga_3.png",
    x: 678,
    y: 418,
    cw: 345,
    ch: 139,
    dx: 0,
    dy: 0,
    ow: 345,
    oh: 139,
    rot: !1
  },
  "lex_logo.png": {
    img: "imga_3.png",
    x: 741,
    y: 277,
    cw: 246,
    ch: 36,
    dx: 0,
    dy: 0,
    ow: 246,
    oh: 36,
    rot: !1
  },
  "lex_dly.png": {
    img: "imga_3.png",
    x: 741,
    y: 315,
    cw: 238,
    ch: 40,
    dx: 0,
    dy: 0,
    ow: 238,
    oh: 40,
    rot: !1
  },
  "lex_rmlogo.png": {
    img: "imga_3.png",
    x: 741,
    y: 357,
    cw: 236,
    ch: 36,
    dx: 0,
    dy: 0,
    ow: 236,
    oh: 36,
    rot: !1
  },
  "SO-BOTTOM.png": {
    img: "imga_3.png",
    x: 452,
    y: 418,
    cw: 224,
    ch: 142,
    dx: 0,
    dy: 0,
    ow: 224,
    oh: 142,
    rot: !1
  },
  "M-TOP-NCS.png": {
    img: "imga_3.png",
    x: 805,
    y: 1,
    cw: 127,
    ch: 202,
    dx: 0,
    dy: 0,
    ow: 127,
    oh: 202,
    rot: !1
  },
  "AUX-M-TOP2.png": {
    img: "imga_3.png",
    x: 323,
    y: 429,
    cw: 127,
    ch: 202,
    dx: 0,
    dy: 0,
    ow: 127,
    oh: 202,
    rot: !1
  },
  "C-AUX-TOP-UPD.png": {
    img: "imga_3.png",
    x: 209,
    y: 429,
    cw: 112,
    ch: 202,
    dx: 0,
    dy: 0,
    ow: 112,
    oh: 202,
    rot: !1
  },
  "C-AUX-TOP.png": {
    img: "imga_3.png",
    x: 95,
    y: 429,
    cw: 112,
    ch: 202,
    dx: 0,
    dy: 0,
    ow: 112,
    oh: 202,
    rot: !1
  },
  "AUX-SC-TOP.png": {
    img: "imga_3.png",
    x: 911,
    y: 559,
    cw: 112,
    ch: 201,
    dx: 0,
    dy: 0,
    ow: 112,
    oh: 201,
    rot: !1
  },
  "C-TOP.png": {
    img: "imga_3.png",
    x: 797,
    y: 559,
    cw: 112,
    ch: 201,
    dx: 0,
    dy: 0,
    ow: 112,
    oh: 201,
    rot: !1
  },
  "TOPNAV-T2.png": {
    img: "imga_3.png",
    x: 595,
    y: 562,
    cw: 200,
    ch: 75,
    dx: 0,
    dy: 0,
    ow: 200,
    oh: 75,
    rot: !1
  },
  "SO-L-BTN-RED.png": {
    img: "imga_3.png",
    x: 805,
    y: 205,
    cw: 192,
    ch: 33,
    dx: 0,
    dy: 0,
    ow: 192,
    oh: 36,
    rot: !1
  },
  "SO-SC-TOP.png": {
    img: "imga_3.png",
    x: 481,
    y: 562,
    cw: 112,
    ch: 190,
    dx: 0,
    dy: 0,
    ow: 112,
    oh: 190,
    rot: !1
  },
  "SC-TOP.png": {
    img: "imga_3.png",
    x: 367,
    y: 633,
    cw: 112,
    ch: 190,
    dx: 0,
    dy: 0,
    ow: 112,
    oh: 190,
    rot: !1
  },
  "EQ-CHN-LED.png": {
    img: "imga_3.png",
    x: 175,
    y: 633,
    cw: 190,
    ch: 42,
    dx: 0,
    dy: 0,
    ow: 190,
    oh: 42,
    rot: !1
  },
  "BLANK-SC-TOP2.png": {
    img: "imga_3.png",
    x: 61,
    y: 633,
    cw: 112,
    ch: 161,
    dx: 0,
    dy: 0,
    ow: 112,
    oh: 161,
    rot: !1
  },
  "TOPNAV-LED.png": {
    img: "imga_3.png",
    x: 595,
    y: 639,
    cw: 157,
    ch: 42,
    dx: 2,
    dy: 0,
    ow: 160,
    oh: 54,
    rot: !1
  },
  "LED-PRESET.png": {
    img: "imga_3.png",
    x: 805,
    y: 240,
    cw: 150,
    ch: 24,
    dx: 0,
    dy: 0,
    ow: 150,
    oh: 24,
    rot: !1
  },
  "M-TILE.png": {
    img: "imga_3.png",
    x: 175,
    y: 677,
    cw: 127,
    ch: 42,
    dx: 0,
    dy: 0,
    ow: 127,
    oh: 42,
    rot: !1
  },
  "M-LABEL.png": {
    img: "imga_3.png",
    x: 595,
    y: 683,
    cw: 127,
    ch: 34,
    dx: 0,
    dy: 0,
    ow: 127,
    oh: 34,
    rot: !1
  },
  "SO-SC-BOTTOM.png": {
    img: "imga_3.png",
    x: 253,
    y: 721,
    cw: 112,
    ch: 125,
    dx: 0,
    dy: 0,
    ow: 112,
    oh: 125,
    rot: !1
  },
  "SC-BOTTOM.png": {
    img: "imga_3.png",
    x: 595,
    y: 719,
    cw: 112,
    ch: 125,
    dx: 0,
    dy: 0,
    ow: 112,
    oh: 125,
    rot: !1
  },
  "SO_SCUI_LOGO_.png": {
    img: "imga_3.png",
    x: 481,
    y: 754,
    cw: 112,
    ch: 125,
    dx: 0,
    dy: 0,
    ow: 112,
    oh: 125,
    rot: !1
  },
  "MTA-OFF.png": {
    img: "imga_3.png",
    x: 709,
    y: 762,
    cw: 119,
    ch: 37,
    dx: 0,
    dy: 0,
    ow: 119,
    oh: 37,
    rot: !1
  },
  "CMIX-OFF.png": {
    img: "imga_3.png",
    x: 830,
    y: 762,
    cw: 119,
    ch: 37,
    dx: 0,
    dy: 0,
    ow: 119,
    oh: 37,
    rot: !1
  },
  "MTA-ON.png": {
    img: "imga_3.png",
    x: 1,
    y: 796,
    cw: 119,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 119,
    oh: 37,
    rot: !1
  },
  "CMIX-ON.png": {
    img: "imga_3.png",
    x: 122,
    y: 796,
    cw: 119,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 119,
    oh: 37,
    rot: !1
  },
  "LARGE-MUTE-OFF.png": {
    img: "imga_3.png",
    x: 906,
    y: 801,
    cw: 117,
    ch: 37,
    dx: 0,
    dy: 0,
    ow: 117,
    oh: 37,
    rot: !1
  },
  "LARGE-MUTE-ON.png": {
    img: "imga_3.png",
    x: 787,
    y: 801,
    cw: 117,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 117,
    oh: 37,
    rot: !1
  },
  "AUX-SC-TILE.png": {
    img: "imga_3.png",
    x: 367,
    y: 825,
    cw: 112,
    ch: 100,
    dx: 0,
    dy: 0,
    ow: 112,
    oh: 100,
    rot: !1
  },
  "SO_BOTTOM.png": {
    img: "imga_3.png",
    x: 1,
    y: 833,
    cw: 112,
    ch: 78,
    dx: 0,
    dy: 0,
    ow: 112,
    oh: 78,
    rot: !1
  },
  "SO_SCA_LOGO_F.png": {
    img: "imga_3.png",
    x: 115,
    y: 833,
    cw: 112,
    ch: 64,
    dx: 0,
    dy: 0,
    ow: 112,
    oh: 64,
    rot: !1
  },
  "SO_SCB_LOGO.png": {
    img: "imga_3.png",
    x: 709,
    y: 838,
    cw: 112,
    ch: 64,
    dx: 0,
    dy: 0,
    ow: 112,
    oh: 64,
    rot: !1
  },
  "BLANK-SC-BOTTOM.png": {
    img: "imga_3.png",
    x: 823,
    y: 840,
    cw: 112,
    ch: 59,
    dx: 0,
    dy: 0,
    ow: 112,
    oh: 59,
    rot: !1
  },
  "AUX-SC-BOTTOM.png": {
    img: "imga_3.png",
    x: 229,
    y: 848,
    cw: 112,
    ch: 59,
    dx: 0,
    dy: 0,
    ow: 112,
    oh: 59,
    rot: !1
  },
  "BLANK-SC-TILE3.png": {
    img: "imga_3.png",
    x: 823,
    y: 840,
    cw: 112,
    ch: 59,
    dx: 0,
    dy: 0,
    ow: 112,
    oh: 59,
    rot: !1
  },
  "C-BOT.png": {
    img: "imga_3.png",
    x: 595,
    y: 846,
    cw: 112,
    ch: 59,
    dx: 0,
    dy: 0,
    ow: 112,
    oh: 59,
    rot: !1
  },
  "C-TILE_small.png": {
    img: "imga_3.png",
    x: 481,
    y: 881,
    cw: 112,
    ch: 42,
    dx: 0,
    dy: 0,
    ow: 112,
    oh: 42,
    rot: !1
  },
  "BLANK-SC-TILE2.png": {
    img: "imga_3.png",
    x: 115,
    y: 899,
    cw: 112,
    ch: 42,
    dx: 0,
    dy: 0,
    ow: 112,
    oh: 42,
    rot: !1
  },
  "BLANK-SC-LABEL.png": {
    img: "imga_3.png",
    x: 911,
    y: 901,
    cw: 112,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 112,
    oh: 35,
    rot: !1
  },
  "C-LABEL.png": {
    img: "imga_3.png",
    x: 797,
    y: 904,
    cw: 112,
    ch: 34,
    dx: 0,
    dy: 0,
    ow: 112,
    oh: 34,
    rot: !1
  },
  "SC-TILE.png": {
    img: "imga_3.png",
    x: 741,
    y: 395,
    cw: 112,
    ch: 10,
    dx: 0,
    dy: 0,
    ow: 112,
    oh: 10,
    rot: !1
  },
  "MUTE-L-BTN-OFF.png": {
    img: "imga_3.png",
    x: 691,
    y: 907,
    cw: 104,
    ch: 37,
    dx: 0,
    dy: 0,
    ow: 104,
    oh: 37,
    rot: !1
  },
  "HIZ-OFF.png": {
    img: "imga_3.png",
    x: 229,
    y: 909,
    cw: 104,
    ch: 37,
    dx: 0,
    dy: 0,
    ow: 104,
    oh: 37,
    rot: !1
  },
  "PHANTOM-OFF.png": {
    img: "imga_3.png",
    x: 9,
    y: 913,
    cw: 104,
    ch: 37,
    dx: 0,
    dy: 0,
    ow: 104,
    oh: 37,
    rot: !1
  },
  "PHANTOM-ON.png": {
    img: "imga_3.png",
    x: 585,
    y: 925,
    cw: 104,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 104,
    oh: 37,
    rot: !1
  },
  "HIZ-ON.png": {
    img: "imga_3.png",
    x: 335,
    y: 927,
    cw: 104,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 104,
    oh: 37,
    rot: !1
  },
  "MUTE-L-BTN-ON.png": {
    img: "imga_3.png",
    x: 441,
    y: 927,
    cw: 104,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 104,
    oh: 37,
    rot: !1
  },
  "DIGITECH_LOGO.png": {
    img: "imga_3.png",
    x: 855,
    y: 395,
    cw: 102,
    ch: 18,
    dx: 0,
    dy: 0,
    ow: 102,
    oh: 18,
    rot: !1
  },
  "TAP-BLA-OFF.png": {
    img: "imga_3.png",
    x: 922,
    y: 938,
    cw: 101,
    ch: 45,
    dx: 0,
    dy: 0,
    ow: 101,
    oh: 45,
    rot: !1
  },
  "TAP-B-OFF.png": {
    img: "imga_3.png",
    x: 819,
    y: 940,
    cw: 101,
    ch: 45,
    dx: 0,
    dy: 0,
    ow: 101,
    oh: 45,
    rot: !1
  },
  "MOME-OFF.png": {
    img: "imga_3.png",
    x: 716,
    y: 946,
    cw: 101,
    ch: 45,
    dx: 0,
    dy: 0,
    ow: 101,
    oh: 45,
    rot: !1
  },
  "TAP-B-ON2.png": {
    img: "imga_3.png",
    x: 115,
    y: 943,
    cw: 101,
    ch: 43,
    dx: 0,
    dy: 0,
    ow: 101,
    oh: 45,
    rot: !1
  },
  "TAP-B-ON.png": {
    img: "imga_3.png",
    x: 218,
    y: 948,
    cw: 101,
    ch: 43,
    dx: 0,
    dy: 0,
    ow: 101,
    oh: 45,
    rot: !1
  },
  "TAP-BLA-ON.png": {
    img: "imga_3.png",
    x: 12,
    y: 952,
    cw: 101,
    ch: 42,
    dx: 0,
    dy: 0,
    ow: 101,
    oh: 45,
    rot: !1
  },
  "TAP-BLU-ON.png": {
    img: "imga_3.png",
    x: 321,
    y: 964,
    cw: 101,
    ch: 42,
    dx: 0,
    dy: 0,
    ow: 101,
    oh: 45,
    rot: !1
  },
  "MOME-ON.png": {
    img: "imga_3.png",
    x: 424,
    y: 964,
    cw: 101,
    ch: 42,
    dx: 0,
    dy: 0,
    ow: 101,
    oh: 45,
    rot: !1
  },
  "VIEWGR-BTN-OFF.png": {
    img: "imga_3.png",
    x: 527,
    y: 964,
    cw: 101,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 101,
    oh: 35,
    rot: !1
  },
  "TAPT-BTN-OFF.png": {
    img: "imga_3.png",
    x: 922,
    y: 985,
    cw: 101,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 101,
    oh: 35,
    rot: !1
  },
  "SUBGR-BTN-OFF.png": {
    img: "imga_3.png",
    x: 819,
    y: 987,
    cw: 101,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 101,
    oh: 35,
    rot: !1
  },
  "MUTEA-BTN-OFF.png": {
    img: "imga_3.png",
    x: 115,
    y: 988,
    cw: 101,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 101,
    oh: 35,
    rot: !1
  },
  "mix_a.png": {
    img: "imga_3.png",
    x: 1,
    y: 429,
    cw: 92,
    ch: 44,
    dx: 0,
    dy: 0,
    ow: 92,
    oh: 49,
    rot: !1
  },
  "EDT-ON_T.png": {
    img: "imga_3.png",
    x: 1,
    y: 475,
    cw: 92,
    ch: 44,
    dx: 0,
    dy: 0,
    ow: 92,
    oh: 49,
    rot: !1
  },
  "EDT-ON.png": {
    img: "imga_3.png",
    x: 1,
    y: 521,
    cw: 92,
    ch: 44,
    dx: 0,
    dy: 0,
    ow: 92,
    oh: 49,
    rot: !1
  },
  "mix_b2.png": {
    img: "imga_3.png",
    x: 1,
    y: 567,
    cw: 92,
    ch: 44,
    dx: 0,
    dy: 0,
    ow: 92,
    oh: 49,
    rot: !1
  },
  "SO-B-BTN-OFF.png": {
    img: "imga_3.png",
    x: 934,
    y: 1,
    cw: 88,
    ch: 56,
    dx: 0,
    dy: 0,
    ow: 88,
    oh: 56,
    rot: !1
  },
  "SO-B-BTN-PNK.png": {
    img: "imga_3.png",
    x: 934,
    y: 59,
    cw: 88,
    ch: 53,
    dx: 0,
    dy: 0,
    ow: 88,
    oh: 56,
    rot: !1
  },
  "SO-B-BTN-BLU.png": {
    img: "imga_3.png",
    x: 934,
    y: 114,
    cw: 88,
    ch: 53,
    dx: 0,
    dy: 0,
    ow: 88,
    oh: 56,
    rot: !1
  },
  "SO-M-BTN-BLU.png": {
    img: "imga_3.png",
    x: 934,
    y: 169,
    cw: 88,
    ch: 33,
    dx: 0,
    dy: 0,
    ow: 88,
    oh: 36,
    rot: !1
  },
  "SLIDER_YELLOW.png": {
    img: "imga_3.png",
    x: 989,
    y: 240,
    cw: 31,
    ch: 85,
    dx: 0,
    dy: 0,
    ow: 31,
    oh: 90,
    rot: !1
  },
  "SLIDER_PINK.png": {
    img: "imga_3.png",
    x: 981,
    y: 327,
    cw: 31,
    ch: 85,
    dx: 0,
    dy: 0,
    ow: 31,
    oh: 90,
    rot: !1
  },
  "SLIDER_GREEN.png": {
    img: "imga_3.png",
    x: 28,
    y: 613,
    cw: 31,
    ch: 85,
    dx: 0,
    dy: 0,
    ow: 31,
    oh: 90,
    rot: !1
  },
  "SLIDER_BLUE.png": {
    img: "imga_3.png",
    x: 754,
    y: 639,
    cw: 31,
    ch: 85,
    dx: 0,
    dy: 0,
    ow: 31,
    oh: 90,
    rot: !1
  },
  "SLIDER_RED.png": {
    img: "imga_3.png",
    x: 28,
    y: 700,
    cw: 31,
    ch: 85,
    dx: 0,
    dy: 0,
    ow: 31,
    oh: 90,
    rot: !1
  },
  "AUXS-LED.png": {
    img: "imga_3.png",
    x: 709,
    y: 726,
    cw: 80,
    ch: 29,
    dx: 0,
    dy: 0,
    ow: 80,
    oh: 29,
    rot: !1
  },
  "EQ-ON.png": {
    img: "imga_3.png",
    x: 937,
    y: 840,
    cw: 77,
    ch: 45,
    dx: 0,
    dy: 0,
    ow: 77,
    oh: 49,
    rot: !1
  },
  "UMIX-ON3.png": {
    img: "imga_3.png",
    x: 630,
    y: 962,
    cw: 77,
    ch: 45,
    dx: 0,
    dy: 0,
    ow: 77,
    oh: 49,
    rot: !1
  },
  "SLIDER_SILVER_H.png": {
    img: "imga_3.png",
    x: 175,
    y: 721,
    cw: 72,
    ch: 46,
    dx: 0,
    dy: 0,
    ow: 72,
    oh: 49,
    rot: !1
  },
  "AFS-OFF-B.png": {
    img: "imga_3.png",
    x: 951,
    y: 762,
    cw: 72,
    ch: 37,
    dx: 0,
    dy: 0,
    ow: 72,
    oh: 37,
    rot: !1
  },
  "BYPASS-ON.png": {
    img: "imga_3.png",
    x: 709,
    y: 801,
    cw: 72,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 72,
    oh: 37,
    rot: !1
  },
  "FX-S-LED.png": {
    img: "imga_3.png",
    x: 175,
    y: 769,
    cw: 70,
    ch: 23,
    dx: 0,
    dy: 0,
    ow: 70,
    oh: 23,
    rot: !1
  },
  "lex.png": {
    img: "imga_3.png",
    x: 218,
    y: 993,
    cw: 66,
    ch: 21,
    dx: 0,
    dy: 0,
    ow: 66,
    oh: 21,
    rot: !1
  },
  "EQ-FADER-H-GRAY.png": {
    img: "imga_3.png",
    x: 304,
    y: 677,
    cw: 61,
    ch: 42,
    dx: 0,
    dy: 0,
    ow: 61,
    oh: 45,
    rot: !1
  },
  "AFS2LOGO.png": {
    img: "imga_3.png",
    x: 778,
    y: 993,
    cw: 39,
    ch: 23,
    dx: 0,
    dy: 0,
    ow: 39,
    oh: 23,
    rot: !1
  },
  "dbx.png": {
    img: "imga_3.png",
    x: 547,
    y: 925,
    cw: 36,
    ch: 21,
    dx: 0,
    dy: 0,
    ow: 36,
    oh: 21,
    rot: !1
  },
  "lex_load-btn-off.png": {
    img: "imga_3.png",
    x: 286,
    y: 993,
    cw: 31,
    ch: 29,
    dx: 0,
    dy: 0,
    ow: 31,
    oh: 29,
    rot: !1
  },
  "lex_load-btn-on.png": {
    img: "imga_3.png",
    x: 745,
    y: 993,
    cw: 31,
    ch: 29,
    dx: 0,
    dy: 0,
    ow: 31,
    oh: 29,
    rot: !1
  },
  "lex_load-btn-off_b.png": {
    img: "imga_3.png",
    x: 712,
    y: 993,
    cw: 31,
    ch: 29,
    dx: 0,
    dy: 0,
    ow: 31,
    oh: 29,
    rot: !1
  },
  "FXRET-BTN-OFF.png": {
    img: "imga_4.png",
    x: 1,
    y: 1,
    cw: 101,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 101,
    oh: 35,
    rot: !1
  },
  "INPUTS-OFF.png": {
    img: "imga_4.png",
    x: 104,
    y: 1,
    cw: 101,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 101,
    oh: 35,
    rot: !1
  },
  "MUTEGR-BTN-OFF.png": {
    img: "imga_4.png",
    x: 207,
    y: 1,
    cw: 101,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 101,
    oh: 35,
    rot: !1
  },
  "AUXM-BTN-OFF.png": {
    img: "imga_4.png",
    x: 310,
    y: 1,
    cw: 101,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 101,
    oh: 35,
    rot: !1
  },
  "MUTEA-BTN-ON.png": {
    img: "imga_4.png",
    x: 413,
    y: 1,
    cw: 101,
    ch: 32,
    dx: 0,
    dy: 0,
    ow: 101,
    oh: 35,
    rot: !1
  },
  "MUTEGR-BTN-ON.png": {
    img: "imga_4.png",
    x: 516,
    y: 1,
    cw: 101,
    ch: 32,
    dx: 0,
    dy: 0,
    ow: 101,
    oh: 35,
    rot: !1
  },
  "INPUTS-ON.png": {
    img: "imga_4.png",
    x: 619,
    y: 1,
    cw: 101,
    ch: 32,
    dx: 0,
    dy: 0,
    ow: 101,
    oh: 35,
    rot: !1
  },
  "SUBGR-BTN-ON.png": {
    img: "imga_4.png",
    x: 722,
    y: 1,
    cw: 101,
    ch: 32,
    dx: 0,
    dy: 0,
    ow: 101,
    oh: 35,
    rot: !1
  },
  "TAPT-BTN-ON.png": {
    img: "imga_4.png",
    x: 825,
    y: 1,
    cw: 101,
    ch: 32,
    dx: 0,
    dy: 0,
    ow: 101,
    oh: 35,
    rot: !1
  },
  "VIEWGR-BTN-ON.png": {
    img: "imga_4.png",
    x: 922,
    y: 35,
    cw: 101,
    ch: 32,
    dx: 0,
    dy: 0,
    ow: 101,
    oh: 35,
    rot: !1
  },
  "FXRET-BTN-ON.png": {
    img: "imga_4.png",
    x: 819,
    y: 35,
    cw: 101,
    ch: 32,
    dx: 0,
    dy: 0,
    ow: 101,
    oh: 35,
    rot: !1
  },
  "AUXM-BTN-ON.png": {
    img: "imga_4.png",
    x: 716,
    y: 35,
    cw: 101,
    ch: 32,
    dx: 0,
    dy: 0,
    ow: 101,
    oh: 35,
    rot: !1
  },
  "AUXM-BTN-ON2.png": {
    img: "imga_4.png",
    x: 613,
    y: 35,
    cw: 101,
    ch: 32,
    dx: 0,
    dy: 0,
    ow: 101,
    oh: 35,
    rot: !1
  },
  "TAP-B-OFF_.png": {
    img: "imga_4.png",
    x: 517,
    y: 35,
    cw: 94,
    ch: 44,
    dx: 0,
    dy: 0,
    ow: 94,
    oh: 46,
    rot: !1
  },
  "TAP-B-ON_.png": {
    img: "imga_4.png",
    x: 421,
    y: 35,
    cw: 94,
    ch: 44,
    dx: 0,
    dy: 0,
    ow: 94,
    oh: 46,
    rot: !1
  },
  "AUX-BTN_Y1.png": {
    img: "imga_4.png",
    x: 327,
    y: 38,
    cw: 92,
    ch: 43,
    dx: 0,
    dy: 0,
    ow: 92,
    oh: 49,
    rot: !1
  },
  "FXS-ON.png": {
    img: "imga_4.png",
    x: 233,
    y: 38,
    cw: 92,
    ch: 43,
    dx: 0,
    dy: 0,
    ow: 92,
    oh: 49,
    rot: !1
  },
  "MIX_B100.png": {
    img: "imga_4.png",
    x: 139,
    y: 38,
    cw: 92,
    ch: 43,
    dx: 0,
    dy: 0,
    ow: 92,
    oh: 49,
    rot: !1
  },
  "AUXS-ON.png": {
    img: "imga_4.png",
    x: 45,
    y: 38,
    cw: 92,
    ch: 43,
    dx: 0,
    dy: 0,
    ow: 92,
    oh: 49,
    rot: !1
  },
  "MIXG-ON.png": {
    img: "imga_4.png",
    x: 931,
    y: 69,
    cw: 92,
    ch: 43,
    dx: 0,
    dy: 0,
    ow: 92,
    oh: 49,
    rot: !1
  },
  "MIXG-GAIN.png": {
    img: "imga_4.png",
    x: 837,
    y: 69,
    cw: 92,
    ch: 43,
    dx: 0,
    dy: 0,
    ow: 92,
    oh: 49,
    rot: !1
  },
  "GAIN-ON.png": {
    img: "imga_4.png",
    x: 743,
    y: 69,
    cw: 92,
    ch: 40,
    dx: 0,
    dy: 3,
    ow: 92,
    oh: 49,
    rot: !1
  },
  "FXS-OFF.png": {
    img: "imga_4.png",
    x: 651,
    y: 69,
    cw: 90,
    ch: 45,
    dx: 1,
    dy: 4,
    ow: 92,
    oh: 49,
    rot: !1
  },
  "GAIN-OFF.png": {
    img: "imga_4.png",
    x: 559,
    y: 81,
    cw: 90,
    ch: 45,
    dx: 1,
    dy: 4,
    ow: 92,
    oh: 49,
    rot: !1
  },
  "MIXG-OFF.png": {
    img: "imga_4.png",
    x: 467,
    y: 81,
    cw: 90,
    ch: 45,
    dx: 1,
    dy: 4,
    ow: 92,
    oh: 49,
    rot: !1
  },
  "AUXS-OFF.png": {
    img: "imga_4.png",
    x: 375,
    y: 83,
    cw: 90,
    ch: 45,
    dx: 1,
    dy: 4,
    ow: 92,
    oh: 49,
    rot: !1
  },
  "EDT-OFF.png": {
    img: "imga_4.png",
    x: 283,
    y: 83,
    cw: 90,
    ch: 44,
    dx: 1,
    dy: 5,
    ow: 92,
    oh: 49,
    rot: !1
  },
  "TAPT-BTN_DLY-OFF.png": {
    img: "imga_4.png",
    x: 191,
    y: 83,
    cw: 90,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 90,
    oh: 35,
    rot: !1
  },
  "TAPT-BTN_DLY-ON.png": {
    img: "imga_4.png",
    x: 928,
    y: 1,
    cw: 90,
    ch: 32,
    dx: 0,
    dy: 0,
    ow: 90,
    oh: 35,
    rot: !1
  },
  "SO-B-BTN-YLW.png": {
    img: "imga_4.png",
    x: 101,
    y: 83,
    cw: 88,
    ch: 53,
    dx: 0,
    dy: 0,
    ow: 88,
    oh: 56,
    rot: !1
  },
  "SO-B-BTN-GRE.png": {
    img: "imga_4.png",
    x: 11,
    y: 83,
    cw: 88,
    ch: 53,
    dx: 0,
    dy: 0,
    ow: 88,
    oh: 56,
    rot: !1
  },
  "SO-M-BTN-OFF.png": {
    img: "imga_4.png",
    x: 743,
    y: 111,
    cw: 88,
    ch: 36,
    dx: 0,
    dy: 0,
    ow: 88,
    oh: 36,
    rot: !1
  },
  "SO-M-BTN-PNK.png": {
    img: "imga_4.png",
    x: 833,
    y: 114,
    cw: 88,
    ch: 33,
    dx: 0,
    dy: 0,
    ow: 88,
    oh: 36,
    rot: !1
  },
  "SO-M-BTN-TUR.png": {
    img: "imga_4.png",
    x: 923,
    y: 114,
    cw: 88,
    ch: 33,
    dx: 0,
    dy: 0,
    ow: 88,
    oh: 36,
    rot: !1
  },
  "SO-M-BTN-RED.png": {
    img: "imga_4.png",
    x: 653,
    y: 116,
    cw: 88,
    ch: 33,
    dx: 0,
    dy: 0,
    ow: 88,
    oh: 36,
    rot: !1
  },
  "SLIDER_PEW.png": {
    img: "imga_4.png",
    x: 191,
    y: 120,
    cw: 31,
    ch: 85,
    dx: 0,
    dy: 0,
    ow: 31,
    oh: 90,
    rot: !1
  },
  "SLIDER_PURPLE.png": {
    img: "imga_4.png",
    x: 224,
    y: 120,
    cw: 31,
    ch: 85,
    dx: 0,
    dy: 0,
    ow: 31,
    oh: 90,
    rot: !1
  },
  "FADER_UI.png": {
    img: "imga_4.png",
    x: 257,
    y: 130,
    cw: 31,
    ch: 85,
    dx: 0,
    dy: 0,
    ow: 31,
    oh: 90,
    rot: !1
  },
  "FADER_BLUE.png": {
    img: "imga_4.png",
    x: 290,
    y: 130,
    cw: 31,
    ch: 85,
    dx: 0,
    dy: 0,
    ow: 31,
    oh: 90,
    rot: !1
  },
  "FADER_UI_A.png": {
    img: "imga_4.png",
    x: 323,
    y: 130,
    cw: 31,
    ch: 85,
    dx: 0,
    dy: 0,
    ow: 31,
    oh: 90,
    rot: !1
  },
  "FADER_YELLOW.png": {
    img: "imga_4.png",
    x: 356,
    y: 130,
    cw: 31,
    ch: 85,
    dx: 0,
    dy: 0,
    ow: 31,
    oh: 90,
    rot: !1
  },
  "FADER_UI_B.png": {
    img: "imga_4.png",
    x: 389,
    y: 130,
    cw: 31,
    ch: 85,
    dx: 0,
    dy: 0,
    ow: 31,
    oh: 90,
    rot: !1
  },
  "FADER_PINK.png": {
    img: "imga_4.png",
    x: 422,
    y: 130,
    cw: 31,
    ch: 85,
    dx: 0,
    dy: 0,
    ow: 31,
    oh: 90,
    rot: !1
  },
  "FADER_UI_BL.png": {
    img: "imga_4.png",
    x: 455,
    y: 130,
    cw: 31,
    ch: 85,
    dx: 0,
    dy: 0,
    ow: 31,
    oh: 90,
    rot: !1
  },
  "FADER-ORANGE.png": {
    img: "imga_4.png",
    x: 488,
    y: 128,
    cw: 31,
    ch: 85,
    dx: 0,
    dy: 0,
    ow: 31,
    oh: 90,
    rot: !1
  },
  "FADER-RED2.png": {
    img: "imga_4.png",
    x: 521,
    y: 128,
    cw: 31,
    ch: 85,
    dx: 0,
    dy: 0,
    ow: 31,
    oh: 90,
    rot: !1
  },
  "FADER-SILVER2.png": {
    img: "imga_4.png",
    x: 554,
    y: 128,
    cw: 31,
    ch: 85,
    dx: 0,
    dy: 0,
    ow: 31,
    oh: 90,
    rot: !1
  },
  "AUX-ON.png": {
    img: "imga_4.png",
    x: 112,
    y: 138,
    cw: 77,
    ch: 45,
    dx: 0,
    dy: 0,
    ow: 77,
    oh: 49,
    rot: !1
  },
  "UMIX-ON.png": {
    img: "imga_4.png",
    x: 33,
    y: 138,
    cw: 77,
    ch: 45,
    dx: 0,
    dy: 0,
    ow: 77,
    oh: 49,
    rot: !1
  },
  "UMIX-ON2.png": {
    img: "imga_4.png",
    x: 587,
    y: 151,
    cw: 77,
    ch: 45,
    dx: 0,
    dy: 0,
    ow: 77,
    oh: 49,
    rot: !1
  },
  "FX-ON.png": {
    img: "imga_4.png",
    x: 666,
    y: 151,
    cw: 77,
    ch: 45,
    dx: 0,
    dy: 0,
    ow: 77,
    oh: 49,
    rot: !1
  },
  "DYN-ON.png": {
    img: "imga_4.png",
    x: 745,
    y: 149,
    cw: 77,
    ch: 45,
    dx: 0,
    dy: 0,
    ow: 77,
    oh: 49,
    rot: !1
  },
  "PEDAL-GREY.png": {
    img: "imga_4.png",
    x: 824,
    y: 149,
    cw: 62,
    ch: 76,
    dx: 0,
    dy: 0,
    ow: 62,
    oh: 76,
    rot: !1
  },
  "EQ-FADER-RED.png": {
    img: "imga_4.png",
    x: 1,
    y: 138,
    cw: 30,
    ch: 74,
    dx: 0,
    dy: 0,
    ow: 30,
    oh: 75,
    rot: !1
  },
  "FX-FADER-YELLOW.png": {
    img: "imga_4.png",
    x: 888,
    y: 149,
    cw: 30,
    ch: 74,
    dx: 0,
    dy: 0,
    ow: 30,
    oh: 75,
    rot: !1
  },
  "FX-FADER-PURPLE.png": {
    img: "imga_4.png",
    x: 920,
    y: 149,
    cw: 30,
    ch: 74,
    dx: 0,
    dy: 0,
    ow: 30,
    oh: 75,
    rot: !1
  },
  "FX-FADER-GREEN.png": {
    img: "imga_4.png",
    x: 952,
    y: 149,
    cw: 30,
    ch: 74,
    dx: 0,
    dy: 0,
    ow: 30,
    oh: 75,
    rot: !1
  },
  "FX-FADER-BLUE.png": {
    img: "imga_4.png",
    x: 984,
    y: 149,
    cw: 30,
    ch: 74,
    dx: 0,
    dy: 0,
    ow: 30,
    oh: 75,
    rot: !1
  },
  "EQ-FADER-GREY.png": {
    img: "imga_4.png",
    x: 33,
    y: 185,
    cw: 30,
    ch: 74,
    dx: 0,
    dy: 0,
    ow: 30,
    oh: 75,
    rot: !1
  },
  "FX-FADER-ORANGE.png": {
    img: "imga_4.png",
    x: 65,
    y: 185,
    cw: 30,
    ch: 74,
    dx: 0,
    dy: 0,
    ow: 30,
    oh: 75,
    rot: !1
  },
  "AFS-OFF.png": {
    img: "imga_4.png",
    x: 97,
    y: 185,
    cw: 72,
    ch: 37,
    dx: 0,
    dy: 0,
    ow: 72,
    oh: 37,
    rot: !1
  },
  "RESET-OFF.png": {
    img: "imga_4.png",
    x: 745,
    y: 196,
    cw: 72,
    ch: 37,
    dx: 0,
    dy: 0,
    ow: 72,
    oh: 37,
    rot: !1
  },
  "SOFT-KNEE-OFF.png": {
    img: "imga_4.png",
    x: 671,
    y: 198,
    cw: 72,
    ch: 37,
    dx: 0,
    dy: 0,
    ow: 72,
    oh: 37,
    rot: !1
  },
  "SETUP-OFF.png": {
    img: "imga_4.png",
    x: 597,
    y: 198,
    cw: 72,
    ch: 37,
    dx: 0,
    dy: 0,
    ow: 72,
    oh: 37,
    rot: !1
  },
  "HARD-KNEE-OFF.png": {
    img: "imga_4.png",
    x: 171,
    y: 207,
    cw: 72,
    ch: 37,
    dx: 0,
    dy: 0,
    ow: 72,
    oh: 37,
    rot: !1
  },
  "FIXED-OFF.png": {
    img: "imga_4.png",
    x: 523,
    y: 215,
    cw: 72,
    ch: 37,
    dx: 0,
    dy: 0,
    ow: 72,
    oh: 37,
    rot: !1
  },
  "LIVE-OFF.png": {
    img: "imga_4.png",
    x: 245,
    y: 217,
    cw: 72,
    ch: 37,
    dx: 0,
    dy: 0,
    ow: 72,
    oh: 37,
    rot: !1
  },
  "EZ-BTN-OFF.png": {
    img: "imga_4.png",
    x: 319,
    y: 217,
    cw: 72,
    ch: 37,
    dx: 0,
    dy: 0,
    ow: 72,
    oh: 37,
    rot: !1
  },
  "RTA_OFF.png": {
    img: "imga_4.png",
    x: 393,
    y: 217,
    cw: 72,
    ch: 37,
    dx: 0,
    dy: 0,
    ow: 72,
    oh: 37,
    rot: !1
  },
  "OFF-OFF.png": {
    img: "imga_4.png",
    x: 97,
    y: 224,
    cw: 72,
    ch: 37,
    dx: 0,
    dy: 0,
    ow: 72,
    oh: 37,
    rot: !1
  },
  "BYPASS-OFF.png": {
    img: "imga_4.png",
    x: 951,
    y: 225,
    cw: 72,
    ch: 37,
    dx: 0,
    dy: 0,
    ow: 72,
    oh: 37,
    rot: !1
  },
  "NEXT-OFF.png": {
    img: "imga_4.png",
    x: 877,
    y: 227,
    cw: 72,
    ch: 36,
    dx: 0,
    dy: 0,
    ow: 72,
    oh: 36,
    rot: !1
  },
  "OFF-ON.png": {
    img: "imga_4.png",
    x: 803,
    y: 235,
    cw: 72,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 72,
    oh: 37,
    rot: !1
  },
  "LIVE-ON.png": {
    img: "imga_4.png",
    x: 729,
    y: 237,
    cw: 72,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 72,
    oh: 37,
    rot: !1
  },
  "SOFT-KNEE-ON.png": {
    img: "imga_4.png",
    x: 655,
    y: 237,
    cw: 72,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 72,
    oh: 37,
    rot: !1
  },
  "ON-ON.png": {
    img: "imga_4.png",
    x: 171,
    y: 246,
    cw: 72,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 72,
    oh: 37,
    rot: !1
  },
  "BYPASS-ON2.png": {
    img: "imga_4.png",
    x: 581,
    y: 254,
    cw: 72,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 72,
    oh: 37,
    rot: !1
  },
  "HARD-KNEE-ON.png": {
    img: "imga_4.png",
    x: 245,
    y: 256,
    cw: 72,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 72,
    oh: 37,
    rot: !1
  },
  "RTA_ON.png": {
    img: "imga_4.png",
    x: 319,
    y: 256,
    cw: 72,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 72,
    oh: 37,
    rot: !1
  },
  "EZ-BTN-ON.png": {
    img: "imga_4.png",
    x: 393,
    y: 256,
    cw: 72,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 72,
    oh: 37,
    rot: !1
  },
  "EZ-ON.png": {
    img: "imga_4.png",
    x: 467,
    y: 254,
    cw: 72,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 72,
    oh: 37,
    rot: !1
  },
  "SETUP-ON.png": {
    img: "imga_4.png",
    x: 97,
    y: 263,
    cw: 72,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 72,
    oh: 37,
    rot: !1
  },
  "DES-ON.png": {
    img: "imga_4.png",
    x: 23,
    y: 261,
    cw: 72,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 72,
    oh: 37,
    rot: !1
  },
  "FIXED-ON.png": {
    img: "imga_4.png",
    x: 951,
    y: 264,
    cw: 72,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 72,
    oh: 37,
    rot: !1
  },
  "AFS-ON.png": {
    img: "imga_4.png",
    x: 877,
    y: 265,
    cw: 72,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 72,
    oh: 37,
    rot: !1
  },
  "RESET-ON.png": {
    img: "imga_4.png",
    x: 803,
    y: 272,
    cw: 72,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 72,
    oh: 37,
    rot: !1
  },
  "NEXT-ON.png": {
    img: "imga_4.png",
    x: 729,
    y: 274,
    cw: 72,
    ch: 33,
    dx: 0,
    dy: 0,
    ow: 72,
    oh: 36,
    rot: !1
  },
  "FX-OFF.png": {
    img: "imga_4.png",
    x: 656,
    y: 274,
    cw: 71,
    ch: 45,
    dx: 3,
    dy: 4,
    ow: 77,
    oh: 49,
    rot: !1
  },
  "DYN-OFF.png": {
    img: "imga_4.png",
    x: 171,
    y: 283,
    cw: 71,
    ch: 45,
    dx: 3,
    dy: 4,
    ow: 77,
    oh: 49,
    rot: !1
  },
  "AUX-OFF.png": {
    img: "imga_4.png",
    x: 244,
    y: 293,
    cw: 71,
    ch: 45,
    dx: 3,
    dy: 4,
    ow: 77,
    oh: 49,
    rot: !1
  },
  "UMIX-OFF.png": {
    img: "imga_4.png",
    x: 317,
    y: 293,
    cw: 71,
    ch: 45,
    dx: 3,
    dy: 4,
    ow: 77,
    oh: 49,
    rot: !1
  },
  "EQ-OFF.png": {
    img: "imga_4.png",
    x: 390,
    y: 293,
    cw: 71,
    ch: 45,
    dx: 3,
    dy: 4,
    ow: 77,
    oh: 49,
    rot: !1
  },
  "MEDIA-REC-OFF.png": {
    img: "imga_4.png",
    x: 463,
    y: 293,
    cw: 70,
    ch: 44,
    dx: 0,
    dy: 0,
    ow: 70,
    oh: 44,
    rot: !1
  },
  "MEDIA-NEXT-OFF.png": {
    img: "imga_4.png",
    x: 535,
    y: 291,
    cw: 70,
    ch: 44,
    dx: 0,
    dy: 0,
    ow: 70,
    oh: 44,
    rot: !1
  },
  "MEDIA-PLAY.png": {
    img: "imga_4.png",
    x: 99,
    y: 300,
    cw: 70,
    ch: 44,
    dx: 0,
    dy: 0,
    ow: 70,
    oh: 44,
    rot: !1
  },
  "MEDIA-PREV-OFF.png": {
    img: "imga_4.png",
    x: 27,
    y: 300,
    cw: 70,
    ch: 44,
    dx: 0,
    dy: 0,
    ow: 70,
    oh: 44,
    rot: !1
  },
  "MEDIA-STOP-OFF.png": {
    img: "imga_4.png",
    x: 953,
    y: 301,
    cw: 70,
    ch: 44,
    dx: 0,
    dy: 0,
    ow: 70,
    oh: 44,
    rot: !1
  },
  "FX-B-LED.png": {
    img: "imga_4.png",
    x: 881,
    y: 302,
    cw: 70,
    ch: 40,
    dx: 0,
    dy: 0,
    ow: 70,
    oh: 40,
    rot: !1
  },
  "MEDIA-STOP-ON.png": {
    img: "imga_4.png",
    x: 809,
    y: 309,
    cw: 70,
    ch: 39,
    dx: 0,
    dy: 0,
    ow: 70,
    oh: 44,
    rot: !1
  },
  "MEDIA-PAUSE.png": {
    img: "imga_4.png",
    x: 737,
    y: 309,
    cw: 70,
    ch: 39,
    dx: 0,
    dy: 0,
    ow: 70,
    oh: 44,
    rot: !1
  },
  "MEDIA-PREV-ON.png": {
    img: "imga_4.png",
    x: 665,
    y: 321,
    cw: 70,
    ch: 39,
    dx: 0,
    dy: 0,
    ow: 70,
    oh: 44,
    rot: !1
  },
  "MEDIA-NEXT-ON.png": {
    img: "imga_4.png",
    x: 171,
    y: 330,
    cw: 70,
    ch: 39,
    dx: 0,
    dy: 0,
    ow: 70,
    oh: 44,
    rot: !1
  },
  "DES-OFF.png": {
    img: "imga_4.png",
    x: 243,
    y: 340,
    cw: 70,
    ch: 36,
    dx: 1,
    dy: 1,
    ow: 72,
    oh: 37,
    rot: !1
  },
  "CHORUS-ON.png": {
    img: "imga_4.png",
    x: 315,
    y: 340,
    cw: 70,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 70,
    oh: 35,
    rot: !1
  },
  "DELAY-GR-ON.png": {
    img: "imga_4.png",
    x: 387,
    y: 340,
    cw: 70,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 70,
    oh: 35,
    rot: !1
  },
  "MEDIA-REC-ON2.png": {
    img: "imga_4.png",
    x: 459,
    y: 340,
    cw: 70,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 70,
    oh: 44,
    rot: !1
  },
  "FX_BTN_BLU.png": {
    img: "imga_4.png",
    x: 531,
    y: 339,
    cw: 70,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 70,
    oh: 35,
    rot: !1
  },
  "ROOM-GR-ON.png": {
    img: "imga_4.png",
    x: 99,
    y: 346,
    cw: 70,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 70,
    oh: 35,
    rot: !1
  },
  "REVERB-ON.png": {
    img: "imga_4.png",
    x: 27,
    y: 346,
    cw: 70,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 70,
    oh: 35,
    rot: !1
  },
  "FX_BTN_OR.png": {
    img: "imga_4.png",
    x: 881,
    y: 344,
    cw: 70,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 70,
    oh: 35,
    rot: !1
  },
  "DELAY-OR-ON.png": {
    img: "imga_4.png",
    x: 953,
    y: 347,
    cw: 70,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 70,
    oh: 35,
    rot: !1
  },
  "FX_BTN_GR.png": {
    img: "imga_4.png",
    x: 809,
    y: 350,
    cw: 70,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 70,
    oh: 35,
    rot: !1
  },
  "FX_BTN_PUR.png": {
    img: "imga_4.png",
    x: 737,
    y: 350,
    cw: 70,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 70,
    oh: 35,
    rot: !1
  },
  "ROOM-OFF.png": {
    img: "imga_4.png",
    x: 665,
    y: 362,
    cw: 70,
    ch: 34,
    dx: 0,
    dy: 1,
    ow: 70,
    oh: 35,
    rot: !1
  },
  "REVERB-OFF.png": {
    img: "imga_4.png",
    x: 171,
    y: 371,
    cw: 70,
    ch: 34,
    dx: 0,
    dy: 1,
    ow: 70,
    oh: 35,
    rot: !1
  },
  "DELAY-OFF.png": {
    img: "imga_4.png",
    x: 243,
    y: 378,
    cw: 70,
    ch: 34,
    dx: 0,
    dy: 1,
    ow: 70,
    oh: 35,
    rot: !1
  },
  "CHORUS-OFF.png": {
    img: "imga_4.png",
    x: 315,
    y: 377,
    cw: 70,
    ch: 34,
    dx: 0,
    dy: 1,
    ow: 70,
    oh: 35,
    rot: !1
  },
  "FX_BTN_OFF.png": {
    img: "imga_4.png",
    x: 387,
    y: 377,
    cw: 70,
    ch: 34,
    dx: 0,
    dy: 1,
    ow: 70,
    oh: 35,
    rot: !1
  },
  "EQ-1x2-LED.png": {
    img: "imga_4.png",
    x: 459,
    y: 377,
    cw: 66,
    ch: 42,
    dx: 0,
    dy: 0,
    ow: 66,
    oh: 42,
    rot: !1
  },
  "M-MUTE-OFF.png": {
    img: "imga_4.png",
    x: 607,
    y: 321,
    cw: 56,
    ch: 37,
    dx: 0,
    dy: 0,
    ow: 56,
    oh: 37,
    rot: !1
  },
  "PRV-SNP-OFF.png": {
    img: "imga_4.png",
    x: 607,
    y: 360,
    cw: 56,
    ch: 37,
    dx: 0,
    dy: 0,
    ow: 56,
    oh: 37,
    rot: !1
  },
  "F1-OFF.png": {
    img: "imga_4.png",
    x: 527,
    y: 377,
    cw: 56,
    ch: 37,
    dx: 0,
    dy: 0,
    ow: 56,
    oh: 37,
    rot: !1
  },
  "M-MUTE-OFF_F.png": {
    img: "imga_4.png",
    x: 113,
    y: 383,
    cw: 56,
    ch: 37,
    dx: 0,
    dy: 0,
    ow: 56,
    oh: 37,
    rot: !1
  },
  "PLAYS-OFF.png": {
    img: "imga_4.png",
    x: 55,
    y: 383,
    cw: 56,
    ch: 37,
    dx: 0,
    dy: 0,
    ow: 56,
    oh: 37,
    rot: !1
  },
  "F2-OFF.png": {
    img: "imga_4.png",
    x: 881,
    y: 381,
    cw: 56,
    ch: 37,
    dx: 0,
    dy: 0,
    ow: 56,
    oh: 37,
    rot: !1
  },
  "PLAY-BTN-OFF.png": {
    img: "imga_4.png",
    x: 939,
    y: 384,
    cw: 56,
    ch: 37,
    dx: 0,
    dy: 0,
    ow: 56,
    oh: 37,
    rot: !1
  },
  "RECS-OFF.png": {
    img: "imga_4.png",
    x: 823,
    y: 387,
    cw: 56,
    ch: 37,
    dx: 0,
    dy: 0,
    ow: 56,
    oh: 37,
    rot: !1
  },
  "MTRK-PLAY.png": {
    img: "imga_4.png",
    x: 765,
    y: 387,
    cw: 56,
    ch: 37,
    dx: 0,
    dy: 0,
    ow: 56,
    oh: 37,
    rot: !1
  },
  "REC-BTN-OFF.png": {
    img: "imga_4.png",
    x: 707,
    y: 398,
    cw: 56,
    ch: 37,
    dx: 0,
    dy: 0,
    ow: 56,
    oh: 37,
    rot: !1
  },
  "MENU_BTN.png": {
    img: "imga_4.png",
    x: 649,
    y: 399,
    cw: 56,
    ch: 37,
    dx: 0,
    dy: 0,
    ow: 56,
    oh: 37,
    rot: !1
  },
  "MTK-REC-OFF.png": {
    img: "imga_4.png",
    x: 591,
    y: 399,
    cw: 56,
    ch: 37,
    dx: 0,
    dy: 0,
    ow: 56,
    oh: 37,
    rot: !1
  },
  "NXT-SNP-OFF.png": {
    img: "imga_4.png",
    x: 171,
    y: 407,
    cw: 56,
    ch: 37,
    dx: 0,
    dy: 0,
    ow: 56,
    oh: 37,
    rot: !1
  },
  "M-SOLO-OFF.png": {
    img: "imga_4.png",
    x: 229,
    y: 414,
    cw: 56,
    ch: 37,
    dx: 0,
    dy: 0,
    ow: 56,
    oh: 37,
    rot: !1
  },
  "F2-ON.png": {
    img: "imga_4.png",
    x: 287,
    y: 414,
    cw: 56,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 56,
    oh: 37,
    rot: !1
  },
  "SAVE-ON.png": {
    img: "imga_4.png",
    x: 345,
    y: 413,
    cw: 56,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 56,
    oh: 37,
    rot: !1
  },
  "PLAY-BTN-ON.png": {
    img: "imga_4.png",
    x: 533,
    y: 416,
    cw: 56,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 56,
    oh: 37,
    rot: !1
  },
  "SAVEAS-ON.png": {
    img: "imga_4.png",
    x: 403,
    y: 421,
    cw: 56,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 56,
    oh: 37,
    rot: !1
  },
  "PLAYS-STOP.png": {
    img: "imga_4.png",
    x: 461,
    y: 421,
    cw: 56,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 56,
    oh: 37,
    rot: !1
  },
  "REC-BTN-ON.png": {
    img: "imga_4.png",
    x: 113,
    y: 422,
    cw: 56,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 56,
    oh: 37,
    rot: !1
  },
  "PRV-SNP-ON.png": {
    img: "imga_4.png",
    x: 55,
    y: 422,
    cw: 56,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 56,
    oh: 37,
    rot: !1
  },
  "RECS-STOP.png": {
    img: "imga_4.png",
    x: 881,
    y: 420,
    cw: 56,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 56,
    oh: 37,
    rot: !1
  },
  "F1-ON.png": {
    img: "imga_4.png",
    x: 939,
    y: 423,
    cw: 56,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 56,
    oh: 37,
    rot: !1
  },
  "M-MUTE-ON.png": {
    img: "imga_4.png",
    x: 823,
    y: 426,
    cw: 56,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 56,
    oh: 37,
    rot: !1
  },
  "M-SOLO-ON.png": {
    img: "imga_4.png",
    x: 765,
    y: 426,
    cw: 56,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 56,
    oh: 37,
    rot: !1
  },
  "MTK-REC-ON.png": {
    img: "imga_4.png",
    x: 707,
    y: 437,
    cw: 56,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 56,
    oh: 37,
    rot: !1
  },
  "MTK-STOP.png": {
    img: "imga_4.png",
    x: 649,
    y: 438,
    cw: 56,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 56,
    oh: 37,
    rot: !1
  },
  "NXT-SNP-ON.png": {
    img: "imga_4.png",
    x: 591,
    y: 438,
    cw: 56,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 56,
    oh: 37,
    rot: !1
  },
  "SO-M-SLV.png": {
    img: "imga_4.png",
    x: 171,
    y: 446,
    cw: 54,
    ch: 37,
    dx: 0,
    dy: 0,
    ow: 54,
    oh: 37,
    rot: !1
  },
  "SAVEAS-OFF.png": {
    img: "imga_4.png",
    x: 535,
    y: 453,
    cw: 54,
    ch: 36,
    dx: 1,
    dy: 1,
    ow: 56,
    oh: 37,
    rot: !1
  },
  "SAVE-OFF.png": {
    img: "imga_4.png",
    x: 227,
    y: 453,
    cw: 54,
    ch: 36,
    dx: 1,
    dy: 1,
    ow: 56,
    oh: 37,
    rot: !1
  },
  "SO-M-BLU.png": {
    img: "imga_4.png",
    x: 467,
    y: 217,
    cw: 54,
    ch: 34,
    dx: 0,
    dy: 0,
    ow: 54,
    oh: 37,
    rot: !1
  },
  "SO-M-RED.png": {
    img: "imga_4.png",
    x: 283,
    y: 453,
    cw: 54,
    ch: 34,
    dx: 0,
    dy: 0,
    ow: 54,
    oh: 37,
    rot: !1
  },
  "SO-M-YLW.png": {
    img: "imga_4.png",
    x: 339,
    y: 451,
    cw: 54,
    ch: 34,
    dx: 0,
    dy: 0,
    ow: 54,
    oh: 37,
    rot: !1
  },
  "SO-M-GRE.png": {
    img: "imga_4.png",
    x: 395,
    y: 458,
    cw: 54,
    ch: 34,
    dx: 0,
    dy: 0,
    ow: 54,
    oh: 37,
    rot: !1
  },
  "SETTINGS-ON.png": {
    img: "imga_4.png",
    x: 2,
    y: 383,
    cw: 51,
    ch: 45,
    dx: 0,
    dy: 0,
    ow: 51,
    oh: 49,
    rot: !1
  },
  "SCENE-ON.png": {
    img: "imga_4.png",
    x: 2,
    y: 430,
    cw: 51,
    ch: 45,
    dx: 0,
    dy: 0,
    ow: 51,
    oh: 49,
    rot: !1
  },
  "TV-ON.png": {
    img: "imga_4.png",
    x: 451,
    y: 458,
    cw: 51,
    ch: 45,
    dx: 0,
    dy: 0,
    ow: 51,
    oh: 49,
    rot: !1
  },
  "AUD-BTN-ON.png": {
    img: "imga_4.png",
    x: 118,
    y: 459,
    cw: 51,
    ch: 45,
    dx: 0,
    dy: 0,
    ow: 51,
    oh: 49,
    rot: !1
  },
  "FADERB-FX2.png": {
    img: "imga_4.png",
    x: 65,
    y: 459,
    cw: 51,
    ch: 39,
    dx: 0,
    dy: 0,
    ow: 51,
    oh: 42,
    rot: !1
  },
  "FADER-FX3.png": {
    img: "imga_4.png",
    x: 881,
    y: 457,
    cw: 51,
    ch: 39,
    dx: 0,
    dy: 0,
    ow: 51,
    oh: 42,
    rot: !1
  },
  "FADERP-FX2.png": {
    img: "imga_4.png",
    x: 934,
    y: 460,
    cw: 51,
    ch: 39,
    dx: 0,
    dy: 0,
    ow: 51,
    oh: 42,
    rot: !1
  },
  "FADERO-FX2.png": {
    img: "imga_4.png",
    x: 828,
    y: 463,
    cw: 51,
    ch: 39,
    dx: 0,
    dy: 0,
    ow: 51,
    oh: 42,
    rot: !1
  },
  "FADERG-FX2.png": {
    img: "imga_4.png",
    x: 775,
    y: 463,
    cw: 51,
    ch: 39,
    dx: 0,
    dy: 0,
    ow: 51,
    oh: 42,
    rot: !1
  },
  "PATTERN_DNS.png": {
    img: "imga_4.png",
    x: 723,
    y: 474,
    cw: 50,
    ch: 50,
    dx: 0,
    dy: 0,
    ow: 50,
    oh: 50,
    rot: !1
  },
  "SOLO-SC-OFF.png": {
    img: "imga_4.png",
    x: 671,
    y: 475,
    cw: 50,
    ch: 37,
    dx: 0,
    dy: 0,
    ow: 50,
    oh: 37,
    rot: !1
  },
  "SOLO-SC-OFF_OLD.png": {
    img: "imga_4.png",
    x: 619,
    y: 475,
    cw: 50,
    ch: 37,
    dx: 0,
    dy: 0,
    ow: 50,
    oh: 37,
    rot: !1
  },
  "48V-OFF.png": {
    img: "imga_4.png",
    x: 13,
    y: 477,
    cw: 50,
    ch: 37,
    dx: 0,
    dy: 0,
    ow: 50,
    oh: 37,
    rot: !1
  },
  "PI-OFF.png": {
    img: "imga_4.png",
    x: 171,
    y: 485,
    cw: 50,
    ch: 37,
    dx: 0,
    dy: 0,
    ow: 50,
    oh: 37,
    rot: !1
  },
  "MUTE-SC-OFF_OLD.png": {
    img: "imga_4.png",
    x: 567,
    y: 491,
    cw: 50,
    ch: 37,
    dx: 0,
    dy: 0,
    ow: 50,
    oh: 37,
    rot: !1
  },
  "PP-OFF.png": {
    img: "imga_4.png",
    x: 223,
    y: 491,
    cw: 50,
    ch: 37,
    dx: 0,
    dy: 0,
    ow: 50,
    oh: 37,
    rot: !1
  },
  "MUTE-SC-OFF_F.png": {
    img: "imga_4.png",
    x: 515,
    y: 491,
    cw: 50,
    ch: 37,
    dx: 0,
    dy: 0,
    ow: 50,
    oh: 37,
    rot: !1
  },
  "HIZ-OFF2.png": {
    img: "imga_4.png",
    x: 275,
    y: 491,
    cw: 50,
    ch: 37,
    dx: 0,
    dy: 0,
    ow: 50,
    oh: 37,
    rot: !1
  },
  "CL_BTN_OFF.png": {
    img: "imga_4.png",
    x: 327,
    y: 489,
    cw: 50,
    ch: 37,
    dx: 0,
    dy: 0,
    ow: 50,
    oh: 37,
    rot: !1
  },
  "MUTE-SC-OFF.png": {
    img: "imga_4.png",
    x: 379,
    y: 494,
    cw: 50,
    ch: 37,
    dx: 0,
    dy: 0,
    ow: 50,
    oh: 37,
    rot: !1
  },
  "PREFX.png": {
    img: "imga_4.png",
    x: 431,
    y: 505,
    cw: 50,
    ch: 37,
    dx: 0,
    dy: 0,
    ow: 50,
    oh: 37,
    rot: !1
  },
  "PRE-OFF_y.png": {
    img: "imga_4.png",
    x: 881,
    y: 498,
    cw: 50,
    ch: 37,
    dx: 0,
    dy: 0,
    ow: 50,
    oh: 37,
    rot: !1
  },
  "PRE-OFF.png": {
    img: "imga_4.png",
    x: 933,
    y: 501,
    cw: 50,
    ch: 37,
    dx: 0,
    dy: 0,
    ow: 50,
    oh: 37,
    rot: !1
  },
  "PRE.png": {
    img: "imga_4.png",
    x: 829,
    y: 504,
    cw: 50,
    ch: 37,
    dx: 0,
    dy: 0,
    ow: 50,
    oh: 37,
    rot: !1
  },
  "PRE_PROC_OFF.png": {
    img: "imga_4.png",
    x: 777,
    y: 504,
    cw: 50,
    ch: 37,
    dx: 0,
    dy: 0,
    ow: 50,
    oh: 37,
    rot: !1
  },
  "PP-ONW.png": {
    img: "imga_4.png",
    x: 65,
    y: 500,
    cw: 50,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 50,
    oh: 37,
    rot: !1
  },
  "SOLO-ON.png": {
    img: "imga_4.png",
    x: 117,
    y: 506,
    cw: 50,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 50,
    oh: 37,
    rot: !1
  },
  "SOLO-SC-ON.png": {
    img: "imga_4.png",
    x: 13,
    y: 516,
    cw: 50,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 50,
    oh: 37,
    rot: !1
  },
  "MUTE-SC-ON.png": {
    img: "imga_4.png",
    x: 665,
    y: 514,
    cw: 50,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 50,
    oh: 37,
    rot: !1
  },
  "48V-ON.png": {
    img: "imga_4.png",
    x: 717,
    y: 526,
    cw: 50,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 50,
    oh: 37,
    rot: !1
  },
  "HIZ-ON2.png": {
    img: "imga_4.png",
    x: 171,
    y: 524,
    cw: 50,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 50,
    oh: 37,
    rot: !1
  },
  "CL_BTN_ON.png": {
    img: "imga_4.png",
    x: 613,
    y: 530,
    cw: 50,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 50,
    oh: 37,
    rot: !1
  },
  "MUTE-ON.png": {
    img: "imga_4.png",
    x: 223,
    y: 530,
    cw: 50,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 50,
    oh: 37,
    rot: !1
  },
  "POST_PROC_ON_W.png": {
    img: "imga_4.png",
    x: 561,
    y: 530,
    cw: 50,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 50,
    oh: 37,
    rot: !1
  },
  "POST-ON_g.png": {
    img: "imga_4.png",
    x: 275,
    y: 530,
    cw: 50,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 50,
    oh: 37,
    rot: !1
  },
  "POSTFX.png": {
    img: "imga_4.png",
    x: 327,
    y: 528,
    cw: 50,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 50,
    oh: 37,
    rot: !1
  },
  "POST-ON.png": {
    img: "imga_4.png",
    x: 509,
    y: 530,
    cw: 50,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 50,
    oh: 37,
    rot: !1
  },
  "PI-ON.png": {
    img: "imga_4.png",
    x: 379,
    y: 533,
    cw: 50,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 50,
    oh: 37,
    rot: !1
  },
  "POST_PROC_ON_O.png": {
    img: "imga_4.png",
    x: 431,
    y: 544,
    cw: 50,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 50,
    oh: 37,
    rot: !1
  },
  "PP-ONO.png": {
    img: "imga_4.png",
    x: 881,
    y: 537,
    cw: 50,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 50,
    oh: 37,
    rot: !1
  },
  "SO-S-SLV.png": {
    img: "imga_4.png",
    x: 769,
    y: 543,
    cw: 49,
    ch: 37,
    dx: 0,
    dy: 0,
    ow: 49,
    oh: 37,
    rot: !1
  },
  "SO-S-YLW.png": {
    img: "imga_4.png",
    x: 820,
    y: 543,
    cw: 49,
    ch: 34,
    dx: 0,
    dy: 0,
    ow: 49,
    oh: 37,
    rot: !1
  },
  "SO-S-BLU.png": {
    img: "imga_4.png",
    x: 933,
    y: 540,
    cw: 49,
    ch: 34,
    dx: 0,
    dy: 0,
    ow: 49,
    oh: 37,
    rot: !1
  },
  "SO-S-GRE.png": {
    img: "imga_4.png",
    x: 65,
    y: 537,
    cw: 49,
    ch: 34,
    dx: 0,
    dy: 0,
    ow: 49,
    oh: 37,
    rot: !1
  },
  "SO-S-RED.png": {
    img: "imga_4.png",
    x: 116,
    y: 543,
    cw: 49,
    ch: 34,
    dx: 0,
    dy: 0,
    ow: 49,
    oh: 37,
    rot: !1
  },
  "AFSON-OFF.png": {
    img: "imga_4.png",
    x: 16,
    y: 553,
    cw: 47,
    ch: 37,
    dx: 0,
    dy: 0,
    ow: 47,
    oh: 37,
    rot: !1
  },
  "AFSON-OFF2.png": {
    img: "imga_4.png",
    x: 665,
    y: 551,
    cw: 47,
    ch: 37,
    dx: 0,
    dy: 0,
    ow: 47,
    oh: 37,
    rot: !1
  },
  "AFSON-ON.png": {
    img: "imga_4.png",
    x: 714,
    y: 563,
    cw: 47,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 47,
    oh: 37,
    rot: !1
  },
  "AFSON-ON2.png": {
    img: "imga_4.png",
    x: 171,
    y: 561,
    cw: 47,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 47,
    oh: 37,
    rot: !1
  },
  "YOUTUBE-OFF.png": {
    img: "imga_4.png",
    x: 618,
    y: 567,
    cw: 45,
    ch: 45,
    dx: 0,
    dy: 0,
    ow: 45,
    oh: 45,
    rot: !1
  },
  "RSS-ON.png": {
    img: "imga_4.png",
    x: 220,
    y: 567,
    cw: 45,
    ch: 45,
    dx: 0,
    dy: 0,
    ow: 45,
    oh: 45,
    rot: !1
  },
  "YOUTUBE-ON.png": {
    img: "imga_4.png",
    x: 571,
    y: 567,
    cw: 45,
    ch: 45,
    dx: 0,
    dy: 0,
    ow: 45,
    oh: 45,
    rot: !1
  },
  "RSS-OFF.png": {
    img: "imga_4.png",
    x: 267,
    y: 567,
    cw: 45,
    ch: 45,
    dx: 0,
    dy: 0,
    ow: 45,
    oh: 45,
    rot: !1
  },
  "WWW-ON.png": {
    img: "imga_4.png",
    x: 524,
    y: 567,
    cw: 45,
    ch: 45,
    dx: 0,
    dy: 0,
    ow: 45,
    oh: 45,
    rot: !1
  },
  "SCENE-OFF.png": {
    img: "imga_4.png",
    x: 314,
    y: 567,
    cw: 45,
    ch: 45,
    dx: 3,
    dy: 4,
    ow: 51,
    oh: 49,
    rot: !1
  },
  "WWW-OFF.png": {
    img: "imga_4.png",
    x: 361,
    y: 570,
    cw: 45,
    ch: 45,
    dx: 0,
    dy: 0,
    ow: 45,
    oh: 45,
    rot: !1
  },
  "FACEBOOK-OFF.png": {
    img: "imga_4.png",
    x: 408,
    y: 581,
    cw: 45,
    ch: 45,
    dx: 0,
    dy: 0,
    ow: 45,
    oh: 45,
    rot: !1
  },
  "TV-OFF.png": {
    img: "imga_4.png",
    x: 455,
    y: 581,
    cw: 45,
    ch: 45,
    dx: 3,
    dy: 4,
    ow: 51,
    oh: 49,
    rot: !1
  },
  "EMAIL-ON.png": {
    img: "imga_4.png",
    x: 65,
    y: 573,
    cw: 45,
    ch: 45,
    dx: 0,
    dy: 0,
    ow: 45,
    oh: 45,
    rot: !1
  },
  "AUD-BTN-OFF.png": {
    img: "imga_4.png",
    x: 881,
    y: 574,
    cw: 45,
    ch: 45,
    dx: 3,
    dy: 4,
    ow: 51,
    oh: 49,
    rot: !1
  },
  "EMAIL-OFF.png": {
    img: "imga_4.png",
    x: 928,
    y: 576,
    cw: 45,
    ch: 45,
    dx: 0,
    dy: 0,
    ow: 45,
    oh: 45,
    rot: !1
  },
  "FACEBOOK-ON.png": {
    img: "imga_4.png",
    x: 975,
    y: 576,
    cw: 45,
    ch: 45,
    dx: 0,
    dy: 0,
    ow: 45,
    oh: 45,
    rot: !1
  },
  "ADOBE-ON.png": {
    img: "imga_4.png",
    x: 834,
    y: 579,
    cw: 45,
    ch: 45,
    dx: 0,
    dy: 0,
    ow: 45,
    oh: 45,
    rot: !1
  },
  "FAQ-OFF.png": {
    img: "imga_4.png",
    x: 112,
    y: 579,
    cw: 45,
    ch: 45,
    dx: 0,
    dy: 0,
    ow: 45,
    oh: 45,
    rot: !1
  },
  "FORUM-ON.png": {
    img: "imga_4.png",
    x: 787,
    y: 582,
    cw: 45,
    ch: 45,
    dx: 0,
    dy: 0,
    ow: 45,
    oh: 45,
    rot: !1
  },
  "FAQ-ON.png": {
    img: "imga_4.png",
    x: 18,
    y: 592,
    cw: 45,
    ch: 45,
    dx: 0,
    dy: 0,
    ow: 45,
    oh: 45,
    rot: !1
  },
  "FORUM-OFF.png": {
    img: "imga_4.png",
    x: 665,
    y: 590,
    cw: 45,
    ch: 45,
    dx: 0,
    dy: 0,
    ow: 45,
    oh: 45,
    rot: !1
  },
  "ADOBE-OFF.png": {
    img: "imga_4.png",
    x: 712,
    y: 600,
    cw: 45,
    ch: 45,
    dx: 0,
    dy: 0,
    ow: 45,
    oh: 45,
    rot: !1
  },
  "SETTINGS-OFF.png": {
    img: "imga_4.png",
    x: 159,
    y: 598,
    cw: 45,
    ch: 45,
    dx: 3,
    dy: 4,
    ow: 51,
    oh: 49,
    rot: !1
  },
  "TV_OFF.png": {
    img: "imga_4.png",
    x: 206,
    y: 614,
    cw: 45,
    ch: 44,
    dx: 3,
    dy: 5,
    ow: 51,
    oh: 49,
    rot: !1
  },
  "CLEAR-SOLOS-OFF.png": {
    img: "imga_4.png",
    x: 253,
    y: 614,
    cw: 44,
    ch: 44,
    dx: 0,
    dy: 0,
    ow: 44,
    oh: 44,
    rot: !1
  },
  "MUTE-ALL-OFF.png": {
    img: "imga_4.png",
    x: 299,
    y: 614,
    cw: 44,
    ch: 44,
    dx: 0,
    dy: 0,
    ow: 44,
    oh: 44,
    rot: !1
  },
  "MUTE-FX-OFF.png": {
    img: "imga_4.png",
    x: 345,
    y: 617,
    cw: 44,
    ch: 44,
    dx: 0,
    dy: 0,
    ow: 44,
    oh: 44,
    rot: !1
  },
  "CLEAR-SOLOS-ON.png": {
    img: "imga_4.png",
    x: 502,
    y: 614,
    cw: 44,
    ch: 37,
    dx: 0,
    dy: 0,
    ow: 44,
    oh: 44,
    rot: !1
  },
  "MUTE-ALL-ON.png": {
    img: "imga_4.png",
    x: 548,
    y: 614,
    cw: 44,
    ch: 37,
    dx: 0,
    dy: 0,
    ow: 44,
    oh: 44,
    rot: !1
  },
  "MUTE-FX-ON.png": {
    img: "imga_4.png",
    x: 594,
    y: 614,
    cw: 44,
    ch: 37,
    dx: 0,
    dy: 0,
    ow: 44,
    oh: 44,
    rot: !1
  },
  "LEX_TAP_OFF.png": {
    img: "imga_4.png",
    x: 2,
    y: 38,
    cw: 41,
    ch: 33,
    dx: 0,
    dy: 0,
    ow: 41,
    oh: 33,
    rot: !1
  },
  "LEX_TAP_ON.png": {
    img: "imga_4.png",
    x: 391,
    y: 628,
    cw: 41,
    ch: 33,
    dx: 0,
    dy: 0,
    ow: 41,
    oh: 33,
    rot: !1
  },
  "nr/NR4-OFF.png": {
    img: "imga_4.png",
    x: 434,
    y: 628,
    cw: 40,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 40,
    oh: 35,
    rot: !1
  },
  "nr/NR2-OFF.png": {
    img: "imga_4.png",
    x: 65,
    y: 620,
    cw: 40,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 40,
    oh: 35,
    rot: !1
  },
  "nr/NR3-OFF.png": {
    img: "imga_4.png",
    x: 881,
    y: 621,
    cw: 40,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 40,
    oh: 35,
    rot: !1
  },
  "nr/NR5-OFF.png": {
    img: "imga_4.png",
    x: 923,
    y: 623,
    cw: 40,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 40,
    oh: 35,
    rot: !1
  },
  "nr/ARR-R-OFF.png": {
    img: "imga_4.png",
    x: 965,
    y: 623,
    cw: 40,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 40,
    oh: 35,
    rot: !1
  },
  "nr/NR6-OFF.png": {
    img: "imga_4.png",
    x: 839,
    y: 626,
    cw: 40,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 40,
    oh: 35,
    rot: !1
  },
  "nr/ARR-L-OFF.png": {
    img: "imga_4.png",
    x: 107,
    y: 626,
    cw: 40,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 40,
    oh: 35,
    rot: !1
  },
  "nr/NR1-OFF.png": {
    img: "imga_4.png",
    x: 797,
    y: 629,
    cw: 40,
    ch: 35,
    dx: 0,
    dy: 0,
    ow: 40,
    oh: 35,
    rot: !1
  },
  "nr/NR4-BEI-ON.png": {
    img: "imga_4.png",
    x: 665,
    y: 637,
    cw: 40,
    ch: 32,
    dx: 0,
    dy: 0,
    ow: 40,
    oh: 35,
    rot: !1
  },
  "nr/NR3-RED-ON.png": {
    img: "imga_4.png",
    x: 1,
    y: 639,
    cw: 40,
    ch: 32,
    dx: 0,
    dy: 0,
    ow: 40,
    oh: 35,
    rot: !1
  },
  "nr/NR4-BLUE-ON.png": {
    img: "imga_4.png",
    x: 707,
    y: 647,
    cw: 40,
    ch: 32,
    dx: 0,
    dy: 0,
    ow: 40,
    oh: 35,
    rot: !1
  },
  "nr/NR4-RED-ON.png": {
    img: "imga_4.png",
    x: 749,
    y: 647,
    cw: 40,
    ch: 32,
    dx: 0,
    dy: 0,
    ow: 40,
    oh: 35,
    rot: !1
  },
  "nr/NR5-RED-ON.png": {
    img: "imga_4.png",
    x: 159,
    y: 645,
    cw: 40,
    ch: 32,
    dx: 0,
    dy: 0,
    ow: 40,
    oh: 35,
    rot: !1
  },
  "nr/NR6-BLUE-ON.png": {
    img: "imga_4.png",
    x: 623,
    y: 653,
    cw: 40,
    ch: 32,
    dx: 0,
    dy: 0,
    ow: 40,
    oh: 35,
    rot: !1
  },
  "nr/NR6-RED-ON.png": {
    img: "imga_4.png",
    x: 581,
    y: 653,
    cw: 40,
    ch: 32,
    dx: 0,
    dy: 0,
    ow: 40,
    oh: 35,
    rot: !1
  },
  "nr/NR5-BLUE-ON.png": {
    img: "imga_4.png",
    x: 539,
    y: 653,
    cw: 40,
    ch: 32,
    dx: 0,
    dy: 0,
    ow: 40,
    oh: 35,
    rot: !1
  },
  "nr/NR3-BLUE-ON.png": {
    img: "imga_4.png",
    x: 497,
    y: 653,
    cw: 40,
    ch: 32,
    dx: 0,
    dy: 0,
    ow: 40,
    oh: 35,
    rot: !1
  },
  "nr/NR2-BEI-ON.png": {
    img: "imga_4.png",
    x: 201,
    y: 660,
    cw: 40,
    ch: 32,
    dx: 0,
    dy: 0,
    ow: 40,
    oh: 35,
    rot: !1
  },
  "nr/NR2-BLUE-ON.png": {
    img: "imga_4.png",
    x: 243,
    y: 665,
    cw: 40,
    ch: 32,
    dx: 0,
    dy: 0,
    ow: 40,
    oh: 35,
    rot: !1
  },
  "nr/NR1-RED-ON.png": {
    img: "imga_4.png",
    x: 285,
    y: 665,
    cw: 40,
    ch: 32,
    dx: 0,
    dy: 0,
    ow: 40,
    oh: 35,
    rot: !1
  },
  "nr/NR1-BEI-ON.png": {
    img: "imga_4.png",
    x: 327,
    y: 665,
    cw: 40,
    ch: 32,
    dx: 0,
    dy: 0,
    ow: 40,
    oh: 35,
    rot: !1
  },
  "nr/ARR-R-ON.png": {
    img: "imga_4.png",
    x: 369,
    y: 665,
    cw: 40,
    ch: 32,
    dx: 0,
    dy: 0,
    ow: 40,
    oh: 35,
    rot: !1
  },
  "nr/NR1-BLUE-ON.png": {
    img: "imga_4.png",
    x: 411,
    y: 665,
    cw: 40,
    ch: 32,
    dx: 0,
    dy: 0,
    ow: 40,
    oh: 35,
    rot: !1
  },
  "nr/ARR-L-ON.png": {
    img: "imga_4.png",
    x: 453,
    y: 665,
    cw: 40,
    ch: 32,
    dx: 0,
    dy: 0,
    ow: 40,
    oh: 35,
    rot: !1
  },
  "nr/NR2-RED-ON.png": {
    img: "imga_4.png",
    x: 65,
    y: 657,
    cw: 40,
    ch: 32,
    dx: 0,
    dy: 0,
    ow: 40,
    oh: 35,
    rot: !1
  },
  "nr/NR3-BEI-ON.png": {
    img: "imga_4.png",
    x: 881,
    y: 658,
    cw: 40,
    ch: 32,
    dx: 0,
    dy: 0,
    ow: 40,
    oh: 35,
    rot: !1
  }
};
MUTEALL_BIT_IDX = 23;
MUTEFX_BIT_IDX = 22;
E_MODE = {
  MIX: 0,
  GAIN: 1,
  EDIT: 2,
  DYN: 3,
  AUX: 4,
  FXEDIT: 5,
  FXSENDS: 6,
  SETTINGS: 7,
  MODALS: 8,
  PLAYER: 9,
  FULL_PEQ: 14,
  FULL_GEQ: 15,
  MOREME: 20,
  NETWORK: 30,
  PONG: 777
};
E_STRIP_TYPE = {
  IN: 1,
  GAIN: 100,
  FX: 2,
  SUB: 3,
  AUX: 4,
  MEDIA: 6,
  AUXSEND: 7,
  FXSEND: 8,
  MTXSEND: 9,
  MASTER: 10,
  LINEIN: 12,
  VCA: 20,
  HW: 777
};
E_STRIP_MODE = {
  MIX: 1,
  GAIN: 2,
  FX: 4,
  AUX: 5,
  SUB: 8,
  MASTER: 10,
  VCA: 20
};
E_FX = {
  REVERB: 0,
  DELAY: 1,
  CHORUS: 2,
  ROOM: 3
};
E_LINES = {
  off: 0,
  thin: 1,
  norm: 2
};
E_COMMANDS = {
  TOGGLE_REC: "RECTOGGLE",
  TOGGLE_MTK_REC: "MTK_REC_TOGGLE",
  MTK_PLAY: "MTK_PLAY",
  MTK_STOP: "MTK_STOP",
  MTK_PAUSE: "MTK_PAUSE",
  MTK_JUMP_TO: "MTK_JUMP_TO",
  MTK_SET_SESSION: "MTK_SELECT",
  MTK_DEL_SESSION: "MTK_DELETE",
  MTK_GET_SESSIONS: "MTK_GET_SESSIONS",
  MTK_GET_FILES: "MTK_GET_FILES",
  MTK_REC_PLAY: "MTK_REC",
  MTK_REC_STOP: "MTK_REC_STOP",
  MTK_REC_PAUSE: "MTK_REC_PAUSE",
  MTK_REC_JUMP_TO: "MTK_REC_JUMP_TO",
  MTK_REC_SET_SESSION: "MTK_REC_SET_SESSION",
  MEDIA_PLAY: "MEDIA_PLAY",
  MEDIA_JUMP_TO: "MEDIA_JUMP_TO",
  MEDIA_PAUSE: "MEDIA_PAUSE",
  MEDIA_STOP: "MEDIA_STOP",
  MEDIA_PREV: "MEDIA_PREV",
  MEDIA_NEXT: "MEDIA_NEXT",
  MEDIA_SWITCH_PLIST: "MEDIA_SWITCH_PLIST",
  MEDIA_SWITCH_TRACK: "MEDIA_SWITCH_TRACK",
  MEDIA_GET_PLISTS: "MEDIA_GET_PLISTS",
  MEDIA_GET_PLIST_TRACKS: "MEDIA_GET_PLIST_TRACKS",
  SHOW_LIST: "SHOWLIST",
  SHOW_DEL: "DELETESHOW",
  SHOW_LOAD: "LOADSHOW",
  SHOW_CREATE: "CREATESHOW",
  SHOW_RENAME: "RENAMESHOW",
  SNAP_LIST: "SNAPSHOTLIST",
  SNAP_SAVE: "SAVESNAPSHOT",
  SNAP_LOAD: "LOADSNAPSHOT",
  SNAP_DEL: "DELETESNAPSHOT",
  SNAP_RENAME: "RENAMESNAPSHOT",
  PRESET_LIST: "PRESETLIST",
  PRESET_DEL: "DELETEPRESET",
  PRESET_READ: "READPRESET",
  PRESET_WRITE: "WRITEPRESET",
  PRESET_RENAME: "RENAMEPRESET",
  SAVESHOW: "SAVESHOW",
  MIXER_RESET: "MIXER_RESET",
  UPDATE_SHOWS: "UPDATE_SHOWS",
  USB_LIST: "USBMOUNTS",
  EXPORT_SHOW: "EXPORTSHOW",
  IMPORT_SHOW: "IMPORTSHOW",
  IMPORT_LIST: "IMPORTSHOWLIST",
  IMPORT_PRESETS: "IMPORTPRESETS",
  EXPORT_PRESETS: "EXPORTPRESETS",
  IMPORT_CONFIG: "IMPORTCONFIG",
  EXPORT_CONFIG: "EXPORTCONFIG"
};
E_FFUNC = {
  NEWSNAP: 0,
  UPDCURSNAP: 1,
  PLAY: 2,
  REC: 3,
  MTK_PLAY: 4,
  MTK_REC: 5,
  NEXT_SNAP: 6,
  PREV_SNAP: 7,
  SWAP_USB: 8,
  MUTE_ALL: 9,
  DIM: 10
};
E_MODAL_MODE = {
  TOTALVIEW: 0,
  MOREME: 1,
  MUTES: 2,
  VIEWS: 3,
  SUBS: 4,
  VCA: 5
};
E_CH_SRC_TYPE = {
  HARDWARE: 0,
  USB_A: 1,
  USB_B: 2,
  USB_C: 3,
  USB_D: 4
};
E_VG = {
  VG1: 0,
  VG2: 1,
  VG3: 2,
  VG4: 3,
  VG5: 4,
  VG6: 5,
  INPUTS: 100,
  FXS: 101,
  SUBS: 102,
  AUXS: 103,
  VCAS: 104,
  SG1: 200,
  SG2: 201,
  SG3: 202,
  SG4: 203,
  SG5: 204,
  SG6: 205,
  VCA1: 300,
  VCA2: 301,
  VCA3: 302,
  VCA4: 303,
  VCA5: 304,
  VCA6: 305
};
E_SRC_NAMES = {
  none: "-",
  "hw.0": "IN-1",
  "hw.1": "IN-2",
  "hw.2": "IN-3",
  "hw.3": "IN-4",
  "hw.4": "IN-5",
  "hw.5": "IN-6",
  "hw.6": "IN-7",
  "hw.7": "IN-8",
  "hw.8": "IN-9",
  "hw.9": "IN-10",
  "hw.10": "IN-11",
  "hw.11": "IN-12",
  "hw.12": "IN-13",
  "hw.13": "IN-14",
  "hw.14": "IN-15",
  "hw.15": "IN-16",
  "hw.16": "IN-17",
  "hw.17": "IN-18",
  "hw.18": "IN-19",
  "hw.19": "IN-20",
  "hw.20": "IN-21",
  "hw.21": "IN-22",
  "li.0": "LI-1",
  "li.1": "LI-2",
  "li.2": "LI-3",
  "li.3": "LI-4",
  "ua.0": "USB-1",
  "ua.1": "USB-2",
  "ua.2": "USB-3",
  "ua.3": "USB-4",
  "ua.4": "USB-5",
  "ua.5": "USB-6",
  "ua.6": "USB-7",
  "ua.7": "USB-8",
  "ua.8": "USB-9",
  "ua.9": "USB-10",
  "ua.10": "USB-11",
  "ua.11": "USB-12",
  "ua.12": "USB-13",
  "ua.13": "USB-14",
  "ua.14": "USB-15",
  "ua.15": "USB-16",
  "ua.16": "USB-17",
  "ua.17": "USB-18",
  "ua.18": "USB-19",
  "ua.19": "USB-20",
  "ua.20": "USB-21",
  "ua.21": "USB-22",
  "ub.0": "DAW-1",
  "ub.1": "DAW-2",
  "ub.2": "DAW-3",
  "ub.3": "DAW-4",
  "ub.4": "DAW-5",
  "ub.5": "DAW-6",
  "ub.6": "DAW-7",
  "ub.7": "DAW-8",
  "ub.8": "DAW-9",
  "ub.9": "DAW-10",
  "ub.10": "DAW-11",
  "ub.11": "DAW-12",
  "ub.12": "DAW-13",
  "ub.13": "DAW-14",
  "ub.14": "DAW-15",
  "ub.15": "DAW-16",
  "ub.16": "DAW-17",
  "ub.17": "DAW-18",
  "ub.18": "DAW-19",
  "ub.19": "DAW-20",
  "ub.20": "DAW-21",
  "ub.21": "DAW-22",
  "ub.22": "DAW-23",
  "ub.23": "DAW-24",
  "ub.24": "DAW-25",
  "ub.25": "DAW-26",
  "ub.26": "DAW-27",
  "ub.27": "DAW-28",
  "ub.28": "DAW-29",
  "ub.29": "DAW-30",
  "ub.30": "DAW-31",
  "ub.31": "DAW-32"
};
dataValue = {};
settingsStorage = {
  ok: !1,
  raw: !1,
  prefix: "UI_",
  init: function() {
    log("STORAGE INIT...");
    if (isDefined(localStorage)) {
      this.ok = !0;
      try {
        localStorage.setItem("TEST_STORAGE", "TEST_STORAGE");
        if ("TEST_STORAGE" !== localStorage.getItem("TEST_STORAGE")) throw "localStorage TEST: NOT PASSED";
        localStorage.removeItem("TEST_STORAGE")
      } catch (b) {
        showPopupMsg("HTML5 localStorage is not available. Probably 'PRIVATE MODE' is ON.", 5E3), this.ok = !1
      }
      if (this.ok)
        for (var a in settings) settings.hasOwnProperty(a) && (null === this.get(a) ? (WEBSITE_MODE &&
          demoSettings.hasOwnProperty(a) && (settings[a] = demoSettings[a]), this.set(a, settings[a])) : settings[a] = this.get(a))
    }
  },
  get: function(a) {
    isDefined(localStorage) && null !== localStorage || (this.ok = !1);
    if (!this.ok) return isDefined(settings[a]) ? settings[a] : null;
    a = localStorage.getItem(a);
    return this.raw ? a : JSON.parse(a)
  },
  set: function(a, b) {
    settings[a] = b;
    if (isDefined(localStorage) && null !== localStorage) {
      var c = this.raw ? b : JSON.stringify(b);
      localStorage.setItem(a, c)
    } else this.ok = !1
  },
  put: function(a, b) {
    isDefined(localStorage) &&
      null !== localStorage || (this.ok = !1);
    if (this.ok) {
      var c = this.raw ? b : JSON.stringify(b);
      localStorage.setItem(a, c)
    }
  },
  save: function() {
    if (this.ok)
      for (var a in settings) settings.hasOwnProperty(a) && this.set(a, settings[a])
  }
};
settings = {
  drawRate: 1,
  disableRetina: !1,
  disableScaling: !1,
  disableShadows: !1,
  disableVUghost: !1,
  disableVUpeak: !1,
  patterned: !1,
  lanes: E_LINES.norm,
  mediaFirst: !1,
  disableVUs: !1,
  disableVUs2: !1,
  bigSlideOut: !1,
  pinSlideOut: !1,
  pinSlideOutX: !1,
  kinetic: !1,
  oneFingerScroll: !0,
  dimVUs: !1,
  vuquantise: !0,
  currentViewGroup: -1,
  nudge: !1,
  lang: "en",
  sync: !1,
  sync_id: "SYNC_ID",
  master_pass: "",
  masterLock: !1,
  moremeportrait: !0,
  f1func: E_FFUNC.PLAY,
  f2func: E_FFUNC.REC,
  viewGroups: [
    [],
    [],
    [],
    [],
    [],
    []
  ],
  viewGroupsNames: "     ".split(" "),
  me: [],
  meout: -1,
  perm_name: "noname",
  perm_lock: !1,
  perm_aux1: !1,
  perm_aux2: !1,
  perm_aux3: !1,
  perm_aux4: !1,
  perm_aux5: !1,
  perm_aux6: !1,
  perm_aux7: !1,
  perm_aux8: !1,
  perm_aux9: !1,
  perm_aux10: !1,
  perm_aux11: !1,
  perm_aux12: !1,
  perm_aux13: !1,
  perm_aux14: !1,
  perm_aux15: !1,
  perm_aux16: !1,
  perm_mvol: !1,
  perm_mfx: !1,
  perm_shows: !1,
  perm_media: !1,
  perm_patching: !1,
  perm_config: !1
};
demoSettings = {
  pinSlideOut: !0,
  bigSlideOut: !0,
  viewGroups: [
    [42, 43, 44, 45, 20, 21, 18, 24],
    [16, 17, 18, 15, 26, 25, 24],
    [29, 20, 21, 28, 27, 45, 43],
    [],
    [],
    []
  ],
  viewGroupsNames: "Main VOX Custom   ".split(" "),
  me: [9, 18],
  meout: 1
};

function toBool(a) {
  return .5 <= a
}

function fromBool(a) {
  return a ? 1 : 0
}

function initDataItem(a, b) {
  isDefined(b) ? dataValue[a] = b : dataValue[a] = null
}

function getValue(a) {
  return a in dataValue ? dataValue[a] : null
}

function setValue(a, b) {
  if (dataValue[a] !== b) {
    if (dataValue["settings.block.pass"] && dataValue["settings.block.pass"] != settings.master_pass) {
      var c = !0,
        d = a.split(".");
      if (dataValue["settings.block.mixlvl"] && ("mgmask" == d.last() && (c = !1), "." == a[1])) switch (a[0]) {
        case "i":
        case "f":
        case "s":
        case "l":
        case "p":
          if (!a.contains(".aux.")) switch (d.last()) {
            case "mix":
            case "mute":
            case "pan":
            case "forceunmute":
              c = !1
          }
      }
      if (dataValue["settings.block.mixproc"] && "." == a[1]) switch (a[0]) {
        case "i":
        case "f":
        case "s":
        case "l":
        case "p":
          if (!a.contains(".aux.")) switch (d.last()) {
            case "mix":
            case "mute":
            case "forceunmute":
            case "pan":
            case "safe":
            case "mgmask":
              break;
            default:
              c = !1
          }
      }
      dataValue["settings.block.player"] && a.startsWith("p.") && (c = !1);
      !dataValue["settings.block.mlvl"] || "m.mix" != a && "m.pan" != a || (c = !1);
      dataValue["settings.block.mproc"] && a.startsWith("m.") && "m.mix" != a && "m.pan" != a && (c = !1);
      dataValue["settings.block.shows"] && a.endsWith(".safe") && (c = !1);
      dataValue["settings.block.auxlvl"] && (a.startsWith("a.") && (a.endsWith(".mix") || a.endsWith(".mute") || a.endsWith(".stereoIndex")) || a.contains(".aux.")) && (c = !1);
      dataValue["settings.block.auxproc"] && a.startsWith("a.") &&
        !a.endsWith(".mix") && !a.endsWith(".mute") && (c = !1);
      c || (settings.perm_aux1 || !a.startsWith("a.0.") && !a.contains(".aux.0.") || (c = !0), settings.perm_aux2 || !a.startsWith("a.1.") && !a.contains(".aux.1.") || (c = !0), settings.perm_aux3 || !a.startsWith("a.2.") && !a.contains(".aux.2.") || (c = !0), settings.perm_aux4 || !a.startsWith("a.3.") && !a.contains(".aux.3.") || (c = !0), settings.perm_aux5 || !a.startsWith("a.4.") && !a.contains(".aux.4.") || (c = !0), settings.perm_aux6 || !a.startsWith("a.5.") && !a.contains(".aux.5.") || (c = !0), settings.perm_aux7 ||
        !a.startsWith("a.6.") && !a.contains(".aux.6.") || (c = !0), settings.perm_aux8 || !a.startsWith("a.7.") && !a.contains(".aux.7.") || (c = !0));
      if (a.startsWith("var.") || a.startsWith("settings.")) c = !1;
      switch (d.last()) {
        case "solo":
          c = !0;
          break;
        case "gain":
          a.contains(".eq.") || (c = dataValue["settings.block.mixgain"] && "i" == a[0] && "." == a[1] ? !1 : !0);
          break;
        case "hiz":
        case "phantom":
        case "invert":
          c = dataValue["settings.block.mixgain"] && "i" == a[0] && "." == a[1] ? !1 : !0
      }
      if (c) {
        showPopupMsg(lang.LOCKED, 1E3);
        return
      }
    }
    setValueX(a, b);
    if ("." ==
      a[1]) switch (a[0]) {
      case "m":
        d = a.split(".");
        c = "";
        if ("mtx" == d[1]) {
          var f = parseInt(d[2], 10);
          0 == getValue("a." + f + ".stereoIndex") ? c = ".mtx." + (f + 1) + "." : 1 == getValue("a." + f + ".stereoIndex") && (c = ".mtx." + (f - 1) + ".");
          c.length && (c = a.replace(".mtx." + f + ".", c), setValueX(c, b), updateByKey(c))
        }
        a.endsWith(".pan");
        break;
      case "i":
      case "a":
      case "f":
      case "p":
      case "s":
      case "l":
        d = a.split(".");
        switch (d[2]) {
          case "gain":
          case "phantom":
          case "stereo":
          case "invert":
          case "delay":
          case "src":
          case "scsrc":
          case "r":
          case "name":
          case "stereoIndex":
          case "mtkrec":
            return
        }
        c =
          "";
        "aux" == d[2] && (f = parseInt(d[3], 10), 0 == getValue("a." + f + ".stereoIndex") ? c = ".aux." + (f + 1) + "." : 1 == getValue("a." + f + ".stereoIndex") && (c = ".aux." + (f - 1) + "."), c.length && (c = a.replace(".aux." + f + ".", c), setValueX(c, b), updateByKey(c)));
        "mtx" == d[2] && (f = parseInt(d[3], 10), 0 == getValue("a." + f + ".stereoIndex") ? c = ".mtx." + (f + 1) + "." : 1 == getValue("a." + f + ".stereoIndex") && (c = ".mtx." + (f - 1) + "."), c.length && (c = a.replace(".mtx." + f + ".", c), setValueX(c, b), updateByKey(c)));
        if (!a.endsWith(".pan") && !a.endsWith(".src") && !a.endsWith(".scsrc")) {
          var f =
            d[0] + "." + d[1] + ".",
            e = "",
            g = parseInt(d[1], 10);
          0 == getValue(f + "stereoIndex") ? e = d[0] + "." + (g + 1) + "." : 1 == getValue(f + "stereoIndex") && (e = d[0] + "." + (g - 1) + ".");
          e.length && (d = a.replace(f, e), setValueX(d, b), c.length && (c = c.replace(f, e), setValueX(c, b)), updateByKey(d))
        }
    }
  }
}

function isBlocked(a, b) {
  var c = getValue("settings.block.pass"),
    c = c && c != settings.master_pass;
  if (!c) return !1;
  isDefined(a) && (c = !dataValue["settings.block." + a]);
  return "auxlvl" != a && "auxproc" != a || c || !isDefined(b) || null == b ? c : !settings["perm_aux" + (b + 1)]
}

function setValueX(a, b) {
  log("[" + a + "] " + b);
  dataValue[a] = b;
  "string" == typeof b ? sendMessage("SETS^" + a + "^" + b) : sendMessage("SETD^" + a + "^" + b)
}

function putValue(a, b) {
  dataValue[a] !== b && (dataValue[a] = b, updateByKey(a, b))
}
prevMGMASK = -1;

function handle_mgmask(a) {
  checkMutes();
  switch (mode) {
    case E_MODE.MIX:
    case E_MODE.GAIN:
      regUpdate(mixerWidget);
      break;
    case E_MODE.EDIT:
      regUpdate(editStripWidget);
      editWidget.mode != editWidget.E_MODE.fx && editWidget.mode != editWidget.E_MODE.aux || regUpdate(editWidget);
      break;
    case E_MODE.AUX:
      regUpdate(auxoutWidget);
      regUpdate(auxWidget);
      break;
    case E_MODE.FXSENDS:
      regUpdate(fxoutWidget);
      break;
    case E_MODE.PLAYER:
      regUpdate(playerStrips);
      regUpdate(playerWidget);
      break;
    case E_MODE.MODALS:
      regUpdate(modalsWidget)
  }
  slideOutWidget.enabled &&
    regUpdate(slideOutWidget);
  var b = getValue("mgmask");
  if (-1 != prevMGMASK && !a) {
    a = b ^ prevMGMASK;
    a & 1 << MUTEALL_BIT_IDX && (b & 1 << MUTEALL_BIT_IDX ? showPopupMsg(lang.MUTE_ALL, 1E3) : showPopupMsg(lang.MUTE_ALL_CANCEL, 1E3));
    a & 1 << MUTEFX_BIT_IDX && (b & 1 << MUTEFX_BIT_IDX ? showPopupMsg(lang.MUTE_FX, 1E3) : showPopupMsg(lang.MUTE_FX_CANCEL, 1E3));
    for (var c = 0; 6 > c; c++) a & 1 << c && (b & 1 << c ? showPopupMsg(lang.MUTEGROUP_1_ACTIVATED.format(c + 1), 1E3) : showPopupMsg(lang.MUTEGROUP_1_DEACTIVATED.format(c + 1), 1E3))
  }
  prevMGMASK = b
}
keyWidgetHash = $H();

function updateByKey(a, b) {
  var c = keyWidgetHash.get(a);
  isDefined(c) && c.forEach(regUpdate);
  a.contains(".subgroup") && (modalsWidget.enabled && regUpdate(modalsWidget.pages[E_MODAL_MODE.SUBS]), -1 != activeSubGroup && mixerWidget.showSG(activeSubGroup));
  mode == E_MODE.EDIT && a.contains(".stereoIndex") && (editWidget.upd(), regUpdate(editWidget));
  a.endsWith(".bpm") && topWidget.led.setMsg(b + " " + lang.BPM);
  if ("mgmask" == a) handle_mgmask(!0);
  else if (a.startsWith("v.") && a.endsWith("mute")) handle_mgmask();
  else if (mode != E_MODE.EDIT ||
    selectedStrip.type != E_STRIP_TYPE.AUX && selectedStrip.type != E_STRIP_TYPE.MASTER || !a.contains("afs."))
    if (a.startsWith("var.")) {
      "var.mtk.present" === a && IS_UI_24 && mtkPlay && mtkPlay.enabled && (sendMessage(E_COMMANDS.MTK_GET_SESSIONS), sendMessage(E_COMMANDS.MTK_GET_FILES));
      "var.afsdata" == a && afsPopup && regUpdate(afsPopup);
      "var.currentShow" == a && drawAll("curShow");
      "var.currentSnapshot" == a && drawAll("curSnap");
      "var.unsaved.chsafes" == a && regUpdate(chSafesPage);
      "var.unsaved.mutegroups" == a && regUpdate(modalsWidget);
      "var.currentState" ==
      a && (regUpdate(player2track), regUpdate(masterWidget));
      "var.currentPlaylist" == a && regUpdate(player2track);
      mode == E_MODE.EDIT && "var.rta" == a && regUpdate(editWidget);
      "var.hpaux" == a && syncHPAUX();
      if ("var.currentTrack" == a) {
        var c = dataValue["var.currentTrack"],
          d = c.length;
        15 < d && (c = "..." + c.substr(d - 15, 15));
        topWidget.led.setMsg(c, "#ff0");
        dataValue["var.currentPlaylist"] == player2track.FLIST.plistName && player2track.FLIST.selectByName(dataValue["var.currentTrack"])
      }
      if ("var.isRecording" == a || "var.recBusy" == a) regUpdate(masterWidget),
        regUpdate(player2track);
      "var.recBusy" == a && regUpdate(topWidget)
    } else if (mode == E_MODE.SETTINGS && a.startsWith("settings.")) regUpdate(settingsWidget);
  else if (a.contains(".name") || a.endsWith(".fxtype")) regUpdate(bottomWidget), "a" === a[0] && mode == E_MODE.AUX && (regUpdate(auxWidget), regUpdate(auxoutWidget)), "f" === a[0] && mode == E_MODE.FXSENDS && (regUpdate(fxSendsWidget), regUpdate(fxoutWidget)), mode == E_MODE.EDIT && a.contains(selectedStrip.name) && (regUpdate(editStripWidget), regUpdate(editWidget));
  else if (mode == E_MODE.MOREME &&
    -1 != settings.meout && a.contains(".aux." + settings.meout) && regUpdate(moremeWidget), mode == E_MODE.MODALS && modalsWidget.mode == E_MODAL_MODE.MOREME && -1 != settings.meout && a.contains(".aux." + settings.meout) && regUpdate(modalsWidget.pages[E_MODAL_MODE.MOREME]), mode == E_MODE.GAIN && a.endsWith(".src") && (gainMixer.onShow(), regUpdate(gainMixer)), mode == E_MODE.MODALS && a.contains(".mgmask")) regUpdate(modalsWidget.pages[E_MODAL_MODE.MUTES]);
  else {
    if (mode == E_MODE.EDIT && a.contains(selectedStrip.name)) {
      regUpdate(editStripWidget);
      selectedStrip.type == E_STRIP_TYPE.MASTER && regUpdate(masterWidget);
      (a.contains(".afs.enabled") || a.contains(".deesser.")) && regUpdate(editWidget);
      switch (editWidget.mode) {
        case editWidget.E_MODE.eqch:
        case editWidget.E_MODE.eqaux:
        case editWidget.E_MODE.eqm:
          if (!a.contains(".eq.")) return;
          a.contains(".eq.easy") && editWidget.pages[editWidget.mode].checkState();
          break;
        case editWidget.E_MODE.dyn:
          "m.dyn.linked" == a && selectedStrip.type == E_STRIP_TYPE.MASTER && (c = editWidget.pages[editWidget.E_MODE.dyn], c.setLeft(!0),
            c.syncSliders(), regUpdate(editWidget));
          if (!a.contains(".dyn.") && !a.contains(".gate.")) return;
          break;
        case editWidget.E_MODE.gate:
          if (!a.contains(".gate.")) return;
          break;
        case editWidget.E_MODE.aux:
          if (!a.contains(".aux.")) return
      }
      regUpdate(editWidget)
    }
    mode == E_MODE.MODALS && (a.contains(".mute") || a.contains(".solo") || a.contains(".phantom") || a.contains(".invert")) && regUpdate(modalsWidget.pages[E_MODAL_MODE.TOTALVIEW]);
    mode == E_MODE.AUX && a.contains(".aux.") && (c = a.split("."), d = parseInt(c[1], 10), "l" == c[0] && (d +=
      curSetup.input), "p" == c[0] && (d += curSetup.input + curSetup.linein), "f" == c[0] && (d += curSetup.input + curSetup.linein + 2), regUpdate(auxWidget.page.strips[d]));
    if (mode == E_MODE.AUX && a.contains(".mtx.")) c = a.split("."), d = parseInt(c[1], 10), "s" == c[0] && (d += curSetup.aux), "m" == c[0] && (regUpdate(auxWidget.page2.strips[auxWidget.page2.strips.length - 1]), regUpdate(auxWidget.page2.strips[auxWidget.page2.strips.length - 2])), regUpdate(auxWidget.page2.strips[d]);
    else if (mode == E_MODE.FXSENDS && a.contains(".fx.")) {
      var c = a.split("."),
        d = parseInt(c[1], 10),
        f = parseInt(c[3], 10);
      "l" == c[0] && (d += curSetup.input);
      "p" == c[0] && (d += curSetup.input + curSetup.linein);
      "s" == c[0] && (d += curSetup.input + curSetup.linein + 2);
      fxSendsWidget.mode == f && regUpdate(fxSendsWidget.page.strips[d])
    } else if (mode == E_MODE.SETTINGS && a.contains(".safe")) regUpdate(chSafesPage);
    else if (!(a.startsWith("iso.") || (c = a.split("."), 2 > c.length || "dyn" == c[1] || "eq" == c[1])))
      if (a.contains(".solo") && checkSolos(), a.contains(".mute") && checkMutes(), mode == E_MODE.SETTINGS && a.endsWith("src") &&
        regUpdate(settingsWidget), mode == E_MODE.MODALS && a.contains(".forceunmute") && regUpdate(tvWidget), "m" == c[0]) regUpdate(masterWidget), "m.eq.linked" == a && regUpdate(editWidget), "m.dyn.linked" == a && regUpdate(editWidget);
      else if (d = c[1], isDefined(d))
      if (f = parseInt(d), isNaN(f)) log("!2 " + a);
      else switch (mode == E_MODE.AUX && auxWidget.page2 && (a.endsWith(".matrix") && auxWidget.upd(), a.contains(".mute") || a.contains(".subgroup") || a.contains(".forceunmute")) && (d = f, "l" == c[0] && (d += curSetup.input), "p" == c[0] && (d += curSetup.input +
        curSetup.linein), "f" == c[0] && (d += curSetup.input + curSetup.linein + 2), regUpdate(auxWidget.page2.strips[d])), c[0]) {
        case "hw":
          "phantom" == c[2] && blockGainBySrc(a.replace(".phantom", ""));
          break;
        case "i":
          0 <= f && f < inStrips.length && (regUpdate(inStrips[f]), "phantom" == c[2] && (1 == dataValue[a] ? blockStrip(f, PHANTOM_ON_DELAY) : blockStrip(f, PHANTOM_OFF_DELAY)));
          break;
        case "l":
          0 <= f && f < lineinStrips.length && regUpdate(lineinStrips[f]);
          break;
        case "f":
          0 <= f && f < fxStrips.length && (regUpdate(fxStrips[f]), mode == E_MODE.FXSENDS && regUpdate(fxoutWidget),
            mode == E_MODE.EDIT && editWidget.mode == editWidget.E_MODE.fx && regUpdate(editWidget.pages[editWidget.E_MODE.fx]));
          break;
        case "a":
          0 <= f && f < auxStrips.length && (regUpdate(auxStrips[f]), mode != E_MODE.AUX && mode != E_MODE.MOREME || regUpdate(auxoutWidget), mode == E_MODE.EDIT && editWidget.mode == editWidget.E_MODE.aux && regUpdate(editWidget.pages[editWidget.E_MODE.aux]));
          break;
        case "s":
          0 <= f && f < subStrips.length && regUpdate(subStrips[f]);
          break;
        case "p":
          0 <= f && f < mediaStrips.length && regUpdate(mediaStrips[f]);
          break;
        case "v":
          0 <=
            f && f < subStrips.length && regUpdate(vcaStrips[f])
      } else log("!1 " + a)
  } else regUpdate(editWidget)
}

function FREQtoV(a) {
  return bound(Math.log(a / 20) / Math.log(1102.5), 0, 1)
}

function resetParEQ(a, b) {
  setValue(a + ".eq.bypass", 0);
  setValue(a + ".eq.prname", "");
  setValue(a + ".eq.prmod", 0);
  isDefined(b) || setValue(a + ".eq.easy", 0);
  setValue(a + ".eq.hpf.freq", 0);
  IS_UI_24 && (setValue(a + ".eq.hpf.slope", 0), setValue(a + ".eq.lpf.freq", 1), setValue(a + ".eq.lpf.slope", 0));
  setValue(a + ".eq.b1.freq", FREQtoV(200));
  setValue(a + ".eq.b1.q", QtoV(1));
  setValue(a + ".eq.b1.gain", .5);
  setValue(a + ".eq.b2.freq", FREQtoV(1E3));
  setValue(a + ".eq.b2.q", QtoV(1));
  setValue(a + ".eq.b2.gain", .5);
  setValue(a + ".eq.b3.freq", FREQtoV(4E3));
  setValue(a + ".eq.b3.q", QtoV(1));
  setValue(a + ".eq.b3.gain", .5);
  setValue(a + ".eq.b4.freq", FREQtoV(1E4));
  setValue(a + ".eq.b4.q", QtoV(1));
  setValue(a + ".eq.b4.gain", .5);
  setValue(a + ".deesser.enabled", 0);
  setValue(a + ".deesser.freq", .773310034);
  setValue(a + ".deesser.threshold", .46875);
  setValue(a + ".deesser.ratio", .4)
}

function resetGraphEQ(a) {
  setValue(a + ".eq.bypass", 0);
  setValue(a + ".eq.prname", "");
  setValue(a + ".eq.prmod", 0);
  if ("m" == a) {
    setValue(a + ".eq.linked", 1);
    IS_UI_24 && (setValue(a + ".eq.hpf.l", 0), setValue(a + ".eq.hpf.r", 0), setValue(a + ".eq.lpf.l", 1), setValue(a + ".eq.lpf.r", 1));
    for (var b = 0; 31 > b; b++) setValue(a + ".eq.peak.l." + b, .5), setValue(a + ".eq.peak.r." + b, .5)
  } else
    for (IS_UI_24 && (setValue(a + ".eq.hpf", 0), setValue(a + ".eq.lpf", 1)), b = 0; 31 > b; b++) setValue(a + ".eq.peak." + b, .5)
}

function resetDyn(a, b) {
  isDefined(b) || (b = !0);
  setValue(a + ".dyn.bypass", 0);
  setValue(a + ".dyn.prname", "");
  setValue(a + ".dyn.prmod", 0);
  var c = "m" == a ? {
    ".dyn.linked": 1,
    ".dyn.l.threshold": .9375,
    ".dyn.l.gain": .75,
    ".dyn.l.ratio": 0,
    ".dyn.l.softknee": 0,
    ".dyn.l.attack": 0,
    ".dyn.l.hold": .158,
    ".dyn.l.outgain": .3333333333333333,
    ".dyn.l.release": .2490234375,
    ".dyn.r.threshold": .9375,
    ".dyn.r.gain": .75,
    ".dyn.r.ratio": 0,
    ".dyn.r.softknee": 0,
    ".dyn.r.attack": 0,
    ".dyn.r.hold": .158,
    ".dyn.r.outgain": .3333333333333333,
    ".dyn.r.release": .2490234375
  } : {
    ".dyn.threshold": .875,
    ".dyn.gain": .75,
    ".dyn.ratio": 1,
    ".dyn.softknee": 0,
    ".dyn.attack": .34375,
    ".dyn.outgain": .3333333333333333,
    ".dyn.release": findV(VtoREL, 500)
  };
  applyPreset(a, c, !0);
  b && resetGate(a)
}

function resetGate(a) {
  setValue(a + ".gate.enabled", 1);
  setValue(a + ".gate.bypass", 0);
  setValue(a + ".gate.prname", "");
  setValue(a + ".gate.prmod", 0);
  setValue(a + ".gate.thresh", 0);
  setValue(a + ".gate.attack", 0);
  setValue(a + ".gate.release", .3150737133956386);
  setValue(a + ".gate.hold", .3042441765273541);
  setValue(a + ".gate.depth", 0)
}

function applyPreset(a, b, c) {
  for (var d in b) b.hasOwnProperty(d) && isDefined(dataValue[a + d]) && null != b[d] && (setValue(a + d, b[d]), updateByKey(a + d))
}

function resetChannel(a) {
  var b = a.split("."),
    c = b[0],
    b = parseInt(b[1]),
    d = IS_UI_24 ? .09523809523809523 : .4;
  switch (c) {
    case "v":
      setValue(a + ".mute", 0);
      setValue(a + ".mix", zeroDbPos);
      setValue(a + ".name", "");
      return;
    case "i":
      setValue(a + ".gain", 0), setValue(a + ".phantom", 0), setValue(a + ".invert", 0), HAVE_LATENCY && setValue(a + ".delay", 0), setValue(a + ".hiz", 0);
    case "l":
      if (HAVE_ROUTING && "i" == c) {
        setValue(a + ".src", "hw." + b);
        setValue(a + ".scsrc", ROUTING_TEST_MODE ? "ub." + b : "ua." + b);
        var f = a.replace("i.", "hw.");
        setValue(f + ".gain",
          d);
        setValue(f + ".phantom", 0);
        setValue(f + ".hiz", 0)
      }
      HAVE_ROUTING && "l" == c && (setValue(a + ".src", "li." + b), setValue(a + ".scsrc", ROUTING_TEST_MODE ? "ub." + (20 + b) : "ua." + (20 + b)));
    case "p":
      setValue(a + ".pan", .5);
      "p" == c && setValue(a + ".pan", b);
      setValue(a + ".mute", 0);
      setValue(a + ".solo", 0);
      setValue(a + ".subgroup", -1);
      setValue(a + ".mix", 0);
      IS_UI_24 && setValue(a + ".vca", -1);
      resetParEQ(a);
      break;
    case "f":
      setValue(a + ".span", .5), setValue(a + ".smix", zeroDbPos);
    case "s":
      setValue(a + ".pan", .5), resetParEQ(a);
    case "a":
      setValue(a + ".mute",
        0);
      setValue(a + ".solo", 0);
      setValue(a + ".mix", zeroDbPos);
      "a" == c && (HAVE_LATENCY && setValue(a + ".delay", 0), resetGraphEQ(a));
      HAVE_MATRIX && setValue(a + ".matrix", 0);
      break;
    case "m":
      setValue(a + ".mix", zeroDbPos), HAVE_LATENCY && (setValue(a + ".delayL", 0), setValue(a + ".delayR", 0)), resetGraphEQ(a)
  }
  setValue(a + ".name", "");
  resetDyn(a);
  resetGate(a);
  for (c = 0; c < curSetup.aux; c++) setValue(a + ".aux." + c + ".value", 0), setValue(a + ".aux." + c + ".pan", .5), setValue(a + ".aux." + c + ".mute", 0), setValue(a + ".aux." + c + ".post", 0), setValue(a + ".aux." +
    c + ".postproc", 1), HAVE_MATRIX && (setValue(a + ".mtx." + c + ".value", 0), setValue(a + ".mtx." + c + ".pan", .5), setValue(a + ".mtx." + c + ".mute", 0));
  for (c = 0; c < curSetup.fx; c++) setValue(a + ".fx." + c + ".value", 0), setValue(a + ".fx." + c + ".mute", 0)
}

function resetFX(a) {
  var b = getValue(a + ".fxtype"),
    c = [
      [.5, .4, .5, 1, 0, 0],
      [0, .5, .3, 1, 0, 0],
      [.4, .5, 1, 0, 0, 0],
      [.5, .4, .5, 1, 0, 0]
    ];
  setValue(a + ".prmod", 0);
  setValue(a + ".prname", "");
  setValue(a + ".par1", c[b][0]);
  setValue(a + ".par2", c[b][1]);
  setValue(a + ".par3", c[b][2]);
  setValue(a + ".par4", c[b][3]);
  setValue(a + ".par5", c[b][4]);
  setValue(a + ".par6", c[b][5])
}

function createData() {
  "undefined" == typeof curSetup ? (curSetup = {
    input: 2,
    fx: 1,
    aux: 1,
    bankSize: 8,
    sub: 1,
    maxx: !0,
    rec: !0,
    phantom: 1,
    linein: 2
  }, noData = !0) : "undefined" != typeof staticInitDataArray && (staticInitDataArray(), staticInitDataArray = null)
}

function checkDataIngegrity() {
  for (var a = 0; a < inStrips.length; a++) {
    var b = inStrips[a];
    b.getNameValue("src") || b.setNameValue("src", "hw." + b.subId)
  }
}
widgetReqPreset = widgetReqList = null;

function deconvertVU(a) {
  return .004167508166392142 * a
}

function deconvertVU_comp(a) {
  a = (1 - .004167508166392142 * (a | a >> 7 & 1)) * COMP_ZOOM;
  .008 > a ? a = 0 : 1 < a && (a = 1);
  return a
}

function parseCommand(a) {
  if (a.startsWith("VU2^")) parseVUdata(a);
  else if (a.startsWith("RTA^")) parseRTAdata(a);
  else if (a.startsWith("BMSG^")) parseBMessage(a);
  else if (a.startsWith("INIT^")) a = a.substring(5), a = JSON.parse(a), Object.extend(dataValue, a), drawAll("INIT");
  else if (a.startsWith("MSG^")) {
    a = a.split("^");
    var b = "";
    if (a[1].startsWith("$")) {
      if (b = a[1].substr(1), b in lang)
        for (var b = lang[b], c = 2; c < a.length; c++) b = b.replace("{" + (c - 2) + "}", a[c])
    } else b = a[1];
    showPopupMsg(b, 3E3)
  } else a.startsWith("DLGSHOW^") ?
    (a = a.split("^"), 3 > a.length || (a.shift(), c = a.shift(), b = a.shift(), dlgShow(c, b, a))) : a.startsWith("DLGHIDE^") ? (a = a.split("^"), c = a[1], dlgHide(c)) : a.startsWith("SHOWLIST^") ? (a = a.split("^"), a.shift(), a = a.filter(function(a) {
      return "" !== a
    }), showsPage && showsPage.SHOWS.setItems(a), showsPopup && showsPopup.SHOWS.setItems(a), null != widgetReqList && (widgetReqList.setItems(a), widgetReqList = null)) : a.startsWith("SNAPSHOTLIST^") ? (a = a.split("^"), a.shift(), b = a.shift(), showsPage && !showsPage.SNAPS.showName && (showsPage.SNAPS.showName =
      b), showsPopup && !showsPopup.SNAPS.showName && (showsPopup.SNAPS.showName = b), a = a.filter(function(a) {
      return "" !== a
    }), showsPage && showsPage.SNAPS.showName == b && showsPage.SNAPS.setItems(a), showsPopup && showsPopup.SNAPS.showName == b && showsPopup.SNAPS.setItems(a), b == getValue("var.currentShow") && (CURRENT_SNAPS_LIST = a)) : a.startsWith("PRESETLIST^") ? (a = a.split("^"), a.shift(), a.shift(), a = a.filter(function(a) {
      return "" !== a
    }), null != widgetReqList && (widgetReqList.setItems(a), widgetReqList = null)) : a.startsWith("USBMOUNTS") ?
    (a = a.split("^"), a.shift(), a = a.filter(function(a) {
      return "" !== a
    }), 0 == a.length ? (widgetReqList = null, showPopupMsg(lang.SHOWEXP_USBNOTFOUND), clearModals()) : null != widgetReqList && (widgetReqList.setItems(a), widgetReqList = null)) : a.startsWith("IMPORTSHOWLIST") ? (a = a.split("^"), a.shift(), a = a.filter(function(a) {
      return "" !== a
    }), 0 == a.length ? (widgetReqList = null, showPopupMsg(lang.SHOWIMP_NOTFOUND), clearModals()) : null != widgetReqList && (widgetReqList.setItems(a), widgetReqList = null)) : a.startsWith("READPRESET^") ? (a = a.split("^"),
      b = JSON.parse(a[3]), null != widgetReqPreset && (isDefined(widgetReqPreset.loadPreset) && (a = a[2].substr(2), widgetReqPreset.loadPreset(b, a), showPopupMsg(a, 800)), widgetReqPreset = null)) : a.startsWith("PLISTS^") ? (a = a.split("^"), a.shift(), a = a.filter(function(a) {
      return "" !== a
    }), player2track.PLISTS && player2track.PLISTS.setItems(a)) : a.startsWith("PLIST_TRACKS^") ? (a = a.split("^"), a.shift(), b = a.shift(), a = a.filter(function(a) {
      return "" !== a
    }), player2track.FLIST && (player2track.FLIST.plistName = b), player2track.FLIST && player2track.FLIST.setItems(a)) :
    a.startsWith("NETCONFIG^") ? (a = a.substring(10), netConfig = JSON.parse(a), mode == E_MODE.SETTINGS && 0 == settingsWidget.mode && regUpdate(settingsWidget)) : a.startsWith("MTK_GET_SESSIONS^") ? mtkPlay && (a = a.split("^"), a.shift(), a = a.filter(function(a) {
      return "" !== a
    }), mtkPlay.sessions.setItems(a)) : a.startsWith("MTK_GET_FILES^") ? mtkPlay && (a = a.split("^"), a.shift(), a = a.filter(function(a) {
      return "" !== a
    }), mtkPlay.files.setItems(a)) : "RELOAD" == a ? (settingsStorage.save(), location.reload()) : a.startsWith("SERIAL") ? (a = a.split("^"),
      a = a[1], null == globalSerial && (globalSerial = a), globalSerial != a && (settingsStorage.save(), location.reload())) : "UPDATE_PLAYLIST" == a ? player2track.updateLists() : "UPDATE_SHOWS" == a ? (showsPage.updLists(), showsPopup && showsPopup.refreshList()) : log("Unknown command to parse: " + a)
}
var globalSerial = null;

function parseVUdata(a) {
  if (!settings.disableVUs || !settings.disableVUs2) {
    a = atob(a.slice(4));
    for (var b = mode == E_MODE.EDIT && editWidget.mode == editWidget.E_MODE.dyn, c = HAVE_GATE && mode == E_MODE.EDIT && editWidget.mode == editWidget.E_MODE.gate, d = editWidget.pages[editWidget.E_MODE.dyn], f = editWidget.pages[editWidget.E_MODE.gate], e = 8, g = 0, h = a.charCodeAt(0); g < h && !(g >= curSetup.input); g++) {
      var l = e + 6 * g,
        m = deconvertVU(a.charCodeAt(l + 0)),
        n = deconvertVU(a.charCodeAt(l + 1)),
        p = deconvertVU(a.charCodeAt(l + 2)),
        r = deconvertVU_comp((a.charCodeAt(l +
          5) & 127) << 1),
        q = 0 != (a.charCodeAt(l + 5) & 128);
      inStrips[g].setVU(n, p, 0, 0, r, 0, q, 0);
      gainStrips[g].setVUPre(m);
      if (b && selectedStrip.type == E_STRIP_TYPE.IN && selectedStrip.subId == g) {
        var t = deconvertVU(a.charCodeAt(l + 3)),
          v = deconvertVU(a.charCodeAt(l + 4));
        d.vuIN.setValue(t);
        d.vuOUT.setValue(v);
        d.vuCOMP.setValue(r)
      }
      c && selectedStrip.type == E_STRIP_TYPE.IN && selectedStrip.subId == g && (t = deconvertVU(a.charCodeAt(l + 3)), v = deconvertVU(a.charCodeAt(l + 4)), f.vuIN.setValue(t), f.vuOUT.setValue(v))
    }
    l = e += 6 * a.charCodeAt(0);
    n = deconvertVU(a.charCodeAt(l +
      1));
    p = deconvertVU(a.charCodeAt(l + 2));
    r = deconvertVU_comp((a.charCodeAt(l + 5) & 127) << 1);
    q = 0 != (a.charCodeAt(l + 5) & 128);
    mediaStrips[0].setVU(n, p, 0, 0, r, 0, q, 0);
    b && selectedStrip.type == E_STRIP_TYPE.MEDIA && 0 == selectedStrip.subId && (t = deconvertVU(a.charCodeAt(l + 3)), v = deconvertVU(a.charCodeAt(l + 4)), d.vuIN.setValue(t), d.vuOUT.setValue(v), d.vuCOMP.setValue(r));
    c && selectedStrip.type == E_STRIP_TYPE.MEDIA && 0 == selectedStrip.subId && (t = deconvertVU(a.charCodeAt(l + 3)), v = deconvertVU(a.charCodeAt(l + 4)), f.vuIN.setValue(t), f.vuOUT.setValue(v));
    l = e + 6;
    n = deconvertVU(a.charCodeAt(l + 1));
    p = deconvertVU(a.charCodeAt(l + 2));
    r = deconvertVU_comp((a.charCodeAt(l + 5) & 127) << 1);
    q = 0 != (a.charCodeAt(l + 5) & 128);
    mediaStrips[1].setVU(n, p, 0, 0, r, 0, q, 0);
    b && selectedStrip.type == E_STRIP_TYPE.MEDIA && 1 == selectedStrip.subId && (t = deconvertVU(a.charCodeAt(l + 3)), v = deconvertVU(a.charCodeAt(l + 4)), d.vuIN.setValue(t), d.vuOUT.setValue(v), d.vuCOMP.setValue(r));
    c && selectedStrip.type == E_STRIP_TYPE.MEDIA && 1 == selectedStrip.subId && (t = deconvertVU(a.charCodeAt(l + 3)), v = deconvertVU(a.charCodeAt(l +
      4)), f.vuIN.setValue(t), f.vuOUT.setValue(v));
    e += 6 * a.charCodeAt(1);
    for (g = 0; g < a.charCodeAt(2) && !(g >= curSetup.sub); g++) l = e + 7 * g, n = deconvertVU(a.charCodeAt(l + 0)), p = deconvertVU(a.charCodeAt(l + 1)), h = deconvertVU(a.charCodeAt(l + 2)), m = deconvertVU(a.charCodeAt(l + 3)), r = deconvertVU_comp((a.charCodeAt(l + 6) & 127) << 1), q = 0 != (a.charCodeAt(l + 6) & 128), subStrips[g].setVU(n, h, p, m, r, r, q, q), b && selectedStrip.type == E_STRIP_TYPE.SUB && selectedStrip.subId == g && (t = deconvertVU(a.charCodeAt(l + 4)), v = deconvertVU(a.charCodeAt(l + 5)), d.vuIN.setValue(t),
      d.vuOUT.setValue(v), d.vuCOMP.setValue(r)), c && selectedStrip.type == E_STRIP_TYPE.SUB && selectedStrip.subId == g && (t = deconvertVU(a.charCodeAt(l + 4)), v = deconvertVU(a.charCodeAt(l + 5)), f.vuIN.setValue(t), f.vuOUT.setValue(v));
    e += 7 * a.charCodeAt(2);
    for (g = 0; g < a.charCodeAt(3) && !(g >= curSetup.fx); g++) l = e + 7 * g, n = deconvertVU(a.charCodeAt(l + 0)), p = deconvertVU(a.charCodeAt(l + 1)), h = deconvertVU(a.charCodeAt(l + 2)), m = deconvertVU(a.charCodeAt(l + 3)), r = deconvertVU_comp((a.charCodeAt(l + 6) & 127) << 1), q = 0 != (a.charCodeAt(l + 6) & 128), fxStrips[g].setVU(n,
      h, p, m, r, r, q, q), fxoutWidget.idx == g && fxoutWidget.setVU(n, h, p, m, r, r, q, q), editWidget.pages[editWidget.E_MODE.fx].enabled && selectedStrip.type == E_STRIP_TYPE.MASTER && (q = editWidget.pages[editWidget.E_MODE.fx], 1 <= h ? q.CLIPS[g].clip() : q.CLIPS[g].state && !q.CLIPS[g].releasing && q.CLIPS[g].release(), q.VUS[g].setValueExt(n, h), 1 <= m ? q.CLIPS2[g].clip() : q.CLIPS2[g].state && !q.CLIPS2[g].releasing && q.CLIPS2[g].release(), q.VUS2[g].setValueExt(p, m)), b && selectedStrip.type == E_STRIP_TYPE.FX && selectedStrip.subId == g && (t = deconvertVU(a.charCodeAt(l +
      4)), v = deconvertVU(a.charCodeAt(l + 5)), d.vuIN.setValue(t), d.vuOUT.setValue(v), d.vuCOMP.setValue(r)), c && selectedStrip.type == E_STRIP_TYPE.FX && selectedStrip.subId == g && (t = deconvertVU(a.charCodeAt(l + 4)), v = deconvertVU(a.charCodeAt(l + 5)), f.vuIN.setValue(t), f.vuOUT.setValue(v));
    e += 7 * a.charCodeAt(3);
    for (g = 0; g < a.charCodeAt(4) && !(g >= curSetup.aux); g++) l = e + 5 * g, n = deconvertVU(a.charCodeAt(l + 0)), p = deconvertVU(a.charCodeAt(l + 1)), r = deconvertVU_comp((a.charCodeAt(l + 4) & 127) << 1), q = 0 != (a.charCodeAt(l + 4) & 128), auxStrips[g].setVU(n,
        p, 0, 0, r, 0, q, 0), auxoutWidget.idx == g && auxoutWidget.setVU(n, p, r, q), editWidget.pages[editWidget.E_MODE.aux].enabled && selectedStrip.type == E_STRIP_TYPE.MASTER && (q = editWidget.pages[editWidget.E_MODE.aux], 1 <= p ? q.CLIPS[g].clip() : q.CLIPS[g].state && !q.CLIPS[g].releasing && q.CLIPS[g].release(), q.VUS[g].setValueExt(n, p)), b && selectedStrip.type == E_STRIP_TYPE.AUX && selectedStrip.subId == g && (t = deconvertVU(a.charCodeAt(l + 2)), v = deconvertVU(a.charCodeAt(l + 3)), d.vuIN.setValue(t), d.vuOUT.setValue(v), d.vuCOMP.setValue(r)),
      c && selectedStrip.type == E_STRIP_TYPE.AUX && selectedStrip.subId == g && (t = deconvertVU(a.charCodeAt(l + 2)), v = deconvertVU(a.charCodeAt(l + 3)), f.vuIN.setValue(t), f.vuOUT.setValue(v));
    var l = e += 5 * a.charCodeAt(4),
      n = deconvertVU(a.charCodeAt(l + 0)),
      p = deconvertVU(a.charCodeAt(l + 1)),
      r = deconvertVU_comp((a.charCodeAt(l + 4) & 127) << 1),
      q = 0 != (a.charCodeAt(l + 4) & 128),
      h = deconvertVU(a.charCodeAt(l + 5)),
      m = deconvertVU(a.charCodeAt(l + 6)),
      g = deconvertVU_comp((a.charCodeAt(l + 9) & 127) << 1),
      J = 0 != (a.charCodeAt(l + 9) & 128);
    masterWidget.setVU2(n,
      p, h, m, r, g, q, J);
    if (b && selectedStrip.type == E_STRIP_TYPE.MASTER) {
      var q = d.left,
        t = deconvertVU(a.charCodeAt(l + 2)),
        v = deconvertVU(a.charCodeAt(l + 3)),
        O = deconvertVU(a.charCodeAt(l + 7)),
        F = deconvertVU(a.charCodeAt(l + 8));
      d.vuIN.setValue(q ? t : O);
      d.vuOUT.setValue(q ? v : F);
      d.vuCOMP.setValue(q ? r : g)
    }
    c && selectedStrip.type == E_STRIP_TYPE.MASTER && (q = f.left, f.vuIN.setValue(q ? t : O), f.vuOUT.setValue(q ? v : F));
    l = e += 5 * a.charCodeAt(6);
    deconvertVU(a.charCodeAt(l + 0));
    n = deconvertVU(a.charCodeAt(l + 1));
    p = deconvertVU(a.charCodeAt(l + 2));
    r = deconvertVU_comp((a.charCodeAt(l + 5) & 127) << 1);
    q = 0 != (a.charCodeAt(l + 5) & 128);
    lineinStrips[0].setVU(n, p, 0, 0, r, 0, q, 0);
    b && selectedStrip.type == E_STRIP_TYPE.LINEIN && 0 == selectedStrip.subId && (t = deconvertVU(a.charCodeAt(l + 3)), v = deconvertVU(a.charCodeAt(l + 4)), d.vuIN.setValue(t), d.vuOUT.setValue(v), d.vuCOMP.setValue(r));
    c && selectedStrip.type == E_STRIP_TYPE.LINEIN && 0 == selectedStrip.subId && (t = deconvertVU(a.charCodeAt(l + 3)), v = deconvertVU(a.charCodeAt(l + 4)), f.vuIN.setValue(t), f.vuOUT.setValue(v));
    l = e + 6;
    deconvertVU(a.charCodeAt(l +
      0));
    n = deconvertVU(a.charCodeAt(l + 1));
    p = deconvertVU(a.charCodeAt(l + 2));
    r = deconvertVU_comp((a.charCodeAt(l + 5) & 127) << 1);
    q = 0 != (a.charCodeAt(l + 5) & 128);
    lineinStrips[1].setVU(n, p, 0, 0, r, 0, q, 0);
    b && selectedStrip.type == E_STRIP_TYPE.LINEIN && 1 == selectedStrip.subId && (t = deconvertVU(a.charCodeAt(l + 3)), v = deconvertVU(a.charCodeAt(l + 4)), d.vuIN.setValue(t), d.vuOUT.setValue(v), d.vuCOMP.setValue(r));
    c && selectedStrip.type == E_STRIP_TYPE.LINEIN && 1 == selectedStrip.subId && (t = deconvertVU(a.charCodeAt(l + 3)), v = deconvertVU(a.charCodeAt(l +
      4)), f.vuIN.setValue(t), f.vuOUT.setValue(v))
  }
}

function parseRTAdata(a) {
  if (mode == E_MODE.EDIT && selectedStrip.name == dataValue["var.rta"] + ".") {
    switch (editWidget.mode) {
      case editWidget.E_MODE.eqch:
      case editWidget.E_MODE.eqaux:
      case editWidget.E_MODE.eqm:
        break;
      default:
        return
    }
    a = atob(a.slice(4));
    for (var b = [], c = 0, d = a.length; c < d; c++) {
      var f = .004167508166392142 * a.charCodeAt(c);
      b.push(f)
    }
    editWidget.pages[editWidget.mode].eq.setRTA(b)
  }
}

function parseBMessage(a) {
  a = a.split("^");
  if ("SYNC" == a[1] && settings.sync) {
    var b = a[3];
    a[2] == (settings.sync_id || "SYNC_ID") && setSelected(b, !1, !0)
  }
}

function potentialTranslate(a) {
  a.startsWith("$") && (a = a.substr(1), a = a in lang ? lang[a] : a);
  return a
}

function dlgShow(a, b, c) {
  var d = document.getElementById("dlg_" + a);
  if ("undefined" == typeof d || null == d) d = document.createElement("DIV"), d.id = "dlg_" + a, d.className = "DIM_DIALOG", d.style.display = "block", document.body.appendChild(d);
  b = "<div><div><h1>" + potentialTranslate(b) + "</h1><br>";
  if (isDefined(c) && "object" == typeof c)
    for (var f = 0; f < c.length; f++) b += "<input type='button' class='BTN' onclick=\"dlgResult('dlg_" + a + "'," + f + ")\" value= '" + potentialTranslate(c[f]) + "' />&nbsp;&nbsp;&nbsp;&nbsp;";
  d.innerHTML = b + "</div></div>"
}

function dlgHide(a) {
  a = document.getElementById("dlg_" + a);
  "undefined" != typeof a && null != a && a.remove()
}

function dlgResult(a, b) {
  log("dlgResult: " + a + " " + b);
  sendMessage("DLGRESULT^" + a + "^" + b);
  dlgHide(a.replace("dlg_", ""))
}

function emulate() {
  for (var a = getValue("mgmask"), b = checkBit(a, MUTEALL_BIT_IDX), c = 0; 8 > c; c++) {
    var d = randomOf(allStrips.length - 1),
      f = allStrips[d],
      e = .9 * Math.random(),
      g = .9 + .2 * Math.random();
    modalsWidget.pages[0].m.setValue(e, d);
    f.type == E_STRIP_TYPE.IN && gainStrips[f.subId].setVUPre(e);
    var d = f.getNameValue("mute"),
      h = f.getNameValue("forceunmute"),
      l = f.getNameValue("mgmask"),
      m = checkBit(a, MUTEFX_BIT_IDX) && f.type == E_STRIP_TYPE.FX,
      h = (a & l || b || m || d) && !h,
      d = f.getNameValue("mix"),
      d = h ? 0 : d / zeroDbPos * e,
      h = .1 * d;
    f.setVU(e,
      d, e * g, d * g, h, h * g, !0, !0)
  }
  .4 < Math.random() && (e = .9 * Math.random(), d = masterWidget.getNameValue("mix"), g = .9 + .2 * Math.random(), d = d / zeroDbPos * e, h = 0, masterWidget.setVU2(e, d, e * g, d * g, h, h * g, !0, !0), d = auxoutWidget.sl.value, d = d / zeroDbPos * e, auxoutWidget.setVU(e, d, e * g, d * g, h, h * g, !0, !0), d = fxoutWidget.sl.value, d = d / zeroDbPos * e, fxoutWidget.setVU(e, d, e * g, d * g, h, h * g, !0, !0));
  if (mode == E_MODE.EDIT && selectedStrip.type == E_STRIP_TYPE.MASTER && .5 < Math.random()) {
    a = editWidget.pages[editWidget.E_MODE.fx].VUS;
    b = editWidget.pages[editWidget.E_MODE.fx].MUTES;
    f = editWidget.pages[editWidget.E_MODE.fx].SLIDERS;
    for (c = 0; c < a.length; c++) e = b[c].state, g = f[c].getVal(), e = g / zeroDbPos * Math.random() * 1.002 * (e ? 0 : 1), a[c].setValueExt(0, e);
    a = editWidget.pages[editWidget.E_MODE.fx].VUS2;
    for (c = 0; c < a.length; c++) e = b[c].state, g = f[c].getVal(), e = g / zeroDbPos * Math.random() * 1.002 * (e ? 0 : 1), a[c].setValueExt(0, e);
    a = editWidget.pages[editWidget.E_MODE.aux].VUS;
    b = editWidget.pages[editWidget.E_MODE.aux].MUTES;
    f = editWidget.pages[editWidget.E_MODE.aux].SLIDERS;
    for (c = 0; c < a.length; c++) e = b[c].state,
      g = f[c].getVal(), e = g / zeroDbPos * Math.random() * 1.002 * (e ? 0 : 1), a[c].setValueExt(0, e)
  }
  .5 < Math.random() && (e = precision(Math.random(), 4), c = precision(.8 * e, 4), d = precision(.2 * e, 4), editWidget.pages[editWidget.E_MODE.dyn].setVU(e, c, d));
  if (mode == E_MODE.EDIT && selectedStrip.name == dataValue["var.rta"] + ".") {
    switch (editWidget.mode) {
      case editWidget.E_MODE.eqch:
      case editWidget.E_MODE.eqaux:
      case editWidget.E_MODE.eqm:
        break;
      default:
        return
    }
    a = [];
    for (c = 0; 120 > c; c++) e = .35 + .03 * Math.random(), a.push(e);
    editWidget.pages[editWidget.mode].eq.setRTA(a)
  }
}
var trd = 0,
  trStop = !1,
  co = 0;

function trololo() {
  for (var a = 0; a < inStrips.length; a++) inStrips[a].setNameValue("mix", bound((Math.cos(trd + .4 * a) + 1) / 2 * .7, 0, 1)), regUpdate(inStrips[a]);
  if (0 == co % 10)
    for (a = fxStrips[0].id; a < allStrips.length; a++) allStrips[a].setNameValue("mix", .7 * Math.random()), regUpdate(allStrips[a]);
  trd += .1;
  co++;
  trStop || setTimeout(trololo, 50)
}

function copyChannel(a) {
  for (var b = Object.keys(dataValue), c = {}, d = 0, f = b.length; d < f; d++) b[d].startsWith(a) && (c[b[d]] = dataValue[b[d]]);
  return c
}

function mixerToJson() {
  for (var a = [], b = 0; b < allStrips.length; b++) {
    var c = copyChannel(allStrips[b].name);
    a.push(c)
  }
  return "jsonToMixer('" + JSON.stringify(a) + "');"
}

function jsonToMixer(a) {
  a = JSON.parse(a);
  for (var b = 0; b < a.length; b++) {
    log(b);
    for (var c = a[b], d = Object.keys(c), f = 0; f < d.length; f++) {
      var e = d[f];
      setValueX(e, c[e])
    }
  }
  drawAll()
}

function showData(a) {
  for (var b = Object.keys(dataValue), c = 0, d = b.length; c < d; c++) b[c].contains(a) && console.log(b[c] + ": " + dataValue[b[c]])
}

function getKeys(a) {
  for (var b = [], c = Object.keys(dataValue), d = 0, f = c.length; d < f; d++) c[d].contains(a) && b.push(c[d]);
  return b
}
PROGRAM_VERSION = "01/07/2017";
APP_ID = "com.soundcraft.ui.tablet";
ROUTING_TEST_MODE = PATTERNED = EMULATE = WEBSITE_MODE = DEPLOY = !1;
VU_RANGE = 80;
COMP_RANGE = 20;
COMP_ZOOM = 2;
COMP_SCALE = COMP_RANGE / VU_RANGE * COMP_ZOOM;
GLOBAL_VU_FALL_SPEED = .01;
GLOBAL_VU_FALL_ACC = GLOBAL_VU_FALL_SPEED / fps;
GLOBAL_PEAK_FALL_SPEED = GLOBAL_VU_FALL_SPEED / 10;
GLOBAL_PEAK_FALL_ACC = GLOBAL_PEAK_FALL_SPEED / fps * 2;
SCROLL_SCALE = 1.5;
TAP_TEMPO_MAX_GAP = 3100;
TAP_TEMPO_AVG_FROM = 5;
DBL_CLK_TIME = 350;
HOLD_TIME = 600;
CLIP_HOLD_TIME = PEAK_HOLD_TIME = 3E3;
PHANTOM_ON_DELAY = 4E3;
PHANTOM_OFF_DELAY = 17E3;
mode = 0;
HAVE_GATE = HAVE_REC = HAVE_HP = HAVE_LATENCY = HAVE_ISOLATION = HAVE_ROUTING = !1;
HAVE_SYNC = !0;
CASCADE_MODE = IS_UI_24 = HAVE_MTK = HAVE_MATRIX = !1;
measures = {
  topWidgetHeight: 71,
  bottomWidgetHeight: 34,
  mixerStripWidth: 112,
  masterStripWidth: 127,
  mixerRightMargin: 127,
  vuWidth: 11,
  db0: .7647058823529421
};
color = {
  bg: "#16181C",
  botBG: "#242424",
  buttonsBG: "#919497",
  tabStroke: "#535457",
  masterLabel: "#ECCA12",
  stripChLabel: "#C4C4C4",
  labelText: "#F9F9F9",
  labelTextSel: "#F9F9F9",
  eqLabel: "#EEEEEE",
  tabText: "#C8C9C9",
  tabTextSel: "#f9f9f9",
  vuBg: "#5E6168",
  ledText: "#00ffff",
  ledTextVCA: "#22E904",
  mLedText: "#E7E840",
  eqBg: "#18191D",
  eqBg2: "#18191D",
  graphMarks: "#8D8E90",
  yellow: "#BCA633",
  red: "#A83B3B",
  blue: "#3576B1",
  brown: "#B28741",
  green: "#47AF46",
  purple: "#8835b1",
  orange: "#b27635",
  gray: "#B0AFAF",
  black: "#060606",
  black2: "#242424",
  sub: "#ba5d81",
  modal: "#32ABBE",
  media: "#A8184B",
  white: "#f9f9f9",
  presetBg: "#232627",
  shadow: "#444",
  maxx: "#AB9A89",
  tvPhantom: "#3577b1",
  tvInvert: "#b37936",
  tvMute: "#b53636",
  tvMuteMG: "#e55",
  tvMuteUn: "#82C9DE",
  tvSolo: "#c3a72d",
  tvGray: "#555",
  tvClearSolo: "#ccaf2f",
  tvMuteALL: "#ba3838",
  tvMuteFX: "#387dba",
  tvInvertOff: "#4D4D5D",
  tvPhantomOff: "#4D4D5D",
  tvMuteOff: "#807B7B",
  tvSoloOff: "#80807B",
  EQ: "#A83B3B",
  DYN: "#47AF46",
  FX: "#3576B1",
  AUX: "#BCA633",
  MATRIX: "#b27635",
  LINEIN: "#BC2D1B",
  DIGI: "#bbb",
  INPUT: "#c4673a",
  vuPeak: "#b4b",
  grad1: null,
  grad2: null,
  grad3: null,
  grad4: null,
  grad5: null,
  grad6: null,
  gradMBL: null,
  panGrad: null,
  mPanGrad: null,
  gradTVInd: null,
  longClickMark: "rgba(200,200,200,0.5)",
  longClickMark2: "rgba(0,0,0,0.14)",
  me: "#FF9900",
  GATE: "#6D9F36",
  USB: "#C35353",
  LOCAL: "#D08561",
  SD: "#BCA633",
  vgText: "#60CAD1",
  mgText: "#E85A62",
  afsFixed: "#3333bb",
  afsLive: "#DBD23C",
  afsGraphPeakFixed: "rgba(51,51,187,0.6)",
  afsGraphPeakLive: "rgba(219,210,60,0.6)"
};
font = {
  stripChannel: "11pt open_sans_condensedbold",
  eqMarks: "12px open_sans_condensedbold",
  eqSlText: "15px open_sans_condensedbold",
  eqLabel: "14pt open_sans_condensedbold",
  tabText: "12pt open_sans_condensedbold",
  tabTextSel: "14pt open_sans_condensedbold",
  botChLabel: "14pt open_sans_condensedbold",
  botMChLabel: "14pt open_sans_condensedbold",
  settingsLabel: "18px open_sans_condensedbold",
  settings: "16px open_sans_condensedbold",
  led: "18px umixled",
  topLed: "16px umixled",
  stripMarks: "9px open_sansbold",
  editbox: "18px open_sans_condensedbold",
  listItems: "13pt open_sans_condensedbold",
  time: "17pt open_sans_condensedbold, monospace",
  sans13pt: "13pt open_sans_condensedbold"
};
Shadow = {
  main: [color.black, 0, 1, 1],
  big: [color.black, 0, 2, 2],
  white: [color.white, 0, 1, 1]
};
allStrips = [];
allStripsNoVca = [];
auxStrips = [];
inStrips = [];
gainStrips = [];
gainStrips2 = [];
fxStrips = [];
subStrips = [];
mediaStrips = [];
lineinStrips = [];
vcaStrips = [];
auxSendStrips = [];
mtxSendStrips = [];
fxSendStrips = [];
bankIdx = 0;
var activeViewGroup = -1,
  lastActiveViewGroup = -1,
  lastActiveViewPosition = -1;
activeSubGroup = -1;
currentSnapName = selectedShowName = inView = null;
selectedChannel = 1;
selectedChID = "";
selectedMtxSend = selectedFxSend = selectedAuxSend = selectedStrip = null;
prevSelChannel = 0;
guiReady = hideHPAUX = stopUpdateMode = noData = !1;

function configFunctions() {
  HAVE_REC = !!curSetup.rec;
  switch (curSetup.input) {
    case 8:
    case 12:
      HAVE_LATENCY = HAVE_ROUTING = !1, HAVE_HP = !0
  }
  20 <= curSetup.input && (HAVE_LATENCY = HAVE_ROUTING = IS_UI_24 = !0, HAVE_HP = !1, HAVE_MATRIX = HAVE_MTK = HAVE_ISOLATION = HAVE_GATE = !0);
  40 <= curSetup.input && (CASCADE_MODE = !0)
}

function loadResources() {
  res._font1 = "asdasd";
  if (isLocal || CHEETAH_TEXTURE) CHEETAH_TEXTURE = !1, res["imga_1.png"] = loadImg("ch/imga_1.png", !1), res["imga_2.png"] = loadImg("ch/imga_2.png", !1), res["imga_3.png"] = loadImg("ch/imga_3.png", !1), res["imga_4.png"] = loadImg("ch/imga_4.png", !1), CHEETAH_TEXTURE = !0;
  res.topBarLeft = loadImg("TOPNAV-L.png");
  res.topBarTile = loadImg("TOPNAV-T3.png");
  res.topBarRight = loadImg("TOPNAV-R.png");
  res.topBarLED = loadImg("TOPNAV-LED.png");
  res.topBarLogo = loadImg("UMIX-OFF.png");
  res.topBarLogo2 =
    loadImg("UMIX-ON3.png");
  res.stripTop = loadImg("C-TOP.png");
  res.stripAuxTop2 = loadImg("C-AUX-TOP.png");
  res.stripAuxTop = loadImg("C-AUX-TOP-UPD.png");
  res.stripTile = loadImg("C-TILE.png");
  res.stripBottom = loadImg("C-BOT.png");
  res.stripLabel = loadImg("C-LABEL.png");
  res.auxStripTop = loadImg("AUX-SC-TOP.png");
  res.auxStripTile = loadImg("AUX-SC-TILE.png");
  res.auxStripBottom = loadImg("AUX-SC-BOTTOM.png");
  res.blStripTop = loadImg("BLANK-SC-TOP2.png");
  res.blStripTile = loadImg("BLANK-SC-TILE.png");
  res.blStripBottom = loadImg("BLANK-SC-BOTTOM.png");
  res.blStripLabel = loadImg("BLANK-SC-LABEL.png");
  res.mAUXStripTop = loadImg("AUX-M-TOP2.png");
  res.mStripTopNCS = loadImg("M-TOP-NCS.png");
  res.mStripTile = loadImg("M-TILE.png");
  res.mStripBottom = loadImg("M-BOTTOM.png");
  res.mStripBottomLabel = loadImg("M-LABEL.png");
  res.mStripMute_OFF = loadImg("M-MUTE-OFF.png");
  res.mStripMute_OFF_F = loadImg("M-MUTE-OFF_F.png");
  res.mStripMute_ON = loadImg("M-MUTE-ON.png");
  res.mStripSolo_OFF = loadImg("M-SOLO-OFF.png");
  res.mStripSolo_ON = loadImg("M-SOLO-ON.png");
  res.fader = loadImg("FADER-SILVER2.png", !0);
  res.redFader = loadImg("FADER-RED2.png", !0);
  res.blueFader = loadImg("FADER_BLUE.png", !0);
  res.greenFader = loadImg("SLIDER_GREEN.png", !0);
  res.subFader = loadImg("FADER_PINK.png", !0);
  res.auxFader = loadImg("FADER_YELLOW.png", !0);
  res.mtxFader = loadImg("FADER-ORANGE.png", !0);
  res.gainFader = loadImg("FADER_UI_B.png", !0);
  res.fxFader = loadImg("FADER-FX3.png", !0);
  res.fxFader_p = loadImg("FADERP-FX2.png", !0);
  res.fxFader_o = loadImg("FADERO-FX2.png", !0);
  res.fxFader_g = loadImg("FADERG-FX2.png", !0);
  res.fxFader_b = loadImg("FADERB-FX2.png", !0);
  res.panSlider = loadImg("PAN-SLIDER.png", !0);
  res.presetLED = loadImg("LED-PRESET.png");
  res.peakOFF = loadImg("PEAK-OFF.png", !0);
  res.peakON = loadImg("PEAK-ON.png", !0);
  res.vuTexture = loadImg("M VU TILE5.png", !0);
  res.bMixGainOff = loadImg("MIXG-OFF.png", !0);
  res.bMixGainOn = loadImg("MIX_B100.png", !0);
  res.bMixGain2 = loadImg("MIXG-GAIN.png", !0);
  res.bTVOff = loadImg("TV-OFF.png", !0);
  res.bTVOn = loadImg("TV-ON.png", !0);
  res.bFXOff = loadImg("FXS-OFF.png", !0);
  res.bFXOn = loadImg("FXS-ON.png", !0);
  res.bAUXOff = loadImg("AUXS-OFF.png", !0);
  res.bAUXOn = loadImg("AUX-BTN_Y1.png", !0);
  res.bEDITOff = loadImg("EDT-OFF.png", !0);
  res.bEDIT_T = loadImg("EDT-ON_T.png", !0);
  res.bSettingsOff = loadImg("SETTINGS-OFF.png", !0);
  res.bSettingsOn = loadImg("SETTINGS-ON.png", !0);
  res.bPlayerOff = loadImg("AUD-BTN-OFF.png", !0);
  res.bPlayerOn = loadImg("AUD-BTN-ON.png", !0);
  res.bMuteOff = loadImg("MUTE-SC-OFF.png", !0);
  res.bMuteOff_F = loadImg("MUTE-SC-OFF_F.png", !0);
  res.bMuteOn = loadImg("MUTE-SC-ON.png", !0);
  res.bPre = loadImg("PRE-OFF.png", !0);
  res.bPost = loadImg("POST-ON_g.png", !0);
  res.bSoloOff = loadImg("SOLO-SC-OFF.png", !0);
  res.bSoloOn = loadImg("SOLO-SC-ON.png", !0);
  res.bF1Off = loadImg("F1-OFF.png");
  res.bF1On = loadImg("F1-ON.png");
  res.bF2Off = loadImg("F2-OFF.png");
  res.bF2On = loadImg("F2-ON.png");
  res.SSUPD_ON = loadImg("SAVE-ON.png");
  res.SSUPD_OFF = loadImg("SAVE-OFF.png");
  res.SS_ON = loadImg("SAVEAS-ON.png");
  res.SS_OFF = loadImg("SAVEAS-OFF.png");
  res.RECS_STOP = loadImg("RECS-STOP.png");
  res.RECS_OFF = loadImg("RECS-OFF.png");
  res.PLAYS_STOP = loadImg("PLAYS-STOP.png");
  res.PLAYS_OFF = loadImg("PLAYS-OFF.png");
  res.bPhantomOff = loadImg("PHANTOM-OFF.png", !0);
  res.bPhantomOn = loadImg("PHANTOM-ON.png", !0);
  res.b48Off = loadImg("48V-OFF.png", !0);
  res.b48On = loadImg("48V-ON.png", !0);
  res.hiz_off = loadImg("HIZ-OFF2.png", !0);
  res.hiz_on = loadImg("HIZ-ON2.png", !0);
  res.bPIOff = loadImg("PI-OFF.png", !0);
  res.bPIOn = loadImg("PI-ON.png", !0);
  res.bBMuteOff = loadImg("MUTE-L-BTN-OFF.png", !0);
  res.bBMuteOn = loadImg("MUTE-L-BTN-ON.png", !0);
  res.soTop = loadImg("SC-TOP.png");
  res.soTile = loadImg("SC-TILE.png");
  res.soBottom = loadImg("SC-BOTTOM.png");
  res.bINPUTS_OFF = loadImg("INPUTS-OFF.png");
  res.bINPUTS_ON = loadImg("INPUTS-ON.png");
  res.bFXRet_OFF = loadImg("FXRET-BTN-OFF.png");
  res.bFXRet_ON = loadImg("FXRET-BTN-ON.png");
  res.bMuteAll_OFF = loadImg("MUTE-ALL-OFF.png");
  res.bMuteAll_ON = loadImg("MUTE-ALL-ON.png");
  res.bMuteFX_OFF = loadImg("MUTE-FX-OFF.png");
  res.bMuteFX_ON = loadImg("MUTE-FX-ON.png");
  res.bMTA_OFF = loadImg("CMIX-OFF.png");
  res.bMTA_ON = loadImg("CMIX-ON.png");
  res.bMuteGr_OFF = loadImg("MUTEGR-BTN-OFF.png");
  res.bMuteGr_ON = loadImg("MUTEGR-BTN-ON.png");
  res.bAUXMast_OFF = loadImg("AUXM-BTN-OFF.png");
  res.bAUXMast_ON = loadImg("AUXM-BTN-ON2.png");
  res.bSUBGr_OFF = loadImg("SUBGR-BTN-OFF.png");
  res.bSUBGr_ON = loadImg("SUBGR-BTN-ON.png");
  res.bVIEWGr_OFF = loadImg("VIEWGR-BTN-OFF.png");
  res.bVIEWGr_ON = loadImg("VIEWGR-BTN-ON.png");
  res.bBYPASS_ON = loadImg("BYPASS-ON.png");
  res.bBYPASS_OFF = loadImg("BYPASS-OFF.png");
  res.bRESET_ON = loadImg("RESET-ON.png");
  res.bRESET_OFF = loadImg("RESET-OFF.png");
  res.bROOM_OFF = loadImg("ROOM-OFF.png");
  res.bROOM_ON = loadImg("ROOM-GR-ON.png");
  res.bHARDKNEE_OFF = loadImg("HARD-KNEE-OFF.png");
  res.bSOFTKNEE_ON = loadImg("SOFT-KNEE-ON.png");
  res.bEZEQ_ON = loadImg("EZ-ON.png");
  res.bEZEQ_OFF = loadImg("EZ-BTN-OFF.png");
  res.eqHFaderGray = loadImg("SLIDER_SILVER_H.png", !0);
  res.eqVFaderGray = loadImg("FADER_UI_B.png", !0);
  res.eqVFaderRed = loadImg("SLIDER_RED.png", !0);
  res.eqVFaderGreen = loadImg("SLIDER_GREEN.png", !0);
  res.eqVFaderOrange = loadImg("SLIDER_PEW.png", !0);
  res.eqVFaderBlue = loadImg("SLIDER_BLUE.png", !0);
  res.eqVFaderPurple = loadImg("SLIDER_PURPLE.png", !0);
  res.eqVFaderYellow = loadImg("SLIDER_YELLOW.png", !0);
  res.fxLEDb = loadImg("FX-B-LED.png", !0);
  res.auxsLED = loadImg("AUXS-LED.png", !0);
  res.b1 = loadImg("nr/NR1-OFF.png");
  res.b2 = loadImg("nr/NR2-OFF.png");
  res.b3 = loadImg("nr/NR3-OFF.png");
  res.b4 = loadImg("nr/NR4-OFF.png");
  res.b5 = loadImg("nr/NR5-OFF.png");
  res.b6 = loadImg("nr/NR6-OFF.png");
  res.b1R = loadImg("nr/NR1-RED-ON.png");
  res.b2R = loadImg("nr/NR2-RED-ON.png");
  res.b3R = loadImg("nr/NR3-RED-ON.png");
  res.b4R = loadImg("nr/NR4-RED-ON.png");
  res.b5R = loadImg("nr/NR5-RED-ON.png");
  res.b6R = loadImg("nr/NR6-RED-ON.png");
  res.b1B = loadImg("nr/NR1-BLUE-ON.png");
  res.b2B = loadImg("nr/NR2-BLUE-ON.png");
  res.b3B = loadImg("nr/NR3-BLUE-ON.png");
  res.b4B = loadImg("nr/NR4-BLUE-ON.png");
  res.b5B = loadImg("nr/NR5-BLUE-ON.png");
  res.b6B = loadImg("nr/NR6-BLUE-ON.png");
  res.bTAP = loadImg("TAP-BLA-OFF.png", !0);
  res.bTAP_Pressed = loadImg("TAP-BLA-ON.png", !0);
  res.bTAPT_OFF = loadImg("TAPT-BTN_DLY-OFF.png", !0);
  res.bTAPT_ON = loadImg("TAPT-BTN_DLY-ON.png", !0);
  res.player_prev_on = loadImg("MEDIA-PREV-ON.png");
  res.player_prev_off =
    loadImg("MEDIA-PREV-OFF.png");
  res.player_next_on = loadImg("MEDIA-NEXT-ON.png");
  res.player_next_off = loadImg("MEDIA-NEXT-OFF.png");
  res.player_play = loadImg("MEDIA-PLAY.png");
  res.player_pause = loadImg("MEDIA-PAUSE.png");
  res.player_stop_on = loadImg("MEDIA-STOP-ON.png");
  res.player_stop_off = loadImg("MEDIA-STOP-OFF.png");
  res.player_rec_on = loadImg("MEDIA-REC-ON2.png");
  res.player_rec_off = loadImg("MEDIA-REC-OFF.png");
  res.lex_delay_a = loadImg("LEX-DA.png");
  res.lex_reverb = loadImg("LEX-REV.png");
  res.lex_chorus = loadImg("LEX-CH.png");
  res.lex_room = loadImg("LEX-RM.png");
  res.lex_tap_off = loadImg("LEX_TAP_OFF.png");
  res.lex_tap_on = loadImg("LEX_TAP_ON.png");
  res.lock = loadImg("lock_3.png", !0);
  res.RTA_OFF = loadImg("RTA_OFF.png");
  res.RTA_ON = loadImg("RTA_ON.png");
  res.DESS_OFF = loadImg("DES-OFF.png");
  res.DESS_ON = loadImg("DES-ON.png");
  res.lex = loadImg("lex.png");
  res.dbx = loadImg("dbx.png");
  res.dbx_logo = loadImg("dbx_logo.png");
  res.lex_rev = loadImg("lex_logo.png");
  res.lex_cho = loadImg("lex_cho.png");
  res.lex_dly = loadImg("lex_dly.png");
  res.lex_rmlogo =
    loadImg("lex_rmlogo.png");
  res.DIGI_PRE = loadImg("DIGI_AM.png");
  res.digitech_logo = loadImg("DIGITECH_LOGO.png");
  res.AFS2LOGO = loadImg("AFS2LOGO.png");
  res.OFF_OFF = loadImg("OFF-OFF.png");
  res.OFF_ON = loadImg("OFF-ON.png");
  res.ON_ON = loadImg("ON-ON.png");
  res.SETUP_OFF = loadImg("SETUP-OFF.png");
  res.SETUP_ON = loadImg("SETUP-ON.png");
  res.AFSON_ON = loadImg("AFSON-ON2.png");
  res.AFSON_OFF = loadImg("AFSON-OFF2.png");
  res.MOME_OFF = loadImg("MOME-OFF.png");
  res.MOME_ON = loadImg("MOME-ON.png");
  res.AMP_D = loadImg("DIGIAMP_A.png");
  res.AMP_G = loadImg("AMP-GREY.png");
  res.CAB_D = loadImg("DIGICAB_A2.png");
  res.CAB_G = loadImg("SPKR-GREY.png");
  res.inv_pic = loadImg("picto_gr2.png", !0);
  res.about = loadImg("SCLOGO_B.png");
  res.pedal_grey = loadImg("PEDAL-GREY.png");
  res.pedal_light = loadImg("PEDAL-LIGHT-ON.png");
  res.bg = loadImg("PATTERN_DNS.png");
  res.bolt_icon = loadImg("BOLT_ICON.png");
  res.cl_s_btn_off = loadImg("CL_BTN_OFF.png");
  res.cl_s_btn_on = loadImg("CL_BTN_ON.png");
  res.postproc = loadImg("PP-OFF.png");
  res.preproc = loadImg("PP-ONO.png");
  res.FX_BTN_OFF =
    loadImg("FX_BTN_OFF.png");
  res.FX_BTN_PUR = loadImg("FX_BTN_PUR.png");
  res.FX_BTN_OR = loadImg("FX_BTN_OR.png");
  res.FX_BTN_GR = loadImg("FX_BTN_GR.png");
  res.FX_BTN_BLU = loadImg("FX_BTN_BLU.png");
  res.PRV_SNP_ON = loadImg("PRV-SNP-ON.png");
  res.PRV_SNP_OFF = loadImg("PRV-SNP-OFF.png");
  res.NXT_SNP_ON = loadImg("NXT-SNP-ON.png");
  res.NXT_SNP_OFF = loadImg("NXT-SNP-OFF.png");
  res.MTK_PLAY = loadImg("MTRK-PLAY.png");
  res.MTK_STOP = loadImg("MTK-STOP.png");
  res.MTK_REC_ON = loadImg("MTK-REC-ON.png");
  res.MTK_REC_OFF = loadImg("MTK-REC-OFF.png");
  res.SO2_TOP = loadImg("SO-TOP.png");
  res.SO2_TILE = loadImg("SO-TILE.png");
  res.SO2_BOTTOM = loadImg("SO-BOTTOM.png");
  res.SO_M_BTN_TUR = loadImg("SO-M-BTN-TUR.png");
  res.SO_M_BTN_RED = loadImg("SO-M-BTN-RED.png");
  res.SO_M_BTN_PNK = loadImg("SO-M-BTN-PNK.png");
  res.SO_M_BTN_OFF = loadImg("SO-M-BTN-OFF.png");
  res.SO_M_BTN_BLU = loadImg("SO-M-BTN-BLU.png");
  res.SO_L_BTN_TUR = loadImg("SO-L-BTN-TUR.png");
  res.SO_L_BTN_RED = loadImg("SO-L-BTN-RED.png");
  res.SO_L_BTN_OFF = loadImg("SO-L-BTN-OFF.png");
  res.SO_B_BTN_YLW = loadImg("SO-B-BTN-YLW.png");
  res.SO_B_BTN_PNK = loadImg("SO-B-BTN-PNK.png");
  res.SO_B_BTN_BLU = loadImg("SO-B-BTN-BLU.png");
  res.SO_B_BTN_GRE = loadImg("SO-B-BTN-GRE.png");
  res.SO_B_BTN_OFF = loadImg("SO-B-BTN-OFF.png");
  res.FFUNC_OFF = loadImg("SO-S-SLV.png");
  res.FFUNC_RED = loadImg("SO-S-RED.png");
  res.FFUNC_GRE = loadImg("SO-S-GRE.png");
  res.FFUNC_YLW = loadImg("SO-S-YLW.png");
  res.FFUNC_BLU = loadImg("SO-S-BLU.png");
  res.FFUNC_B_OFF = loadImg("SO-M-SLV.png");
  res.FFUNC_B_YLW = loadImg("SO-M-YLW.png");
  res.FFUNC_B_RED = loadImg("SO-M-RED.png");
  res.FFUNC_B_GRE =
    loadImg("SO-M-GRE.png");
  res.FFUNC_B_BLU = loadImg("SO-M-BLU.png");
  IS_UI_24 && settings.bigSlideOut && (res.VCA_ON = loadImg("VCA_ON.png"), res.VCA_OFF = loadImg("VCA_OFF.png"), res.SUBG_ON = loadImg("SUBG_ON.png"), res.SUBG_OFF = loadImg("SUBG_OFF.png"), res.HOME_ON = loadImg("HOME_ON.png"), res.HOME_OFF = loadImg("HOME_OFF.png"), res.FXM_ON = loadImg("FXM_ON.png"), res.FXM_OFF = loadImg("FXM_OFF.png"), res.AUXM_ON = loadImg("AUXM_ON.png"), res.AUXM_OFF = loadImg("AUXM_OFF.png"));
  getValue("settings.demo") && (res.UIX = loadImg("uix.png"));
  checkFonts()
}
var topWidget = null,
  bottomWidget = null,
  masterWidget = null,
  mixerWidget = null,
  gainMixer = null,
  auxWidget = null,
  fxSendsWidget = null,
  editWidget = null,
  editStripWidget = null,
  settingsWidget = null,
  playerStrips = null,
  playerLabels = null,
  slideOutWidget = null,
  auxoutWidget = null,
  fxoutWidget = null,
  modalsWidget = null,
  playerWidget = null,
  fsGEQ = null,
  fsPEQ = null,
  pongGame = null,
  moremeWidget = null,
  networkWidget = null;
showsPopup = metersWidget = null;

function settingsCheck() {
  curSetup.rec || (settings.f1func == E_FFUNC.REC && settingsStorage.set("f1func", E_FFUNC.PLAY), settings.f2func == E_FFUNC.REC && settingsStorage.set("f2func", E_FFUNC.NEWSNAP));
  1 > settings.drawRate && settingsStorage.set("drawRate", 1)
}
bgPattern = color.eqBg;

function initGUI() {
  IMG_LOAD_0 = null;
  WEBSITE_MODE && loadDemoUserSnapshot();
  if ("ch" == settings.lang)
    for (var a = Object.keys(font), b = 0; b < a.length; b++) font[a[b]] = font[a[b]].replace("open_sans_condensedbold", "Tahoma");
  isLocal && initLocal();
  if (PATTERNED = isLocal ? !1 : settings.patterned) bgPattern = createPattern(res.bg, "repeat"), color.eqBg = bgPattern;
  sendTime();
  setInterval(function() {
    sendMessage("ALIVE")
  }, 1E3);
  settingsCheck();
  initGradients();
  HAVE_HP && (hideHPAUX = 0 == getValue("var.hpaux"));
  topWidget = new TopWidget;
  auxoutWidget =
    new AUXOUTStrip;
  fxoutWidget = new FXOUTStrip;
  bottomWidget = new BottomWidget2;
  mixerWidget = new MainMixer;
  gainMixer = new GainMixer;
  selectedStrip = inStrips[0];
  masterWidget = new MasterStrip;
  slideOutWidget = IS_UI_24 && settings.bigSlideOut ? new SlideOut2 : new SlideOut;
  auxWidget = new AUXSendsPage;
  fxSendsWidget = new FXSENDSPage;
  settingsWidget = new SETTINGS;
  modalsWidget = new MODALS;
  playerStrips = new MEDIA_STRIPS;
  playerLabels = new MEDIA_LABELS;
  playerWidget = IS_UI_24 ? new PLAYER_PAGE : new PLAYER;
  editWidget = new EDIT_PAGE;
  editStripWidget =
    new EDIT_STRIP;
  moremeWidget = new MOREME;
  pongGame = new PONG;
  prepareF1F2();
  resumeShowGroup();
  guiReady = !0;
  mode = E_MODE.MIX;
  isPortrait && settings.moremeportrait ? setMode(E_MODE.MOREME, 2) : setMode(E_MODE.MIX);
  syncHPAUX();
  selectFirstVisible();
  setTimeout(updateSomeStuff, 500);
  setInterval(updateSomeStuff, 3E3);
  WEBSITE_MODE && setInterval(saveDemoUserSnapshot, 5E3);
  EMULATE && setInterval(emulate, 50)
}

function saveDemoUserSnapshot() {
  settingsStorage.put("DEMO_SNAP_VER", "ui" + curSetup.input);
  settingsStorage.put("DEMO_SNAP_DATA", dataValue)
}

function loadDemoUserSnapshot() {
  var a = settingsStorage.get("DEMO_SNAP_VER"),
    b = settingsStorage.get("DEMO_SNAP_DATA");
  a == "ui" + curSetup.input && b && "object" === typeof b && Object.extend(dataValue, b)
}
var keyboard = null,
  keyboardCheckTimer = null;

function initLocal() {
  isLocal && isDefined($j) && ($j("#eb2").keyboard({
    layout: "custom",
    customLayout: {
      normal: ["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}", "q w e r t y u i o p [ ] \\", "a s d f g h j k l ; ' {accept}", "{shift} z x c v b n m , . / {shift}", "{accept} {alt} {space} {alt} {cancel}"],
      shift: ["~ ! @ # $ % ^ & * ( ) _ + {bksp}", "Q W E R T Y U I O P { } |", 'A S D F G H J K L : " {accept}', "{shift} Z X C V B N M < > ? {shift}", "{accept} {alt} {space} {alt} {cancel}"],
      alt: ["~ ¡ ² ³ ¤ € ¼ ½ ¾ ‘ ’ ¥ × {bksp}",
        "ä å é ® þ ü ú í ó ö « » ¬", "á ß ð f g h j k ø ¶ ´ {accept}", "{shift} æ x © v b ñ µ ç > ¿ {shift}", "{accept} {alt} {space} {alt} {cancel}"
      ],
      "alt-shift": ["~ ¹ ² ³ £ € ¼ ½ ¾ ‘ ’ ¥ ÷ {bksp}", "Ä Å É ® Þ Ü Ú Í Ó Ö « » ¦", "Ä § Ð F G H J K Ø ° ¨ {accept}", "{shift} Æ X ¢ V B Ñ µ Ç . ¿ {shift}", "{accept} {alt} {space} {alt} {cancel}"]
    },
    display: {
      accept: "OK",
      cancel: "CANCEL",
      shift: "SHIFT",
      alt: "ALT",
      bksp: "←"
    },
    userClosed: !0,
    usePreview: !1,
    cancelClose: !1,
    accepted: function(a, b, c) {
      editOk.valueFunc();
      hideEditBox2()
    },
    canceled: function(a, b, c) {
      hideEditBox2()
    }
  }), keyboard = $j("#eb2").getkeyboard(), keyboardCheckTimer = setInterval(function() {
    "none" == editContainer.style.display && keyboard.isVisible() && keyboard.close()
  }, 250))
}

function onDataINIT() {
  updateSomeStuff()
}

function updateSomeStuff() {
  updateCurSnapList()
}

function updateCurSnapList() {
  var a = getValue("var.currentShow");
  a && sendMessage(E_COMMANDS.SNAP_LIST + "^" + a)
}

function selectFirstVisible() {
  for (var a = 0, b = 0; b < allStrips.length; b++)
    if (allStrips[b].enabled) {
      a = b;
      break
    }
  setSelected(a)
}

function resumeShowGroup() {
  var a = settings.currentViewGroup;
  if (-1 != a)
    if (300 <= a && IS_UI_24) mixerWidget.showVCA(bound(a - 300, 0, 6));
    else if (200 <= a) mixerWidget.showSG(bound(a - 200, 0, 6));
  else if (100 <= a) switch (a) {
    case E_VG.INPUTS:
      mixerWidget.showInputsGroup();
      break;
    case E_VG.FXS:
      mixerWidget.showFxGroup();
      break;
    case E_VG.SUBS:
      mixerWidget.showSubGroup();
      break;
    case E_VG.AUXS:
      mixerWidget.showAuxGroup();
      break;
    case E_VG.VCAS:
      mixerWidget.showVCAGroup()
  } else mixerWidget.showViewGroup(settings.currentViewGroup)
}

function goBack() {
  setMode(lastMode)
}
lastMode = E_MODE.MIX;
modeHistory = [];

function modeBack() {
  isPortrait || (2 > modeHistory.length ? setMode(E_MODE.MIX) : setMode(modeHistory.pop()))
}

function setMode(a, b) {
  if (null != mixerWidget) {
    if (isPortrait) switch (a) {
      case E_MODE.MIX:
      case E_MODE.GAIN:
      case E_MODE.AUX:
      case E_MODE.FXSENDS:
      case E_MODE.MOREME:
        break;
      default:
        return
    }
    lastMode = mode;
    modeHistory.push(mode);
    mode = a;
    clearInterval(ticker);
    switch (a) {
      case E_MODE.MIX:
      case E_MODE.GAIN:
      case E_MODE.AUX:
      case E_MODE.FXSENDS:
      case E_MODE.MOREME:
        break;
      default:
        slideOutWidget.hide()
    }
    for (var c = 0; c < widgets.length; c++) widgets[c].hide();
    topWidget.show();
    masterWidget.show();
    bottomWidget.show();
    mixerWidget.mode !=
      E_MODE.MIX && mixerWidget.setMode(E_MODE.MIX);
    bottomWidget.upd();
    switch (a) {
      case E_MODE.MIX:
        mixerWidget.show();
        (settings.pinSlideOut || isDefined(b) && 2 != b) && slideOutWidget.show();
        break;
      case E_MODE.GAIN:
        bottomWidget.syncOffset();
        gainMixer.show();
        break;
      case E_MODE.EDIT:
        editStripWidget.show();
        editWidget.show();
        break;
      case E_MODE.AUX:
        (settings.pinSlideOutX || isDefined(b) && 2 != b) && slideOutWidget.show();
        auxoutWidget.show();
        auxWidget.show();
        break;
      case E_MODE.FXSENDS:
        (settings.pinSlideOutX || isDefined(b) && 2 != b) &&
        slideOutWidget.show();
        fxSendsWidget.show();
        fxoutWidget.show();
        break;
      case E_MODE.SETTINGS:
        bottomWidget.hide();
        settingsWidget.show();
        break;
      case E_MODE.MODALS:
        bottomWidget.hide();
        modalsWidget.show();
        break;
      case E_MODE.PLAYER:
        bottomWidget.hide();
        playerWidget.show();
        IS_UI_24 ? 0 == playerWidget.mode && (playerStrips.show(), playerLabels.show()) : (playerStrips.show(), playerLabels.show());
        break;
      case E_MODE.PONG:
        pongGame.show();
        break;
      case E_MODE.MOREME:
        slideOutWidget.hide(), bottomWidget.hide(), masterWidget.hide(),
          isDefined(b) && 2 == b && topWidget.hide(), auxoutWidget.show(), moremeWidget.show()
    }
    geomAll();
    drawAll("MODE(" + a + ")")
  }
}

function setSelected(a, b, c) {
  if (isDefined(a) && null != a) {
    var d = selectedStrip;
    c = c || !1;
    if (a > allStrips.length - 1 || -1 > a) return !1;
    if (-1 == a && -1 == selectedChannel && b) return setSelected(prevSelChannel);
    if (selectedChannel == a) return !1; - 1 != a && (prevSelChannel = a); - 1 == a ? (selectedChannel = -1, selectedStrip = masterWidget, selectedChID = masterWidget.name.slice(0, -1)) : (selectedChannel = a, selectedStrip = allStrips[a], selectedChID = selectedStrip.name.slice(0, -1));
    mode == E_MODE.EDIT && (editStripWidget.setStrip(), editWidget.upd(), regUpdate(editStripWidget));
    regUpdate(selectedStrip);
    regUpdate(d);
    regUpdate(bottomWidget);
    regUpdate(masterWidget);
    mode == E_MODE.PLAYER && regUpdate(playerLabels);
    mode == E_MODE.GAIN && (regUpdate(findByID(gainStrips, d.id)), regUpdate(findByID(gainStrips, selectedStrip.id)));
    mode == E_MODE.AUX && (regUpdate(findByID(auxSendStrips, d.id)), regUpdate(findByID(auxSendStrips, selectedStrip.id)), -1 == d.id || -1 == selectedStrip.id ? regUpdate(auxWidget) : (regUpdate(findByID(mtxSendStrips, d.id)), regUpdate(findByID(mtxSendStrips, selectedStrip.id))));
    mode ==
      E_MODE.FXSENDS && (b = fxSendsWidget.page.strips, regUpdate(findByID(b, d.id)), regUpdate(findByID(b, selectedStrip.id)));
    auxoutWidget.enabled && regUpdate(auxoutWidget);
    fxoutWidget.enabled && regUpdate(fxoutWidget);
    settings.sync && !c && sendMessage("BMSG^SYNC^" + settings.sync_id + "^" + a);
    return !0
  }
}

function findByID(a, b) {
  for (var c = 0; c < a.length; c++)
    if (a[c].id == b) return a[c];
  return null
}

function findStripByKey(a) {
  a.endsWith(".") || (a += ".");
  if (a.contains("m.")) return masterWidget;
  for (var b = 0; b < allStrips.length; b++)
    if (allStrips[b].name == a) return allStrips[b]
}

function sendTime() {
  var a = (new Date).getTimezoneOffset();
  sendMessage("USERTIME^" + Date.now() + "^" + a)
}

function toggleSlideOut() {
  mode != E_MODE.MIX && mode != E_MODE.GAIN && mode != E_MODE.AUX && mode != E_MODE.FXSENDS ? setMode(E_MODE.MIX, !0) : (slideOutWidget.enabled ? slideOutWidget.hide() : slideOutWidget.show(), geomAll(), drawAll("slideout " + slideOutWidget.enabled))
}

function initGradients() {
  color.grad1 = ctx.createLinearGradient(0, 0, 0, 7);
  color.grad1.addColorStop(0, "rgba(255,255,255,0.1)");
  color.grad1.addColorStop(1, "rgba(255,255,255,0)");
  color.grad2 = ctx.createLinearGradient(0, 7, 0, 0);
  color.grad2.addColorStop(0, "rgba(255,255,255,0.1)");
  color.grad2.addColorStop(1, "rgba(255,255,255,0)");
  color.grad3 = ctx.createLinearGradient(0, 0, 0, 5);
  color.grad3.addColorStop(0, "rgba(255,255,255,0.7)");
  color.grad3.addColorStop(.15, "rgba(255,255,255,0.2)");
  color.grad3.addColorStop(1, "rgba(255,255,255,0)");
  color.grad4 = ctx.createLinearGradient(0, 5, 0, 0);
  color.grad4.addColorStop(0, "rgba(255,255,255,0.7)");
  color.grad4.addColorStop(.2, "rgba(255,255,255,0.2)");
  color.grad4.addColorStop(1, "rgba(255,255,255,0)");
  color.grad5 = ctx.createLinearGradient(0, 0, 0, 20);
  color.grad5.addColorStop(0, "rgba(255,255,255,0.0)");
  color.grad5.addColorStop(1, "rgba(255,255,255,0.15)");
  color.grad6 = ctx.createLinearGradient(0, 0, 0, 20);
  color.grad6.addColorStop(0, "rgba(255,255,255,0.15)");
  color.grad6.addColorStop(.6, "rgba(255,255,255,0.0)");
  color.gradMBL = ctx.createLinearGradient(0, 0, 123, 0);
  color.gradMBL.addColorStop(0, "rgba(255,255,255,0)");
  color.gradMBL.addColorStop(.5, "rgba(255,255,255,0.2)");
  color.gradMBL.addColorStop(1, "rgba(255,255,255,0)");
  color.panGrad = ctx.createLinearGradient(0, 13, 0, 19);
  color.panGrad.addColorStop(0, "#00ffff");
  color.panGrad.addColorStop(1, "#0D6666");
  color.mPanGrad = ctx.createLinearGradient(0, 13, 0, 19);
  color.mPanGrad.addColorStop(0, "#ffff00");
  color.mPanGrad.addColorStop(1, "#666600");
  color.tvvuGrad = ctx.createLinearGradient(0,
    82, 0, 0);
  color.tvvuGrad.addColorStop(0, "green");
  color.tvvuGrad.addColorStop(.5, "yellow");
  color.tvvuGrad.addColorStop(1, "red");
  color.tvvuGrad2 = ctx.createLinearGradient(0, 82, 0, 0);
  color.tvvuGrad2.addColorStop(0, "#494");
  color.tvvuGrad2.addColorStop(.5, "#aa3");
  color.tvvuGrad2.addColorStop(1, "#d44");
  color.stripGrad = ctx.createLinearGradient(0, 0, measures.mixerStripWidth, 0);
  color.stripGrad.addColorStop(0, "rgba(255,255,255,0)");
  color.stripGrad.addColorStop(.5, "rgba(255,255,255,0.2)");
  color.stripGrad.addColorStop(1,
    "rgba(255,255,255,0)");
  color.grpeak = ctx.createLinearGradient(0, 6, 0, 0);
  color.grpeak.addColorStop(1, "#700");
  color.grpeak.addColorStop(.3, "#f00");
  color.grpeak.addColorStop(0, "#f00")
}
IMG_LOAD_0 = null;

function drawLoadingScreen() {
  var a = screenWidth,
    b = screenHeight;
  ctx.fillStyle = "#000000";
  ctx.fillRect(0, 0, a, b);
  a = isRetina ? "img2x/" : "img1x/";
  IMG_LOAD_0 = new Image;
  IMG_LOAD_0.onload = IL_LOADED;
  IMG_LOAD_0.src = a + "UI_SPLASH_D.png"
}

function IL_LOADED() {
  drawProgress(0);
  startLoadingTime = Date.now();
  CHK_START()
}
startLoadingTime = 0;

function CHK_START() {
  if (1 == startLoading) {
    var a = Date.now() - startLoadingTime;
    log("start delay: " + a + "ms");
    loadResources()
  } else 0 == startLoading ? (drawProgress(-1), checkConnection()) : drawProgress(0), setTimeout(CHK_START, 1E3)
}

function drawProgress(a) {
  var b = screenWidth,
    c = screenHeight,
    d = 560 > c ? .8 : 1,
    f = b / 2 | 0,
    e = (b - IMG_LOAD_0.w() * d) / 2 | 0,
    g = (c - IMG_LOAD_0.h() * d) / 2 | 0,
    g = g + 0;
  550 > c && (g -= 26);
  var h = g + 40 | 0,
    f = ctx.createRadialGradient(f, h, 0, f, h, 500);
  f.addColorStop(0, "#1C2A34");
  f.addColorStop(1, "#000");
  ctx.fillStyle = "#000";
  ctx.fillRect(0, 0, b, c);
  ctx.fillStyle = f;
  ctx.fillRect(0, 0, b, c);
  drawImageScale(IMG_LOAD_0, e, g, d);
  c = 1 + (b - 338) / 2 | 0;
  d = g + IMG_LOAD_0.h() * d - 10;
  0 > a ? (ctx.font = "bold 48pt open_sans_condensedbold", ctx.fillStyle = "#e33", ctx.textAlign =
    "center", ctx.fillText(lang.OFFLINE, b / 2 | 0, d + 28)) : (ctx.fillStyle = "#004040", ctx.shadowColor = "#004040", ctx.shadowBlur = 6, ctx.fillRect(c, d, 338, 5), ctx.shadowColor = "#00BFBF", ctx.shadowBlur = 20, ctx.shadowOffsetX = -1, ctx.fillStyle = "#00BFBF", ctx.fillRect(c, d, bound(Math.round(338 * a), 2, 338), 5), ctx.setShadow(null))
}

function updateCacheAll() {
  log("updateCacheAll()");
  allStrips.forEach(function(a) {
    a.UPDATE_CACHE()
  });
  auxSendStrips.forEach(function(a) {
    a.UPDATE_CACHE()
  });
  fxSendStrips.forEach(function(a) {
    a.UPDATE_CACHE()
  });
  auxWidget && auxWidget.page.strips[0].cachePaint();
  fxSendsWidget && fxSendsWidget.page.strips[0].cachePaint();
  slideOutWidget && slideOutWidget.cachePaint()
}
isPortrait = !1;

function onResize() {
  var a = screenWidth < screenHeight;
  log(screenWidth + "x" + screenHeight + "; guiReady: " + guiReady);
  a ? (isPortrait || onPortrait(), isPortrait = !0) : (a = isPortrait, isPortrait = !1, a && onLandscape());
  geomAll();
  updateCacheAll();
  drawAll("resize " + screenWidth + "x" + screenHeight)
}

function onLandscape() {
  log("onLandscape()");
  guiReady && (mode == E_MODE.MOREME || settings.moremeportrait) && modeBack()
}

function onPortrait() {
  log("onPortrait()");
  if (guiReady)
    if (settings.moremeportrait) setMode(E_MODE.MOREME, 2);
    else switch (mode) {
      case E_MODE.MIX:
      case E_MODE.GAIN:
      case E_MODE.AUX:
      case E_MODE.FXSENDS:
      case E_MODE.MOREME:
        break;
      default:
        setMode(E_MODE.MIX)
    }
}

function calcBPMfromArr(a) {
  if (2 > a.length) return -1;
  a = (a.last() - a[0]) / (a.length - 1);
  return Math.round(6E4 / a)
}

function getGlobalBpm() {
  for (var a = 0, b = 0, c = !1, d = fxStrips.length - 1; 0 < d; d--) {
    var f = fxStrips[d].getNameValue("bpm");
    1 == fxStrips[d].getNameValue("fxtype") && (a = f, 0 != b && b != f && (c = !0), b = f)
  }
  return "" + a + (c ? "*" : "")
}
BPM_TAP_ARRAY = [];

function bpmTapHandler(a) {
  isDefined(a) || (a = -1);
  var b = Date.now();
  if (0 == BPM_TAP_ARRAY.length) topWidget.led.setMsg(lang.KEEP_TAPPING), BPM_TAP_ARRAY.push(b);
  else if (BPM_TAP_ARRAY.length > TAP_TEMPO_AVG_FROM && BPM_TAP_ARRAY.shift(), b - BPM_TAP_ARRAY.last() > TAP_TEMPO_MAX_GAP) BPM_TAP_ARRAY.clear(), topWidget.led.setMsg(lang.KEEP_TAPPING), BPM_TAP_ARRAY.push(b);
  else if (BPM_TAP_ARRAY.push(b), !(3 > BPM_TAP_ARRAY.length || (b = calcBPMfromArr(BPM_TAP_ARRAY), 10 > b))) switch (topWidget.led.setMsg(b + " " + lang.BPM), a) {
    case -1:
      for (a =
        0; a < fxStrips.length; a++) fxStrips[a].setNameValue("bpm", b);
      break;
    case 0:
      fxStrips[0].setNameValue("bpm", b);
      break;
    case 1:
      fxStrips[1].setNameValue("bpm", b);
      break;
    case 2:
      fxStrips[2] && fxStrips[2].setNameValue("bpm", b);
      break;
    case 3:
      fxStrips[3] && fxStrips[3].setNameValue("bpm", b)
  }
}

function askBpm(a) {
  isDefined(a) || (a = -1);
  var b = [];
  switch (a) {
    case -1:
      for (a = 0; a < fxStrips.length; a++) b.push(fxStrips[a]);
      break;
    case 0:
      b.push(fxStrips[0]);
      break;
    case 1:
      b.push(fxStrips[1]);
      break;
    case 2:
      fxStrips[2] && b.push(fxStrips[2]);
      break;
    case 3:
      fxStrips[3] && b.push(fxStrips[3])
  }
  editOk.arr = b;
  editOk.valueFunc = function() {
    var a = editBox2.value;
    if (null != a && 0 != a.length && (a = parseInt(a), !isNaN(a)))
      if (20 > a || 400 < a) showPopupMsg(lang.OUT_OF_RANGE);
      else {
        for (var b = 0; b < this.arr.length; b++) this.arr[b].setNameValue("bpm",
          a);
        topWidget.led.setMsg(a + " " + lang.BPM);
        drawAll()
      }
  };
  b = b[0].getNameValue("bpm");
  showEditBox2(lang.ENTER_BPM, "" + b)
}

function prepareF1F2() {
  regUpdate(masterWidget)
}

function doFfunc(a) {
  if (EMULATE) showPopupMsg(lang.DEMO_VERSION);
  else switch (a) {
    case E_FFUNC.NEWSNAP:
      settingsWidget.setMode(2);
      setMode(E_MODE.SETTINGS);
      showsPage.bSNAPSAVE.click();
      break;
    case E_FFUNC.UPDCURSNAP:
      a = getValue("var.currentShow");
      var b = getValue("var.currentSnapshot");
      if (!a || !b) {
        showPopupMsg(lang.NO_CURRENT_SNAPSHOT, 1E3);
        break
      }
      confOk.valueFunc = function() {
        var a = getValue("var.currentShow"),
          b = getValue("var.currentSnapshot");
        a && b ? sendMessage(E_COMMANDS.SNAP_SAVE + "^" + a + "^" + b) : showPopupMsg(lang.NO_CURRENT_SNAPSHOT,
          1E3)
      };
      showConfBox(lang.UPDATE_CURRENT_SNAPSHOT);
      break;
    case E_FFUNC.PLAY:
      if (isBlocked("player")) {
        showPopupMsg(lang.LOCKED, 800);
        break
      }
      if (a = 2 == getValue("var.currentState")) player2track.STOP.onPress();
      else player2track.PLAY.onToggleUp();
      break;
    case E_FFUNC.REC:
      toggleRec();
      break;
    case E_FFUNC.MTK_REC:
      toggleMTKRec();
      break;
    case E_FFUNC.MTK_PLAY:
      if (isBlocked("player")) {
        showPopupMsg(lang.LOCKED, 800);
        break
      }
      if (a = 2 == getValue("var.mtk.currentState")) mtkPlay.STOP.onPress();
      else mtkPlay.PLAY.onToggleUp();
      break;
    case E_FFUNC.NEXT_SNAP:
      a =
        getValue("var.currentShow");
      b = getValue("var.currentSnapshot");
      b = CURRENT_SNAPS_LIST.indexOf(b);
      (b = CURRENT_SNAPS_LIST[b + 1] || CURRENT_SNAPS_LIST[0]) && sendMessage(E_COMMANDS.SNAP_LOAD + "^" + a + "^" + b);
      break;
    case E_FFUNC.PREV_SNAP:
      a = getValue("var.currentShow");
      b = getValue("var.currentSnapshot");
      b = CURRENT_SNAPS_LIST.indexOf(b);
      (b = CURRENT_SNAPS_LIST[b - 1] || CURRENT_SNAPS_LIST.last()) && sendMessage(E_COMMANDS.SNAP_LOAD + "^" + a + "^" + b);
      break;
    case E_FFUNC.SWAP_USB:
      sendMessage("SWAPUSB");
      break;
    case E_FFUNC.MUTE_ALL:
      isMuteAll() ?
        mixerWidget.cancelMuteAll() : mixerWidget.muteAll();
      break;
    case E_FFUNC.DIM:
      a = getValue("m.dim"), setValue("m.dim", a ? 0 : 1)
  }
}
var CURRENT_SNAPS_LIST = [];

function toggleRec() {
  isBlocked("player") ? showPopupMsg(lang.LOCKED, 800) : (getValue("var.isRecording"), .5 <= getValue("var.recBusy") || (sendMessage(E_COMMANDS.TOGGLE_REC), regUpdate(player2track), regUpdate(masterWidget)))
}

function toggleMTKRec() {
  isBlocked("player") ? showPopupMsg(lang.LOCKED, 800) : .5 <= getValue("var.mtk.rec.busy") || (getValue("var.mtk.rec.currentState"), sendMessage(E_COMMANDS.TOGGLE_MTK_REC), regUpdate(mtkRec), regUpdate(masterWidget))
}
ignoreClearModal = !1;

function handleKey(a, b, c) {
  if (guiReady && "block" != editBox.style.display && "block" != editContainer.style.display) {
    switch (b) {
      case E_KEYS.escape:
        mixerWidget.showAll();
        break;
      case E_KEYS.backspace:
      case E_KEYS.tab:
        c.preventDefault()
    }
    switch (b) {
      case E_KEYS.backspace:
        setMode(lastMode);
        break;
      case E_KEYS.tab:
        switch (mode) {
          case E_MODE.MIX:
            slideOutWidget.enabled && "SlideOut2" == slideOutWidget.widgetName && slideOutWidget.nextMode();
            break;
          case E_MODE.EDIT:
            editWidget.nextMode();
            break;
          case E_MODE.AUX:
            auxWidget.nextMode();
            break;
          case E_MODE.FXSENDS:
            fxSendsWidget.nextMode();
            break;
          case E_MODE.SETTINGS:
            settingsWidget.nextMode();
            break;
          case E_MODE.MODALS:
            modalsWidget.nextMode();
            break;
          case E_MODE.PLAYER:
            IS_UI_24 && playerWidget.nextMode()
        }
        break;
      case E_KEYS.down_arrow:
        mixerWidget.enabled && mixerWidget.goLeft();
        break;
      case E_KEYS.up_arrow:
        mixerWidget.enabled && mixerWidget.goRight();
        break;
      case E_KEYS.left_arrow:
        switch (mode) {
          case E_MODE.MIX:
          case E_MODE.GAIN:
          case E_MODE.EDIT:
          case E_MODE.AUX:
          case E_MODE.FXSENDS:
            break;
          default:
            return
        }
        selectPrevChannel();
        break;
      case E_KEYS.right_arrow:
        switch (mode) {
          case E_MODE.MIX:
          case E_MODE.GAIN:
          case E_MODE.EDIT:
          case E_MODE.AUX:
          case E_MODE.FXSENDS:
            break;
          default:
            return
        }
        selectNextChannel()
    }
    switch (a) {
      case "1":
        topWidget.bTOTAL.click();
        break;
      case "2":
        topWidget.bMix.click();
        break;
      case "3":
        topWidget.bEDIT.click();
        break;
      case "4":
        topWidget.bAUX.click();
        break;
      case "5":
        topWidget.bFX.click();
        break;
      case "6":
        topWidget.bPlayer.click();
        break;
      case "7":
        topWidget.bSet.click();
        break;
      case "8":
      case " ":
        topWidget.bLogo.click();
        break;
      case "Q":
        slideOutWidget.inp.click();
        break;
      case "W":
        slideOutWidget.fx.click();
        break;
      case "E":
        slideOutWidget.sub.click();
        break;
      case "R":
        slideOutWidget.aux.click();
        break;
      case "T":
        IS_UI_24 && slideOutWidget.vca.click();
        break;
      case "D":
        DEPLOY || (dbgWidgets = !dbgWidgets, drawAll());
        break;
      case "P":
        mode == E_MODE.EDIT && (null != currentPresetWindow ? currentPresetWindow.close() : editWidget.showPresets());
        if (mode == E_MODE.MIX) {
          switch (selectedStrip.type) {
            case E_STRIP_TYPE.MASTER:
            case E_STRIP_TYPE.VCA:
              return
          }
          mWidgets.length ? "PRESET_MENU" == mWidgets[0].widgetName &&
            clearModals() : (clearModals(), mixerWidget.showPresets())
        }
        return;
      case "F":
      case "n":
        toggleMuteFX();
        break;
      case "A":
      case "`":
        toggleMuteAll();
        break;
      case "M":
        switch (mode) {
          case E_MODE.MIX:
          case E_MODE.EDIT:
            selectedStrip.mute && selectedStrip.mute.click();
            break;
          case E_MODE.AUX:
            a = null;
            (a = 1 == auxStrips[auxWidget.mode].getNameValue("matrix") ? findByID(mtxSendStrips, selectedStrip.id) : findByID(auxSendStrips, selectedStrip.id)) && a.mute && a.mute.click();
            break;
          case E_MODE.FXSENDS:
            (a = findByID(fxSendStrips, selectedStrip.id)) &&
            a.mute && a.mute.click();
            break;
          default:
            return
        }
        break;
      case "S":
        switch (mode) {
          case E_MODE.MIX:
          case E_MODE.EDIT:
            break;
          default:
            return
        }
        selectedStrip.solo && (selectedStrip.solo.click(), mode == E_MODE.MODALS && regUpdate(tvWidget));
        break;
      case "C":
        if (mWidgets.length) "SUBMENU" == mWidgets[0].widgetName && clearModals();
        else if (bottomWidget.enabled && -1 != bottomWidget.IDS.indexOf(selectedChannel)) bottomWidget.onHold(!0);
        return;
      case "a":
        muteGroupToggle(0);
        break;
      case "b":
        muteGroupToggle(1);
        break;
      case "c":
        muteGroupToggle(2);
        break;
      case "d":
        muteGroupToggle(3);
        break;
      case "e":
        muteGroupToggle(4);
        break;
      case "f":
        muteGroupToggle(5);
        break;
      case "Z":
        masterWidget.f1c.enabled && masterWidget.f1c.click();
        break;
      case "X":
        masterWidget.f2c.enabled && masterWidget.f2c.click();
        break;
      case "q":
        switch (mode) {
          case E_MODE.MIX:
          case E_MODE.GAIN:
          case E_MODE.EDIT:
          case E_MODE.AUX:
          case E_MODE.FXSENDS:
            break;
          default:
            return
        }
        var d = selectedStrip;
        if (null == d || d.type == E_STRIP_TYPE.MASTER) return;
        editOk.valueFunc = function() {
          var a = editBox2.value;
          null != a && 0 != a.length &&
            (a = a.toUpperCase(), d.setName(a), regUpdate(bottomWidget), regUpdate(editStripWidget), regUpdate(playerStrips), regUpdate(editWidget))
        };
        showEditBox2(lang.RENAME_CHANNEL.format(d.text), d.getName())
    }!ignoreClearModal && mWidgets.length && clearModals();
    ignoreClearModal = !1
  }
}

function toggleMuteAll() {
  checkBit(getValue("mgmask"), MUTEALL_BIT_IDX) ? mixerWidget.cancelMuteAll() : mixerWidget.muteAll();
  regUpdate(slideOutWidget);
  regUpdate(playerWidget)
}

function toggleMuteFX() {
  checkBit(getValue("mgmask"), MUTEFX_BIT_IDX) ? mixerWidget.unMuteFX() : mixerWidget.muteFX();
  regUpdate(slideOutWidget);
  regUpdate(playerWidget)
}

function selectNextChannel() {
  var a = -1,
    b = allStrips;
  if (0 <= activeViewGroup && 10 > activeViewGroup && inView) a = inView.indexOf(selectedChannel), a = inView.length - 1 == a ? -1 : a + 1, a = -1 == a ? -1 : inView[a], setSelected(a), bottomWidget.gotoID2(a);
  else {
    for (var c = selectedChannel + 1; c < b.length; c++) {
      var d = b[c];
      if (-1 != bottomWidget.IDS.indexOf(d.id)) {
        a = d.id;
        setSelected(a);
        bottomWidget.gotoID2(a);
        return
      }
    } - 1 == a && (mode == E_MODE.AUX || mode == E_MODE.FXSENDS ? (setSelected(0), bottomWidget.gotoID2(0)) : setSelected(-1))
  }
}

function selectPrevChannel() {
  var a = -1,
    b = allStrips;
  if (0 <= activeViewGroup && 10 > activeViewGroup && inView) a = inView.indexOf(selectedChannel), a = 0 == a ? -1 : -1 == a ? inView.length - 1 : a - 1, a = -1 == a ? -1 : inView[a], setSelected(a), bottomWidget.gotoID2(a);
  else if (-1 == selectedChannel) {
    for (var c = b.length - 1; 0 <= c; c--) {
      var d = b[c];
      if (-1 != bottomWidget.IDS.indexOf(d.id)) {
        a = d.id;
        break
      }
    }
    setSelected(a); - 1 != selectedChannel && bottomWidget.gotoID3(a)
  } else {
    for (c = selectedChannel - 1; 0 <= c; c--)
      if (d = b[c], -1 != bottomWidget.IDS.indexOf(d.id)) {
        a = d.id;
        setSelected(a);
        bottomWidget.gotoID3(a);
        break
      } - 1 == a && (mode == E_MODE.AUX || mode == E_MODE.FXSENDS ? (a = bottomWidget.IDS.last(), setSelected(a), bottomWidget.gotoID3(a)) : setSelected(-1))
  }
}
wsock = null;
netConnectCache = netConnectState = wsockFailures = 0;
netConnectTimer = null;
netwFrameCounter = 0;
noConnectMessage = null;

function networkTick() {
  if (null == wsock) {
    var a = document.URL.replace("http:", "ws:"),
      a = a.replace("/phone.html", ""),
      a = a.replace("/mixer.html", "");
    log(a);
    noConnectMessage = $("noConnectMessage");
    wsock = io.connect(a, {
      "reconnection limit": 3E3,
      "max reconnection attempts": Infinity
    });
    wsock.on("connect", function() {
      wsockFailures = 0;
      sendTimeNetwork();
      sendMessage("SERIAL")
    });
    wsock.on("disconnect", function() {
      wsockFailures++
    });
    wsock.on("reconnect_failed", function() {
      log("reconnect failed");
      wsockFailures++;
      wsock.disconnect();
      wsock.socket.reconnect()
    });
    wsock.on("error", function(a) {
      log("Socket.io ERROR: " + a.message);
      wsockFailures++;
      wsock.disconnect();
      wsock.socket.reconnect()
    });
    wsock.on("message", receiveMessage)
  }
  netwFrameCounter & 7 || (netConnectState = isSocketConnected(), netConnectCache !== netConnectState && (netConnectState ? (conMessageHide(), clearTimeout(netConnectTimer), onNetConnect()) : (netConnectTimer = setTimeout(function() {
    conMessageShow()
  }, 2E3), onNetDisconnect()), netConnectCache = netConnectState));
  netwFrameCounter++;
  15E3 <=
    netwFrameCounter && (netwFrameCounter = 0)
}

function isSocketConnected() {
  return null != wsock && wsock.socket.connected
}

function sendMessage(a) {
  dbgNetwork && log(a);
  return null != wsock && wsock.socket.connected ? (wsock.send(a), !0) : !1
}

function onNetConnect() {
  log("#onNetConnect");
  topWidget && regUpdate(topWidget)
}

function onNetDisconnect() {
  log("#onNetDisconnect");
  topWidget && regUpdate(topWidget)
}

function conMessageShow() {
  log("#conMessageShow");
  "visible" != noConnectMessage.style.visibility && (noConnectMessage.style.visibility = "visible")
}

function conMessageHide() {
  log("#conMessageHide");
  "hidden" != noConnectMessage.style.visibility && (noConnectMessage.style.visibility = "hidden")
}

function iosys(a) {
  sendMessage("IOSYS^" + a)
}

function sendTimeNetwork() {
  var a = (new Date).getTimezoneOffset();
  sendMessage("USERTIME^" + Date.now() + "^" + a)
}
initSent = !1;
msgCount2 = msgCount = 0;

function receiveMessage2(a) {
  msgCount2++;
  try {
    if (null != a)
      if (a.startsWith("SETD^")) {
        var b = a.split("^", 3);
        3 > b.length || putValue(b[1], parseFloat(b[2]))
      } else a.startsWith("SETS^") ? (b = a.split("^", 3), 3 > b.length || putValue(b[1], b[2])) : parseCommand(a)
  } catch (c) {
    showPopupMsg(c.message), log(c.stack), initSent || sendMessage("INIT"), initSent = !0
  }
}

function receiveMessage(a) {
  msgCount++;
  if (a.contains("\n")) {
    a = a.split("\n");
    for (var b = 0; b < a.length; b++) receiveMessage2(a[b])
  } else receiveMessage2(a)
}
networkPollTick = networkTick;

function VtoPAN(a) {
  return 200 * a - 100 | 0
}

function PANtoV(a) {
  return bound((a + 100) / 200, 0, 1)
}

function VtoLIN(a) {
  return 2.676529517952372E-4 * Math.exp(a * (23.90844819639692 + a * (-26.23877598214595 + (12.195249692570245 - .4878099877028098 * a) * a))) * (.055 > a ? Math.sin(28.559933214452666 * a) : 1)
}
zeroDbPos = .7647058823529421;
SOUND_SPEED = 331.3 + .606 * 22;
SAMPLE_RATE = 44100;
ONE_FOOT_IN_METERS = .3048;

function VtoDB(a) {
  var b = VtoLIN(a);
  .001 > a ? a = "- @ " : (b = (20 * Math.log(b) / Math.log(10) * 10 + .45 | 0) / 10, -20 >= b ? b = "" + (b | 0) : -1 == ("" + b).indexOf(".") && (b += ".0"), a = b + " dB", -120 > b && (this.text = "- @ "));
  return a
}

function VtoDB2(a) {
  var b = VtoLIN(a);
  .001 > a ? a = "-inf" : (b = (20 * Math.log(b) / Math.log(10) * 10 + .45 | 0) / 10, -20 >= b ? b = "" + (b | 0) : -1 == ("" + b).indexOf(".") && (b += ".0"), a = b, -120 > b && (this.text = "-inf"));
  return a
}

function VtoDBf(a) {
  a = VtoLIN(a);
  return 1E-10 > a ? -200 : 20 * Math.log(a) / Math.log(10)
}

function VtoDBf3(a) {
  a = VtoLIN(a);
  return (20 * Math.log(a) / Math.log(10) * 10 + .45 | 0) / 10
}

function DBtoVf2(a) {
  return findV(VtoDBf3, a)
}

function DBtoVf(a) {
  if (-200 >= a) return 0;
  if (10 <= a) return 1;
  a = Math.pow(10, a / 20);
  for (var b = 0, c = 1, d = 0; 128 > d; d++) {
    var f = .5 * (b + c),
      e = VtoLIN(f);
    if (1E-10 > Math.abs(e - a)) return f;
    e > a ? c = f : b = f
  }
  return .5 * (b + c)
}

function findV(a, b) {
  for (var c = 0, d = 1, f = 0; 128 > f; f++) {
    var e = .5 * (c + d),
      g = a(e);
    if (1E-10 > Math.abs(g - b)) return e;
    g > b ? d = e : c = e
  }
  return .5 * (c + d)
}

function VtoGAINP(a) {
  return 90 * a - 40
}

function GAINPtoV(a) {
  return bound((a + 40) / 90, 0, 1)
}
ui24pgains = [-5, -5, -3, -3, -1, -1, 1, 1, 3, 3, 5, 5, 7, 7, 9, 9, 11, 11, 13, 13, 15, 15, 17, 17, 19, 19, 21, 21, 23, 23, 25, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58];

function VtoGAIN24(a) {
  a = parseInt(64 * a);
  0 > a && (a = 0);
  63 < a && (a = 63);
  return ui24pgains[a] - 1
}

function GAIN24toV(a) {
  return bound((a + 6) / 63, 0, 1)
}

function VtoLATENCY(a) {
  return 0 == a ? "0" + lang.MS : a <= 47 / SAMPLE_RATE ? Math.round(SAMPLE_RATE * a) + lang.SMPL : precision(1E3 * a, 1) + lang.MS
}

function askForDelay(a, b, c, d) {
  c = c || "delay";
  editOk.valueFunc = function() {
    $("DELAY_TIME").hide();
    var d = $$("input[type=radio]:checked")[0].value,
      f = parseFloat(editBox2.value);
    if (isNaN(f) && "fps" != d) showPopupMsg(lang.WRONG_VALUE);
    else {
      switch (d) {
        case lang.MS:
          f /= 1E3;
          break;
        case "smpl":
          f = (f | 0) / SAMPLE_RATE;
          break;
        case "meters":
          f = m2ms(f) / 1E3;
          break;
        case "ft":
          f = m2ms(f * ONE_FOOT_IN_METERS) / 1E3;
          break;
        case "fps":
          f = editBox2.value || "";
          f = f.replace("\\", "/");
          if (20 < f.length || !f.contains("/")) {
            showPopupMsg(lang.SYNTAX_FPS_ENTER);
            return
          }
          f = eval(f);
          if (!isDefined(f) || isNaN(f)) {
            showPopupMsg(lang.SYNTAX_FPS_ENTER);
            return
          }
      }
      if (f > b) {
        var h = b,
          l = "";
        switch (d) {
          case "fps":
          case "ms":
            h = precision(1E3 * h, 2);
            l = h + lang.MS;
            break;
          case "smpl":
            h = Math.round(h * SAMPLE_RATE);
            l = h + lang.SMPL;
            break;
          case "meters":
            h = s2m(h);
            h = precision(h, 2);
            l = h + lang.METERS;
            break;
          case "ft":
            h = s2m(h) / ONE_FOOT_IN_METERS, h = precision(h, 2), l = h + lang.FT
        }
        showPopupMsg(lang.EXCEEDS_MAXIMUM_DELAY + " (" + l + ")")
      }
      f = bound(f, 0, b);
      a.setNameValue(c, f);
      regUpdate(a)
    }
  };
  var f = a.getNameValue(c);
  switch ($$("input[type=radio]:checked")[0].value) {
    case "ms":
      f =
        precision(1E3 * f, 2);
      break;
    case "smpl":
      f = Math.round(f * SAMPLE_RATE);
      break;
    case "meters":
      f = s2m(f);
      f = precision(f, 2);
      break;
    case "ft":
      f = s2m(f) / ONE_FOOT_IN_METERS;
      f = precision(f, 2);
      break;
    case "fps":
      f = ""
  }
  showEditBox2(d, "" + f);
  $("DELAY_TIME").show()
}
cachedStripLinein = cachedStripGain2 = cachedStripGain = cachedStripAux = cachedStrip = null;
cachedStripGain2H = cachedStripGainH = cachedStripH = -1;
cachedMStripH = cachedMStrip = null;
settingsBuffer = {};
settingsBufferType = -1;

function blockGainBySrc(a) {
  log("blockGainBySrc: " + a);
  if (HAVE_ROUTING && a && a.startsWith("hw.")) {
    var b = getValue(a + ".phantom") ? 4E3 : 17E3;
    log(a + " " + b);
    for (var c = 0, d = gainStrips.length; c < d; c++)
      if (gainStrips[c].getNameValue("src") == a) {
        var f = gainStrips[c];
        f.slGain.disabled = !0;
        f.blocked_gain = !0;
        regUpdate(f);
        clearTimeout(f.btimer);
        f.btimer = setTimeout(function() {
          this.blocked_gain = this.slGain.disabled = !1;
          regUpdate(this)
        }.bind(f), b)
      }
    c = 0;
    for (d = gainStrips2.length; c < d; c++) gainStrips2[c].name == a + "." && (f = gainStrips2[c],
      f.slGain.disabled = !0, f.blocked_gain = !0, regUpdate(f), clearTimeout(f.btimer), f.btimer = setTimeout(function() {
        this.blocked_gain = this.slGain.disabled = !1;
        regUpdate(this)
      }.bind(f), b))
  }
}

function blockStrip(a, b) {
  var c = inStrips[a],
    d = gainStrips[a],
    f = gainStrips2[a];
  c && (c.blocked_gain = !0, regUpdate(c), d && (d.slGain.disabled = !0, d.blocked_gain = !0, regUpdate(d)), f && (f.slGain.disabled = !0, f.blocked_gain = !0, regUpdate(f)), clearTimeout(c.btimer), c.btimer = setTimeout(function() {
    c.blocked_gain = !1;
    regUpdate(c);
    d && (d.slGain.disabled = !1, d.blocked_gain = !1, regUpdate(d));
    f && (f.slGain.disabled = !1, f.blocked_gain = !1, regUpdate(f))
  }, b || 3E3))
}

function ms2m(a) {
  return a / 1E3 * SOUND_SPEED
}

function s2m(a) {
  return a * SOUND_SPEED
}

function m2ms(a) {
  return a / SOUND_SPEED * 1E3
}

function m2s(a) {
  return a / SOUND_SPEED
}
var MAX_DELAY_INPUT = .25,
  MAX_DELAY_OUTPUT = .5,
  Strip = Class.create(Widget, {
    initialize: function($super, b, c, d, f) {
      $super(b);
      this.CACHED_DRAWING = CACHE_TECHNOLOGIES;
      this.widgetName = "Strip";
      this.id = c;
      this.subId = f;
      this.type = d;
      this.name = "zz.xx";
      this.w = measures.mixerStripWidth;
      this.text = "CH 0";
      this.mode = E_STRIP_MODE.MIX;
      this.color = "#FFFFFF";
      this.subGroup = -1;
      this.stereo = !1;
      this.defaultSRC = "";
      this.haveVCA = !1;
      switch (this.type) {
        case E_STRIP_TYPE.IN:
          this.name = "i." + f + ".";
          this.defaultSRC = "hw." + f;
          this.color = color.INPUT;
          this.haveVCA = IS_UI_24;
          break;
        case E_STRIP_TYPE.FX:
          this.name = "f." + f + ".";
          this.stereo = !0;
          this.color = color.blue;
          this.haveVCA = IS_UI_24;
          break;
        case E_STRIP_TYPE.SUB:
          this.name = "s." + f + ".";
          this.stereo = !0;
          this.color = color.sub;
          break;
        case E_STRIP_TYPE.AUX:
          this.name = "a." + f + ".";
          this.color = color.AUX;
          break;
        case E_STRIP_TYPE.MEDIA:
          this.name = "p." + f + ".";
          this.color = color.media;
          this.haveVCA = IS_UI_24;
          break;
        case E_STRIP_TYPE.LINEIN:
          this.name = "l." + f + ".";
          this.defaultSRC = "li." + f;
          this.color = color.LINEIN;
          this.haveVCA = IS_UI_24;
          break;
        case E_STRIP_TYPE.VCA:
          this.name = "v." + f + ".", this.color = color.green
      }
      this.gainName = this.name;
      this.widgetName += "(" + this.name + ")";
      this.AUXS = [];
      this.FXS = [];
      this.MTX = null;
      this.linked = this.isClipping = !1;
      this.linkTarget = null;
      this.firstInGroup = this.lastInGroup2 = this.lastInGroup = !1;
      this.cacheGain = this.cache = null;
      this.cacheH = 0;
      this.gtimer = null;
      this.blocked_gain = !1;
      this.btimer = null;
      this.initWidgets()
    },
    updGain: function() {},
    getMuteState: function(a, b) {
      a = a || !1;
      var c = b ? !1 : this.getNameValue("mute"),
        d = getValue("mgmask"),
        f = this.getNameValue("mgmask"),
        f = d & f,
        e = checkBit(d, MUTEALL_BIT_IDX),
        d = this.type == E_STRIP_TYPE.FX && checkBit(d, MUTEFX_BIT_IDX),
        g = !1;
      if (IS_UI_24 && this.haveVCA) {
        var h = this.getNameValue("vca");
        vcaStrips[h] && (g = vcaStrips[h].getMuteState())
      }
      if (f || e || d || g) c = 1;
      f = this.getNameValue("forceunmute");
      !a && f && (c = 0);
      return c
    },
    initWidgets: function() {
      var a = this;
      if (this.type == E_STRIP_TYPE.VCA) this.led = new LED(this), this.led.setPos(6, 4), this.led.setSize(100, 38), this.led.onInput = function(b) {
          b = parseFloat(b);
          a.sl.setValue(DBtoVf2(b))
        },
        this.led.onDouble = function() {
          mode == E_MODE.MIX && a.sl.setValue(zeroDbPos)
        }, this.mute = new CheckBox(this), this.mute.setPos(4, 88), this.mute.setImages(res.bMuteOff, res.bMuteOn, res.bMuteOff_F), this.mute.getState = function() {
          this.state = a.getNameValue("mute");
          var b = getValue("mgmask"),
            c = a.getNameValue("mgmask"),
            c = b & c,
            b = checkBit(b, MUTEALL_BIT_IDX);
          if (c || b) this.state = 1;
          1 == a.getNameValue("forceunmute") ? (this.state = 0, this.img0 = res.bMuteOff_F) : this.img0 = res.bMuteOff;
          return this.state
        }, this.mute.onToggle = function() {
          handle_mgmask(!1)
        },
        this.mute.onToggleUp = function() {
          var b = getValue("mgmask"),
            c = a.getNameValue("mgmask"),
            c = b & c,
            b = checkBit(b, MUTEALL_BIT_IDX);
          c || b || a.setNameValue("mute", 1);
          a.setNameValue("forceunmute", 0)
        }, this.mute.onToggleDown = function() {
          var b = getValue("mgmask"),
            c = a.getNameValue("mgmask"),
            c = b & c,
            b = checkBit(b, MUTEALL_BIT_IDX);
          c || b ? a.setNameValue("forceunmute", 1) : a.setNameValue("mute", 0)
        }, this.spread = new CheckBox(this), this.spread.setAnchors(4, null, null, 30), this.spread.setImages(res.FFUNC_OFF, res.FFUNC_GRE), this.spread.redrawParent = !0, this.spread.idx = this.subId, this.spread.font = "14px open_sans_condensedbold", this.spread.textColor = color.black2, this.spread.textColorActive = color.black2, this.spread.disabledHide = !0, this.spread.textParam = {
          font: "14px open_sans_condensedbold",
          x: null,
          y: null,
          offsetX: 1,
          offsetY: -3,
          pressOffsetX: 0,
          pressOffsetY: 1,
          align: "center",
          valign: "middle",
          shadow: ["#ccc", 0, 1, 1],
          dy: 12
        }, this.spread.getState = function() {
          this.text = (this.state = activeViewGroup == 300 + this.idx ? 1 : 0) ? lang.CLOSE : lang.SPILL;
          this.disabled = !0;
          for (var a =
              0, c = allStrips.length; a < c; a++)
            if (allStrips[a].haveVCA && allStrips[a].getNameValue("vca") === this.idx) {
              this.disabled = !1;
              break
            }
        }, this.spread.onToggleUp = function() {
          mixerWidget.showVCA(this.idx);
          this.state = activeViewGroup == 300 + this.idx ? 1 : 0
        }, this.spread.onToggleDown = function() {
          resumeLastActiveVG();
          this.state = activeViewGroup == 300 + this.idx ? 1 : 0
        }, this.sl = new Slider(this, this.type), this.sl.setPos(0, 134), this.sl.setKey(this.name + "mix"), this.sl.color = this.color, this.sl.w = this.w, this.sl.laneOffset = 36, this.sl.faderX =
        60, this.sl.bottomMargin = 24, this.sl.lane = !0;
      else {
        this.led = new LED(this);
        this.led.setPos(6, 4);
        this.led.setSize(100, 38);
        this.type == E_STRIP_TYPE.IN && IS_UI_24 && (this.led.getState = function() {
          var b = a.getNameValue("vca"),
            c = mode != E_MODE.GAIN;
          this.color = 0 <= b && 7 > b && c ? color.ledTextVCA : color.ledText
        });
        this.led.onInput = function(b) {
          b = parseFloat(b);
          isNaN(b) ? showPopupMsg(lang.WRONG_VALUE) : mode == E_MODE.GAIN ? a.slGain.setValue(GAINPtoV(b)) : a.sl.setValue(DBtoVf2(b))
        };
        this.led.onDouble = function() {
          mode != E_MODE.GAIN && a.sl.setValue(zeroDbPos)
        };
        this.type != E_STRIP_TYPE.AUX ? (this.pan = new PanSlider(this), this.pan.key = this.name + "pan", this.pan.setPos(5, 46), this.pan.setSize(102, 30)) : HAVE_LATENCY && (this.delay = new TButton(this), this.delay.setPos(58, 46), this.delay.setImages(res.cl_s_btn_off, res.cl_s_btn_on), this.delay.redrawParent = !0, this.delay.opaque = !1, this.delay.setKey(this.name + "delay"), this.delay.getState = function() {
          this.text = VtoLATENCY(a.getNameValue("delay"))
        }, this.delay.onPress = function() {
          askForDelay(a, MAX_DELAY_OUTPUT, "delay", a.getName() +
            " " + lang.OUTPUT_DELAY)
        });
        this.mute = new CheckBox(this);
        this.mute.setPos(4, 88);
        this.mute.setImages(res.bMuteOff, res.bMuteOn, res.bMuteOff_F);
        this.mute.getState = function() {
          this.state = a.getMuteState();
          this.img0 = a.getNameValue("forceunmute") ? res.bMuteOff_F : res.bMuteOff;
          return this.state
        };
        this.mute.onToggle = function() {
          checkMutes();
          isDefined(this.parent.id) && selectedChannel != this.parent.id && setSelected(this.parent.id)
        };
        this.mute.onToggleUp = function() {
          var b = getValue("mgmask"),
            c = a.getNameValue("mgmask"),
            c =
            b & c,
            d = checkBit(b, MUTEALL_BIT_IDX),
            b = checkBit(b, MUTEFX_BIT_IDX) && a.type == E_STRIP_TYPE.FX,
            f = !1;
          if (IS_UI_24 && this.haveVCA) {
            var e = a.getNameValue("vca");
            vcaStrips[e] && (f = vcaStrips[e].getMuteState())
          }
          c || d || b || f || a.setNameValue("mute", 1);
          a.setNameValue("forceunmute", 0)
        };
        this.mute.onToggleDown = function() {
          a.getMuteState(!0, !0) ? a.setNameValue("forceunmute", 1) : a.setNameValue("mute", 0)
        };
        this.solo = new CheckBox(this);
        this.solo.setPos(58, 88);
        this.solo.setImages(res.bSoloOff, res.bSoloOn);
        this.solo.getState = function() {
          this.state =
            a.getNameValue("solo")
        };
        this.solo.onToggle = function() {
          checkSolos();
          isDefined(this.parent.id) && selectedChannel != this.parent.id && setSelected(this.parent.id)
        };
        this.solo.onToggleUp = function() {
          if (0 == getValue("settings.multiplesolo"))
            for (var b = 0; b < allStrips.length; b++) allStrips[b].type != E_STRIP_TYPE.VCA && allStrips[b].setNameValue("solo", 0);
          a.setNameValue("solo", 1)
        };
        this.solo.onToggleDown = function() {
          a.setNameValue("solo", 0)
        };
        this.sl = new Slider(this, this.type);
        this.sl.setPos(0, 134);
        this.sl.color = this.color;
        this.sl.param = "mix";
        this.sl.key = this.name + "mix";
        this.sl.w = this.w;
        this.sl.laneOffset = 36;
        this.sl.faderX = 60;
        this.sl.bottomMargin = 24;
        this.sl.lane = this.type != E_STRIP_TYPE.IN;
        this.type == E_STRIP_TYPE.AUX && (this.sl.getState = function() {
          var b = 1 == a.getNameValue("matrix");
          this.fader = b ? res.mtxFader : res.auxFader;
          this.color = b ? color.MATRIX : a.color
        });
        switch (this.type) {
          case E_STRIP_TYPE.AUX:
            this.sl.onDoubleKnob = function() {
              editWidget.setMode(editWidget.arr[0]);
              setMode(E_MODE.EDIT)
            };
            this.sl.onDouble = function() {
              auxWidget.setMode(a.subId);
              setMode(E_MODE.AUX)
            };
            break;
          case E_STRIP_TYPE.FX:
            this.sl.onDoubleKnob = function() {
              editWidget.setMode(editWidget.arr[0]);
              setMode(E_MODE.EDIT)
            };
            this.sl.onDouble = function() {
              fxSendsWidget.setMode(a.subId);
              setMode(E_MODE.FXSENDS)
            };
            break;
          case E_STRIP_TYPE.MEDIA:
            this.sl.onDoubleKnob = function() {
              editWidget.setMode(editWidget.arr[0]);
              setMode(E_MODE.EDIT)
            };
            this.sl.onDouble = function() {
              mode == E_MODE.PLAYER ? setMode(E_MODE.MIX) : setMode(E_MODE.PLAYER)
            };
            break;
          default:
            this.sl.onDoubleKnob = function() {
              editWidget.setMode(editWidget.arr[0]);
              setMode(E_MODE.EDIT)
            }, this.sl.onDouble = function() {
              modalsWidget.setMode(0);
              setMode(E_MODE.MODALS)
            }
        }
        this.stereo ? (this.vu = new VUMeter(this), this.vu.setAnchors(15, 149, null, settings.disableVUs2 ? 25 : 101), this.clip = new ClipBulb(this), this.clip.setPos(9, 127), settings.disableVUs2 || (this.gi = new GATEind(this), this.gi.x = 15, this.gr = new GRMeter(this), this.gr.x = 15, this.gi2 = new GATEind(this), this.gi2.x = 32, this.gr2 = new GRMeter(this), this.gr2.x = 32), this.vu2 = new VUMeter(this), this.vu2.setAnchors(32, 149, null, settings.disableVUs2 ?
          25 : 101), this.clip2 = new ClipBulb(this), this.clip2.setPos(26, 127), this.tvvu2 = this.tvvu = null) : (this.vu = new VUMeter(this), this.vu.setAnchors(21, 149, null, settings.disableVUs2 ? 25 : 101), this.clip = new ClipBulb(this), this.clip.setPos(15, 127), settings.disableVUs2 || (this.gi = new GATEind(this), this.gi.x = 21, this.gr = new GRMeter(this), this.gr.x = 21), this.tvvu = null)
      }
    },
    setMode: function(a) {
      this.mode = a;
      switch (a) {
        case E_STRIP_MODE.MIX:
          this.enabled = !0;
          this.type == E_STRIP_TYPE.IN && (isDefined(this.gr) && (this.gr.enabled = !0),
            isDefined(this.gi) && (this.gi.enabled = !0), isDefined(this.hiz) && (this.hiz.enabled = !1), isDefined(this.delay) && (this.delay.enabled = !1), this.phantom.enabled = !1, this.slGain.enabled = !1, this.polarity.enabled = !1, this.vuPre.enabled = !1, this.clipPre.enabled = !1, this.pan.enabled = !0, this.mute.enabled = !0, this.solo.enabled = !0, this.sl.enabled = !0, this.vu.enabled = !0, this.clip.enabled = !0, this.color = color.INPUT);
          break;
        case E_STRIP_MODE.GAIN:
          this.type != E_STRIP_TYPE.IN ? this.enabled = !1 : (isDefined(this.gr) && (this.gr.enabled = !1), isDefined(this.gi) && (this.gi.enabled = !1), this.mute.enabled = !1, this.solo.enabled = !1, this.pan.enabled = !1, this.sl.enabled = !1, this.vu.enabled = !1, this.clip.enabled = !1, isDefined(this.hiz) && (this.hiz.enabled = !0), isDefined(this.delay) && (this.delay.enabled = !0), this.phantom.enabled = !0, this.polarity.enabled = !0, this.slGain.enabled = !0, this.vuPre.enabled = !0, this.clipPre.enabled = !0, this.color = color.red);
          getValue("settings.demo") && 20 > curSetup.input && 2 > this.id && this.phantom.hide();
          this.updGain();
          break;
        default:
          return
      }
      this.NEED_UPDATE = !0
    },
    calcGeometry: function() {
      this.h = this.parent.h;
      isDefined(this.gr) && (this.gr.y = this.h - this.gr.h - 26);
      isDefined(this.gi) && (this.gi.y = this.h - this.gr.h - 26 - 13);
      isDefined(this.gr2) && (this.gr2.y = this.h - this.gr2.h - 26);
      isDefined(this.gi2) && (this.gi2.y = this.h - this.gr2.h - 26 - 13)
    },
    reset: function() {
      0 == this.getNameValue("stereoIndex") && (this.setLinked(!1), allStrips[this.id + 1].setLinked(!1), this.type != E_STRIP_TYPE.MEDIA && allStrips[this.id + 1].setNameValue("pan", .5));
      1 == this.getNameValue("stereoIndex") && (this.setLinked(!1),
        allStrips[this.id - 1].setLinked(!1), this.type != E_STRIP_TYPE.MEDIA && allStrips[this.id - 1].setNameValue("pan", .5));
      if (this.type == E_STRIP_TYPE.VCA) {
        var a = this.subId;
        allStrips.each(function(b) {
          b.getNameValue("vca") == a && (b.setNameValue("vca", -1), regUpdate(b))
        });
        activeViewGroup == E_VG.VCA1 + a && mixerWidget.showAll()
      }
      resetChannel(this.name.slice(0, -1));
      regUpdate(this);
      regUpdate(bottomWidget);
      regUpdate(gainMixer);
      mode == E_MODE.FXSENDS && regUpdate(fxSendsWidget);
      mode == E_MODE.PLAYER && regUpdate(playerLabels);
      mode ==
        E_MODE.EDIT && regUpdate(editWidget)
    },
    copySettings: function(a) {
      settingsBuffer = {};
      a = isDefined(a);
      for (var b in dataValue) !dataValue.hasOwnProperty(b) || !b.contains(this.name) || b.contains(".name") || b.contains(".defname") || b.contains(".stereoIndex") || b.contains(".slave") || b.contains(".stereo") || !a && b.contains(".mgmask") || !a && b.contains(".subgroup") || b.contains(".gain") && !b.contains(".eq.") || b.contains(".phantom") || b.contains(".invert") || b.contains(".hiz") || b.contains(".digitech") || b.contains(".safe") || b.contains(".src") ||
        b.contains(".scsrc") || !a && b.contains(".mute") && !b.contains(".aux.") && !b.contains(".fx.") || !a && b.contains(".solo") || !a && b.contains(".forceunmute") || (settingsBuffer[b.replace(this.name, "")] = dataValue[b]);
      settingsBufferType = this.type
    },
    pasteSettings: function() {
      if (settingsBufferType != this.type) showPopupMsg(lang.INCOMPATIBLE_CHANNEL_TYPE, 1E3);
      else
        for (var a in settingsBuffer) settingsBuffer.hasOwnProperty(a) && isDefined(dataValue[this.name + a]) && (setValue(this.name + a, settingsBuffer[a]), updateByKey(this.name +
          a))
    },
    getLabel: function() {
      var a = this.text;
      this.type == E_STRIP_TYPE.AUX && HAVE_MATRIX && this.getNameValue("matrix") && (a = "MTX " + (this.subId + 1));
      this.getNameValue("stereoIndex");
      return a
    },
    getColor: function() {
      return this.type == E_STRIP_TYPE.AUX && HAVE_MATRIX && this.getNameValue("matrix") ? color.MATRIX : this.color
    },
    getName: function() {
      var a = getValue(this.name + "name");
      if (!a) switch (this.type) {
        case E_STRIP_TYPE.VCA:
          a = lang.VCA + " " + (this.subId + 1);
          break;
        case E_STRIP_TYPE.IN:
          a = lang.CH + " " + (this.subId + 1);
          break;
        case E_STRIP_TYPE.AUX:
          a =
            lang.AUX + " " + (this.subId + 1);
          HAVE_MATRIX && this.getNameValue("matrix") && (a = lang.MTX + " " + (this.subId + 1));
          break;
        case E_STRIP_TYPE.FX:
          var b = this.getNameValue("fxtype"),
            a = lang.FX + " " + (this.subId + 1);
          switch (b) {
            case E_FX.REVERB:
              a += " " + lang.REVERB;
              break;
            case E_FX.DELAY:
              a += " " + lang.DELAY;
              break;
            case E_FX.CHORUS:
              a += " " + lang.CHORUS;
              break;
            case E_FX.ROOM:
              a += " " + lang.ROOM
          }
          break;
        case E_STRIP_TYPE.SUB:
          a = lang.SUB + " " + (this.subId + 1);
          break;
        case E_STRIP_TYPE.LINEIN:
          a = lang.LINE_IN;
          1 < curSetup.linein && (a += " " + (0 == this.subId %
            2 ? lang.L : lang.R));
          break;
        case E_STRIP_TYPE.MEDIA:
          a = lang.PLAYER + " " + (0 == this.subId % 2 ? lang.L : lang.R)
      }
      return a
    },
    setName: function(a) {
      setValue(this.name + "name", a);
      regUpdate(bottomWidget)
    },
    getNameValue: function(a) {
      return getValue(this.name + a)
    },
    setNameValue: function(a, b) {
      setValue(this.name + a, b);
      regUpdate(this)
    },
    setLinked: function(a) {
      if (a) {
        if (this.type == E_STRIP_TYPE.AUX) {
          if (isBlocked("auxlvl", this.subId)) {
            showPopupMsg(lang.LOCKED, 1E3);
            return
          }
          if (isBlocked("auxlvl", this.subId + 1)) {
            showPopupMsg(lang.LOCKED, 1E3);
            return
          }
        }
        this.linkTarget = allStrips[this.id + 1];
        if (!this.linkTarget || this.linkTarget.type != this.type) return;
        this.copySettings(!0);
        this.linkTarget.pasteSettings();
        setValue(this.name + "stereoIndex", 0);
        setValue(this.linkTarget.name + "stereoIndex", 1);
        settings.me.contains(this.id) ? settings.me.push(this.linkTarget.id) : settings.me.contains(this.linkTarget.id) && settings.me.push(this.id);
        if (this.type == E_STRIP_TYPE.AUX) {
          a = this.subId;
          for (var b = 0; b < inStrips.length; b++) setValue(inStrips[b].name + "aux." + (a + 1) + ".value",
            inStrips[b].getNameValue("aux." + a + ".value")), setValue(inStrips[b].name + "aux." + (a + 1) + ".post", inStrips[b].getNameValue("aux." + a + ".post")), setValue(inStrips[b].name + "aux." + (a + 1) + ".mute", inStrips[b].getNameValue("aux." + a + ".mute"));
          for (b = 0; b < lineinStrips.length; b++) setValue(lineinStrips[b].name + "aux." + (a + 1) + ".value", lineinStrips[b].getNameValue("aux." + a + ".value")), setValue(lineinStrips[b].name + "aux." + (a + 1) + ".post", lineinStrips[b].getNameValue("aux." + a + ".post")), setValue(lineinStrips[b].name + "aux." + (a +
            1) + ".mute", lineinStrips[b].getNameValue("aux." + a + ".mute"));
          for (b = 0; b < mediaStrips.length; b++) setValue(mediaStrips[b].name + "aux." + (a + 1) + ".value", mediaStrips[b].getNameValue("aux." + a + ".value")), setValue(mediaStrips[b].name + "aux." + (a + 1) + ".post", mediaStrips[b].getNameValue("aux." + a + ".post")), setValue(mediaStrips[b].name + "aux." + (a + 1) + ".mute", mediaStrips[b].getNameValue("aux." + a + ".mute"));
          for (b = 0; b < fxStrips.length; b++) setValue(fxStrips[b].name + "aux." + (a + 1) + ".value", fxStrips[b].getNameValue("aux." + a + ".value")),
            setValue(fxStrips[b].name + "aux." + (a + 1) + ".post", fxStrips[b].getNameValue("aux." + a + ".post")), setValue(fxStrips[b].name + "aux." + (a + 1) + ".mute", fxStrips[b].getNameValue("aux." + a + ".mute"));
          if (HAVE_MATRIX) {
            for (b = 0; b < auxStrips.length; b++) setValue(auxStrips[b].name + "mtx." + (a + 1) + ".value", auxStrips[b].getNameValue("mtx." + a + ".value")), setValue(auxStrips[b].name + "mtx." + (a + 1) + ".mute", auxStrips[b].getNameValue("mtx." + a + ".mute"));
            for (b = 0; b < subStrips.length; b++) setValue(subStrips[b].name + "mtx." + (a + 1) + ".value", subStrips[b].getNameValue("mtx." +
              a + ".value")), setValue(subStrips[b].name + "mtx." + (a + 1) + ".mute", subStrips[b].getNameValue("mtx." + a + ".mute"));
            setValue("m.mtx." + (a + 1) + ".value", getValue("m.mtx." + a + ".value"));
            setValue("m.mtx." + (a + 1) + ".mute", getValue("m.mtx." + a + ".mute"));
            setValue("m.mtx." + (a + 1) + ".r.value", getValue("m.mtx." + a + ".r.value"));
            setValue("m.mtx." + (a + 1) + ".r.mute", getValue("m.mtx." + a + ".r.mute"));
            for (b = 0; b < curSetup.aux; b++) setValue(this.name + "mtx." + b + ".pan", 0), setValue(this.linkTarget.name + "mtx." + b + ".pan", 1)
          }
        }
        if (this.type == E_STRIP_TYPE.IN ||
          this.type == E_STRIP_TYPE.MEDIA || this.type == E_STRIP_TYPE.LINEIN)
          for (setValue(this.name + "pan", 0), setValue(this.linkTarget.name + "pan", 1), b = 0; b < curSetup.aux; b++) setValue(this.name + "aux." + b + ".pan", 0), setValue(this.linkTarget.name + "aux." + b + ".pan", 1);
        regUpdate(this);
        regUpdate(this.linkTarget);
        mode == E_MODE.EDIT && (editWidget.upd(), regUpdate(editWidget))
      } else {
        a = 0 == getValue(this.name + "stereoIndex");
        if (this.type == E_STRIP_TYPE.AUX) {
          if (isBlocked("auxlvl", this.subId)) {
            showPopupMsg(lang.LOCKED, 1E3);
            return
          }
          if (isBlocked("auxlvl",
              this.subId + (a ? 1 : -1))) {
            showPopupMsg(lang.LOCKED, 1E3);
            return
          }
        }
        this.linkTarget = allStrips[this.id + (a ? 1 : -1)];
        if (!this.linkTarget || this.linkTarget.type != this.type) return;
        setValue(this.name + "stereoIndex", -1);
        setValue(this.linkTarget.name + "stereoIndex", -1);
        if (this.type == E_STRIP_TYPE.IN || this.type == E_STRIP_TYPE.MEDIA || this.type == E_STRIP_TYPE.LINEIN)
          for (b = 0; b < curSetup.aux; b++) setValue(this.name + "aux." + b + ".pan", .5), setValue(this.linkTarget.name + "aux." + b + ".pan", .5);
        if (this.type == E_STRIP_TYPE.AUX && HAVE_MATRIX)
          for (b =
            0; b < curSetup.aux; b++) setValue(this.name + "mtx." + b + ".pan", .5), setValue(this.linkTarget.name + "mtx." + b + ".pan", .5);
        regUpdate(this);
        regUpdate(this.linkTarget);
        mode == E_MODE.EDIT && (editWidget.upd(), regUpdate(editWidget));
        this.linkTarget = null
      }
      if (mode == E_MODE.AUX) auxWidget.onShow()
    },
    setVU: function(a, b, c, d, f, e, g, h) {
      if (this.type != E_STRIP_TYPE.VCA) {
        1 <= b ? this.clip.clip() : this.clip.state && !this.clip.releasing && this.clip.release();
        this.vu.setValueExt(a, b);
        settings.disableVUs2 || (this.gr.setValue(f), this.gi.setValue(g));
        for (var l = 0; l < this.AUXS.length; l++) this.AUXS[l].setVU(a, b);
        for (l = 0; l < this.FXS.length; l++) this.FXS[l].setVU(a, b);
        HAVE_MATRIX && this.MTX && this.MTX.setVU(a, b);
        this.stereo ? (1 <= d ? this.clip2.clip() : this.clip2.state && !this.clip2.releasing && this.clip2.release(), this.vu2.setValueExt(c, d), settings.disableVUs2 || (this.gr2.setValue(e), this.gi2.setValue(h)), modalsWidget.pages[0].m.setValue(b, f, g, this.id, d, e, h)) : modalsWidget.pages[0].m.setValue(b, f, g, this.id)
      }
    },
    drawMarksGain: function(a) {
      var b = this.sl.h - 80;
      a.fillStyle =
        "rgba(255,255,255,0.35)";
      a.textAlign = "center";
      a.font = font.stripMarks;
      GAINPtoV(30);
      GAINPtoV(0);
      GAINPtoV(-20);
      IS_UI_24 && (GAIN24toV(30), GAIN24toV(0));
      a.shadowColor = "transparent";
      var c = [1, GAINPtoV(40), GAINPtoV(30), GAINPtoV(20), GAINPtoV(10), GAINPtoV(-10), GAINPtoV(-20), GAINPtoV(-30), 0];
      IS_UI_24 && (c = [1, GAIN24toV(50), GAIN24toV(40), GAIN24toV(30), GAIN24toV(20), GAIN24toV(10), 0]);
      for (var d = 0; d < c.length; d++) {
        var f = Math.floor(b * (1 - c[d])) + 35;
        a.fillStyle = "rgba(0,0,0,0.2)";
        a.fillRect(92, 134 + f, 10, 1);
        a.fillStyle = "rgba(255,255,255,0.26)";
        a.fillRect(92, 134 + f + 1, 10, 1)
      }
      f = b * (1 - GAINPtoV(0)) + 35;
      IS_UI_24 && (f = b * (1 - GAIN24toV(0)) + 35);
      a.fillStyle = "#939394";
      a.fillRect(92, 134 + (f | 0), 12, 3)
    },
    DRAW_UPDATE_CHECK: function() {
      var a;
      a = this.getNameValue("mix");
      var b = this.getNameValue("mute"),
        c = this.getNameValue("forceunmute"),
        d = this.getNameValue("mgmask"),
        f = getValue("mgmask"),
        e = this.getNameValue("solo"),
        g = this.getNameValue("pan"),
        h = this.getNameValue("stereoIndex");
      a = "" + a + b + c + d + f + e + g + (selectedStrip == this) + h + this.firstInGroup + this.lastInGroup + this.sl.slowMode;
      switch (this.type) {
        case E_STRIP_TYPE.IN:
          a += this.blocked_gain;
        case E_STRIP_TYPE.LINEIN:
          a += this.getNameValue("src");
        case E_STRIP_TYPE.MEDIA:
          a += this.getNameValue("subgroup"), a += -1 != settings.me.indexOf(this.id);
        case E_STRIP_TYPE.FX:
          IS_UI_24 && (a += this.getNameValue("src"), b = this.getNameValue("vca"), null == b && (b = -1), a = a + b + (0 <= b ? vcaStrips[b] && vcaStrips[b].getMuteState() : !1));
          break;
        case E_STRIP_TYPE.VCA:
          a += activeViewGroup == 300 + this.subId;
          a += this.spread.state;
          b = !0;
          c = 0;
          for (d = allStrips.length; c < d; c++)
            if (allStrips[c].haveVCA &&
              allStrips[c].getNameValue("vca") === this.subId) {
              b = !1;
              break
            }
          a += b;
          break;
        case E_STRIP_TYPE.AUX:
          IS_UI_24 && (a += this.getNameValue("delay"), a += this.getNameValue("matrix")), a += settings.meout, a += this.subId == settings.meout
      }
      if (a === this.CACHED_PARAMS) return !1;
      this.CACHED_PARAMS = a;
      return !0
    },
    paint: function() {
      this.cacheH != this.h && this.cachePaint();
      drawImage(this.cache, 0, 0);
      var a = this.getNameValue("stereoIndex"),
        b = selectedStrip.id == this.id,
        c = !1;
      switch (this.type) {
        case E_STRIP_TYPE.IN:
        case E_STRIP_TYPE.MEDIA:
          settings.me.contains(this.id) &&
            (c = !0);
          0 == a && settings.me.contains(this.id + 1) && (c = !0);
          1 == a && settings.me.contains(this.id - 1) && (c = !0);
          break;
        case E_STRIP_TYPE.AUX:
          settings.meout == this.subId && (c = !0), 0 == a && settings.meout == this.subId + 1 && (c = !0), 1 == a && settings.meout == this.subId - 1 && (c = !0)
      }
      b && (ctx.globalAlpha = .055, ctx.fillStyle = "#fff", ctx.fillRect(1, 0, this.w - 2, this.h), ctx.globalAlpha = 1);
      ctx.fillStyle = this.color;
      ctx.fillRect(0 + (this.firstInGroup ? 2 : 0), this.h - 3, this.w - (this.firstInGroup ? 2 : 0) - (this.lastInGroup ? 2 : 0), 3);
      ctx.textBaseline = "alphabetic";
      b = this.text;
      this.type == E_STRIP_TYPE.AUX ? (HAVE_MATRIX && (b = this.getNameValue("matrix") ? "MTX " + (this.subId + 1) : "AUX " + (this.subId + 1)), 0 == a ? b += "L" : 1 == a && (b += "R")) : !HAVE_ROUTING || this.type != E_STRIP_TYPE.IN && this.type != E_STRIP_TYPE.LINEIN || (a = this.getNameValue("src")) && isString(a) && a != this.defaultSRC && (b += " (" + (E_SRC_NAMES[a] || a) + ")");
      ctx.textAlign = "left";
      ctx.font = font.stripChannel;
      ctx.fillStyle = c ? color.me : "#B5B5B5";
      ctx.fillText(b, 11, this.h - 10);
      ctx.textAlign = "center";
      this.subGroup = getValue(this.name + "subgroup");
      null != this.subGroup && 0 <= this.subGroup && (ctx.fillStyle = "#B55B7F", ctx.fillText("S" + (this.subGroup + 1), this.w - 11, this.h - 25));
      c = IS_UI_24 && this.haveVCA ? getValue(this.name + "vca") : -1;
      IS_UI_24 && 0 <= c && (ctx.fillStyle = "#58AE6E", ctx.fillText("V" + (c + 1), this.w - 11, this.h - 40));
      HAVE_HP && this.type == E_STRIP_TYPE.AUX && this.subId >= curSetup.aux - 2 && (ctx.shadowColor = "transparent", ctx.fillStyle = "#252522", ctx.fillRect(this.w - 51, this.h - 22, 30, 15), ctx.fillStyle = color.white, ctx.fillText(lang.HP + " " + (0 == this.subId % 2 ? lang.L : lang.R),
        this.w - 36, this.h - 10));
      if (mode != E_MODE.GAIN) {
        var d = dataValue.mgmask,
          a = this.getNameValue("mgmask"),
          b = a & d,
          f = this.getNameValue("mute"),
          e = d & 1 << MUTEALL_BIT_IDX,
          g = this.type == E_STRIP_TYPE.FX && d & 1 << MUTEFX_BIT_IDX,
          d = !1;
        IS_UI_24 && vcaStrips[c] && (d = vcaStrips[c].mute.getState());
        var h = this.getNameValue("forceunmute");
        ctx.fillStyle = h ? color.tvMuteUn : color.tvMuteMG;
        ctx.textAlign = "center";
        ctx.font = "10pt open_sans_condensedbold";
        var l = 0,
          m = this.stereo ? 9 : 11;
        e && ctx.fillText("A", m, 142 + 16 * l);
        l++;
        f && ctx.fillText("M", m, 142 +
          16 * l);
        l++;
        g && ctx.fillText("F", m, 142 + 16 * l);
        l++;
        for (f = 0; 6 > f; f++) a & 1 << f && (ctx.fillStyle = b & 1 << f ? h ? color.tvMuteUn : color.tvMuteMG : "#888", ctx.fillText(f + 1 + "", m, 142 + 16 * l)), l++;
        IS_UI_24 && 0 <= c && (ctx.fillStyle = d ? h ? color.tvMuteUn : color.tvMuteMG : "#888", ctx.fillText("V" + (c + 1), m, 142 + 16 * l))
      }
      this.blocked_gain && (ctx.setShadow(null), ctx.fillStyle = color.yellow, ctx.fillRoundRect(4, 190, 16, 18, 4), drawImage(res.bolt_icon, 4, 191))
    },
    cachePaint: function(a) {
      a ? a = ctx : (this.cache = document.createElement("canvas"), a = this.cache.getContext("2d"),
        isRetina ? (this.cache.width = 2 * this.w, this.cache.height = 2 * this.h, a.scale(2, 2)) : (this.cache.width = this.w, this.cache.height = this.h));
      switch (this.type) {
        case E_STRIP_TYPE.VCA:
        case E_STRIP_TYPE.AUX:
          fillVertPatternCtx(res.stripTile, this.h, a);
          drawImageCtx(res.stripBottom, 0, this.h - res.stripBottom.h(), a);
          HAVE_LATENCY ? drawImageCtx(res.stripAuxTop, 0, 0, a) : drawImageCtx(res.stripAuxTop2, 0, 0, a);
          break;
        default:
          fillVertPatternCtx(res.stripTile, this.h, a), drawImageCtx(res.stripBottom, 0, this.h - res.stripBottom.h(), a), drawImageCtx(res.stripTop,
            0, 0, a)
      }
      if (this.type != E_STRIP_TYPE.IN) {
        switch (this.type) {
          case E_STRIP_TYPE.FX:
            a.globalAlpha = .08;
            break;
          case E_STRIP_TYPE.MEDIA:
            a.globalAlpha = .05;
            break;
          case E_STRIP_TYPE.SUB:
            a.globalAlpha = .07;
            break;
          case E_STRIP_TYPE.AUX:
            a.globalAlpha = .07;
            break;
          case E_STRIP_TYPE.LINEIN:
            a.globalAlpha = .07;
            break;
          default:
            a.globalAlpha = .07
        }
        a.fillStyle = this.color;
        a.fillRect(0, 0, this.w, this.h);
        a.globalAlpha = 1
      }
      drawMarksDB(this.sl.h, 134, 100, a);
      this.stereo ? drawVUMarks(this.vu2, this.gr2, a) : drawVUMarks(this.vu, this.gr, a);
      this.cacheH =
        this.h
    },
    cachePaintGain: function() {
      cachedStripGain = document.createElement("canvas");
      var a = cachedStripGain.getContext("2d");
      isRetina ? (cachedStripGain.width = 2 * this.w, cachedStripGain.height = 2 * this.h, a.scale(2, 2)) : (cachedStripGain.width = this.w, cachedStripGain.height = this.h);
      fillVertPatternCtx(res.stripTile, this.h, a);
      drawImageCtx(res.stripBottom, 0, this.h - res.stripBottom.h(), a);
      drawImageCtx(res.stripAuxTop, 0, 0, a);
      a.globalAlpha = .07;
      a.fillStyle = "#f00";
      a.fillRect(0, 0, this.w, this.h);
      a.globalAlpha = 1;
      this.drawMarksGain(a);
      drawVUMarks(this.vuPre, null, a);
      cachedStripH = this.h
    }
  }),
  GainStrip = Class.create(Widget, {
    initialize: function($super, b, c) {
      $super(b);
      this.CACHED_DRAWING = CACHE_TECHNOLOGIES;
      this.widgetName = "Strip";
      this.subId = this.id = c;
      this.type = E_STRIP_TYPE.GAIN;
      this.name = "zz.xx";
      this.w = measures.mixerStripWidth;
      this.setAnchors(null, 0, null, 0);
      this.text = "CH 0";
      this.color = color.red;
      this.subGroup = -1;
      this.stereo = !1;
      this.gainName = this.name = "i." + this.subId + ".";
      HAVE_ROUTING && (this.gainName = "hw." + this.subId + ".");
      this.defaultSRC =
        "hw." + this.subId;
      this.widgetName += "(" + this.name + ")";
      this.linked = this.isClipping = !1;
      this.linkTarget = null;
      this.firstInGroup = this.lastInGroup2 = this.lastInGroup = !1;
      this.cacheGain = this.cache = null;
      this.cacheH = 0;
      this.gtimer = null;
      this.blocked_gain = !1;
      this.btimer = null;
      this.noGain = !1;
      this.initWidgets();
      this.updGain()
    },
    onShow: function() {
      this.updGain()
    },
    updGain: function() {
      if (HAVE_ROUTING) {
        var a = this.getNameValue("src");
        isString(a) && a || (a = "hw." + this.subId, this.setNameValue("src", a));
        this.led.state = 0;
        this.slGain.disabled = !1;
        this.noGain = this.slGain.hideOnDisabled = !1;
        a.startsWith("hw.") ? (this.phantom.show(), this.slGain.show(), this.gainName = a += ".", this.unRegAllKeys(), this.regKey(a + "hiz"), this.regKey(a + "disablegain"), this.phantom.setKey(a + "phantom", !0), this.slGain.setKey(a + "gain", !0), this.led.state = 0, this.led.keyPrefix = a, this.led.unRegAllKeys(), this.led.regKey(a + "gain"), this.led.regKey(a + "disablegain"), this.hiz.setKey(a + "hiz", !0), hasHIZ(this) ? this.hiz.show() : this.hiz.hide()) : (this.phantom.hide(), this.hiz.hide(), this.slGain.disabled = !0, this.slGain.hideOnDisabled = !0, this.led.state = 2, this.led.msg = "...", this.noGain = !0)
      }
    },
    initWidgets: function() {
      var a = this;
      this.led = new LED(this);
      this.led.setPos(6, 4);
      this.led.setSize(100, 38);
      this.led.redrawParent = !0;
      IS_UI_24 && (this.led.getState = function() {
        if (2 == this.state) {
          var b = a.getNameValue("src");
          this.msg = b = E_SRC_NAMES[b] || "..."
        }
      });
      this.led.onInput = function(b) {
        b = parseFloat(b);
        isNaN(b) ? showPopupMsg(lang.WRONG_VALUE) : a.slGain.setValue((IS_UI_24 ? GAIN24toV : GAINPtoV)(b))
      };
      this.led.onDouble = function() {
        a.slGain.setValue((IS_UI_24 ?
          GAIN24toV : GAINPtoV)(0))
      };
      this.phantom = new CheckBox(this);
      this.phantom.param = "phantom";
      this.phantom.setKey(this.gainName + "phantom", !0);
      this.phantom.setPos(4, 46);
      this.phantom.setImages(res.b48Off, res.b48On);
      this.phantom.getState = function() {
        this.disabled = getValue(a.gainName + "disablegain");
        hasHIZ(a) && !this.disabled && (this.disabled = 1 == a.getGainNameValue("hiz"))
      };
      HAVE_ROUTING ? this.phantom.onToggle = function() {
        blockGainBySrc(this.key.replace(".phantom", ""));
        updateByKey(this.key)
      } : (this.phantom.onToggleDown =
        function() {
          blockStrip(a.id, PHANTOM_OFF_DELAY)
        }, this.phantom.onToggleUp = function() {
          blockStrip(a.id, PHANTOM_ON_DELAY)
        });
      this.polarity = new CheckBox(this);
      this.polarity.param = "invert";
      this.polarity.setKey(this.name + "invert", !0);
      this.polarity.setPos(58, 46);
      this.polarity.setImages(res.bPIOff, res.bPIOn);
      this.hiz = new CheckBox(this);
      this.hiz.setKey(this.gainName + "hiz", !0);
      this.hiz.setPos(4, 88);
      this.hiz.setImages(res.hiz_off, res.hiz_on);
      this.hiz.getState = function() {
        this.disabled = getValue(a.gainName + "disablegain")
      };
      this.hiz.onToggleUp = function() {
        1 == a.getGainNameValue("phantom") && (a.setGainNameValue("phantom", 0), HAVE_ROUTING ? blockGainBySrc(this.key.replace(".hiz", "")) : blockStrip(a.id, PHANTOM_OFF_DELAY))
      };
      HAVE_ROUTING ? this.hiz.onToggle = function() {
        updateByKey(this.key)
      } : hasHIZ(this) || this.hiz.hide();
      HAVE_LATENCY && (this.delay = new TButton(this), this.delay.setPos(58, 88), this.delay.setImages(res.cl_s_btn_off, res.cl_s_btn_on), this.delay.redrawParent = !0, this.delay.opaque = !1, this.delay.setKey(this.name + "delay", !0), this.delay.getState =
        function() {
          this.text = VtoLATENCY(a.getNameValue("delay"))
        }, this.delay.onPress = function() {
          askForDelay(a, MAX_DELAY_INPUT, "delay", a.getName() + " " + lang.INPUT_DELAY)
        });
      this.slGain = new Slider(this, this.type);
      this.slGain.fader = res.gainFader;
      this.slGain.param = "gain";
      this.slGain.setKey(this.name + "gain", !0);
      this.slGain.setPos(0, 134);
      this.slGain.color = color.red;
      this.slGain.w = this.w;
      this.slGain.laneOffset = 36;
      this.slGain.faderX = 60;
      this.slGain.bottomMargin = 24;
      this.slGain.noStereoArrows = !0;
      for (var b = .29, c = []; 1 > b;) c.push(b),
        b += .0225;
      c.push(1);
      this.slGain.latch = !1;
      this.slGain.latchArr = c;
      this.slGain.latchStep = .0225;
      this.slGain.getState = function() {
        this.disabled = this.disabled || getValue(a.gainName + "disablegain")
      };
      this.slGain.onDouble = function() {
        setMode(E_MODE.MIX)
      };
      this.slGain.onDoubleKnob = function() {
        editWidget.setMode(editWidget.arr[0]);
        setMode(E_MODE.EDIT)
      };
      HAVE_ROUTING && (this.slGain.onValue = function() {
        updateByKey(this.key)
      });
      this.vuPre = new VUMeter(this);
      this.vuPre.setAnchors(21, 149, null, 26);
      this.vuPre.gain = !0;
      this.clipPre =
        new ClipBulb(this);
      this.clipPre.setPos(15, 127);
      this.clipPre.master = !0
    },
    getLabel: function() {
      return this.text
    },
    getColor: function() {
      return this.color
    },
    getName: function() {
      var a = getValue(this.name + "name");
      a || (a = lang.CH + " " + (this.subId + 1));
      return a
    },
    setName: function(a) {
      setValue(this.name + "name", a);
      regUpdate(bottomWidget)
    },
    getGainNameValue: function(a) {
      return getValue(this.gainName + a)
    },
    setGainNameValue: function(a, b) {
      return setValue(this.gainName + a, b)
    },
    getNameValue: function(a) {
      return getValue(this.name + a)
    },
    setNameValue: function(a, b) {
      setValue(this.name + a, b);
      regUpdate(this)
    },
    setVUPre: function(a) {
      if (1 <= a) this.clipPre.clip(), this.slGain.noUp = !0, this.slGain.noUpValue = this.slGain.value, masterWidget.setClipped();
      else if (this.clipPre.state && !this.clipPre.releasing) {
        this.clipPre.release();
        masterWidget.clipRelease();
        var b = this;
        clearTimeout(this.gtimer);
        this.gtimer = setTimeout(function() {
          b.slGain.noUp = !1
        }, CLIP_HOLD_TIME)
      }
      this.vuPre.setValueExt(0, a)
    },
    drawMarksGain: function(a) {
      var b = this.slGain.h - 80;
      a.fillStyle =
        "rgba(255,255,255,0.35)";
      a.textAlign = "center";
      a.font = font.stripMarks;
      GAINPtoV(30);
      GAINPtoV(0);
      GAINPtoV(-20);
      IS_UI_24 && (GAIN24toV(30), GAIN24toV(0));
      var c = [1, GAINPtoV(40), GAINPtoV(30), GAINPtoV(20), GAINPtoV(10), GAINPtoV(-10), GAINPtoV(-20), GAINPtoV(-30), 0];
      IS_UI_24 && (c = [1, GAIN24toV(50), GAIN24toV(40), GAIN24toV(30), GAIN24toV(20), GAIN24toV(10), 0]);
      for (var d = 0; d < c.length; d++) {
        var f = Math.floor(b * (1 - c[d])) + 35;
        a.fillStyle = "rgba(0,0,0,0.2)";
        a.fillRect(92, 134 + f, 10, 1);
        a.fillStyle = "rgba(255,255,255,0.26)";
        a.fillRect(92,
          134 + f + 1, 10, 1)
      }
      f = b * (1 - GAINPtoV(0)) + 35;
      IS_UI_24 && (f = b * (1 - GAIN24toV(0)) + 35);
      a.fillStyle = "#939394";
      a.fillRect(92, 134 + (f | 0), 12, 3)
    },
    DRAW_UPDATE_CHECK: function() {
      var a;
      a = this.getGainNameValue("gain");
      var b = this.getGainNameValue("phantom"),
        c = this.getNameValue("invert");
      a = "" + a + b + c + this.blocked_gain + (selectedStrip.id == this.id);
      a += this.firstInGroup;
      a += this.lastInGroup;
      a += this.slGain.slowMode;
      HAVE_ROUTING && (a += this.getNameValue("src"));
      IS_UI_24 && (a += this.getNameValue("delay"));
      hasHIZ(this) && (a += this.getGainNameValue("hiz"));
      if (a == this.CACHED_PARAMS) return !1;
      this.CACHED_PARAMS = a;
      return !0
    },
    paint: function() {
      cachedStripGainH != this.h && this.cachePaint();
      drawImage(cachedStripGain, 0, 0);
      this.noGain && (ctx.fillStyle = "rgba(0,0,0,0.3)", ctx.fillRect(0, 0, this.w, this.h));
      var a = this.getNameValue("stereoIndex"),
        b = selectedStrip.id == this.id,
        c = !1;
      switch (this.type) {
        case E_STRIP_TYPE.IN:
        case E_STRIP_TYPE.MEDIA:
          settings.me.contains(this.id) && (c = !0);
          0 == a && settings.me.contains(this.id + 1) && (c = !0);
          1 == a && settings.me.contains(this.id - 1) && (c = !0);
          break;
        case E_STRIP_TYPE.AUX:
          settings.meout == this.subId && (c = !0), 0 == a && settings.meout == this.subId + 1 && (c = !0), 1 == a && settings.meout == this.subId - 1 && (c = !0)
      }
      b && (ctx.globalAlpha = .055, ctx.fillStyle = "#fff", ctx.fillRect(1, 0, this.w - 2, this.h), ctx.globalAlpha = 1);
      ctx.fillStyle = this.color;
      ctx.fillRect(0 + (this.firstInGroup ? 2 : 0), this.h - 3, this.w - (this.firstInGroup ? 2 : 0) - (this.lastInGroup ? 2 : 0), 3);
      ctx.textBaseline = "alphabetic";
      a = this.text;
      HAVE_ROUTING && (b = this.getNameValue("src")) && isString(b) && b != this.defaultSRC && (a +=
        " (" + (E_SRC_NAMES[b] || b) + ")");
      ctx.textAlign = "left";
      ctx.font = font.stripChannel;
      ctx.fillStyle = c ? color.me : "#B5B5B5";
      ctx.fillText(a, 11, this.h - 10);
      this.blocked_gain && (ctx.setShadow(null), ctx.fillStyle = color.yellow, ctx.fillRoundRect(4, 190, 16, 18, 4), drawImage(res.bolt_icon, 4, 191))
    },
    cachePaint: function() {
      cachedStripGain = document.createElement("canvas");
      var a = cachedStripGain.getContext("2d");
      isRetina ? (cachedStripGain.width = 2 * this.w, cachedStripGain.height = 2 * this.h, a.scale(2, 2)) : (cachedStripGain.width = this.w,
        cachedStripGain.height = this.h);
      fillVertPatternCtx(res.stripTile, this.h, a);
      drawImageCtx(res.stripBottom, 0, this.h - res.stripBottom.h(), a);
      drawImageCtx(res.stripAuxTop, 0, 0, a);
      a.globalAlpha = .07;
      a.fillStyle = "#f00";
      a.fillRect(0, 0, this.w, this.h);
      a.globalAlpha = 1;
      this.drawMarksGain(a);
      drawVUMarks(this.vuPre, null, a);
      cachedStripGainH = this.h
    }
  }),
  GainStrip2 = Class.create(Widget, {
    initialize: function($super, b, c, d) {
      $super(b);
      this.CACHED_DRAWING = CACHE_TECHNOLOGIES;
      this.widgetName = "Strip";
      this.id = c;
      this.subId = d;
      this.type =
        777;
      this.name = "zz.xx";
      this.w = measures.mixerStripWidth;
      this.setAnchors(null, 0, null, 0);
      this.text = "HW " + (this.subId + 1);
      this.color = color.red;
      this.subGroup = -1;
      this.stereo = !1;
      this.gainName = this.name = "hw." + this.subId + ".";
      this.widgetName += "(" + this.name + ")";
      this.linked = this.isClipping = !1;
      this.linkTarget = null;
      this.firstInGroup = this.lastInGroup2 = this.lastInGroup = !0;
      this.cacheGain = this.cache = null;
      this.cacheH = 0;
      this.gtimer = null;
      this.blocked_gain = !1;
      this.btimer = null;
      this.initWidgets()
    },
    updGain: function() {},
    initWidgets: function() {
      var a =
        this;
      this.unRegAllKeys();
      this.regKey(this.name + "hiz");
      this.regKey(this.name + "disablegain");
      this.led = new LED(this);
      this.led.setPos(6, 4);
      this.led.setSize(100, 38);
      this.led.regKey(this.name + "gain");
      this.led.needStereo = !1;
      this.led.keyPrefix = this.gainName;
      this.led.onInput = function(b) {
        b = parseFloat(b);
        isNaN(b) ? showPopupMsg(lang.WRONG_VALUE) : a.slGain.setValue((IS_UI_24 ? GAIN24toV : GAINPtoV)(b))
      };
      this.led.onDouble = function() {
        a.slGain.setValue((IS_UI_24 ? GAIN24toV : GAINPtoV)(0))
      };
      this.phantom = new CheckBox(this);
      this.phantom.param = "phantom";
      this.phantom.setKey(this.name + "phantom", !0);
      this.phantom.setPos(4, 46);
      this.phantom.setImages(res.b48Off, res.b48On);
      this.phantom.getState = function() {
        this.disabled = getValue(a.gainName + "disablegain");
        hasHIZ(a) && !this.disabled && (this.disabled = 1 == a.getNameValue("hiz"))
      };
      this.phantom.onToggle = function() {
        blockGainBySrc(this.key.replace(".phantom", ""));
        updateByKey(this.key)
      };
      2 > this.subId % 20 && (this.phantom.regKey(this.name + "hiz"), this.hiz = new CheckBox(this), this.hiz.setKey(this.name +
        "hiz", !0), this.hiz.setPos(4, 88), this.hiz.setImages(res.hiz_off, res.hiz_on), this.hiz.getState = function() {
        this.disabled = getValue(a.gainName + "disablegain")
      }, this.hiz.onToggleUp = function() {
        1 == a.getNameValue("phantom") && (a.setNameValue("phantom", 0), blockGainBySrc(this.key.replace(".hiz", "")))
      }, this.hiz.onToggle = function() {
        updateByKey(this.key)
      });
      this.slGain = new Slider(this, this.type);
      this.slGain.fader = res.gainFader;
      this.slGain.param = "gain";
      this.slGain.noFocus = !0;
      this.slGain.setKey(this.name + "gain", !0);
      this.slGain.setPos(0, 134);
      this.slGain.color = color.red;
      this.slGain.w = this.w;
      this.slGain.laneOffset = 36;
      this.slGain.faderX = 60;
      this.slGain.bottomMargin = 24;
      this.slGain.getState = function() {
        this.disabled = this.disabled || getValue(a.gainName + "disablegain")
      };
      this.slGain.onDouble = function() {
        setMode(E_MODE.MIX)
      };
      this.slGain.onValue = function() {
        updateByKey(this.key)
      }
    },
    getLabel: function() {
      return this.text
    },
    getColor: function() {
      return this.color
    },
    getName: function() {
      return "[ in " + (this.subId + 1) + " ]"
    },
    setName: function(a) {},
    getNameValue: function(a) {
      return getValue(this.name + a)
    },
    setNameValue: function(a, b) {
      setValue(this.name + a, b);
      regUpdate(this)
    },
    drawMarksGain: function(a) {
      var b = this.slGain.h - 80;
      a.fillStyle = "rgba(255,255,255,0.35)";
      a.textAlign = "center";
      a.font = font.stripMarks;
      GAINPtoV(30);
      GAINPtoV(0);
      GAINPtoV(-20);
      IS_UI_24 && (GAIN24toV(30), GAIN24toV(0));
      a.shadowColor = "transparent";
      var c = [1, GAINPtoV(40), GAINPtoV(30), GAINPtoV(20), GAINPtoV(10), GAINPtoV(-10), GAINPtoV(-20), GAINPtoV(-30), 0];
      IS_UI_24 && (c = [1, GAIN24toV(50), GAIN24toV(40),
        GAIN24toV(30), GAIN24toV(20), GAIN24toV(10), 0
      ]);
      for (var d = 0; d < c.length; d++) {
        var f = Math.floor(b * (1 - c[d])) + 35;
        a.fillStyle = "rgba(0,0,0,0.2)";
        a.fillRect(92, 134 + f, 10, 1);
        a.fillStyle = "rgba(255,255,255,0.26)";
        a.fillRect(92, 134 + f + 1, 10, 1)
      }
      f = b * (1 - GAINPtoV(0)) + 35;
      IS_UI_24 && (f = b * (1 - GAIN24toV(0)) + 35);
      a.fillStyle = "#939394";
      a.fillRect(92, 134 + (f | 0), 12, 3)
    },
    DRAW_UPDATE_CHECK: function() {
      var a;
      a = this.getNameValue("gain");
      var b = this.getNameValue("phantom");
      a = "" + a + b + this.blocked_gain + this.slGain.slowMode;
      2 > this.subId && (a +=
        this.getNameValue("hiz"));
      if (!this.CACHED_PARAMS.length) return this.CACHED_PARAMS = a, !0;
      if (a == this.CACHED_PARAMS) return !1;
      this.CACHED_PARAMS = a;
      return !0
    },
    paint: function() {
      cachedStripGain2H != this.h && this.cachePaint();
      drawImage(cachedStripGain2, 0, 0);
      var a = this.getNameValue("stereoIndex"),
        b = selectedStrip.id == this.id;
      switch (this.type) {
        case E_STRIP_TYPE.IN:
        case E_STRIP_TYPE.MEDIA:
          settings.me.contains(this.id), 0 == a && settings.me.contains(this.id + 1), 1 == a && settings.me.contains(this.id - 1)
      }
      b && (ctx.globalAlpha =
        .055, ctx.fillStyle = "#fff", ctx.fillRect(1, 0, this.w - 2, this.h), ctx.globalAlpha = 1);
      ctx.fillStyle = this.color;
      ctx.fillRect(0 + (this.firstInGroup ? 2 : 0), this.h - 3, this.w - (this.firstInGroup ? 2 : 0) - (this.lastInGroup ? 2 : 0), 3);
      ctx.textBaseline = "alphabetic";
      a = this.text;
      ctx.textAlign = "left";
      ctx.font = font.stripChannel;
      ctx.fillStyle = "#B5B5B5";
      ctx.fillText(a, 11, this.h - 10);
      this.blocked_gain && (ctx.setShadow(null), ctx.fillStyle = color.yellow, ctx.fillRoundRect(4, 190, 16, 18, 4), drawImage(res.bolt_icon, 4, 191))
    },
    cachePaint: function() {
      cachedStripGain2 =
        document.createElement("canvas");
      var a = cachedStripGain2.getContext("2d");
      isRetina ? (cachedStripGain2.width = 2 * this.w, cachedStripGain2.height = 2 * this.h, a.scale(2, 2)) : (cachedStripGain2.width = this.w, cachedStripGain2.height = this.h);
      fillVertPatternCtx(res.stripTile, this.h, a);
      drawImageCtx(res.stripBottom, 0, this.h - res.stripBottom.h(), a);
      drawImageCtx(res.stripAuxTop, 0, 0, a);
      a.globalAlpha = .04;
      a.fillStyle = "#f00";
      a.fillRect(0, 0, this.w, this.h);
      a.globalAlpha = 1;
      this.drawMarksGain(a);
      drawVUMarks(this.vuPre, null, a);
      cachedStripH = this.h
    }
  }),
  MasterStrip = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "MasterStrip";
      this.name = "m.";
      this.y = measures.topWidgetHeight;
      this.w = measures.masterStripWidth;
      this.botLabelHeight = res.mStripBottomLabel.h();
      this.botHeight = res.mStripBottom.h();
      this.color = color.red;
      this.stereo = !0;
      this.type = E_STRIP_TYPE.MASTER;
      this.subId = this.id = -1;
      this.text = lang.MASTER;
      this.muted = this.soloed = this.clipped = !1;
      this.timer = this.MTX2 = this.MTX = null;
      this.lastClickTime = -1;
      this.regKey("m.dim");
      this.initWidgets()
    },
    setVU2: function(a, b, c, d, f, e, g, h) {
      1 <= b ? this.clip.clip() : this.clip.state && !this.clip.releasing && this.clip.release();
      this.vu.setValueExt(a, b);
      1 <= d ? this.clip2.clip() : this.clip2.state && !this.clip2.releasing && this.clip2.release();
      this.vu2.setValueExt(c, d);
      HAVE_MATRIX && this.MTX && this.MTX.setVU(a, b);
      HAVE_MATRIX && this.MTX2 && this.MTX2.setVU(c, d);
      settings.disableVUs2 || (this.gr.setValue(f), this.gr2.setValue(e), IS_UI_24 || (this.gi.setValue(g), this.gi2.setValue(h)))
    },
    initWidgets: function() {
      this.led =
        new LED(this);
      this.led.setPos(6, 4);
      this.led.setSize(115, 38);
      this.led.color = color.mLedText;
      this.led.master = !0;
      this.led.onDown = function() {
        mode == E_MODE.MODALS ? setMode(E_MODE.MIX) : (modalsWidget.setMode(0), setMode(E_MODE.MODALS))
      };
      this.pan = new PanSlider(this);
      this.pan.key = this.name + "pan";
      this.pan.setPos(5, 46);
      this.pan.setSize(117, 30);
      var a = this;
      this.sl = new Slider(this, E_STRIP_TYPE.MASTER);
      this.sl.param = "mix";
      this.sl.key = this.name + "mix";
      this.sl.setPos(0, 134);
      this.sl.canScroll = !1;
      this.sl.w = this.w;
      this.sl.laneOffset =
        34;
      this.sl.faderX = 77;
      this.sl.bottomMargin = 58;
      this.sl.master = !0;
      this.sl.onhold = function() {
        if (settings.masterLock && this.locked) {
          this.locked = !1;
          this.slide = !0;
          var b = this;
          clearTimeout(this.holdTimer);
          this.holdTimer = setTimeout(function() {
            var c = Math.abs(b.pressPoint[1] - b.currentPoint[1]);
            5 > Math.abs(b.pressPoint[0] - b.currentPoint[0]) && 5 > c && (settings.nudge && (b.slowMode = !0), regUpdate(a))
          }, this.holdTime + 500)
        } else settings.nudge && (this.slowMode = !0);
        regUpdate(a)
      };
      this.sl.onDoubleKnob = function() {
        editWidget.setMode(editWidget.arr[0]);
        mode != E_MODE.EDIT && setMode(E_MODE.EDIT); - 1 != selectedChannel && setSelected(-1)
      };
      this.f1c = new CheckBox(this);
      this.f1c.setPos(4, 88);
      this.f1c.setImages(res.PLAYS_OFF, res.PLAYS_STOP);
      this.f1c.font = "14px open_sans_condensedbold";
      this.f1c.textColor = color.black2;
      this.f1c.textColorActive = color.white;
      this.f1c.shadowColorActive = "#333";
      this.f1c.shadowColor = "#ccc";
      this.f1c.opaque = !1;
      this.f1c.regKey("mgmask");
      this.f1c.regKey("m.dim");
      this.f1c.regKey("var.currentState");
      this.f1c.regKey("var.recBusy");
      this.f1c.regKey("var.isRecording");
      this.f1c.regKey("var.present");
      this.f1c.regKey("var.mtk.present");
      this.f1c.regKey("var.mtk.currentState");
      this.f1c.regKey("var.mtk.rec.busy");
      this.f1c.regKey("var.mtk.rec.currentState");
      this.f1c.textParam = {
        font: "14px open_sans_condensedbold",
        x: null,
        y: null,
        offsetX: -1,
        offsetY: -3,
        pressOffsetX: 0,
        pressOffsetY: 1,
        align: "center",
        valign: "middle",
        shadow: ["#ccc", 0, 1, 1],
        dy: 12
      };
      this.f1c.getState = function() {
        this.text = null;
        var a = settings.bigSlideOut && slideOutWidget.enabled ? E_FFUNC.MUTE_ALL : settings.f1func;
        this.buttonMode =
          this.disabled = !1;
        this.state = 0;
        switch (a) {
          case E_FFUNC.NEWSNAP:
            this.img0 = res.SS_OFF;
            this.img1 = res.SS_ON;
            this.buttonMode = !0;
            break;
          case E_FFUNC.UPDCURSNAP:
            this.img0 = res.SSUPD_OFF;
            this.img1 = res.SSUPD_ON;
            this.buttonMode = !0;
            break;
          case E_FFUNC.NEXT_SNAP:
            this.img0 = res.NXT_SNP_OFF;
            this.img1 = res.NXT_SNP_ON;
            this.buttonMode = !0;
            break;
          case E_FFUNC.PREV_SNAP:
            this.img0 = res.PRV_SNP_OFF;
            this.img1 = res.PRV_SNP_ON;
            this.buttonMode = !0;
            break;
          case E_FFUNC.MUTE_ALL:
            this.state = isMuteAll() ? 1 : 0;
            this.img0 = res.FFUNC_B_OFF;
            this.img1 =
              res.FFUNC_B_RED;
            this.text = lang.MUTE_ALL.replace(" ", "\n");
            break;
          case E_FFUNC.DIM:
            this.state = getValue("m.dim") ? 1 : 0;
            this.img0 = res.FFUNC_B_OFF;
            this.img1 = res.FFUNC_B_BLU;
            this.text = lang.DIM;
            break;
          case E_FFUNC.PLAY:
            this.state = 2 == getValue("var.currentState") ? 1 : 0;
            this.disabled = 0 == getValue("var.present");
            this.img0 = res.PLAYS_OFF;
            this.img1 = res.PLAYS_STOP;
            break;
          case E_FFUNC.REC:
            this.state = getValue("var.isRecording");
            this.disabled = 0 == getValue("var.present") || .5 < getValue("var.recBusy");
            this.img0 = res.RECS_OFF;
            this.img1 =
              res.RECS_STOP;
            break;
          case E_FFUNC.MTK_PLAY:
            this.state = 2 == getValue("var.mtk.currentState") ? 1 : 0;
            this.disabled = 0 == getValue("var.mtk.present") || .5 < getValue("var.mtk.rec.busy") || .5 < getValue("var.mtk.rec.currentState");
            this.img0 = res.MTK_PLAY;
            this.img1 = res.MTK_STOP;
            break;
          case E_FFUNC.MTK_REC:
            this.state = getValue("var.mtk.rec.currentState");
            this.disabled = 0 == getValue("var.mtk.present") || .5 < getValue("var.mtk.rec.busy") || 0 != getValue("var.mtk.currentState");
            this.img0 = res.MTK_REC_OFF;
            this.img1 = res.MTK_REC_ON;
            break;
          default:
            this.img1 = res.bF1Off, this.img2 = res.bF1On
        }
      };
      this.f1c.onToggle = function() {
        doFfunc(settings.bigSlideOut && slideOutWidget.enabled ? E_FFUNC.MUTE_ALL : settings.f1func)
      };
      this.f2c = new CheckBox(this);
      this.f2c.setPos(67, 88);
      this.f2c.setImages(res.PLAYS_OFF, res.PLAYS_STOP);
      this.f2c.font = "14px open_sans_condensedbold";
      this.f2c.textColor = color.black2;
      this.f2c.textColorActive = color.white;
      this.f2c.shadowColorActive = "#333";
      this.f2c.shadowColor = "#ccc";
      this.f2c.regKey("mgmask");
      this.f2c.regKey("m.dim");
      this.f2c.regKey("var.currentState");
      this.f2c.regKey("var.recBusy");
      this.f2c.regKey("var.isRecording");
      this.f2c.regKey("var.present");
      this.f2c.regKey("var.mtk.present");
      this.f2c.regKey("var.mtk.currentState");
      this.f2c.regKey("var.mtk.rec.busy");
      this.f2c.regKey("var.mtk.rec.currentState");
      this.f2c.textParam = {
        font: "14px open_sans_condensedbold",
        x: null,
        y: null,
        offsetX: -1,
        offsetY: -3,
        pressOffsetX: 0,
        pressOffsetY: 1,
        align: "center",
        valign: "middle",
        shadow: ["#ccc", 0, 1, 1],
        dy: 12
      };
      this.f2c.getState = function() {
        this.text = null;
        var a = settings.bigSlideOut &&
          slideOutWidget.enabled ? E_FFUNC.DIM : settings.f2func;
        this.buttonMode = this.disabled = !1;
        this.state = 0;
        switch (a) {
          case E_FFUNC.NEWSNAP:
            this.img0 = res.SS_OFF;
            this.img1 = res.SS_ON;
            this.buttonMode = !0;
            break;
          case E_FFUNC.UPDCURSNAP:
            this.img0 = res.SSUPD_OFF;
            this.img1 = res.SSUPD_ON;
            this.buttonMode = !0;
            break;
          case E_FFUNC.NEXT_SNAP:
            this.img0 = res.NXT_SNP_OFF;
            this.img1 = res.NXT_SNP_ON;
            this.buttonMode = !0;
            break;
          case E_FFUNC.PREV_SNAP:
            this.img0 = res.PRV_SNP_OFF;
            this.img1 = res.PRV_SNP_ON;
            this.buttonMode = !0;
            break;
          case E_FFUNC.MUTE_ALL:
            this.state =
              isMuteAll() ? 1 : 0;
            this.img0 = res.FFUNC_B_OFF;
            this.img1 = res.FFUNC_B_RED;
            this.text = lang.MUTE_ALL.replace(" ", "\n");
            break;
          case E_FFUNC.DIM:
            this.state = getValue("m.dim") ? 1 : 0;
            this.img0 = res.FFUNC_B_OFF;
            this.img1 = res.FFUNC_B_BLU;
            this.text = lang.DIM;
            break;
          case E_FFUNC.PLAY:
            this.state = 2 == getValue("var.currentState") ? 1 : 0;
            this.disabled = 0 == getValue("var.present");
            this.img0 = res.PLAYS_OFF;
            this.img1 = res.PLAYS_STOP;
            break;
          case E_FFUNC.REC:
            this.state = getValue("var.isRecording");
            this.disabled = 0 == getValue("var.present") ||
              .5 < getValue("var.recBusy");
            this.img0 = res.RECS_OFF;
            this.img1 = res.RECS_STOP;
            break;
          case E_FFUNC.MTK_PLAY:
            this.state = 2 == getValue("var.mtk.currentState") ? 1 : 0;
            this.disabled = 0 == getValue("var.mtk.present") || .5 < getValue("var.mtk.rec.busy") || .5 < getValue("var.mtk.rec.currentState");
            this.img0 = res.MTK_PLAY;
            this.img1 = res.MTK_STOP;
            break;
          case E_FFUNC.MTK_REC:
            this.state = getValue("var.mtk.rec.currentState");
            this.disabled = 0 == getValue("var.mtk.present") || .5 < getValue("var.mtk.rec.busy") || 0 != getValue("var.mtk.currentState");
            this.img0 = res.MTK_REC_OFF;
            this.img1 = res.MTK_REC_ON;
            break;
          default:
            this.img1 = res.bF2Off, this.img2 = res.bF2On
        }
      };
      this.f2c.onToggle = function() {
        doFfunc(settings.bigSlideOut && slideOutWidget.enabled ? E_FFUNC.DIM : settings.f2func)
      };
      var b = 101 + measures.bottomWidgetHeight;
      this.clip = new ClipBulb(this);
      this.clip.setPos(12, 127);
      this.vu = new VUMeter(this);
      this.vu.setAnchors(18, 149, null, settings.disableVUs2 ? 59 : b);
      settings.disableVUs2 || (IS_UI_24 || (this.gi = new GATEind(this), this.gi.x = 18, this.gi2 = new GATEind(this), this.gi2.x =
        37), this.gr = new GRMeter(this), this.gr.x = 18, this.gr2 = new GRMeter(this), this.gr2.x = 37);
      this.clip2 = new ClipBulb(this);
      this.clip2.setPos(31, 127);
      this.vu2 = new VUMeter(this);
      this.vu2.setAnchors(37, 149, null, settings.disableVUs2 ? 59 : b)
    },
    getLabel: function() {
      return this.text
    },
    getColor: function() {
      return this.color
    },
    getName: function() {
      return lang.MASTER
    },
    setNameValue: function(a, b) {
      setValue(this.name + a, b);
      regUpdate(this)
    },
    getNameValue: function(a) {
      return getValue(this.name + a)
    },
    calcGeometry: function() {
      this.x = screenWidth -
        this.w;
      slideOutWidget.enabled && (this.x -= slideOutWidget.w);
      this.h = screenHeight - this.y;
      settings.disableVUs2 || (this.gr.y = this.h - this.gr.h - 26 - measures.bottomWidgetHeight, this.gr2.y = this.h - this.gr.h - 26 - measures.bottomWidgetHeight, IS_UI_24 || (this.gi.y = this.gr.y - 13, this.gi2.y = this.gr2.y - 13))
    },
    setClipped: function() {
      this.clipped = !0;
      regUpdate(this)
    },
    clipRelease: function() {
      var a = this;
      clearTimeout(this.timer);
      this.timer = setTimeout(function() {
        a.clipped = !1;
        regUpdate(a)
      }, CLIP_HOLD_TIME)
    },
    setSolo: function(a) {
      this.soloed =
        a;
      regUpdate(this)
    },
    onDown: function(a, b) {
      this.globalX();
      var c = b - this.globalY();
      this.botDown = !1;
      if (c > this.h - 34)
        if (this.botDown = !0, c = Date.now(), c - this.lastClickTime < DBL_CLK_TIME) this.onDouble(), this.lastClickTime = c - DBL_CLK_TIME;
        else {
          this.lastClickTime = c;
          var d = this;
          clearTimeout(this.holdTimer);
          this.holdTimer = setTimeout(function() {
            d.onHold()
          }, HOLD_TIME)
        }
    },
    onUp: function() {
      this.botDown && setSelected(-1, !0);
      clearTimeout(this.holdTimer)
    },
    onHold: function() {
      this.botDown = !1; - 1 != selectedChannel && setSelected(-1);
      var a = new STRIPMENU(null, this);
      a.x = bound(this.x, 0, screenWidth - a.w);
      a.y = screenHeight - a.h - measures.bottomWidgetHeight;
      a.poplineX = 130;
      mWidgets.push(widgets.pop());
      regUpdate(a)
    },
    onDouble: function() {
      this.botDown = !1;
      mode != E_MODE.EDIT ? (editWidget.setMode(editWidget.E_MODE.dyn), -1 != selectedChannel && setSelected(-1), setMode(E_MODE.EDIT)) : (-1 != selectedChannel && setSelected(-1), goBack())
    },
    showPresets: function() {
      this.menu = new PRESET_MENU2(null, "chm", this);
      this.menu.color = this.color;
      this.menu.center = !0;
      this.menu.updateGeometry();
      regUpdate(this.menu)
    },
    savePreset: function() {
      for (var a = "m.afs.enabled m.afs.fmode m.afs.cmode m.afs.numtotal m.afs.numfixed m.afs.logic m.afs.livelift m.afs.sensitivity m.l.invert m.r.invert".split(" "), a = a.concat(getKeys("m.eq.")), a = a.concat(getKeys("m.dyn.")), a = a.filter(function(a) {
          return !a.contains(".enabled")
        }), a = a.filter(function(a) {
          return !a.contains(".bypass")
        }), a = a.filter(function(a) {
          return !a.contains(".prmod")
        }), b = {}, c = 0; c < a.length; c++) {
        var d = a[c],
          f = a[c].replace("m.", ".");
        b[f] = getValue(d)
      }
      return b
    },
    loadPreset: function(a, b) {
      applyPreset("m", a);
      isDefined(b) && (setValue("m.eq.prname", b), setValue("m.dyn.prname", b));
      regUpdate(editWidget)
    },
    paint: function() {
      cachedMStripH != this.h && this.cachePaint();
      drawImage(cachedMStrip, 0, 0, this.w, this.h);
      ctx.fillStyle = color.gradMBL;
      ctx.fillRect(2, this.h - 37, this.w - 4, 3);
      ctx.fillStyle = this.color;
      selectedChannel == this.id && ctx.fillRect(2, this.h - this.botLabelHeight, this.w - 4, 35);
      ctx.drawText(lang.MASTER, this.w / 2, this.h - 10, {
        color: ctx.fillStyle = color.masterLabel,
        font: font.botMChLabel,
        align: "center",
        shadow: Shadow.main
      });
      ctx.textAlign = "left";
      for (var a = !1, b = 0; b < allStrips.length; b++)
        if (allStrips[b].getNameValue("mute")) {
          a = !0;
          break
        }
      b = getValue("mgmask");
      if (a || b) ctx.fillStyle = "#e22", ctx.font = "14px open_sans_condensedbold", ctx.drawText(b ? "MG" : "M", 11, 20.5, {
        shadow: Shadow.main
      });
      a = !1;
      for (b = 0; b < allStrips.length; b++)
        if (allStrips[b].getNameValue("solo")) {
          a = !0;
          break
        }
      a && (ctx.font = "14px open_sans_condensedbold", ctx.fillStyle = "#ee2", ctx.drawText("S", 13, 36, {
        shadow: Shadow.main
      }));
      IS_UI_24 && getValue("m.dim") &&
        (ctx.font = "10px open_sans_condensedbold", ctx.fillStyle = "#32B6E2", ctx.textAlign = "right", ctx.drawText("DIM", this.w - 10, 37, {
          shadow: Shadow.main
        }));
      this.clipped && (ctx.fillStyle = "#e22", ctx.fillRoundRect(101, 9, 17, 15, 2), ctx.fillStyle = color.black, ctx.textAlign = "left", ctx.font = "14px open_sans_condensedbold", ctx.fillText("C", 106, 21.5));
      ctx.shadowColor = "transparent"
    },
    cachePaint: function() {
      if (cachedMStripH != this.h) {
        cachedMStrip = document.createElement("canvas");
        var a = cachedMStrip.getContext("2d");
        isRetina ? (cachedMStrip.width =
          2 * this.w, cachedMStrip.height = 2 * this.h, a.scale(2, 2)) : (cachedMStrip.width = this.w, cachedMStrip.height = this.h);
        a.fillStyle = "#15171C";
        a.fillRect(0, 0, this.w, this.h);
        fillVertPatternCtx(res.mStripTile, this.h, a);
        drawImageCtx(res.mStripBottom, 0, this.h - this.botHeight - this.botLabelHeight, a);
        drawImageCtx(res.mStripBottomLabel, 0, this.h - this.botLabelHeight, a);
        drawImageCtx(res.mStripTopNCS, 0, 0, a);
        a.globalAlpha = .06;
        a.fillStyle = "#fff";
        a.fillRect(0, 0, this.w, this.h);
        a.globalAlpha = 1;
        a.fillStyle = "rgba(255,255,0,0.8)";
        a.fillTriangle(this.w - 18, 10, 3, 4);
        a.fillStyle = this.color;
        a.fillRect(2, this.h - 37, this.w - 4, 3);
        a.font = font.stripChannel;
        a.textAlign = "left";
        a.fillStyle = color.stripChLabel;
        a.setShadow(color.black, 3, 1, 1);
        a.fillText(lang.L, 20, this.h - 43);
        a.fillText(lang.R, 38, this.h - 43);
        drawVUMarks(this.vu2, this.gr2, a);
        drawMarksDB(this.sl.h, 134, 117, a);
        cachedMStripH = this.h
      }
    }
  });

function isMuteAll() {
  return checkBit(getValue("mgmask"), MUTEALL_BIT_IDX)
}
fxStripCache = null;
fxStripCacheH = -1;
var FXStrip = Class.create(Widget, {
  initialize: function($super, b, c, d, f) {
    $super(b);
    this.CACHED_DRAWING = CACHE_TECHNOLOGIES;
    this.id = c;
    this.widgetName = "FXStrip";
    this.name = d;
    this.name2 = f;
    this.w = measures.mixerStripWidth;
    this.x = this.w * c;
    this.text = "CH X";
    this.color = b.color;
    this.lastInGroup = this.firstInGroup = !1;
    this.initWidgets()
  },
  setMode: function(a) {
    this.name2 = "fx." + a + ".";
    var b = this.name + this.name2;
    this.mute.setKey(b + "mute");
    this.sl.setKey(b + "value");
    this.led.setKey(b + "value");
    b = color.white;
    switch (a) {
      case 0:
        b =
          color.blue;
        break;
      case 1:
        b = color.brown;
        break;
      case 2:
        b = color.purple;
        break;
      case 3:
        b = color.green
    }
    this.sl.color = b
  },
  calcGeometry: function() {
    this.h = this.parent.h
  },
  setVU: function(a, b, c, d) {
    b = 0 == this.mute.state ? modVu(b, this.sl.value) : 0;
    1 <= b ? this.clip.clip() : this.clip.state && !this.clip.releasing && this.clip.release();
    this.vu.setValueExt(a, b)
  },
  getNameValue: function(a) {
    return getValue(this.name + a)
  },
  getName2Value: function(a) {
    return getValue(this.name + this.name2 + a)
  },
  initWidgets: function() {
    var a = this;
    this.led = new LED(this);
    this.led.key = this.name + this.name2 + "value";
    this.led.setPos(6, 4);
    this.led.setSize(100, 38);
    this.led.onInput = function(b) {
      b = parseFloat(b);
      isNaN(b) ? showPopupMsg(lang.WRONG_VALUE) : a.sl.setValue(DBtoVf2(b))
    };
    this.mute = new CheckBox(this);
    this.mute.key = this.name + this.name2 + "mute";
    this.mute.setPos(4, 48);
    this.mute.setSize(102, 29);
    this.mute.setImages(res.bBMuteOff, res.bBMuteOn);
    this.sl = new Slider(this, this.type);
    this.sl.key = this.name + this.name2 + "value";
    this.sl.color = this.color;
    this.sl.setPos(0, 94);
    this.sl.w = this.w;
    this.sl.laneOffset = 36;
    this.sl.faderX = 60;
    this.sl.bottomMargin = 24;
    this.sl.onDouble = function() {
      setMode(E_MODE.MIX)
    };
    this.vu = new VUMeter(this);
    this.vu.setAnchors(21, 109, null, 26);
    this.clip = new ClipBulb(this);
    this.clip.setPos(15, 87)
  },
  paint: function() {
    fxStripCacheH != this.h && this.cachePaint();
    ctx.drawImage(fxStripCache, 0, 0, this.w, this.h);
    selectedStrip.id == this.id && (ctx.globalAlpha = .06, ctx.fillStyle = "#fff", ctx.fillRect(1, 0, this.w - 2, this.h), ctx.globalAlpha = 1);
    ctx.fillStyle = this.color;
    ctx.fillRect(0 + (this.firstInGroup ?
      2 : 0), this.h - 3, this.w - (this.firstInGroup ? 2 : 0) - (this.lastInGroup ? 2 : 0), 3);
    ctx.textAlign = "left";
    ctx.font = font.stripChannel;
    ctx.fillStyle = color.stripChLabel;
    ctx.setShadow(color.black, 3, 1, 1);
    ctx.fillText(this.text, 11, this.h - 10);
    ctx.shadowColor = "transparent"
  },
  DRAW_UPDATE_CHECK: function() {
    var a;
    a = this.getName2Value("value");
    var b = this.getName2Value("mute"),
      c = this.getNameValue("stereoIndex");
    a = "" + a + b + this.clip.state + c + (selectedStrip.id == this.id);
    if (a === this.CACHED_PARAMS) return !1;
    this.CACHED_PARAMS = a;
    return !0
  },
  cachePaint: function() {
    fxStripCache = document.createElement("canvas");
    var a = fxStripCache.getContext("2d");
    isRetina ? (fxStripCache.width = 2 * this.w, fxStripCache.height = 2 * this.h, a.scale(2, 2)) : (fxStripCache.width = this.w, fxStripCache.height = this.h);
    a.fillStyle = "#15171C";
    a.fillRect(0, 0, this.w, this.h);
    fillVertPatternCtx(res.auxStripTile, this.h, a);
    drawImageCtx(res.auxStripBottom, 0, this.h - res.auxStripBottom.h(), a);
    drawImageCtx(res.auxStripTop, 0, 0, a);
    drawMarksDB(this.sl.h, 94, 100, a);
    drawVUMarks(this.vu, null, a);
    fxStripCacheH = this.h
  }
});
auxStripCache = null;
auxStripCacheH = -1;
var AUXStrip = Class.create(Widget, {
  initialize: function($super, b, c, d, f) {
    $super(b);
    this.CACHED_DRAWING = CACHE_TECHNOLOGIES;
    this.id = c;
    this.widgetName = "AUXStrip";
    this.name = d;
    this.name2 = f;
    this.w = measures.mixerStripWidth;
    this.x = this.w * c;
    this.st = null;
    this.text = "CH X";
    this.mode = 0;
    this.color = b.color;
    this.pre = this.lastInGroup = this.firstInGroup = !1;
    this.initWidgets()
  },
  setMode: function(a) {
    this.mode = a;
    this.name2 = a = "aux." + a + ".";
    a = this.name + a;
    this.led.setKey(a + "value");
    this.led.keyPrefix = a;
    this.pan.setKey(a + "pan");
    this.mute.setKey(a + "mute");
    this.post.setKey(a + "post");
    this.sl.setKey(a + "value");
    this.postproc && this.postproc.setKey(a + "postproc");
    this.vu.reset();
    regUpdate(this)
  },
  calcGeometry: function() {
    this.h = this.parent.h
  },
  setVU: function(a, b) {
    var c = 0 == this.post.state,
      c = 0 == this.mute.state ? modVu(c ? a : b, this.sl.value) : 0;
    1 <= c ? this.clip.clip() : this.clip.state && !this.clip.releasing && this.clip.release();
    this.vu.setValueExt(a, c)
  },
  setNameValue: function(a, b) {
    setValue(this.name + a, b)
  },
  setName2Value: function(a, b) {
    setValue(this.name +
      this.name2 + a, b)
  },
  getNameValue: function(a) {
    return getValue(this.name + a)
  },
  getName2Value: function(a) {
    return getValue(this.name + this.name2 + a)
  },
  getMuteState: function(a) {
    a = isDefined(a) ? a : this.mode;
    var b = getValue("settings.auxmutelink"),
      c = this.name + ("aux." + a + ".");
    a = getValue(c + "mute");
    c = getValue(c + "post");
    (b || c) && par.st.getMuteState() && (a = 1);
    return a
  },
  initWidgets: function() {
    var a = this;
    this.led = new LED(this);
    this.led.key = this.name + this.name2 + "value";
    this.led.keyPrefix = this.name + this.name2;
    this.led.setPos(6,
      4);
    this.led.setSize(100, 38);
    this.led.onInput = function(b) {
      b = parseFloat(b);
      isNaN(b) ? showPopupMsg(lang.WRONG_VALUE) : a.sl.setValue(DBtoVf2(b))
    };
    this.pan = new PanSlider(this);
    this.pan.key = this.name + this.name2 + "pan";
    this.pan.disabled = !0;
    this.pan.setPos(5, 46);
    this.pan.setSize(102, 30);
    this.pan.onDisabledClick = function() {
      showPopupMsg(lang.NO_PAN_ON_MONO_AUX)
    };
    this.pan.getState = function() {
      this.disabled = -1 == auxStrips[a.parent.auxID].getNameValue("stereoIndex")
    };
    this.mute = new CheckBox(this);
    this.mute.setPos(4,
      88);
    this.mute.setImages(res.bMuteOff, res.bMuteOn);
    this.mute.getState = function() {
      this.state = a.getName2Value("mute");
      this.disabled = !1;
      var b = getValue("settings.auxmutelink"),
        c = a.getName2Value("post");
      (b || c) && a.st.getMuteState() && (this.state = 1, this.disabled = !0)
    };
    this.post = new CheckBox(this);
    this.post.key = this.name + this.name2 + "post";
    this.post.longClickMark = !0;
    this.post.clickOnUp = !0;
    this.post.setPos(58, 88);
    this.post.setSize(50, 37);
    this.post.setImages(res.bPre, res.bPost);
    this.post.onHold = function() {
      var b =
        0 == this.state ? 0 : 1,
        c = a.name2;
      confOk.valueFunc = function() {
        for (var a = 0; a < allStrips.length; a++) {
          switch (allStrips[a].type) {
            case E_STRIP_TYPE.IN:
            case E_STRIP_TYPE.MEDIA:
            case E_STRIP_TYPE.LINEIN:
            case E_STRIP_TYPE.FX:
              break;
            default:
              continue
          }
          allStrips[a].setNameValue(c + "post", b);
          updateByKey(allStrips[a].name + c + "post")
        }
      };
      showConfBox(lang.SET_ALL_CHANNELS_TO.format(b ? lang.POST : lang.PRE))
    };
    IS_UI_24 && (this.postproc = new CheckBox(this), this.postproc.key = this.name + this.name2 + "postproc", this.postproc.longClickMark = !0, this.postproc.clickOnUp = !0, this.postproc.setPos(4, 131), this.postproc.setSize(50, 37), this.postproc.invertedValue = !0, this.postproc.setImages(res.postproc, res.preproc), this.postproc.onHold = function() {
      var a = 0 == this.state ? 0 : 1;
      confOk.valueFunc = function() {
        for (var b = 0; b < auxSendStrips.length; b++) auxSendStrips[b].setName2Value("postproc", a), regUpdate(auxSendStrips[b])
      };
      showConfBox(lang.SET_ALL_CHANNELS_TO.format(a ? lang.POST_PROCESSING : lang.PRE_PROCESSING))
    });
    this.sl = new Slider(this, this.type);
    this.sl.key =
      this.name + this.name2 + "value";
    this.sl.color = this.color;
    this.sl.setPos(0, 134);
    this.sl.w = this.w;
    this.sl.laneOffset = 36;
    this.sl.faderX = 60;
    this.sl.bottomMargin = 24;
    this.sl.onDouble = function() {
      setMode(E_MODE.MIX)
    };
    this.vu = new VUMeter(this);
    this.vu.setAnchors(21, IS_UI_24 ? 193 : 149, null, 26);
    this.clip = new ClipBulb(this);
    this.clip.setPos(15, IS_UI_24 ? 171 : 127)
  },
  DRAW_UPDATE_CHECK: function() {
    var a;
    a = -1 != settings.me.indexOf(this.id);
    var b = this.getName2Value("pan"),
      c = this.getName2Value("value"),
      d = this.getName2Value("mute"),
      f = this.getNameValue("mute"),
      e = this.getName2Value("post"),
      g = this.getName2Value("postproc"),
      h = this.clip.state,
      l = this.getNameValue("stereoIndex");
    a = "" + c + b + d + f + e + g + a + h + l + (selectedStrip.id == this.id);
    if (a === this.CACHED_PARAMS) return !1;
    this.CACHED_PARAMS = a;
    return !0
  },
  paint2: function() {
    ctx.fillStyle = "#15171C";
    ctx.fillRect(0, 0, this.w, this.h);
    fillVertPattern(res.stripTile, this.h);
    drawImage(res.stripBottom, 0, this.h - res.stripBottom.h());
    drawImage(res.stripTop, 0, 0);
    ctx.fillStyle = this.color;
    ctx.fillRect(0 + (this.firstInGroup ?
      2 : 0), this.h - 3, this.w - (this.firstInGroup ? 2 : 0) - (this.lastInGroup ? 2 : 0), 3);
    ctx.textAlign = "left";
    ctx.font = font.stripChannel;
    ctx.fillStyle = color.stripChLabel;
    ctx.fillText(this.text, 11, this.h - 10);
    this.drawMarks(ctx)
  },
  paint: function() {
    auxStripCacheH != this.h && this.cachePaint();
    ctx.drawImage(auxStripCache, 0, 0, this.w, this.h);
    this.sl.color = 0 == getValue(this.name + this.name2 + "post") ? color.AUX : color.green;
    selectedStrip.id == this.id && (ctx.globalAlpha = .06, ctx.fillStyle = "#fff", ctx.fillRect(1, 0, this.w - 2, this.h), ctx.globalAlpha =
      1);
    var a = this.getNameValue("stereoIndex"),
      b = !1;
    settings.me.contains(this.id) && (b = !0);
    0 == a && settings.me.contains(this.id + 1) && (b = !0);
    1 == a && settings.me.contains(this.id - 1) && (b = !0);
    ctx.fillStyle = this.color;
    ctx.fillRect(0 + (this.firstInGroup ? 2 : 0), this.h - 3, this.w - (this.firstInGroup ? 2 : 0) - (this.lastInGroup ? 2 : 0), 3);
    ctx.textAlign = "left";
    ctx.font = font.stripChannel;
    ctx.fillStyle = b ? color.me : color.stripChLabel;
    ctx.fillText(this.text, 11, this.h - 10);
    ctx.shadowColor = "transparent"
  },
  cachePaint: function() {
    auxStripCache =
      document.createElement("canvas");
    var a = auxStripCache.getContext("2d");
    isRetina ? (auxStripCache.width = 2 * this.w, auxStripCache.height = 2 * this.h, a.scale(2, 2)) : (auxStripCache.width = this.w, auxStripCache.height = this.h);
    a.fillStyle = "#15171C";
    a.fillRect(0, 0, this.w, this.h);
    fillVertPatternCtx(res.stripTile, this.h, a);
    drawImageCtx(res.stripBottom, 0, this.h - res.stripBottom.h(), a);
    drawImageCtx(res.stripTop, 0, 0, a);
    drawMarksDB(this.sl.h, 134, 100, a);
    drawVUMarks(this.vu, null, a);
    auxStripCacheH = this.h
  }
});
mtxStripCache = null;
mtxStripCacheH = -1;
var MTXStrip = Class.create(Widget, {
    initialize: function($super, b, c, d, f) {
      $super(b);
      this.CACHED_DRAWING = CACHE_TECHNOLOGIES;
      this.id = c;
      this.widgetName = "MTXStrip";
      this.name = d;
      this.name2 = f;
      this.w = measures.mixerStripWidth;
      this.x = this.w * c;
      this.text = "CH X";
      this.color = color.MATRIX;
      this.pre = this.rr = this.lastInGroup = this.firstInGroup = !1;
      this.initWidgets()
    },
    calcGeometry: function() {
      this.h = this.parent.h
    },
    setMode: function(a) {
      var b = this.name;
      a = "mtx." + a + ".";
      this.rr && (a += "r.");
      this.name2 = a;
      var c = b + a;
      this.led.setKey(c +
        "value");
      this.led.keyPrefix = b + a;
      this.pan.setKey(c + "pan");
      this.mute.setKey(c + "mute");
      this.sl.setKey(c + "value");
      this.vu.reset()
    },
    setVU: function(a, b) {
      var c = 0 == this.mute.state ? modVu(b, this.sl.value) : 0;
      1 <= c ? this.clip.clip() : this.clip.state && !this.clip.releasing && this.clip.release();
      this.vu.setValueExt(a, c)
    },
    setNameValue: function(a, b) {
      setValue(this.name + a, b)
    },
    setName2Value: function(a, b) {
      setValue(this.name + this.name2 + a, b)
    },
    getNameValue: function(a) {
      return getValue(this.name + a)
    },
    getName2Value: function(a, b) {
      return getValue(this.name +
        this.name2 + a)
    },
    initWidgets: function() {
      var a = this;
      this.led = new LED(this);
      this.led.key = this.name + this.name2 + "value";
      this.led.keyPrefix = this.name + this.name2;
      this.led.setPos(6, 4);
      this.led.setSize(100, 38);
      this.pan = new PanSlider(this);
      this.pan.key = this.name + this.name2 + "pan";
      this.pan.disabled = !0;
      this.pan.setPos(5, 46);
      this.pan.setSize(102, 30);
      this.pan.onDisabledClick = function() {
        showPopupMsg(lang.NO_PAN_ON_MONO_MATRIX)
      };
      this.pan.getState = function() {
        this.disabled = -1 == auxStrips[a.parent.auxID].getNameValue("stereoIndex")
      };
      this.mute = new CheckBox(this);
      this.mute.key = this.name + this.name2 + "mute";
      this.mute.setPos(4, 88);
      this.mute.setImages(res.bMuteOff, res.bMuteOn);
      this.sl = new Slider(this, this.type);
      this.sl.key = this.name + this.name2 + "value";
      this.sl.color = color.MATRIX;
      this.sl.setPos(0, 134);
      this.sl.w = this.w;
      this.sl.laneOffset = 36;
      this.sl.faderX = 60;
      this.sl.bottomMargin = 24;
      this.sl.onDouble = function() {
        setMode(E_MODE.MIX)
      };
      this.vu = new VUMeter(this);
      this.vu.setAnchors(21, 149, null, 26);
      this.clip = new ClipBulb(this);
      this.clip.setPos(15,
        127)
    },
    DRAW_UPDATE_CHECK: function() {
      var a;
      a = this.getName2Value("pan");
      var b = this.getName2Value("value"),
        c = this.getName2Value("mute");
      a = [b, a, c];
      if (!this.CACHED_PARAMS.length) return this.CACHED_PARAMS = a, !0;
      if (a.equals(this.CACHED_PARAMS)) return !1;
      this.CACHED_PARAMS = a;
      return !0
    },
    paint2: function() {
      ctx.fillStyle = "#15171C";
      ctx.fillRect(0, 0, this.w, this.h);
      fillVertPattern(res.stripTile, this.h);
      drawImage(res.stripBottom, 0, this.h - res.stripBottom.h());
      drawImage(res.stripTop, 0, 0);
      ctx.fillStyle = this.color;
      ctx.fillRect(0 +
        (this.firstInGroup ? 2 : 0), this.h - 3, this.w - (this.firstInGroup ? 2 : 0) - (this.lastInGroup ? 2 : 0), 3);
      ctx.textAlign = "left";
      ctx.font = font.stripChannel;
      ctx.fillStyle = color.stripChLabel;
      ctx.fillText(this.text, 11, this.h - 10);
      this.drawMarks(ctx)
    },
    paint: function() {
      mtxStripCacheH != this.h && this.cachePaint();
      ctx.drawImage(mtxStripCache, 0, 0, this.w, this.h);
      selectedStrip.id == this.id && (ctx.globalAlpha = .06, ctx.fillStyle = "#fff", ctx.fillRect(1, 0, this.w - 2, this.h), ctx.globalAlpha = 1);
      var a = this.getNameValue("stereoIndex"),
        b = !1;
      settings.me.contains(this.id) && (b = !0);
      0 == a && settings.me.contains(this.id + 1) && (b = !0);
      1 == a && settings.me.contains(this.id - 1) && (b = !0);
      ctx.fillStyle = this.color;
      ctx.fillRect(this.firstInGroup ? 2 : 0, this.h - 3, this.w - (this.firstInGroup ? 2 : 0) - (this.lastInGroup ? 2 : 0), 3);
      ctx.textAlign = "left";
      ctx.font = font.stripChannel;
      ctx.fillStyle = b ? color.me : color.stripChLabel;
      ctx.fillText(this.text, 11, this.h - 10);
      ctx.shadowColor = "transparent"
    },
    cachePaint: function() {
      mtxStripCache = document.createElement("canvas");
      var a = mtxStripCache.getContext("2d");
      isRetina ? (mtxStripCache.width = 2 * this.w, mtxStripCache.height = 2 * this.h, a.scale(2, 2)) : (mtxStripCache.width = this.w, mtxStripCache.height = this.h);
      a.fillStyle = "#15171C";
      a.fillRect(0, 0, this.w, this.h);
      fillVertPatternCtx(res.stripTile, this.h, a);
      drawImageCtx(res.stripBottom, 0, this.h - res.stripBottom.h(), a);
      drawImageCtx(res.stripTop, 0, 0, a);
      a.globalAlpha = .07;
      a.fillStyle = this.color;
      a.fillRect(0, 0, this.w, this.h);
      a.globalAlpha = 1;
      drawMarksDB(this.sl.h, 134, 100, a);
      drawVUMarks(this.vu, null, a);
      mtxStripCacheH = this.h
    }
  }),
  AUXOUTStrip = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "AUX_OUT";
      this.y = measures.topWidgetHeight;
      this.w = measures.masterStripWidth;
      this.botLabelHeight = res.mStripBottomLabel.h();
      this.botHeight = res.mStripBottom.h();
      this.color = color.AUX;
      this.stereo = !1;
      this.idx = 0;
      this.label = "AUX_OUT";
      this.text = "AUX";
      this.holdTimer = this.t = null;
      this.initWidgets()
    },
    onShow: function() {
      this.setAux(auxWidget.mode)
    },
    setVU: function(a, b, c, d) {
      1 <= b ? this.clip.clip() : this.clip.state && !this.clip.releasing &&
        this.clip.release();
      this.vu.setValueExt(a, b);
      settings.disableVUs2 || (this.gr.setValue(c), this.gi.setValue(d))
    },
    setAux: function(a) {
      this.idx = a;
      this.vu.reset();
      this.t = auxStrips[a];
      this.name = a = "a." + a + ".";
      this.led.key = a + "mix";
      this.sl.key = a + "mix";
      this.solo.key = a + "solo";
      this.label = lang.AUX + " " + (this.idx + 1) + " " + lang.SEND;
      this.text = "AUX " + (this.idx + 1);
      regUpdate(this)
    },
    initWidgets: function() {
      var a = this;
      this.MIXTOAUX = new Button(this);
      this.MIXTOAUX.setPos(4, 5);
      this.MIXTOAUX.setImages(res.bMTA_OFF, res.bMTA_ON);
      this.MIXTOAUX.getState = function() {
        a.t && (this.disabled = 1 == a.t.getNameValue("matrix"))
      };
      this.MIXTOAUX.onPress = function() {
        isBlocked("auxlvl", auxWidget.mode) ? showPopupMsg(lang.LOCKED, 1E3) : (confOk.valueFunc = function() {
          copyMixToAux(auxWidget.mode)
        }, showConfBox(lang.COPY_MIX_TO_AUX))
      };
      this.led = new LED(this);
      this.led.setPos(6, 44);
      this.led.setSize(115, 38);
      this.led.color = color.mLedText;
      this.led.onInput = function(b) {
        b = parseFloat(b);
        isNaN(b) ? showPopupMsg(lang.WRONG_VALUE) : a.sl.setValue(DBtoVf2(b))
      };
      this.led.onDouble =
        function() {
          setValue(a.sl.key, zeroDbPos);
          updateByKey(a.sl.key)
        };
      this.sl = new Slider(this, E_STRIP_TYPE.AUX);
      this.sl.setPos(0, 134);
      this.sl.canScroll = !1;
      this.sl.w = this.w;
      this.sl.laneOffset = 34;
      this.sl.faderX = 77;
      this.sl.bottomMargin = 58;
      this.sl.lane = !1;
      this.sl.onDoubleKnob = function() {
        isPortrait || (mode == E_MODE.MOREME && setMode(E_MODE.AUX), setSelected(a.t.id), editWidget.setMode(editWidget.arr[0]), setMode(E_MODE.EDIT))
      };
      this.sl.getState = function() {
        this.fader = 1 == a.t.getNameValue("matrix") ? res.mtxFader : res.auxFader
      };
      this.mute = new CheckBox(this);
      this.mute.setPos(4, 88);
      this.mute.setImages(res.mStripMute_OFF, res.mStripMute_ON);
      this.mute.getState = function() {
        this.state = a.t.getNameValue("mute");
        var b = getValue("mgmask"),
          d = a.t.getNameValue("mgmask"),
          f = checkBit(b, MUTEALL_BIT_IDX),
          e = checkBit(b, MUTEFX_BIT_IDX) && a.t.type == E_STRIP_TYPE.FX;
        if (b & d || f || e) this.state = 1;
        1 == a.t.getNameValue("forceunmute") ? (this.state = 0, this.img0 = res.mStripMute_OFF_F) : this.img0 = res.mStripMute_OFF
      };
      this.mute.onToggleUp = function() {
        var b = getValue("mgmask"),
          d = a.t.getNameValue("mgmask"),
          d = b & d,
          f = checkBit(b, MUTEALL_BIT_IDX),
          b = checkBit(b, MUTEFX_BIT_IDX) && a.t.type == E_STRIP_TYPE.FX;
        d || f || b ? a.t.setNameValue("forceunmute", 0) : a.t.setNameValue("mute", 1)
      };
      this.mute.onToggleDown = function() {
        var b = getValue("mgmask"),
          d = a.t.getNameValue("mgmask"),
          d = b & d,
          f = checkBit(b, MUTEALL_BIT_IDX),
          b = checkBit(b, MUTEFX_BIT_IDX) && a.t.type == E_STRIP_TYPE.FX;
        d || f || b ? a.t.setNameValue("forceunmute", 1) : a.t.setNameValue("mute", 0)
      };
      this.mute.onToggle = function() {
        checkMutes()
      };
      this.solo = new CheckBox(this);
      this.solo.setPos(67, 88);
      this.solo.setImages(res.mStripSolo_OFF, res.mStripSolo_ON);
      this.solo.onToggle = function() {
        checkSolos()
      };
      this.solo.onToggleUp = function() {
        if (0 == getValue("settings.multiplesolo"))
          for (var b = 0; b < allStrips.length; b++) allStrips[b].setNameValue("solo", 0);
        a.t.setNameValue("solo", 1)
      };
      var b = 101 + measures.bottomWidgetHeight;
      this.clip = new ClipBulb(this);
      this.clip.setPos(21, 127);
      this.vu = new VUMeter(this);
      this.vu.setAnchors(27, 149, null, settings.disableVUs2 ? 59 : b);
      settings.disableVUs2 || (this.gi =
        new GATEind(this), this.gi.x = 27, this.gr = new GRMeter(this), this.gr.x = 27)
    },
    onDown: function(a, b) {
      this.globalX();
      var c = this;
      if (b - this.globalY() > this.h - 32) {
        var d = Date.now();
        if (d - this.lastClickTime < DBL_CLK_TIME) isPortrait || (mode != E_MODE.EDIT ? setMode(E_MODE.EDIT) : setMode(lastMode), this.lastClickTime = d - DBL_CLK_TIME);
        else {
          var f = this.t;
          this.holdTimer = setTimeout(function() {
            if (mode != E_MODE.MOREME) {
              var a = new STRIPMENU(null, f);
              a.x = bound(c.globalX(), 0, screenWidth - a.w);
              a.y = screenHeight - a.h - measures.bottomWidgetHeight;
              mWidgets.push(widgets.pop());
              regUpdate(a)
            }
          }, HOLD_TIME);
          this.t && setSelected(this.t.id, !0);
          this.lastClickTime = d;
          regUpdate(this)
        }
      }
    },
    onUp: function() {
      clearTimeout(this.holdTimer)
    },
    calcGeometry: function() {
      this.x = screenWidth - this.w;
      masterWidget.enabled && (this.x -= masterWidget.w);
      slideOutWidget.enabled && (this.x -= slideOutWidget.w);
      this.y = topWidget.enabled ? topWidget.h : 0;
      this.h = screenHeight - this.y;
      settings.disableVUs2 || (this.gr.y = this.h - this.gr.h - 26 - measures.bottomWidgetHeight, this.gi.y = this.gr.y - 13)
    },
    paint: function() {
      ctx.fillStyle =
        color.bg;
      ctx.fillRect(0, 0, this.w, this.h);
      fillVertPattern(res.mStripTile, this.h);
      drawImage(res.mStripBottom, 0, this.h - this.botHeight - this.botLabelHeight);
      drawImage(res.mAUXStripTop, 0, 0);
      drawImage(res.mStripBottomLabel, 0, this.h - this.botLabelHeight);
      ctx.globalAlpha = .05;
      ctx.fillStyle = color.AUX;
      ctx.fillRect(0, 0, this.w, this.h);
      ctx.globalAlpha = 1;
      ctx.fillStyle = this.color;
      ctx.fillRect(2, this.h - 3 - this.botLabelHeight, this.w - 4, 3);
      ctx.fillStyle = color.gradMBL;
      ctx.fillRect(2, this.h - 3 - this.botLabelHeight, this.w - 4,
        3);
      ctx.fillStyle = this.color;
      var a = selectedChannel == this.t.id;
      a && ctx.fillRect(2, this.h - this.botLabelHeight, this.w - 4, 35);
      ctx.font = font.botMChLabel;
      ctx.textAlign = "center";
      var b = this.t.getName();
      ctx.fillStyle = color.black;
      ctx.fillText(b, this.w / 2 + 4 | 0, this.h - 10 + 1, this.w - 10);
      ctx.fillStyle = a ? color.white : color.masterLabel;
      ctx.fillText(b, this.w / 2 + 3 | 0, this.h - 10, this.w - 10);
      ctx.font = font.stripChannel;
      ctx.textAlign = "left";
      a = this.t.getNameValue("matrix") ? lang.MTX + " " + (this.t.subId + 1) : lang.AUX + " " + (this.t.subId + 1);
      b = getValue(this.name + "stereoIndex");
      0 == b ? a += "L" : 1 == b && (a += "R");
      var c = !1;
      settings.meout == this.idx && (c = !0);
      0 == b && settings.meout == this.idx + 1 && (c = !0);
      1 == b && settings.meout == this.idx - 1 && (c = !0);
      ctx.fillStyle = c ? color.me : color.stripChLabel;
      ctx.fillText(a, 11, this.h - 10 - measures.bottomWidgetHeight);
      ctx.shadowColor = "transparent";
      drawVUMarks(this.vu, this.gr, ctx);
      drawMarksDB(this.sl.h, 134, 117);
      b = getValue("mgmask");
      a = this.t.getNameValue("mgmask") & b;
      b &= 1 << MUTEALL_BIT_IDX;
      c = this.t.getNameValue("forceunmute");
      ctx.fillStyle =
        c ? color.tvMuteUn : color.tvMuteMG;
      if (b || a) {
        ctx.textAlign = "center";
        ctx.font = "10pt open_sans_condensedbold";
        c = 0;
        b && ctx.fillText("A", 12, 137 + 16 * c++);
        if (a)
          for (b = 0; 6 > b; b++) a & 1 << b && ctx.fillText(b + 1 + "", 12, 137 + 16 * c++);
        1 == this.t.getNameValue("mute") && (this.t.getNameValue("forceunmute") && (ctx.fillStyle = "#82C9DE"), ctx.fillText("M", 12, 137 + 16 * c++))
      }
    }
  }),
  FXOUTStrip = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "FX_OUT";
      this.y = measures.topWidgetHeight;
      this.w = measures.masterStripWidth;
      this.botLabelHeight = res.mStripBottomLabel.h();
      this.botHeight = res.mStripBottom.h();
      this.color = color.blue;
      this.stereo = !0;
      this.text = "FXR";
      this.label = "FX";
      this.idx = 0;
      this.initWidgets()
    },
    initWidgets: function() {
      var a = this;
      this.led = new LED(this);
      this.led.pkey = "mix";
      this.led.setPos(6, 4);
      this.led.setSize(115, 38);
      this.led.color = color.mLedText;
      this.led.onDouble = function() {
        setValue(a.sl.key, zeroDbPos);
        updateByKey(a.sl.key)
      };
      this.led.onInput = function(b) {
        b = parseFloat(b);
        isNaN(b) ? showPopupMsg(lang.WRONG_VALUE) :
          a.sl.setValue(DBtoVf2(b))
      };
      this.pan = new PanSlider(this);
      this.pan.setPos(5, 46);
      this.pan.setSize(117, 30);
      this.mute = new CheckBox(this);
      this.mute.setPos(4, 88);
      this.mute.setImages(res.mStripMute_OFF, res.mStripMute_ON);
      this.mute.getState = function() {
        this.state = a.t.getNameValue("mute");
        var b = getValue("mgmask"),
          d = a.t.getNameValue("mgmask"),
          f = checkBit(b, MUTEALL_BIT_IDX),
          e = checkBit(b, MUTEFX_BIT_IDX) && a.t.type == E_STRIP_TYPE.FX;
        if (b & d || f || e) this.state = 1;
        1 == a.t.getNameValue("forceunmute") ? (this.state = 0, this.img0 =
          res.mStripMute_OFF_F) : this.img0 = res.mStripMute_OFF
      };
      this.mute.onToggleUp = function() {
        var b = getValue("mgmask"),
          d = a.t.getNameValue("mgmask"),
          d = b & d,
          f = checkBit(b, MUTEALL_BIT_IDX),
          b = checkBit(b, MUTEFX_BIT_IDX) && a.t.type == E_STRIP_TYPE.FX;
        d || f || b ? a.t.setNameValue("forceunmute", 0) : a.t.setNameValue("mute", 1)
      };
      this.mute.onToggleDown = function() {
        var b = getValue("mgmask"),
          d = a.t.getNameValue("mgmask"),
          d = b & d,
          f = checkBit(b, MUTEALL_BIT_IDX),
          b = checkBit(b, MUTEFX_BIT_IDX) && a.t.type == E_STRIP_TYPE.FX;
        d || f || b ? a.t.setNameValue("forceunmute",
          1) : a.t.setNameValue("mute", 0)
      };
      this.mute.onToggle = function() {
        checkMutes()
      };
      this.solo = new CheckBox(this);
      this.solo.setPos(67, 88);
      this.solo.setImages(res.mStripSolo_OFF, res.mStripSolo_ON);
      this.solo.onToggle = function() {
        checkSolos()
      };
      this.solo.onToggleUp = function() {
        if (0 == getValue("settings.multiplesolo"))
          for (var b = 0; b < allStrips.length; b++) allStrips[b].setNameValue("solo", 0);
        a.t.setNameValue("solo", 1)
      };
      this.sl = new Slider(this, E_STRIP_TYPE.FX);
      this.sl.setPos(0, 134);
      this.sl.canScroll = !1;
      this.sl.w = this.w;
      this.sl.laneOffset = 34;
      this.sl.faderX = 77;
      this.sl.bottomMargin = 58;
      this.sl.lane = !1;
      var b = 101 + measures.bottomWidgetHeight;
      this.clip = new ClipBulb(this);
      this.clip.setPos(12, 127);
      this.vu = new VUMeter(this);
      this.vu.setAnchors(18, 149, null, settings.disableVUs2 ? 59 : b);
      settings.disableVUs2 || (this.gi = new GATEind(this), this.gi.x = 18, this.gr = new GRMeter(this), this.gr.x = 18, this.gi2 = new GATEind(this), this.gi2.x = 37, this.gr2 = new GRMeter(this), this.gr2.x = 37);
      this.clip2 = new ClipBulb(this);
      this.clip2.setPos(31, 127);
      this.vu2 =
        new VUMeter(this);
      this.vu2.setAnchors(37, 149, null, settings.disableVUs2 ? 59 : b)
    },
    onShow: function() {
      this.setFx(fxSendsWidget.mode)
    },
    setVU: function(a, b, c, d, f, e, g, h) {
      1 <= b ? this.clip.clip() : this.clip.state && !this.clip.releasing && this.clip.release();
      this.vu.setValueExt(a, b);
      1 <= d ? this.clip2.clip() : this.clip2.state && !this.clip2.releasing && this.clip2.release();
      this.vu2.setValueExt(c, d);
      settings.disableVUs2 || (this.gr && this.gr.setValue(f), this.gi && this.gi.setValue(g), this.gr2 && this.gr2.setValue(e), this.gi2 && this.gi2.setValue(h))
    },
    setFx: function(a) {
      this.idx = a;
      this.vu.reset();
      this.vu2.reset();
      this.t = fxStrips[a];
      a = "f." + a + ".";
      this.led.keyPrefix = a;
      this.pan.key = a + "pan";
      this.sl.key = a + "mix";
      this.solo.key = a + "solo";
      this.label = this.t.getName();
      this.text = "FXR " + (this.idx + 1) + "";
      this.holdTimer = null;
      regUpdate(this)
    },
    calcGeometry: function() {
      this.x = screenWidth - this.w;
      masterWidget.enabled && (this.x -= masterWidget.w);
      slideOutWidget.enabled && (this.x -= slideOutWidget.w);
      this.y = topWidget.enabled ? topWidget.h : 0;
      this.h = screenHeight - this.y;
      settings.disableVUs2 ||
        (this.gr.y = this.h - this.gr.h - 26 - measures.bottomWidgetHeight, this.gi.y = this.gr.y - 13, this.gr2.y = this.h - this.gr.h - 26 - measures.bottomWidgetHeight, this.gi2.y = this.gr2.y - 13)
    },
    onDown: function(a, b) {
      var c = a - this.globalX(),
        d = b - this.globalY(),
        f = this;
      this.pressPoint = [c, d];
      if (d > this.h - measures.bottomWidgetHeight)
        if (c = Date.now(), c - this.lastClickTime < DBL_CLK_TIME) editWidget.setMode(editWidget.E_MODE.fx), setMode(E_MODE.EDIT), bottomWidget.gotoIDmid(selectedChannel), this.lastClickTime = c - DBL_CLK_TIME;
        else {
          var e = this.t;
          this.holdTimer = setTimeout(function() {
            var a = new STRIPMENU(null, e);
            a.x = bound(f.globalX(), 0, screenWidth - a.w);
            a.y = screenHeight - a.h - measures.bottomWidgetHeight;
            mWidgets.push(widgets.pop());
            regUpdate(a)
          }, HOLD_TIME);
          this.t && setSelected(this.t.id, !0);
          this.lastClickTime = c;
          regUpdate(this)
        }
    },
    onUp: function() {
      clearTimeout(this.holdTimer)
    },
    paint: function() {
      ctx.fillStyle = color.bg;
      ctx.fillRect(0, 0, this.w, this.h);
      fillVertPattern(res.mStripTile, this.h);
      drawImage(res.mStripTopNCS, 0, 0);
      drawImage(res.mStripBottom, 0, this.h -
        this.botHeight - this.botLabelHeight);
      drawImage(res.mStripBottomLabel, 0, this.h - this.botLabelHeight);
      ctx.globalAlpha = .03;
      ctx.fillStyle = "#99F";
      ctx.fillRect(0, 0, this.w, this.h);
      ctx.globalAlpha = 1;
      ctx.fillStyle = this.color;
      ctx.fillRect(2, this.h - 3 - this.botLabelHeight, this.w - 4, 3);
      ctx.fillStyle = color.gradMBL;
      ctx.fillRect(2, this.h - 3 - this.botLabelHeight, this.w - 4, 3);
      ctx.fillStyle = this.color;
      selectedChannel == this.t.id && ctx.fillRect(2, this.h - this.botLabelHeight, this.w - 4, 35);
      ctx.font = font.botMChLabel;
      ctx.textAlign =
        "center";
      var a = this.t.getName();
      ctx.fillStyle = color.black;
      ctx.fillText(a, this.w / 2 + 1 | 0, this.h - 10 + 1, this.w - 2);
      ctx.fillStyle = color.masterLabel;
      ctx.fillText(a, this.w / 2 | 0, this.h - 10, this.w - 2);
      ctx.font = font.stripChannel;
      ctx.fillStyle = color.stripChLabel;
      ctx.textAlign = "left";
      ctx.fillText(this.text, 11, this.h - 10 - measures.bottomWidgetHeight);
      ctx.shadowColor = "transparent";
      drawVUMarks(this.vu2, this.gr2, ctx);
      drawMarksDB(this.sl.h, 134, 117);
      var b = getValue("mgmask"),
        a = this.t.getNameValue("mgmask") & b,
        c = b & 1 << MUTEALL_BIT_IDX,
        b = this.t.type == E_STRIP_TYPE.FX && b & 1 << MUTEFX_BIT_IDX,
        d = this.t.getNameValue("forceunmute");
      ctx.fillStyle = d ? "#82C9DE" : "#e66";
      if (c || b || a) {
        ctx.textAlign = "center";
        ctx.font = "10pt open_sans_condensedbold";
        d = 0;
        b && ctx.fillText("F", 10, 137 + 16 * d++);
        c && ctx.fillText("A", 10, 137 + 16 * d++);
        if (a)
          for (c = 0; 6 > c; c++) a & 1 << c && ctx.fillText(c + 1 + "", 10, 137 + 16 * d++);
        1 == this.t.getNameValue("mute") && (this.t.getNameValue("forceunmute") && (ctx.fillStyle = "#82C9DE"), ctx.fillText("M", 10, 137 + 16 * d++))
      }
    }
  });

function drawVUMarks(a, b, c) {
  if (a) {
    c = isDefined(c) ? c : ctx;
    c.fillStyle = "rgba(255,255,255,0.35)";
    c.textAlign = "left";
    c.textBaseline = "middle";
    c.font = font.stripMarks;
    var d = a.x + a.w + 2,
      f = [-96, -90, -80, -70, -60, -50, -40, -24, -12, -6, 0],
      e = a.y + 5,
      g = a.h - 9;
    if (70 < g)
      for (a = 0; a < f.length; a++)
        if (!(f[a] < -VU_RANGE)) {
          var h = e + vuPosMark(f[a], g);
          c.fillText(f[a], d, h)
        }
    if (isDefined(b) && null != b)
      for (f = ["1", "5", "10", "20"], h = b.y + 5, dy = (b.h - 9) / (f.length - 1), d = b.x + b.w + 2, a = 0; a < f.length; a++) c.fillText(f[a], d, h | 0), h += dy
  }
}

function drawMarksDB(a, b, c, d) {
  d = isDefined(d) ? d : ctx;
  b = isDefined(b) ? b : 134;
  a = a - 80 + 2;
  if (!(0 > a)) {
    d.fillStyle = "rgba(255,255,255,0.35)";
    d.textAlign = "center";
    d.setShadow(color.black, 0, 2, 1);
    d.font = font.stripMarks;
    for (var f = [1, zeroDbPos, .5276, .1834, .0572, 0], e = 0; e < f.length; e++) 0 == f[e] && (d.font = "bold 11px sans serif");
    d.shadowColor = "transparent";
    var f = [1, .8932, .6327, .5276, .3746, .1834, .0572, 0],
      g = d.createLinearGradient(c - 8, 0, c - 8 + 8, 0);
    g.addColorStop(1, "rgba(255,255,255,0.13)");
    g.addColorStop(.5, "rgba(255,255,255,0.22)");
    g.addColorStop(0, "rgba(255,255,255,0.3)");
    var h = d.createLinearGradient(c - 8, 0, c - 8 + 12, 0);
    h.addColorStop(1, "rgba(255,255,255,0.16)");
    h.addColorStop(.5, "rgba(255,255,255,0.22)");
    h.addColorStop(0, "rgba(255,255,255,0.3)");
    for (e = 0; e < f.length; e++) {
      var l = Math.round(a * (1 - f[e]) + 35 - 1);
      d.fillStyle = g;
      d.fillRect(c - 8, b + l + 1, 10, 1)
    }
    l = a * (1 - zeroDbPos) + 35 - 2;
    d.fillStyle = h;
    d.fillRect(c - 8, b + l, 12, 3)
  }
}

function vuPosMark(a, b) {
  return -a * b / VU_RANGE + .45 | 0
}

function drawMarksVU(a, b, c, d) {
  d = isDefined(d) ? d : ctx;
  b = (isDefined(b) ? b : 24) + 4;
  a -= 4;
  d.fillStyle = "rgba(255,192,128,0.5)";
  d.textAlign = "right";
  d.shadowColor = "transparent";
  d.font = "9px sans serif";
  --c;
  for (var f = [-96, -90, -80, -70, -60, -50, -40, -24, -12, -6, 0], e = 0; e < f.length; e++)
    if (!(f[e] < -VU_RANGE)) {
      var g = vuPosMark(f[e], a) + 4;
      d.fillText(f[e] + "-", c, b + g)
    }
  d.shadowColor = "transparent"
}

function copyMixToAux(a) {
  var b = !1; - 1 != auxStrips[a].getNameValue("stereoIndex") && (b = !0);
  for (var c = 0; c < allStrips.length; c++) {
    var d = allStrips[c];
    switch (d.type) {
      case E_STRIP_TYPE.SUB:
      case E_STRIP_TYPE.AUX:
        continue
    }
    setValue(d.name + "aux." + a + ".value", d.getNameValue("mix"));
    b && setValue(d.name + "aux." + a + ".pan", d.getNameValue("pan"))
  }
  drawAll()
}

function checkSolos() {
  regUpdate(masterWidget)
}

function checkMutes() {
  mode == E_MODE.EDIT && editWidget.mode == editWidget.E_MODE.aux && regUpdate(editWidget);
  regUpdate(masterWidget)
}
mPanGrad = panGrad = null;
scrollLock = mixerTouches = 0;
var Slider = Class.create(Widget, {
    initialize: function($super, b, c) {
      $super(b);
      this.widgetName = "Slider";
      this.id = this.parent.id;
      this.key = null;
      this.type = c;
      this.param = null;
      switch (c) {
        case E_STRIP_TYPE.IN:
          this.fader = res.fader;
          this.color = color.INPUT;
          break;
        case E_STRIP_TYPE.MASTER:
          this.fader = res.redFader;
          this.color = "transparent";
          break;
        case E_STRIP_TYPE.FX:
          this.fader = res.blueFader;
          this.color = color.blue;
          break;
        case E_STRIP_TYPE.AUX:
          this.fader = res.auxFader;
          this.color = color.AUX;
          break;
        case E_STRIP_TYPE.SUB:
          this.fader =
            res.subFader;
          this.color = color.sub;
          break;
        case E_STRIP_TYPE.MEDIA:
        case E_STRIP_TYPE.LINEIN:
          this.fader = res.fader;
          this.color = color.media;
          break;
        default:
          this.fader = res.fader, this.color = "#ffffff"
      }
      this.x = this.w = 0;
      this.y = 90;
      this.laneOffset = this.faderX = this.bottomMargin = 0;
      this.needMoveEvt = this.redrawParent = !0;
      this.oldValue = this.value = this.lastClickTime = 0;
      this.faderH = this.fader.h() - 12;
      this.faderW = this.fader.w();
      this.slide = this.pressed = !1;
      this.touchID = -1;
      this.linked = !1;
      this.canScroll = !0;
      this.dy = 0;
      this.lastPressPoint = [-1, -1];
      this.locked = settings.masterLock;
      this.hist = [0, 0];
      this.master = !1;
      this.lane = !0;
      this.noUp = !1;
      this.noUpValue = 1;
      this.slowMode = this.hideOnDisabled = this.disabled = !1;
      this.slowValue = 10;
      this.holdTime = 1E3;
      this.noFocus = this.noStereoArrows = !1;
      this.latchArr = null;
      this.latch = !1;
      this.latchStep = 0
    },
    calcGeometry: function() {
      this.h = this.parent.h - this.y - this.bottomMargin
    },
    onDown: function(a, b, c) {
      mixerTouches++;
      var d = this;
      clearTimeout(this.holdTimer);
      this.currentPoint = [a, b];
      if (!this.disabled && !this.pressed) {
        this.pressed = !0;
        this.touchID = c;
        var f = this.globalX() + this.faderX,
          e = this.globalY() + (this.h - this.faderH) * (1 - this.getVal()),
          e = e | 0;
        this.slide = f - 10 <= a && f + this.faderW + 10 + 5 >= a && e - 10 <= b && e + this.faderH + 10 >= b;
        this.lastPressPoint = this.pressPoint;
        this.pressPoint = [a, b];
        if (this.slide) {
          this.holdTimer = setTimeout(function() {
            var a = Math.abs(d.pressPoint[1] - d.currentPoint[1]);
            if (5 > Math.abs(d.pressPoint[0] - d.currentPoint[0]) && 5 > a) d.onhold()
          }, this.holdTime);
          scrollLock++;
          this.oldValue = this.getVal();
          if (1 == scrollLock) this.onFocus();
          this.ondown()
        }
        this.master &&
          settings.masterLock ? (this.locked = !0, this.slide = !1) : this.locked = !1
      }
      this.canScroll && bottomWidget.startScroll(a, c)
    },
    onMove: function(a, b, c) {
      this.currentPoint = [a, b];
      if (!this.locked) {
        if (!this.disabled && this.touchID == c && this.slide) {
          b -= this.pressPoint[1];
          this.dy = Math.abs(b);
          var d = b / (this.h - this.faderH);
          this.slowMode && (d /= this.slowValue);
          d = bound(this.oldValue - d, 0, 1);
          if (this.noUp && d > this.noUpValue && 0 > b) return;
          this.setVal(d);
          this.onValue();
          regUpdate(this)
        }
        this.canScroll && bottomWidget.setScroll(a, c)
      }
    },
    onUp: function(a) {
      mixerTouches--;
      this.canScroll && bottomWidget.endScroll(a);
      if (!this.disabled && this.touchID == a)
        if (this.onup(), clearTimeout(this.holdTimer), this.locked) 0 < scrollLock && scrollLock--, this.pressed = !1, this.touchID = -1, this.slide = !1, regUpdate(this);
        else {
          this.slide && (this.oldValue = 0, scrollLock--);
          a = Date.now();
          var b = Math.abs(this.lastPressPoint[1] - this.pressPoint[1]);
          if (15 > Math.abs(this.lastPressPoint[0] - this.pressPoint[0]) && 15 > b && a - this.lastClickTime < DBL_CLK_TIME) {
            if (this.slide) this.onDoubleKnob();
            else this.onDouble();
            this.lastClickTime =
              a - DBL_CLK_TIME
          } else this.lastClickTime = a;
          this.pressed = !1;
          this.touchID = -1;
          this.slowMode && regUpdate(this);
          this.slide = this.slowMode = !1;
          this.master && settings.masterLock && (this.locked = !0)
        }
    },
    onhold: function() {
      settings.nudge && (this.slowMode = !0, regUpdate(this))
    },
    onWheel: function(a) {
      if (!(this.disabled || this.master && settings.masterLock)) {
        var b = this.getVal(),
          c = a / 120 / 30;
        this.latch && this.latchStep && (c = this.latchStep * (0 > a ? -1 : 1));
        b = bound(b + c, 0, 1);
        this.noUp && b > this.noUpValue || (this.setVal(b), this.onValue(), regUpdate(this))
      }
    },
    setVal: function($super, b) {
      var c = b;
      if (this.latch && this.latchArr)
        for (var d = 0, f = this.latchArr.length; d < f; d++) b >= this.latchArr[d] && (c = this.latchArr[d]);
      $super(c)
    },
    ondown: function() {
      this.C_CH = !1;
      this.parent.CACHED_DRAWING && (this.parent.CACHED_DRAWING = !1, this.C_CH = !0)
    },
    onup: function() {
      this.C_CH && (this.parent.CACHED_DRAWING = !0)
    },
    setValue: function(a) {
      this.setVal(a);
      this.onValue();
      regUpdate(this)
    },
    onDouble: function() {},
    onDoubleKnob: function() {},
    onFocus: function() {
      this.noFocus || !isDefined(this.parent.id) ||
        -1 == this.parent.id && mode == E_MODE.EDIT || bottomWidget.setSelected(this.parent.id)
    },
    onValue: function() {},
    getState: function() {},
    paint: function() {
      this.getState();
      this.value = this.getVal();
      var a = (this.h - this.faderH) * (1 - this.value),
        a = a | 0;
      this.disabled && (ctx.globalAlpha = this.hideOnDisabled ? 0 : .5);
      if (this.lane && 0 != settings.lanes) {
        ctx.strokeStyle = this.color;
        var b = a + this.faderH - 20,
          c = this.h - 27,
          d = this.w - this.laneOffset;
        0 < c - b && (ctx.beginPath(), ctx.moveTo(d, b), ctx.lineTo(d, c), ctx.lineCap = "round", ctx.lineWidth = 1 ==
          settings.lanes ? 2 : 4, ctx.stroke())
      }
      this.slowMode && (ctx.shadowColor = "#33CAFF", ctx.shadowBlur = 12, ctx.shadowOffsetX = 0, ctx.shadowOffsetY = 0);
      drawImage(this.fader, this.faderX, a);
      this.slowMode && ctx.setShadow();
      b = this.faderX;
      a += 34;
      if (isDefined(this.parent.getNameValue) && !this.noStereoArrows) switch (this.parent.getNameValue("stereoIndex")) {
        case 0:
          ctx.fillStyle = this.color;
          ctx.fillTriangle2(this.w - 12, a - 10, this.w - 8 - 12, a, this.w - 12, a + 10);
          break;
        case 1:
          ctx.fillStyle = this.color, ctx.fillTriangle2(b - 8, a - 10, b, a, b - 8, a + 10)
      }
      this.master &&
        settings.masterLock && this.locked && (ctx.setShadow(color.black, 4, 2, 2), drawImage(res.lock, this.faderX + 5.5, this.h - 25))
    }
  }),
  PanSlider = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "PanSlider";
      this.param = "pan";
      this.sliderW = res.panSlider.w();
      this.needMoveEvt = !0;
      this.oldValue = this.value = this.lastClickTime = 0;
      this.defaultValue = .5;
      this.grad = this.parent.stereo ? color.mPanGrad : color.panGrad;
      this.timer = null;
      this.disabled = this.moved = this.lastP = this.slide = !1
    },
    onDown: function(a, b) {
      clearTimeout(this.parent.led.timer);
      clearTimeout(this.timer);
      if (this.disabled) this.onDisabledClick();
      else {
        var c = this.globalX() + (this.w - this.sliderW) * this.getVal(),
          d = this.globalY(),
          c = c | 0;
        this.slide = c - 8 <= a && c + this.sliderW + 8 >= a && d <= b && d + this.h >= b;
        this.moved = !1;
        this.slide && (this.oldValue = this.getVal(), this.pressPoint = [a, b], isDefined(this.parent.id) && -1 != this.parent.id && mode != E_MODE.EDIT && bottomWidget.setSelected(this.parent.id));
        this.parent.led.setState(1);
        regUpdate(this.parent)
      }
    },
    onMove: function(a, b) {
      if (this.slide && !this.disabled) {
        var c =
          a - this.pressPoint[0];
        3 < Math.abs(c) && (this.moved = !0);
        c = bound(this.oldValue + c / (this.w - this.sliderW), 0, 1);
        this.setVal(c);
        this.onValue();
        regUpdate(this.parent)
      }
    },
    onUp: function() {
      if (!this.disabled) {
        var a = Date.now();
        if (a - this.lastClickTime < DBL_CLK_TIME && !this.moved && !this.lastP) {
          if (this.parent && this.parent.getNameValue) switch (this.parent.getNameValue("stereoIndex")) {
            case 0:
              this.setVal(0);
              break;
            case 1:
              this.setVal(1);
              break;
            default:
              this.setVal(this.defaultValue)
          } else this.setVal(this.defaultValue);
          this.lastClickTime =
            0;
          regUpdate(this.parent)
        }
        this.lastP = this.moved;
        this.lastClickTime = a;
        this.slide = this.moved = !1;
        this.oldValue = 0;
        this.pressPoint = [-1, -1];
        var b = this.parent.led;
        this.timer = setTimeout(function() {
          b.setState(0)
        }, 2E3);
        this.onValue()
      }
    },
    onWheel: function(a) {
      var b = this.getVal(),
        b = bound(b + a / 120 / 30, 0, 1);
      this.setVal(b);
      this.parent.led.setState(1);
      var c = this.parent.led;
      clearTimeout(this.timer);
      this.timer = setTimeout(function() {
        c.setState(0)
      }, 2E3);
      regUpdate(this.parent)
    },
    onDisabledClick: function() {},
    onValue: function() {},
    getState: function() {},
    paint: function() {
      this.getState();
      this.grad = this.parent.stereo ? color.mPanGrad : color.panGrad;
      var a = this.w - this.sliderW,
        b = a * this.getVal() + .5 | 0,
        c = this.w / 2;
      this.disabled && (ctx.globalAlpha = .5, b = .5 * a + .5 | 0);
      ctx.fillStyle = this.grad;
      ctx.fillRect(c, 12, b - c + (this.sliderW / 2 | 0), 8);
      drawImage(res.panSlider, b, 0);
      this.disabled && (ctx.globalAlpha = 1)
    }
  });
vuGradGain = vuGrad4 = vuGrad3 = vuGrad2 = vuGrad = null;
vuGradH = 0;
vuPattern = null;
var VUMeter = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "VUMeter";
      this.ignoreEvents = this.DYNAMIC_WIDGET = !0;
      this.w = measures.vuWidth;
      this.bottomMargin = 0;
      this.bh = 12;
      this.ghostFallVelocity = this.ghostValueBg = this.ghostValue = this.pFallVelocity = this.pValue = this.fallVelocity = this.valueBg = this.value = 0;
      this.clipping = !1;
      this.gridImg = null;
      this.cachedHeight = -1;
      this.gain = !1;
      vuPattern || (vuPattern = createPattern(res.vuTexture, "repeat-y"));
      this.fillTexture = vuPattern;
      this.ignoreGrad = !1;
      this.ptimer = null;
      this.curpPos = this.curgPos = this.curPos = 0;
      this.quant = this.isTicking = !1;
      this.vuGradH = 0;
      this.vuGradGain = this.vuGrad4 = this.vuGrad3 = this.vuGrad2 = this.vuGrad = null;
      this.disabled = !1
    },
    setValueExt: function(a, b) {
      if (!settings.disableVUs)
        if (!this.globalEnabled())
          if (this.value = this.valueBg = bound(b, 0, 4), this.ghostValue = this.ghostValueBg = bound(a, 0, 4), this.valueBg > this.pValue) this.pValue = this.valueBg, this.pFallVelocity = 0, clearTimeout(this.ptimer), this.ptimer = null;
          else {
            var c = this;
            null == this.ptimer &&
              (this.ptimer = setTimeout(function() {
                c.pFallVelocity = GLOBAL_VU_FALL_SPEED / 2;
                c.isTicking || (c.isTicking = !0, regTick(c));
                c.ptimer = null
              }, PEAK_HOLD_TIME))
          }
      else if (!(.005 > Math.abs(b - this.valueBg) && .005 > Math.abs(a - this.ghostValueBg))) {
        this.valueBg = bound(b, 0, 4);
        this.ghostValueBg = bound(a, 0, 4);
        var d = !1,
          f = !1,
          e = this.h * this.valueBg | 0;
        e > this.h % 12 && (e = e - e % 12 + this.h % 12);
        this.curPos != e && (this.value < this.valueBg ? (this.value = this.valueBg, f = !0) : (this.fallVelocity = GLOBAL_VU_FALL_SPEED, d = !0));
        settings.disableVUpeak || (this.pValue <
          this.valueBg ? (this.pValue = this.valueBg, this.pFallVelocity = 0, clearTimeout(this.ptimer), this.ptimer = null) : (c = this, null == this.ptimer && (this.ptimer = setTimeout(function() {
            c.pFallVelocity = GLOBAL_PEAK_FALL_SPEED;
            c.isTicking || (c.isTicking = !0, regTick(c));
            c.ptimer = null
          }, PEAK_HOLD_TIME))));
        this.disableVUghost || (e = this.h * this.ghostValueBg | 0, e > this.h % 12 && (e = e - e % 12 + this.h % 12), this.curgPos != e && (this.ghostValue < this.ghostValueBg ? (this.ghostValue = this.ghostValueBg, f = !0) : (this.ghostFallVelocity = GLOBAL_VU_FALL_SPEED,
          d = !0)));
        d && !this.isTicking && (this.isTicking = !0, regTick(this));
        f && regUpdate(this)
      }
    },
    reset: function() {
      this.pValue = this.ghostValue = this.ghostValueBg = this.value = this.valueBg = 0;
      regUpdate(this)
    },
    tick: function() {
      var a = !1,
        b = !1;
      if (this.value <= this.valueBg) this.value = this.valueBg;
      else {
        this.value -= this.fallVelocity;
        this.fallVelocity += GLOBAL_VU_FALL_ACC;
        this.value < this.valueBg ? this.value = this.valueBg : a = !0;
        var c = this.h * this.value | 0;
        settings.vuquantise && c > this.h % 12 && (c = c - c % 12 + this.h % 12);
        this.curPos != c && (b = !0)
      }
      this.disableVUghost ||
        (this.ghostValue <= this.ghostValueBg ? this.ghostValue = this.ghostValueBg : (this.ghostValue -= this.ghostFallVelocity, this.ghostFallVelocity += GLOBAL_VU_FALL_ACC, this.ghostValue < this.ghostValueBg ? this.ghostValue = this.ghostValueBg : a = !0, c = this.h * this.ghostValue | 0, settings.vuquantise && c > this.h % 12 && (c = c - c % 12 + this.h % 12), this.curgPos != c && (b = !0)));
      settings.disableVUpeak || (this.pValue <= this.valueBg ? this.pValue = this.valueBg : 0 < this.pValue && 0 < this.pFallVelocity && (this.pValue -= this.pFallVelocity, this.pFallVelocity +=
        GLOBAL_PEAK_FALL_ACC, this.pValue < this.valueBg ? this.pValue = this.valueBg : a = !0, c = this.h * this.pValue | 0, settings.vuquantise && c > this.h % 12 && (c = c - c % 12 + this.h % 12), this.curpPos != c && (b = !0)));
      a ? regTick(this) : this.isTicking = !1;
      b && regUpdate(this)
    },
    setPos: function($super, b, c, d) {
      $super(b, c);
      this.bottomMargin = d
    },
    calcGeometry: function() {},
    onResize: function() {
      this.createGradient()
    },
    createGradient: function() {
      this.vuGradH == this.h || this.ignoreGrad || 1 > this.h || (this.vuGrad = ctx.createLinearGradient(0, this.h, 0, 0), this.vuGrad.addColorStop(0,
          "green"), this.vuGrad.addColorStop(.5, "yellow"), this.vuGrad.addColorStop(1, "red"), this.vuGrad2 = ctx.createLinearGradient(0, this.h, 0, 0), this.vuGrad2.addColorStop(0, "#494"), this.vuGrad2.addColorStop(.5, "#aa3"), this.vuGrad2.addColorStop(1, "#d44"), this.vuGrad3 = ctx.createLinearGradient(0, this.h, 0, 0), this.vuGrad3.addColorStop(0, "#345C7F"), this.vuGrad3.addColorStop(1, "#698CAF"), this.vuGrad4 = ctx.createLinearGradient(0, this.h, 0, 0), this.vuGrad4.addColorStop(0, "#296BA0"), this.vuGrad4.addColorStop(1, "#60A5EA"),
        this.vuGradGain = ctx.createLinearGradient(0, this.h, 0, 0), this.vuGradGain.addColorStop(0, "#FF9900"), this.vuGradGain.addColorStop(1, "#FF0000"), this.vuGradH = this.h)
    },
    paint: function() {
      ctx.fillStyle = this.disabled ? "#000" : color.vuBg;
      ctx.fillRect(0, 0, this.w, this.h);
      this.disabled && (ctx.globalAlpha = .3);
      if (!settings.disableVUs) {
        var a = this.h * this.value | 0;
        settings.vuquantise && a > this.h % 12 && (a = a - a % 12 + this.h % 12);
        this.curPos = a;
        a = bound(a, 0, this.h);
        ctx.fillStyle = this.gain ? this.vuGradGain : settings.dimVUs ? this.vuGrad2 :
          this.vuGrad;
        ctx.fillRect(2, this.h - a, this.w - 4, a);
        if (!settings.disableVUghost) {
          var b = this.h * this.ghostValue | 0;
          settings.vuquantise && b > this.h % 12 && (b = b - b % 12 + this.h % 12);
          this.curgPos = b;
          b = bound(b, 0, this.h);
          b > a && (ctx.fillStyle = 1 > a ? this.vuGrad4 : this.vuGrad3, ctx.fillRect(2, this.h - b, this.w - 4, b - a))
        }
        settings.disableVUpeak || (a = this.h * this.pValue | 0, settings.vuquantise && a > this.h % 12 && (a = a - a % 12 + this.h % 12), this.curpPos = a, 12 < a && a < this.h && (ctx.fillStyle = this.gain ? this.vuGradGain : settings.dimVUs ? this.vuGrad2 : this.vuGrad,
          ctx.fillRect(2, this.h - a, this.w - 4, settings.vuquantise ? 12 : 5)))
      }
      ctx.fillStyle = this.fillTexture;
      ctx.fillRect(0, 0, this.w, this.h);
      ctx.fillStyle = "#090B0F";
      ctx.fillRect(0, this.h - 2, this.w, 2);
      ctx.fillRect(0, 0, this.w, 2)
    }
  }),
  GRMeter = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "GRMeter";
      this.DYNAMIC_WIDGET = !0;
      this.w = measures.vuWidth;
      this.h = 60;
      this.ignoreEvents = !0;
      this.pFallVelocity = this.fallVelocity = this.valueBg = this.value = 0
    },
    tick: function() {},
    setValue: function(a) {
      settings.disableVUs ||
        (a = bound(a / COMP_SCALE, 0, 1), .01 > Math.abs(a - this.value) || (this.value = a, regUpdate(this)))
    },
    paint: function() {
      ctx.fillStyle = "#52545A";
      ctx.fillRect(0, 0, this.w, this.h);
      if (.015 < this.value) {
        var a = (this.h - 4) * this.value | 0,
          a = bound(a, 0, this.h);
        1 < a && (ctx.fillStyle = "#800", ctx.fillRect(2, 2, this.w - 4, a), ctx.fillStyle = "#f00", ctx.fillRect(2, a + 2, this.w - 4, 1));
        2 < a && (ctx.fillStyle = "#b00", ctx.fillRect(2, a - 1 + 2, this.w - 4, 1))
      }
      ctx.fillStyle = vuPattern;
      ctx.fillRect(0, 0, this.w, this.h);
      ctx.fillStyle = "#090B0F";
      ctx.fillRect(0, this.h -
        2, this.w, 2);
      ctx.fillRect(0, 0, this.w, 2)
    }
  }),
  GATEind = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "GRMeter";
      this.DYNAMIC_WIDGET = !0;
      this.h = this.w = measures.vuWidth;
      this.value = this.ignoreEvents = !0
    },
    setValue: function(a) {
      this.value != a && (this.value = a, regUpdate(this))
    },
    paint: function() {
      ctx.fillStyle = "#111";
      ctx.fillRect(0, 0, this.w, this.h);
      ctx.fillStyle = "#494B51";
      ctx.fillRect(2, 2, this.w - 4, this.h - 4);
      ctx.strokeStyle = "rgba(0,0,0,0.1)";
      ctx.strokeRect(.5, .5, this.w - 1, this.h - 1);
      if (!this.value) {
        ctx.fillStyle =
          "#e11";
        var a = 2;
        ctx.fillRect(a, a, this.w - 2 * a, this.h - 2 * a);
        ctx.strokeStyle = "rgba(0,0,0,0.8)";
        ctx.lineWidth = 2;
        a = 3;
        ctx.beginPath();
        ctx.moveTo(a, a);
        ctx.lineTo(this.w - a, this.h - a);
        ctx.moveTo(this.w - a, a);
        ctx.lineTo(a, this.h - a);
        ctx.stroke()
      }
    }
  }),
  ModeButton = Class.create(Widget, {
    initialize: function($super, b, c) {
      $super(b);
      this.widgetName = "ModeButton";
      this.state = 0;
      this.disabled = !1;
      this.mode = c;
      this.img2 = this.img1 = this.img0 = this.mode2 = null;
      this.transMode = !1;
      this.clr0 = "#424242";
      this.clr1 = "#9036b5";
      this.clr2 = "#00c"
    },
    setMode2: function(a) {
      this.mode2 = a
    },
    setImages: function(a, b) {
      null != a && (this.img0 = a, this.img1 = b, this.w = this.img0.w(), this.h = this.img0.h())
    },
    onDown: function() {
      if (!this.disabled) switch (this.valueFunc(), this.state) {
        case 0:
          setMode(this.mode);
          break;
        case 1:
          null != this.mode2 ? setMode(this.mode2) : setMode(E_MODE.MIX);
          break;
        case 2:
          null != this.mode2 ? setMode(this.mode) : setMode(E_MODE.MIX)
      }
    },
    setState: function(a) {
      this.state = a
    },
    valueFunc: function() {},
    getState: function() {
      this.state = mode == this.mode ? 1 : null != this.mode2 &&
        this.mode2 == mode ? 2 : 0
    },
    paint: function() {
      this.getState();
      this.disabled && (ctx.globalAlpha = .6);
      if (this.transMode) switch (ctx.roundRect(4, 6, this.w - 8, this.h - 14, 4), this.state) {
        case 0:
          ctx.fillStyle = this.clr0;
          ctx.fill();
          this.img0 && drawImage(this.img0, 0, 0);
          break;
        case 1:
          ctx.fillStyle = this.clr1;
          ctx.fill();
          this.img0 && drawImage(this.img1, 0, 0);
          break;
        case 2:
          ctx.fillStyle = this.clr2, ctx.fill(), this.img0 && drawImage(this.img1, 0, 0)
      } else {
        switch (this.state) {
          case 0:
            null != this.img0 ? drawImage(this.img0, 0, 0) : (ctx.fillStyle =
              "rgba(60,60,60,0.7)", ctx.fillRect(0, 0, this.w, this.h));
            break;
          case 1:
            null != this.img1 ? drawImage(this.img1, 0, 0) : (null != this.img0 && drawImage(this.img0, 0, 0), ctx.fillStyle = "rgba(255,255,0,0.2)", ctx.fillRect(0, 0, this.w, this.h));
            break;
          case 2:
            null != this.img2 ? drawImage(this.img2, 0, 0) : (ctx.fillStyle = color.red, ctx.fillRect(0, 0, this.w, this.h))
        }
        this.disabled && (ctx.globalAlpha = 1)
      }
    }
  }),
  TabButton = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "TabButton";
      this.mode = this.state = 0;
      this.text =
        "null";
      this.img0 = null;
      this.font = font.tabText;
      this.textColor = color.tabText;
      this.it = this.cosmetic = !1;
      this.w = 111;
      this.h = 30
    },
    onDown: function() {
      this.cosmetic ? this.valueFunc() : this.parent.setMode(this.mode)
    },
    setImage: function(a, b, c) {
      this.img0 = a;
      this.ix = b;
      this.iy = c
    },
    valueFunc: function() {
      this.parent.setMode(this.mode)
    },
    getState: function() {
      this.cosmetic || (this.state = this.parent.mode == this.mode ? 1 : 0)
    },
    paint: function() {
      this.getState();
      this.dsbld && (ctx.globalAlpha = .4);
      0 == this.state ? (ctx.fillStyle = color.eqBg, ctx.fillRect(0,
        0, this.w, this.h), ctx.strokeStyle = color.tabStroke, ctx.strokeRect(.5, .5, this.w - 1, this.h - 2), ctx.fillStyle = "rgba(255,255,255,0.1)", ctx.fillRect(1, this.h, this.w - 2, -10), null != this.img0 ? (this.it && (ctx.globalAlpha = .4), drawImage(this.img0, this.ix, this.iy), this.it && (ctx.globalAlpha = 1)) : (ctx.font = this.font, ctx.textAlign = "center", ctx.fillStyle = color.black, ctx.fillText(this.text, this.w / 2 + 1 | 0, 23, this.w - 4), ctx.fillStyle = this.textColor, ctx.fillText(this.text, this.w / 2 | 0, 22, this.w - 4))) : (isDefined(this.color) ? ctx.fillStyle =
        this.color : ctx.fillStyle = this.parent.color, ctx.fillRect(0, 0, this.w, this.h), ctx.fillStyle = color.grad3, ctx.fillRect(0, 0, this.w, 7), null != this.img0 ? (this.it && (ctx.globalAlpha = .4), drawImage(this.img0, this.ix, this.iy), this.it && (ctx.globalAlpha = 1)) : (ctx.font = font.tabTextSel, ctx.textAlign = "center", ctx.fillStyle = color.black, ctx.fillText(this.text, this.w / 2 + 1 | 0, 23, this.w - 4), ctx.fillStyle = color.tabTextSel, ctx.fillText(this.text, this.w / 2 | 0, 22, this.w - 4), ctx.shadowColor = "transparent"));
      this.dsbld && (ctx.globalAlpha =
        1)
    }
  }),
  CheckBox = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "CheckBox";
      this.img2 = this.img1 = this.img0 = this.param = null;
      this.state = 0;
      this.opaque = !1;
      this.clr0 = "#3E3E3E";
      this.clr1 = "rgba(255,255,255,0.5)";
      this.linked = this.invisible = this.disabledHide = this.disabled = this.invertedValue = !1;
      this.holdTimer = null;
      this.stopClick = this.clickOnUp = this.needBG = this.longClickMark = !1;
      this.lmColor = color.longClickMark;
      this.text = null;
      this.textColorActive = this.textColor = color.white;
      this.shadowColorActive =
        this.shadowColor = null;
      this.textMargin = 3;
      this.textParam = {
        font: font.tabText,
        x: null,
        y: null,
        offsetX: 0,
        offsetY: -2,
        pressOffsetX: 0,
        pressOffsetY: 1,
        align: "center",
        valign: "middle",
        shadow: [color.black, 0, 1, 1],
        dy: 16
      };
      this.buttonMode = !1
    },
    setImages: function(a, b, c) {
      isDefined(a) && (this.img0 = a, this.w = this.img0.w(), this.h = this.img0.h());
      this.img1 = b;
      isDefined(c) && (this.img2 = c)
    },
    onDownB: function() {
      this.disabled || (this.longOk = !1, this.state = 1, this.opaque ? regUpdate(this.parent) : regUpdate(this))
    },
    onUpB: function() {
      this.disabled ||
        (this.state = 0, this.opaque ? regUpdate(this.parent) : regUpdate(this), this.valueFunc(), this.onToggle())
    },
    onDown: function() {
      if (this.buttonMode) return this.onDownB();
      this.stopClick = !1;
      if (!this.disabled) {
        this.clickOnUp || this.doClick();
        var a = this;
        clearTimeout(this.holdTimer);
        this.onHold && (this.holdTimer = setTimeout(function() {
          a.onHold();
          a.stopClick = !0
        }, HOLD_TIME))
      }
    },
    onUp: function() {
      if (this.buttonMode) return this.onUpB();
      clearTimeout(this.holdTimer);
      this.clickOnUp && !this.stopClick && (clearTimeout(this.holdTimer),
        this.doClick())
    },
    doClick: function() {
      switch (this.state) {
        case 0:
        case !1:
          this.state = 1;
          this.onToggleUp();
          break;
        case 1:
        case !0:
          this.state = 0, this.onToggleDown()
      }
      null != this.key && this.setVal(this.state);
      this.linked && null != this.parent.linkTarget && this.parent.linkTarget.setNameValue(this.param, this.state);
      this.onToggle();
      this.valueFunc(this.state);
      regUpdate(this.parent)
    },
    setState: function(a) {
      this.state = a;
      regUpdate(this.parent)
    },
    onToggle: function() {},
    onToggleUp: function() {},
    onToggleDown: function() {},
    valueFunc: function() {},
    getState: function() {},
    paint: function() {
      null != this.key && (this.state = this.getVal());
      this.getState();
      isDefined(this.state) && null != this.state || (this.state = 0);
      if (!this.invisible) {
        this.needBG && (ctx.fillStyle = color.eqBg, ctx.fillRect(0, 0, this.w, this.h));
        this.disabled && (ctx.globalAlpha = this.disabledHide ? 0 : .2);
        switch (this.state) {
          case 0:
          case !1:
            this.invertedValue ? this.drawDOWNState() : this.drawUPState();
            break;
          case 1:
          case !0:
            this.invertedValue ? this.drawUPState() : this.drawDOWNState()
        }
        this.disabled && (ctx.globalAlpha =
          1);
        if (this.longClickMark) {
          var a = 4;
          if (this.invertedValue && !this.state || !this.invertedValue && this.state) a += 1;
          ctx.fillStyle = color.longClickMark2;
          ctx.fillCircle(this.w - 6, a + 1, 3);
          ctx.fillStyle = color.longClickMark;
          ctx.fillCircle(this.w - 6, a + 1, 2)
        }
      }
    },
    drawUPState: function() {
      null != this.img0 ? drawImage(this.img0, 0, 0) : (ctx.fillStyle = this.clr0, ctx.fillRect(0, 0, this.w, this.h));
      if (this.text) {
        var a = Math.floor(this.textParam.x || this.w / 2) + this.textParam.offsetX,
          b = Math.floor(this.textParam.y || this.h / 2) + this.textParam.offsetY;
        ctx.fillStyle = this.textColor;
        this.textParam.max = this.w - 2 * this.textMargin;
        this.shadowColor && (this.textParam.shadow[0] = this.shadowColor);
        this.disabled && (this.textParam.shadow[0] = "transparent");
        ctx.drawText(this.text, a, b, this.textParam)
      }
    },
    drawDOWNState: function() {
      null != this.img1 ? drawImage(this.img1, 0, 0) : (null != this.img0 && drawImage(this.img0, 0, 0), ctx.fillStyle = this.clr1, ctx.fillRect(0, 0, this.w, this.h));
      if (this.text) {
        var a = Math.floor(this.textParam.x || this.w / 2) + this.textParam.offsetX,
          b = Math.floor(this.textParam.y ||
            this.h / 2) + this.textParam.offsetY,
          a = a + this.textParam.pressOffsetX,
          b = b + this.textParam.pressOffsetY;
        ctx.fillStyle = this.textColorActive || this.textColor;
        this.textParam.max = this.w - 2 * this.textMargin;
        this.shadowColorActive && (this.textParam.shadow[0] = this.shadowColorActive);
        this.disabled && (this.textParam.shadow[0] = "transparent");
        ctx.drawText(this.text, a, b, this.textParam)
      }
    }
  }),
  Indicator = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "CheckBox";
      this.img2 = this.img1 = this.img0 = this.param =
        null;
      this.state = 0;
      this.clr0 = "#222";
      this.clr1 = "rgba(255,255,255,0.5)";
      this.clr2 = "#0f0"
    },
    setImages: function(a, b) {
      this.img0 = a;
      this.img1 = b;
      this.w = this.img0.w();
      this.h = this.img0.h()
    },
    setState: function(a) {
      this.state = a;
      regUpdate(this.parent)
    },
    getState: function() {},
    paint: function() {
      null != this.key && (this.state = this.getVal());
      this.getState();
      switch (this.state) {
        case 0:
          null != this.img0 ? drawImage(this.img0, 0, 0) : (ctx.fillStyle = this.clr0, ctx.fillRoundRect(0, 0, this.w, this.h, 2));
          break;
        case 1:
          null != this.img1 ? drawImage(this.img1,
            0, 0) : (null != this.img0 && drawImage(this.img0, 0, 0), ctx.fillStyle = this.clr1, ctx.fillRoundRect(0, 0, this.w, this.h, 2));
          break;
        case 2:
          null != this.img2 ? drawImage(this.img2, 0, 0) : (ctx.fillStyle = this.clr2, ctx.fillRoundRect(0, 0, this.w, this.h, 2))
      }
    }
  }),
  Button = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "Button";
      this.img2 = this.img1 = null;
      this.pressed = !1;
      this.timer = null;
      this.disabled = this.longClickMark = this.longOk = !1;
      this.disabledHide = !0;
      this.text = null;
      this.textColorActive = this.textColor =
        color.white;
      this.textMargin = 3;
      this.textParam = {
        font: font.tabText,
        x: null,
        y: null,
        offsetX: 0,
        offsetY: 0,
        pressOffsetX: 0,
        pressOffsetY: 1,
        align: "center",
        valign: "middle",
        shadow: [color.black, 0, 1, 1],
        dy: 16
      }
    },
    setImages: function(a, b) {
      this.img1 = a;
      this.img2 = b;
      this.w = this.img1.w();
      this.h = this.img1.h()
    },
    onDown: function() {
      if (!this.disabled) {
        this.longOk = !1;
        this.pressed = !0;
        this.valueFunc();
        var a = this;
        clearTimeout(this.timer);
        this.longClickMark && (this.timer = setTimeout(function() {
          a.onHold();
          a.longOk = !0
        }, HOLD_TIME));
        this.opaque ?
          regUpdate(this.parent) : regUpdate(this)
      }
    },
    onUp: function() {
      if (!this.disabled && (clearTimeout(this.timer), this.pressed = !1, this.opaque ? regUpdate(this.parent) : regUpdate(this), !this.longOk)) this.onPress()
    },
    onHold: function() {},
    valueFunc: function() {},
    onValue: function() {},
    onPress: function() {},
    getState: function() {},
    paint: function() {
      this.getState();
      this.disabled && (ctx.globalAlpha = this.disabledHide ? 0 : .2);
      this.pressed ? null != this.img2 ? drawImage(this.img2, 0, 0) : (ctx.fillStyle = "red", ctx.fillRect(0, 0, this.w, this.h)) :
        null != this.img1 ? drawImage(this.img1, 0, 0) : (ctx.fillStyle = "#666", ctx.fillRect(0, 0, this.w, this.h));
      if (this.text) {
        var a = Math.floor(this.textParam.x || this.w / 2) + this.textParam.offsetX,
          b = Math.floor(this.textParam.y || this.h / 2) + this.textParam.offsetY;
        this.pressed ? (a += this.textParam.pressOffsetX, b += this.textParam.pressOffsetY, ctx.fillStyle = this.textColorActive || this.textColor) : ctx.fillStyle = this.textColor;
        this.textParam.max = this.w - 2 * this.textMargin;
        ctx.drawText(this.text, a, b, this.textParam)
      }
      this.longClickMark &&
        (b = 4, this.state && (b += 1), ctx.fillStyle = color.longClickMark2, ctx.fillCircle(this.w - 6, b + 1, 3), ctx.fillStyle = color.longClickMark, ctx.fillCircle(this.w - 6, b + 1, 2));
      this.disabled && (ctx.globalAlpha = 1)
    }
  }),
  ClipBulb = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "CLIP_INDICATOR";
      this.state = 0;
      this.h = this.w = 20;
      this.timer = null;
      this.master = !1;
      this.redrawParent = !0;
      this.releasing = !1
    },
    clip: function() {
      this.state || (this.state = 1, this.releasing = !1, regUpdate(this))
    },
    release: function() {
      clearTimeout(this.timer);
      this.releasing = !0;
      var a = this;
      this.timer = setTimeout(function() {
        a.state = 0;
        regUpdate(a)
      }, CLIP_HOLD_TIME)
    },
    paint: function() {
      0 == this.state ? drawImage(res.peakOFF, 0, 0) : drawImage(res.peakON, 0, 0)
    }
  }),
  LED = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "LED";
      this.text = "0.0 db";
      this.msg = "Message";
      null != this.parent && (this.id = this.parent.id);
      this.state = 0;
      this.color = color.ledText;
      this.holdtimer = this.timer = null;
      this.keyPrefix = this.parent.name;
      this.percentMode = !1;
      this.pkey = "mix";
      this.master = !1;
      this.lastClickTime = 0;
      this.needStereo = !0
    },
    updateLevel: function() {
      if ("undefined" != typeof this.parent.sl || "undefined" != typeof this.parent.slGain)
        if (mode == E_MODE.GAIN && isDefined(this.parent.slGain)) {
          var a = getValue(this.keyPrefix + "gain"),
            a = precision((IS_UI_24 ? VtoGAIN24 : VtoGAINP)(a), 1);
          this.text = (0 < a ? "+" : "") + a + " dB";
          getValue(this.keyPrefix + "disablegain") && (this.text = "...")
        } else a = getValue(this.keyPrefix + this.pkey), this.text = VtoDB(a)
    },
    updateLevelByKey: function() {
      if (this.percentMode) this.text = (100 * getValue(this.key) |
        0) + "%";
      else {
        var a = getValue(this.key);
        this.text = VtoDB(a)
      }
    },
    updatePan: function() {
      if ("undefined" != typeof this.parent.pan) {
        var a = getValue(this.keyPrefix + "pan"),
          a = VtoPAN(a);
        this.text = 0 < a ? "R " + a : 0 > a ? "L " + -a : lang.CENTER
      }
    },
    setState: function(a) {
      this.state = a;
      this.parent.NEED_UPDATE = !0;
      regUpdate(this.parent)
    },
    setMsg: function(a) {
      this.msg = a;
      this.state = 2;
      regUpdate(this.parent)
    },
    clearMsg: function() {
      this.state = 0;
      regUpdate(this.parent)
    },
    valueFunc: function() {},
    showPan: function() {
      this.state = 1;
      var a = this;
      clearTimeout(this.timer);
      this.timer = setTimeout(function() {
        a.setState(0)
      }, 1E3)
    },
    onDown: function() {
      this.valueFunc();
      var a = this;
      clearTimeout(this.holdtimer);
      this.holdtimer = setTimeout(function() {
        a.onHold()
      }, HOLD_TIME)
    },
    onUp: function() {
      clearTimeout(this.holdtimer);
      log("x");
      var a = Date.now();
      a - this.lastClickTime < DBL_CLK_TIME ? (this.onDouble(), this.lastClickTime = a - DBL_CLK_TIME) : this.lastClickTime = a
    },
    onPress: function() {},
    onHold: function() {
      var a = this;
      editOk.valueFunc = function() {
        a.onInput(editBox2.value)
      };
      showEditBox2(lang.NEW_VALUE,
        "")
    },
    onDouble: function() {},
    onInput: function(a) {
      showPopupMsg("" + a)
    },
    getState: function() {},
    getState2: function() {
      null == this.key ? (0 == this.state && this.updateLevel(), 1 == this.state && this.updatePan()) : 1 == this.state ? this.updatePan() : this.updateLevelByKey()
    },
    paint: function() {
      this.getState();
      this.getState2();
      if (this.needStereo) {
        var a = getValue(this.parent.name + "stereoIndex");
        0 == a && (ctx.fillStyle = this.parent.color, ctx.fillRect(0, 1, this.w + 5, 2), ctx.beginPath(), ctx.triangle2(0, 1, 18, 1, 0, 19), ctx.fill());
        1 == a && (ctx.fillStyle =
          this.parent.color, ctx.fillRect(-5, 1, this.w + 4, 2), ctx.beginPath(), ctx.triangle2(this.w - 18, 1, this.w, 1, this.w, 19), ctx.fill())
      }
      ctx.font = font.led;
      ctx.textAlign = "center";
      2 == this.state ? (ctx.fillStyle = this.color, ctx.fillText(this.msg, this.w / 2 | 0, 27)) : (ctx.fillStyle = this.color, ctx.fillText(this.text, this.w / 2 | 0, 27))
    }
  }),
  TopLED = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "LED";
      this.text = "...";
      this.msg = "MSG";
      this.w = 160;
      this.h = 50;
      this.state = 0;
      this.color = color.ledText;
      this.msgColor =
        "#FF0";
      this.clickTimer = this.timer = null;
      this.clickTime = -1;
      this.usbTimer = null;
      this.usbMTK = this.usbFill = 0;
      IS_UI_24 && (this.regKey("var.mtk.soundcheck"), this.regKey("var.mtk.rec.currentState"), this.regKey("var.mtk.rec.busy"));
      this.regKey("var.recBusy");
      this.regKey("var.isRecording");
      var c = this;
      HAVE_MTK ? this.usbTimer = setInterval(function() {
          var b = getValue("var.usbfill"),
            f = getValue("var.mtk.bufferfill");
          f > b ? (b = f, c.usbMTK = 1) : c.usbMTK = 0;
          b = bound(b, 0, 1);
          isNear(b, c.usbFill, .01) || (c.usbFill = b, regUpdate(c))
        }, 500) :
        HAVE_REC && (this.usbTimer = setInterval(function() {
          var b = getValue("var.usbfill"),
            b = bound(b, 0, 1);
          isNear(b, c.usbFill, .01) || (c.usbFill = b, regUpdate(c))
        }, 500))
    },
    setText: function(a) {
      this.text = a;
      this.state = 0;
      regUpdate(this)
    },
    setMsg: function(a, b) {
      this.msg = a;
      this.state = 1;
      isDefined(b) && (this.msgColor = b);
      regUpdate(this);
      clearTimeout(this.timer);
      var c = this;
      this.timer = setTimeout(function() {
        c.state = 0;
        regUpdate(c)
      }, 3E3)
    },
    clearMsg: function() {
      clearTimeout(this.timer);
      this.state = 0;
      regUpdate(this)
    },
    onDown: function() {
      this.clickTime =
        Date.now();
      var a = this;
      clearTimeout(this.clickTimer);
      this.clickTimer = setTimeout(function() {
        a.onLong()
      }, HOLD_TIME)
    },
    onUp: function() {
      clearTimeout(this.clickTimer);
      Date.now() - this.clickTime > HOLD_TIME || (this.menu = new SHOW_MENU(null), this.menu.color = this.color, regUpdate(this.menu))
    },
    onLong: function() {
      settingsWidget.setMode(2);
      setMode(E_MODE.SETTINGS)
    },
    paint: function() {
      drawImage(res.topBarLED, 0, 0);
      ctx.textAlign = "center";
      ctx.font = font.topLed;
      var a = this.w / 2 | 0;
      ctx.lineWidth = 1;
      if (.9 <= this.usbFill) {
        ctx.fillStyle =
          "#e11";
        ctx.strokeStyle = "#e11";
        ctx.font = "10pt open_sans_condensedbold";
        var b = lang.RECORDING_DROPOUT;
        this.usbMTK && (b = lang.MTK + " " + b);
        ctx.fillText(b, a, 20, this.w - 16);
        ctx.strokeRect(20.5, 23.5, 120, 10);
        ctx.fillRect(20, 23, 120 * this.usbFill | 0, 10)
      } else if (.6 <= this.usbFill) ctx.fillStyle = "#e81", ctx.strokeStyle = "#e81", ctx.font = "10pt open_sans_condensedbold", b = lang.USB_REC_TOO_SLOW, this.usbMTK && (b = lang.MTK + " " + b), ctx.fillText(b, a, 20, this.w - 16), ctx.strokeRect(20.5, 23.5, 120, 10), ctx.fillRect(20, 23, 120 * this.usbFill |
        0, 10);
      else if (.2 <= this.usbFill) ctx.fillStyle = "#ee1", ctx.strokeStyle = "#ee1", ctx.font = "10pt open_sans_condensedbold", b = lang.USB_REC_BUFFER, this.usbMTK && (b = lang.MTK + " " + b), ctx.fillText(b, a, 20, this.w - 16), ctx.strokeRect(20.5, 23.5, 120, 10), ctx.fillRect(20, 23, 120 * this.usbFill | 0, 10);
      else if (0 == this.state) {
        var b = .5 < getValue("var.recBusy"),
          c = .5 < getValue("var.isRecording"),
          d = IS_UI_24 && .5 < getValue("var.mtk.rec.busy");
        ctx.fillStyle = this.color;
        if (c && b || d) {
          ctx.font = "11pt open_sans_condensedbold";
          ctx.fillStyle = color.yellow;
          b = lang.RECORDER_IS_BUSY;
          if (this.usbMTK || d) b = lang.MTK + " " + b;
          ctx.fillText(b, a, 30, this.w - 16)
        } else(d = getValue("var.currentSnapshot")) && 0 == d.length && (d = lang.NO_SNAPSHOT), ctx.fillText(d, a, 30, this.w - 16)
      } else 1 == this.state && (ctx.fillStyle = this.msgColor, ctx.fillText(this.msg, a, 30, this.w - 16));
      IS_UI_24 && (a = getValue("var.mtk.rec.currentState"), d = getValue("var.mtk.soundcheck"), b = 8, c = 5, a && (ctx.fillStyle = color.red, ctx.fillRoundRect(b, c, 25, 14, 4), ctx.textAlign = "left", ctx.font = "8pt open_sans_condensedbold", ctx.fillStyle =
        color.white, ctx.drawText("MTK", b + 3, c + 11, {
          shadow: [color.black, 0, 1, 1]
        }), b += 27), d && (ctx.fillStyle = "#4FCA3F", ctx.fillRoundRect(b, c, 16, 14, 4), ctx.textAlign = "left", ctx.font = "8pt open_sans_condensedbold", ctx.fillStyle = color.white, ctx.drawText("SC", b + 3, c + 11, {
        shadow: [color.black, 0, 1, 1]
      })));
      netConnectState || (b = this.w - 24, c = 5, ctx.fillStyle = "#E2464F", ctx.fillRoundRect(b, c, 16, 14, 4), ctx.textAlign = "left", ctx.font = "10pt Arial", ctx.fillStyle = color.white, ctx.drawText("⚠", b + 2, c + 11, {
        shadow: [color.black, 0, 1, 1]
      }))
    }
  });

function usbFillCheck() {}
var TopWidget = Class.create(Widget, {
  initialize: function($super, b) {
    $super(b);
    this.widgetName = "TopWidget";
    this.y = this.x = 0;
    this.needClip = !0;
    this.h = measures.topWidgetHeight;
    this.cachedStrip = null;
    this.cachedStripHeight = 0;
    this.initWidgets()
  },
  initWidgets: function() {
    var a = 31;
    this.bTOTAL = new ModeButton(this, E_MODE.MODALS);
    this.bTOTAL.setPos(a, 13);
    this.bTOTAL.setImages(res.bTVOff, res.bTVOn);
    this.bTOTAL.getState = function() {
      this.state = mode == this.mode ? 1 : null != this.mode2 && this.mode2 == mode ? 2 : 0;
      this.disabled = isPortrait
    };
    this.bTOTAL.valueFunc = function() {
      modalsWidget.setMode(0)
    };
    a += this.bTOTAL.w + 4;
    this.bMix = new ModeButton(this, E_MODE.MIX);
    this.bMix.setPos(a, 13);
    this.bMix.setImages(res.bMixGainOff, res.bMixGainOn);
    this.bMix.setMode2(E_MODE.GAIN);
    this.bMix.img2 = res.bMixGain2;
    a += this.bMix.w + 26;
    this.bEDIT = new ModeButton(this, E_MODE.EDIT);
    this.bEDIT.setPos(a, 13);
    this.bEDIT.transMode = !0;
    this.bEDIT.setImages(res.bEDITOff, res.bEDIT_T);
    this.bEDIT.getState = function() {
      this.state = mode == this.mode ? 1 : null != this.mode2 && this.mode2 ==
        mode ? 2 : 0;
      this.disabled = isPortrait
    };
    this.bEDIT.valueFunc = function() {
      mode == E_MODE.AUX && editWidget.setMode(editWidget.E_MODE.aux);
      mode == E_MODE.FXSENDS && editWidget.setMode(editWidget.E_MODE.fx)
    };
    a += this.bEDIT.w + 26;
    this.bAUX = new ModeButton(this, E_MODE.AUX);
    this.bAUX.setPos(a, 13);
    this.bAUX.setImages(res.bAUXOff, res.bAUXOn);
    a += this.bAUX.w + 5;
    this.bFX = new ModeButton(this, E_MODE.FXSENDS);
    this.bFX.setPos(a, 13);
    this.bFX.setImages(res.bFXOff, res.bFXOn);
    a += this.bFX.w + 25;
    this.bPlayer = new CheckBox(this);
    this.bPlayer.setPos(a,
      13);
    this.bPlayer.setImages(res.bPlayerOff, res.bPlayerOn);
    this.bPlayer.onHold = function() {
      setMode(E_MODE.PONG)
    };
    this.bPlayer.getState = function() {
      this.state = mode == E_MODE.PLAYER ? 1 : 0;
      this.disabled = isPortrait
    };
    this.bPlayer.onDown = function() {
      this.stopClick = !1;
      if (!this.disabled) {
        this.clickOnUp || this.doClick();
        var a = this;
        clearTimeout(this.holdTimer);
        this.holdTimer = setTimeout(function() {
          a.onHold();
          a.stopClick = !0
        }, 4E3)
      }
    };
    this.bPlayer.onToggleUp = function() {
      setMode(E_MODE.PLAYER)
    };
    this.bPlayer.onToggleDown = function() {
      setMode(E_MODE.MIX)
    };
    a += this.bPlayer.w + 3;
    this.bSet = new ModeButton(this, E_MODE.SETTINGS);
    this.bSet.setPos(a, 13);
    this.bSet.setImages(res.bSettingsOff, res.bSettingsOn);
    this.bSet.getState = function() {
      this.state = mode == this.mode ? 1 : null != this.mode2 && this.mode2 == mode ? 2 : 0;
      this.disabled = isPortrait
    };
    this.led = new TopLED(this);
    this.bLogo = new CheckBox(this);
    this.bLogo.setImages(res.topBarLogo, res.topBarLogo2);
    this.bLogo.getState = function() {
      this.state = slideOutWidget.enabled ? 1 : 0
    };
    DEPLOY || (this.bLogo.onHold = function() {
      confOk.valueFunc =
        function() {
          location.reload()
        };
      showConfBox(lang.RELOAD_UI)
    });
    this.bLogo.onToggle = function() {
      clearInterval(ticker);
      toggleSlideOut()
    }
  },
  calcGeometry: function() {
    this.w = screenWidth;
    this.led.setPos(this.w - 270, 15);
    this.bLogo.setPos(this.w - this.bLogo.w - 25, 13);
    this.led.enabled = this.led.x > this.bSet.x + this.bSet.w + 4;
    this.bLogo.enabled = this.bLogo.x > this.bSet.x + this.bSet.w + 4
  },
  paint: function() {
    this.cachedStripHeight != this.w && this.cachePaint();
    ctx.drawImage(this.cachedStrip, 0, 0, this.w, this.h)
  },
  drawSeparator: function(a,
    b) {
    b.fillStyle = "rgba(255,255,255,0.08)";
    b.fillRect(a - 1, 2, 3, measures.topWidgetHeight - 4);
    b.fillStyle = "rgba(0,0,0,0.41)";
    b.fillRect(a, 2, 1, measures.topWidgetHeight - 4)
  },
  cachePaint: function() {
    null != this.cachedStrip && delete this.cachedStrip;
    this.cachedStrip = document.createElement("canvas");
    var a = this.cachedStrip.getContext("2d");
    isRetina ? (this.cachedStrip.width = 2 * this.w, this.cachedStrip.height = 2 * this.h, a.scale(2, 2)) : (this.cachedStrip.width = this.w, this.cachedStrip.height = this.h);
    a.fillStyle = "#E3E3E4";
    a.fillRect(0,
      0, this.w, this.h);
    fillHorPatternCtx(res.topBarTile, this.w, a);
    979 < this.w && drawImageCtx(res.topBarRight, this.w - res.topBarRight.w(), 0, a);
    drawImageCtx(res.topBarLeft, 0, 0, a);
    this.drawSeparator(191, a);
    this.drawSeparator(309, a);
    this.drawSeparator(524, a);
    this.cachedStripHeight = this.w
  }
});
velocity = ticker = null;
amplitude = position = 0;
timestamp = null;
step = frame = 0;

function syncHPAUX() {
  HAVE_HP && (hideHPAUX = 0 == getValue("var.hpaux"), null == inView ? mixerWidget.showAll() : mixerWidget.arrangeStrips("syncHPAUX"), editWidget.pages[editWidget.E_MODE.aux].sync(), hideHPAUX && auxWidget.mode > curSetup.aux - 3 && auxWidget.setMode(0), mode == E_MODE.AUXSENDS && (auxWidget.onShow(), regUpdate(auxWidget)), regUpdate(settingsWidget))
}
var BottomWidget2 = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "BottomWidget2";
      this.x = 0;
      this.h = measures.bottomWidgetHeight;
      this.needClip = this.needMoveEvt = !0;
      this.step = measures.mixerStripWidth;
      this.rw = 0;
      this.holdTimer = null;
      this.IDS = [0];
      this.maxOffset = 0;
      this.color = "white";
      this.ownColor = !1;
      this.COLORS = ["red"];
      this.move = this.editMode = !1;
      this.scrollX = this.touchID = -1;
      this.internia = 0;
      this.prevSelected = this.lastClickTime = -1;
      this.grd = null;
      this.strips_arr = allStrips
    },
    addFrom: function(a,
      b) {
      for (var c = 0; c < a.length; c++)(a[c].enabled || isDefined(b)) && this.IDS.push(a[c].id)
    },
    addFrom2: function(a) {
      for (var b = 0; b < a.length; b++) this.IDS.push(a[b].id), this.COLORS.push(a[b].color)
    },
    upd: function() {
      this.ownColor = !1;
      this.rw = 0;
      this.IDS = [];
      this.COLORS = [];
      this.editMode = !1;
      this.strips_arr = mixerWidget.strips;
      switch (mode) {
        default: var a = !1;mode != E_MODE.EDIT && (this.ownColor = !0);
        if (0 <= activeViewGroup && 10 > activeViewGroup && inView) {
          var b = [];
          inView.forEach(function(a) {
            b.push(allStrips[a])
          });
          for (var c = 0; c < b.length; c++) {
            var d =
              b[c];
            mode == E_MODE.EDIT && d.type == E_STRIP_TYPE.VCA || !d.enabled || (this.IDS.push(d.id), this.COLORS.push(d.color))
          }
          break
        }
        settings.mediaFirst && (this.addFrom(mediaStrips), mediaStrips[0].enabled && this.COLORS.push(mediaStrips[0].color), mediaStrips[1].enabled && this.COLORS.push(mediaStrips[1].color), a = !0);
        for (c = 0; c < this.strips_arr.length; c++) d = this.strips_arr[c],
        mode == E_MODE.EDIT && d.type == E_STRIP_TYPE.VCA || !d.enabled || a && d.type == E_STRIP_TYPE.MEDIA || (this.IDS.push(d.id), this.COLORS.push(d.color));
        break;
        case E_MODE.GAIN:
            this.color =
            color.INPUT;this.strips_arr = gainMixer.strips;this.addFrom(this.strips_arr);
          break;
        case E_MODE.AUX:
            if (auxWidget.page2 && auxWidget.page2.enabled) this.ownColor = !1, this.color = color.MATRIX, this.addFrom(mtxSendStrips);
            else {
              this.ownColor = !0;
              this.color = color.AUX;
              this.addFrom(inStrips, !0);
              this.addFrom(lineinStrips, !0);
              this.addFrom(mediaStrips, !0);
              this.addFrom(fxStrips, !0);
              for (c = 0; c < inStrips.length; c++) this.COLORS.push(color.AUX);
              for (c = 0; c < lineinStrips.length; c++) this.COLORS.push(color.LINEIN);
              for (c = 0; c < mediaStrips.length; c++) this.COLORS.push(color.media);
              for (c = 0; c < fxStrips.length; c++) this.COLORS.push(color.blue)
            }break;
        case E_MODE.FXSENDS:
            this.color = color.blue;this.ownColor = !0;this.addFrom(inStrips, !0);this.addFrom(lineinStrips, !0);this.addFrom(mediaStrips, !0);this.addFrom(subStrips, !0);
          for (c = 0; c < inStrips.length; c++) this.COLORS.push(fxSendsWidget.page.color);
          for (c = 0; c < lineinStrips.length; c++) this.COLORS.push(color.LINEIN);
          for (c = 0; c < mediaStrips.length; c++) this.COLORS.push(color.media);
          for (c = 0; c < subStrips.length; c++) this.COLORS.push(color.sub)
      }
      this.rw =
        this.IDS.length * this.step;
      this.maxOffset = this.rw - this.w;
      0 > this.maxOffset && (this.maxOffset = 0)
    },
    onDown: function(a, b, c) {
      this.pressPoint = [a, b];
      this.prX = a - this.x + this.offsetX;
      this.dx = 0;
      this.touchID = c;
      this.move = !0;
      if (!((this.prX / this.step | 0) >= this.IDS.length)) {
        var d = this;
        clearTimeout(this.holdTimer);
        this.holdTimer = setTimeout(function() {
          d.onHold()
        }, HOLD_TIME);
        this.velStart()
      }
    },
    onMove: function(a, b, c) {
      this.touchID != c || !this.move || 0 < scrollLock || (this.dx = a - this.pressPoint[0], 3 < Math.abs(this.dx) && clearTimeout(this.holdTimer),
        this.setOffset(this.offsetXold - this.dx * SCROLL_SCALE))
    },
    onUp: function(a) {
      if (this.touchID == a || -123 == a) {
        clearTimeout(this.holdTimer);
        if (8 > Math.abs(this.dx)) {
          var b = this.prX / this.step | 0;
          if (0 <= b && b < this.IDS.length) {
            var c = this.IDS[b];
            mode == E_MODE.GAIN && 777 == this.strips_arr[c].type || this.setSelected(this.IDS[b])
          }
        }
        this.move = !1;
        this.touchID = -1;
        this.pressPoint = [-1, -1];
        this.offsetXold = this.offsetX;
        c = Date.now();
        (!IS_UI_24 || this.IDS[b] < vcaStrips[0].id) && c - this.lastClickTime < DBL_CLK_TIME && -123 != a && 8 > Math.abs(this.dx) ?
          (this.onDouble(), this.lastClickTime = c - DBL_CLK_TIME) : (this.lastClickTime = c, this.prevSelected = selectedChannel, this.velRelease())
      }
    },
    onHold: function(a) {
      if (0 == mWidgets.length) {
        if (!a) this.onUp(-123);
        bottomWidget.move = !1;
        switch (mode) {
          case E_MODE.MIX:
          case E_MODE.GAIN:
          case E_MODE.EDIT:
          case E_MODE.AUX:
          case E_MODE.FXSENDS:
          case E_MODE.VCA:
            break;
          default:
            return
        }
        if (mode == E_MODE.EDIT) {
          a = this.prX / this.step | 0;
          if (a >= this.IDS.length) return;
          this.setSelected(this.IDS[a])
        }
        if (-1 != selectedChannel) {
          a = new STRIPMENU(null, selectedStrip);
          var b = bottomWidget.IDS.indexOf(selectedStrip.id);
          a.x = bottomWidget.x + b * measures.mixerStripWidth - bottomWidget.offsetX - 20;
          a.x = bound(a.x, 0, screenWidth - a.w);
          a.y = screenHeight - a.h - measures.bottomWidgetHeight;
          mWidgets.push(widgets.pop());
          regUpdate(a)
        }
      }
    },
    onDouble: function() {
      if (this.prevSelected == selectedChannel) {
        var a = this.prX / this.step | 0,
          b = !0;
        0 > a && a >= this.IDS.length && (b = !1);
        a = this.IDS[a];
        mode == E_MODE.GAIN && 777 == this.strips_arr[a].type && (b = !1);
        b && (mode != E_MODE.EDIT ? (selectedStrip.type == E_STRIP_TYPE.FX ? editWidget.setMode(editWidget.E_MODE.fx) :
          editWidget.setMode(editWidget.E_MODE.dyn), setMode(E_MODE.EDIT)) : setMode(lastMode))
      }
    },
    setSelected: function(a) {
      setSelected(a)
    },
    velStart: function() {
      velocity = amplitude = 0;
      timestamp = Date.now();
      clearInterval(ticker);
      frame = bottomWidget.offsetX;
      ticker = setInterval(this.velTrack, 1E3 / fps)
    },
    velTrack: function() {
      var a, b;
      a = Date.now();
      b = a - timestamp;
      timestamp = a;
      a = bottomWidget.offsetX - frame;
      frame = bottomWidget.offsetX;
      b = 1E3 * a / (1 + b);
      velocity = 0 == velocity ? b : .3 * b + .7 * velocity
    },
    velRelease: function() {
      clearInterval(ticker);
      Date.now() - timestamp < 1E3 / fps && this.velTrack();
      5 < Math.abs(velocity) && this.mScroll(velocity)
    },
    mScroll: function(a) {
      if (!settings.kinetic) {
        var b = 1E3 / fps;
        position = this.offsetX;
        amplitude = .2 * a;
        step = 0;
        var c = this;
        clearInterval(ticker);
        ticker = setInterval(function() {
          var a = amplitude / b * 2;
          position += a;
          amplitude -= a;
          step += 1;
          .5 > Math.abs(a) && clearInterval(ticker);
          step > 3 * fps && clearInterval(ticker);
          (0 >= position || position > c.maxOffset) && clearInterval(ticker);
          c.offsetX != (position | 0) && c.setOffset(position | 0)
        }, b)
      }
    },
    syncOffset: function() {
      switch (mode) {
        case E_MODE.GAIN:
        case E_MODE.MIX:
          gainMixer.setOffset(this.offsetX);
          mixerWidget.setOffset(this.offsetX);
          break;
        case E_MODE.AUX:
          auxWidget.setOffset(this.offsetX);
          break;
        case E_MODE.FXSENDS:
          fxSendsWidget.setOffset(this.offsetX)
      }
    },
    startScroll: function(a, b) {
      scrollLock || mixerTouches != (settings.oneFingerScroll ? 1 : 2) && b != mouseID || this.move || (this.touchID = b, this.scrollX = a, this.move = !0, this.velStart())
    },
    setScroll: function(a, b) {
      scrollLock || mixerTouches != (settings.oneFingerScroll ? 1 : 2) && b != mouseID || this.touchID != b || (this.offsetX = bound(this.offsetXold - (a - this.scrollX) * SCROLL_SCALE |
        0, 0, this.maxOffset), this.syncOffset(), regUpdate(this), this.velTrack())
    },
    endScroll: function(a) {
      this.touchID == a && (this.touchID = this.scrollX = -1, this.move = !1, this.offsetXold = this.offsetX, this.velRelease())
    },
    setOffset: function(a) {
      this.offsetX = bound(a | 0, 0, this.maxOffset);
      this.move || (this.offsetXold = this.offsetX);
      this.syncOffset();
      regUpdate(this)
    },
    setOffset2: function(a) {
      this.offsetXold = this.offsetX = bound(a | 0, 0, this.maxOffset);
      regUpdate(this)
    },
    gotoID: function(a) {
      clearInterval(ticker);
      0 > a || (a = this.IDS.indexOf(a),
        0 <= a && this.setOffset(a * this.step))
    },
    gotoID2: function(a) {
      clearInterval(ticker);
      0 > a || (a = this.IDS.indexOf(a), 0 <= a && (a *= this.step, (a - this.offsetX > this.w - this.step || 0 > a - this.offsetX) && this.setOffset(a + this.step - this.w)))
    },
    gotoID3: function(a) {
      clearInterval(ticker);
      0 > a || (a = this.IDS.indexOf(a), 0 <= a && (a *= this.step, (0 > a - this.offsetX || a - this.offsetX > this.w) && this.setOffset(a)))
    },
    gotoIDmid: function(a) {
      clearInterval(ticker);
      0 > a || (a = this.IDS.indexOf(a), -1 != a && (a = measures.mixerStripWidth * a - (this.w - measures.mixerStripWidth) /
        2, this.setOffset(a | 0), mixerWidget.setOffset(a | 0)))
    },
    goLeft: function() {
      this.setOffset(this.offsetX - measures.mixerStripWidth * curSetup.bankSize);
      this.syncOffset()
    },
    goRight: function() {
      this.setOffset(this.offsetX + measures.mixerStripWidth * curSetup.bankSize);
      this.syncOffset()
    },
    gotoSelected: function() {
      this.gotoID(selectedStrip.id)
    },
    gotoAUX: function() {
      this.gotoID(auxStrips[0].id)
    },
    gotoFX: function() {
      this.gotoID(fxStrips[0].id)
    },
    gotoSUB: function() {
      this.gotoID(subStrips[0].id)
    },
    gotoStart: function() {
      this.setOffset(0)
    },
    gotoEnd: function() {
      this.setOffset(this.maxOffset)
    },
    calcGeometry: function() {
      this.w = screenWidth;
      masterWidget.enabled && (this.w -= masterWidget.w);
      fxoutWidget.enabled && (this.w -= fxoutWidget.w);
      auxoutWidget.enabled && (this.w -= auxoutWidget.w);
      this.x = editStripWidget.enabled ? editStripWidget.w : 0;
      this.w -= this.x;
      slideOutWidget.enabled && (this.w -= slideOutWidget.w);
      this.y = screenHeight - this.h;
      this.maxOffset = this.rw - this.w;
      0 > this.maxOffset && (this.maxOffset = 0);
      this.offsetX > this.maxOffset && (this.offsetXold = this.offsetX =
        this.maxOffset, this.syncOffset())
    },
    paint: function() {
      ctx.fillStyle = color.botBG;
      ctx.fillRect(this.offsetX, 0, this.w, this.h);
      var a = this.IDS.length;
      if (a * measures.mixerStripWidth < this.w)
        for (var b = a * measures.mixerStripWidth; b < this.w; b += measures.mixerStripWidth) drawImage(res.blStripLabel, b, 0);
      var b = this.offsetX / this.step | 0,
        c = (this.offsetX + this.w) / this.step | 0;
      ctx.font = font.botChLabel;
      ctx.textAlign = "center";
      for (var d = 0, f = 0; f < a; f++)
        if (!(f < b)) {
          if (f > c) break;
          var e = this.IDS[f],
            g = this.step * f;
          drawImage(res.stripLabel,
            g, 0);
          d++;
          var h = color.labelText;
          switch (mode) {
            case E_MODE.EDIT:
              switch (this.strips_arr[e].type) {
                case E_STRIP_TYPE.IN:
                  h = "#C97247";
                  break;
                case E_STRIP_TYPE.AUX:
                  h = color.AUX;
                  break;
                case E_STRIP_TYPE.FX:
                  h = color.blue;
                  break;
                case E_STRIP_TYPE.SUB:
                  h = "#CC88A2";
                  break;
                case E_STRIP_TYPE.MEDIA:
                  h = "#AB2152";
                  break;
                case E_STRIP_TYPE.LINEIN:
                  h = color.LINEIN
              }
              this.color = editWidget.buttons[editWidget.mode].color;
              break;
            case E_MODE.GAIN:
              this.color = color.red
          }
          ctx.fillStyle = h;
          var l = !1; - 1 != e && 1 == Math.abs(selectedChannel - e) && (l = this.strips_arr[e].getNameValue("stereoIndex"),
            l = 1 == l && selectedChannel == e - 1 || 0 == l && selectedChannel == e + 1);
          var m = selectedChannel == e;
          mode == E_MODE.GAIN && (777 == this.strips_arr[e].type && (m = !1, h = "#888"), l = !1);
          if (m || l) ctx.fillStyle = this.ownColor ? this.COLORS[f] : this.color, l && (ctx.fillStyle = hexToRGBA(ctx.fillStyle, .5)), ctx.fillRect(g + 2, 0, this.step - 4, this.h - 2), ctx.translate(0, this.h - 7), ctx.fillStyle = color.grad4, l || ctx.fillRect(g + 3, 0, this.step - 6, 5), ctx.translate(0, -(this.h - 7)), ctx.fillStyle = color.labelTextSel;
          e = -1 == e ? lang.MASTER : this.strips_arr[e].getName();
          ctx.fillStyle = color.black;
          ctx.fillText(e, g + this.step / 2 + 2 | 0, 25, this.step - 6);
          ctx.fillStyle = m || l ? color.labelTextSel : h;
          ctx.fillText(e, g + this.step / 2 | 0, 24, this.step - 6)
        }
      0 < this.maxOffset && (ctx.fillStyle = "#99b", a = this.w - 2, ctx.fillRect(this.offsetX + 2 + (this.offsetX / (this.maxOffset + this.w) * a | 0), this.h - 3, this.w / (this.maxOffset + this.w) * a | 0, 2))
    }
  }),
  MainMixer = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "MainMixer";
      this.y = measures.topWidgetHeight;
      this.needClip = !0;
      this.mode = 0;
      this.strips = [];
      this.muteBackup = [];
      this.moveX = this.moveTID = -1;
      this.vis = this.realWidth = 0;
      this.createStrips()
    },
    addButtons: function(a) {
      a.mute = new CheckBox(a);
      a.mute.setPos(4, 89);
      a.mute.setImages(res.bMuteOff, null);
      a.mute.setSize(50, 30);
      a.solo = new CheckBox(a);
      a.solo.setPos(57, 87);
      a.solo.setImages(res.bSoloOff, res.bSoloOn);
      a.solo.setSize(50, 30);
      a.phantom = new CheckBox(a);
      a.phantom.enabled = !1;
      a.phantom.setPos(4, 89);
      a.phantom.setImages(res.bPhantomOff, null);
      a.phantom.setSize(102, 30)
    },
    setMode: function(a) {},
    createStrips: function() {
      for (var a =
          curSetup.input, b = curSetup.fx, c = curSetup.linein, d = curSetup.sub, f = curSetup.aux, e = 0, g = 0; g < a; g++) {
        var h = new Strip(this, e, E_STRIP_TYPE.IN, g);
        0 == g && (h.firstInGroup = !0);
        g == a - 1 && (h.lastInGroup2 = h.lastInGroup = !0);
        h.text = "CH " + (g + 1);
        this.strips.push(h);
        inStrips.push(h);
        allStrips.push(h);
        e++
      }
      for (g = 0; g < c; g++) h = new Strip(this, e, E_STRIP_TYPE.LINEIN, g), 0 == g && (h.firstInGroup = !0), g == c - 1 && (h.lastInGroup2 = h.lastInGroup = !0), h.text = "LINE IN " + (0 == g ? "L" : "R"), 1 < g && (h.text += " " + Math.floor(g / 2 + 1)), h.label = "LINE IN " + (0 ==
        g ? "L" : "R"), allStrips.push(h), lineinStrips.push(h), this.strips.push(h), e++;
      h = new Strip(this, e, E_STRIP_TYPE.MEDIA, 0);
      h.firstInGroup = !0;
      h.lastInGroup = !1;
      h.text = "PLAYER L";
      h.label = "MEDIA L";
      allStrips.push(h);
      mediaStrips.push(h);
      this.strips.push(h);
      e++;
      h = new Strip(this, e, E_STRIP_TYPE.MEDIA, 1);
      h.firstInGroup = !1;
      h.lastInGroup2 = h.lastInGroup = !0;
      h.text = "PLAYER R";
      h.label = "MEDIA R";
      allStrips.push(h);
      mediaStrips.push(h);
      this.strips.push(h);
      e++;
      for (g = 0; g < b; g++) h = new Strip(this, e, E_STRIP_TYPE.FX, g), 0 == g && (h.firstInGroup = !0), g == b - 1 && (h.lastInGroup2 = h.lastInGroup = !0), h.text = "FXR " + (g + 1), this.strips.push(h), fxStrips.push(h), allStrips.push(h), e++;
      for (g = 0; g < d; g++) h = new Strip(this, e, E_STRIP_TYPE.SUB, g), 0 == g && (h.firstInGroup = !0), g == d - 1 && (h.lastInGroup2 = h.lastInGroup = !0), h.text = "SUB " + (g + 1), h.SGIDX = g, this.strips.push(h), subStrips.push(h), allStrips.push(h), e++;
      for (g = 0; g < f; g++) h = new Strip(this, e, E_STRIP_TYPE.AUX, g), 0 == g && (h.firstInGroup = !0), g == f - 1 && (h.lastInGroup2 = h.lastInGroup = !0), h.text = "AUX " + (g + 1), this.strips.push(h),
        auxStrips.push(h), allStrips.push(h), e++;
      allStripsNoVca = copyObject(allStrips);
      if (IS_UI_24)
        for (g = 0; 6 > g; g++) h = new Strip(this, e, E_STRIP_TYPE.VCA, g), 0 == g && (h.firstInGroup = !0), g == f - 1 && (h.lastInGroup2 = h.lastInGroup = !0), h.text = "VCA " + (g + 1), this.strips.push(h), vcaStrips.push(h), allStrips.push(h), e++;
      this.arrangeStrips("createStrips")
    },
    arrangeStrips: function(a) {
      if (mode != E_MODE.PLAYER) {
        var b = 0;
        a = this.strips;
        var c = 0 <= activeViewGroup && 10 > activeViewGroup && inView;
        settings.mediaFirst && !c && (mediaStrips[0].enabled &&
          (b += 1), mediaStrips[1].enabled && (b += 1));
        for (var d = auxStrips.length - 2; d < auxStrips.length; d++) inView && inView.contains(auxStrips[d].id) ? auxStrips[d].enabled = !hideHPAUX : hideHPAUX && (auxStrips[d].enabled = !1);
        for (var f = 0, d = 0; d < a.length; d++) {
          var e = a[d];
          if (e.enabled) {
            f++;
            if (c) b = inView.indexOf(e.id), e.firstInGroup = !0, e.lastInGroup = !0;
            else if (settings.mediaFirst && e.type == E_STRIP_TYPE.MEDIA) {
              e.x = e.subId * measures.mixerStripWidth;
              continue
            }
            e.x = b * measures.mixerStripWidth;
            b++
          }
        }
        var b = -1,
          g = null;
        if (!c)
          for (d = 0; d < a.length; d++) e =
            a[d], e.enabled ? (b != e.type ? (e.firstInGroup = !0, e.lastInGroup = !1, null != g && (g.lastInGroup = !0), b = e.type) : (e.firstInGroup = !1, e.lastInGroup = !1), g = e) : (e.firstInGroup = !1, e.lastInGroup = !1);
        g && (g.lastInGroup = !0);
        this.realWidth = f * measures.mixerStripWidth;
        this.vis = f
      }
    },
    gotoEnd: function() {
      var a = this.vis * measures.mixerStripWidth - this.w;
      0 > a && (a = 0);
      this.setOffset(a);
      this.syncOffset()
    },
    gotoStart: function() {
      this.setOffset(0);
      this.syncOffset()
    },
    gotoIdx: function(a) {
      a > this.strips.length || (this.setOffset(this.strips[a].x),
        this.syncOffset())
    },
    gotoBank: function(a) {
      var b = curSetup.bankSize * a;
      0 > b || b > this.strips.length - 1 || (bankIdx = a, this.setOffset(this.strips[b].x), this.syncOffset())
    },
    goLeft: function() {
      this.setOffset(this.offsetX - this.w);
      this.syncOffset()
    },
    goRight: function() {
      this.setOffset(this.offsetX + this.w);
      this.syncOffset()
    },
    gotoFX: function() {
      clearInterval(ticker);
      this.setOffset(fxStrips[fxStrips.length - 1].x + measures.mixerStripWidth - this.w, !0);
      this.syncOffset()
    },
    gotoAUX: function() {
      clearInterval(ticker);
      this.setOffset((auxStrips[auxStrips.length -
        1].id + 1) * measures.mixerStripWidth - bottomWidget.w, !0);
      this.syncOffset()
    },
    gotoSUB: function() {
      clearInterval(ticker);
      this.setOffset(subStrips[subStrips.length - 1].x + measures.mixerStripWidth - this.w, !0);
      this.syncOffset()
    },
    syncOffset: function() {
      mode != E_MODE.MODALS && (bottomWidget.setOffset2(this.offsetX), bottomWidget.offsetX != this.offsetX && this.setOffset(bottomWidget.offsetX))
    },
    onShow: function() {
      this.syncOffset()
    },
    onDown: function() {
      clearInterval(ticker)
    },
    muteFX: function() {
      if (isBlocked()) showPopupMsg(lang.LOCKED,
        1E3);
      else {
        for (var a = getValue("mgmask") | 1 << MUTEFX_BIT_IDX, b = 0; b < fxStrips.length; b++) {
          var c = fxStrips[b];
          c.setNameValue("forceunmute", 0);
          regUpdate(c)
        }
        setValue("mgmask", a);
        topWidget.led.setMsg(lang.MUTE_FX);
        showPopupMsg(lang.MUTE_FX, 1E3);
        mode == E_MODE.MODALS && regUpdate(tvWidget);
        regUpdate(editWidget);
        regUpdate(fxoutWidget);
        regUpdate(auxWidget);
        checkMutes()
      }
    },
    unMuteFX: function() {
      if (isBlocked()) showPopupMsg(lang.LOCKED, 1E3);
      else {
        for (var a = getValue("mgmask"), b = a & ~(1 << MUTEFX_BIT_IDX), c = checkBit(a, MUTEALL_BIT_IDX),
            d = 0; d < fxStrips.length; d++) {
          var f = fxStrips[d],
            e = f.getNameValue("mgmask");
          1 != f.getNameValue("forceunmute") || 0 != (e & a) || c || (f.setNameValue("forceunmute", 0), f.setNameValue("mute", 0));
          regUpdate(f)
        }
        setValue("mgmask", b);
        topWidget.led.setMsg(lang.MUTE_FX_CANCEL);
        showPopupMsg(lang.MUTE_FX_CANCEL, 1E3);
        mode == E_MODE.MODALS && regUpdate(tvWidget);
        regUpdate(editWidget);
        regUpdate(fxoutWidget);
        regUpdate(auxWidget);
        checkMutes()
      }
    },
    clearSolos: function() {
      if (isBlocked()) showPopupMsg(lang.LOCKED, 1E3);
      else {
        for (var a = 0; a < allStrips.length; a++) allStrips[a].setNameValue("solo",
          0);
        checkSolos();
        topWidget.led.setMsg(lang.CLEAR_ALL_SOLOS);
        showPopupMsg(lang.CLEAR_ALL_SOLOS, 1E3)
      }
    },
    muteAll: function() {
      if (isBlocked()) showPopupMsg(lang.LOCKED, 1E3);
      else {
        for (var a = getValue("mgmask") | 1 << MUTEALL_BIT_IDX, b = 0; b < allStrips.length; b++) allStrips[b].setNameValue("forceunmute", 0);
        setValue("mgmask", a);
        topWidget.led.setMsg(lang.MUTE_ALL);
        showPopupMsg(lang.MUTE_ALL, 1E3);
        mode == E_MODE.MODALS && regUpdate(modalsWidget.pages[0]);
        regUpdate(this);
        regUpdate(auxoutWidget);
        regUpdate(fxoutWidget);
        regUpdate(editWidget);
        regUpdate(auxWidget);
        regUpdate(playerStrips);
        regUpdate(editStripWidget);
        checkMutes()
      }
    },
    cancelMuteAll: function() {
      if (isBlocked()) showPopupMsg(lang.LOCKED, 1E3);
      else {
        for (var a = getValue("mgmask"), b = a & ~(1 << MUTEALL_BIT_IDX), c = checkBit(a, MUTEFX_BIT_IDX), d = 0; d < allStrips.length; d++) {
          var f = allStrips[d],
            e = f.getNameValue("mgmask");
          1 != f.getNameValue("forceunmute") || 0 != (e & a) || c && f.type == E_STRIP_TYPE.FX || (f.setNameValue("forceunmute", 0), f.setNameValue("mute", 0))
        }
        setValue("mgmask", b);
        topWidget.led.setMsg(lang.MUTE_ALL_CANCEL);
        showPopupMsg(lang.MUTE_ALL_CANCEL, 1E3);
        mode == E_MODE.MODALS && regUpdate(modalsWidget.pages[0]);
        regUpdate(this);
        regUpdate(auxoutWidget);
        regUpdate(fxoutWidget);
        regUpdate(editWidget);
        regUpdate(auxWidget);
        regUpdate(playerStrips);
        regUpdate(editStripWidget);
        checkMutes()
      }
    },
    hideAll: function() {
      inView = null; - 1 != activeViewGroup && (activeViewGroup = -1, regUpdate(slideOutWidget)); - 1 != activeSubGroup && (activeSubGroup = -1, regUpdate(slideOutWidget));
      for (var a = 0; a < this.strips.length; a++) this.strips[a].enabled = !1
    },
    showAll: function() {
      mode ==
        E_MODE.EDIT && editStripWidget.unStrip();
      for (var a = 0; a < this.strips.length; a++) this.strips[a].enabled = !0;
      inView = null; - 1 != activeViewGroup && (activeViewGroup = -1, regUpdate(slideOutWidget)); - 1 != activeSubGroup && (activeSubGroup = -1, regUpdate(slideOutWidget));
      gainMixer.showAll();
      this.arrangeStrips("showAll");
      bottomWidget.upd();
      slideOutWidget.clearViewButtons();
      settingsStorage.set("currentViewGroup", -1);
      mode == E_MODE.EDIT && editStripWidget.setStrip();
      mode == E_MODE.GAIN && mixerWidget.setMode(E_MODE.GAIN);
      regUpdate(bottomWidget);
      regUpdate(this)
    },
    showSG: function(a) {
      if (0 > a || a >= curSetup.sub) this.showAll(), activeSubGroup = -1;
      else {
        for (var b = 0, c = 0; c < this.strips.length; c++) this.strips[c].getNameValue("subgroup") == a && b++;
        if (0 == b) this.showAll(), showPopupMsg(lang.NO_ASSIGNED_SUBGROUP.format(a + 1), 1E3);
        else {
          mode == E_MODE.EDIT && editStripWidget.unStrip();
          this.hideAll();
          inView = [];
          for (c = 0; c < this.strips.length; c++) this.strips[c].getNameValue("subgroup") == a && (this.strips[c].enabled = !0, inView.push(this.strips[c].id));
          inView.push(subStrips[a].id);
          subStrips[a].enabled = !0;
          activeSubGroup = a;
          activeViewGroup = 200 + a;
          settingsStorage.set("currentViewGroup", activeViewGroup);
          this.arrangeStrips("showSG");
          gainMixer.syncVG();
          bottomWidget.upd();
          bottomWidget.gotoStart();
          mode == E_MODE.EDIT && editStripWidget.setStrip();
          regUpdate(mixerWidget);
          regUpdate(bottomWidget);
          regUpdate(slideOutWidget)
        }
      }
    },
    showVCA: function(a) {
      for (var b = 0, c = 0; c < this.strips.length; c++) this.strips[c].getNameValue("vca") == a && b++;
      if (0 == b) showPopupMsg(lang.NO_ASSIGNED_CHANNELS, 1E3);
      else if (saveLastActiveVG(),
        0 > a || 6 <= a || !IS_UI_24) this.showAll();
      else {
        mode == E_MODE.EDIT && editStripWidget.unStrip();
        this.hideAll();
        inView = [];
        for (c = 0; c < this.strips.length; c++) b = this.strips[c], b.haveVCA && b.getNameValue("vca") == a && (b.show(), inView.push(b.id));
        inView.push(vcaStrips[a].id);
        vcaStrips[a].enabled = !0;
        activeSubGroup = a;
        activeViewGroup = 300 + a;
        settingsStorage.set("currentViewGroup", activeViewGroup);
        this.arrangeStrips("showVCA");
        gainMixer.syncVG();
        bottomWidget.upd();
        bottomWidget.gotoEnd();
        mode == E_MODE.EDIT && editStripWidget.setStrip();
        regUpdate(mixerWidget);
        regUpdate(bottomWidget);
        regUpdate(slideOutWidget)
      }
    },
    showViewGroup: function(a) {
      if (0 > a || 5 < a) this.showAll(), activeViewGroup = -1, settingsStorage.set("currentViewGroup", -1), regUpdate(slideOutWidget);
      else {
        var b = settings.viewGroups[a] || [];
        0 == b.length ? (this.showAll(), activeViewGroup = -1, settingsStorage.set("currentViewGroup", -1), regUpdate(slideOutWidget), showPopupMsg(lang.NO_ASSIGNED_VIEWGROUP.format(a + 1), 1E3)) : (activeSubGroup = -1, activeViewGroup = a, settingsStorage.set("currentViewGroup",
          a), this.applyVG(b, a), activeViewGroup = a, slideOutWidget.clearGotoButtons(), regUpdate(slideOutWidget))
      }
    },
    applyVG: function(a, b) {
      if (0 == a.length) this.showAll(), activeSubGroup = activeViewGroup = -1, settingsStorage.set("currentViewGroup", -1), regUpdate(slideOutWidget);
      else {
        this.hideAll();
        inView = a;
        for (var c = 0; c < a.length; c++) {
          var d = this.strips[a[c]];
          d && (d.enabled = !0)
        }
        isDefined(b) && (activeViewGroup = b);
        this.arrangeStrips("applyVG");
        gainMixer.syncVG();
        bottomWidget.upd();
        bottomWidget.gotoStart();
        regUpdate(mixerWidget)
      }
    },
    showInputsGroup: function() {
      saveLastActiveVG();
      for (var a = [], b = 0; b < inStrips.length; b++) a.push(inStrips[b].id);
      mixerWidget.applyVG(a);
      activeViewGroup = E_VG.INPUTS;
      settingsStorage.set("currentViewGroup", activeViewGroup)
    },
    showFxGroup: function() {
      saveLastActiveVG();
      for (var a = [], b = 0; b < fxStrips.length; b++) a.push(fxStrips[b].id);
      mixerWidget.applyVG(a);
      activeViewGroup = E_VG.FXS;
      settingsStorage.set("currentViewGroup", activeViewGroup)
    },
    showSubGroup: function() {
      saveLastActiveVG();
      for (var a = [], b = 0; b < subStrips.length; b++) a.push(subStrips[b].id);
      mixerWidget.applyVG(a);
      activeViewGroup = E_VG.SUBS;
      settingsStorage.set("currentViewGroup", activeViewGroup)
    },
    showAuxGroup: function() {
      saveLastActiveVG();
      for (var a = [], b = 0; b < auxStrips.length; b++) a.push(auxStrips[b].id);
      mixerWidget.applyVG(a);
      activeViewGroup = E_VG.AUXS;
      settingsStorage.set("currentViewGroup", activeViewGroup)
    },
    showVCAGroup: function() {
      saveLastActiveVG();
      for (var a = [], b = 0; b < vcaStrips.length; b++) a.push(vcaStrips[b].id);
      mixerWidget.applyVG(a);
      activeViewGroup = E_VG.VCAS;
      settingsStorage.set("currentViewGroup",
        activeViewGroup)
    },
    showPresets: function() {
      this.menu = new PRESET_MENU2(null, "ch", this);
      this.menu.color = selectedStrip.color;
      regUpdate(this.menu)
    },
    savePreset2: function() {
      for (var a = ".eq.easy .eq.bass .eq.mid .eq.treble .eq.hpf.freq .eq.b1.freq .eq.b1.q .eq.b1.gain .eq.b2.freq .eq.b2.q .eq.b2.gain .eq.b3.freq .eq.b3.q .eq.b3.gain .eq.b4.freq .eq.b4.q .eq.b4.gain .dyn.threshold .dyn.gain .dyn.ratio .dyn.softknee .dyn.attack .dyn.outgain .dyn.release .gate.enabled .gate.bypass .gate.thresh .gate.attack .gate.hold .gate.release .gate.depth".split(" "),
          b = {}, c = selectedStrip.name.split("."), c = c[0] + "." + c[1], d = 0; d < a.length; d++) {
        var f = getValue(c + a[d]);
        isDefined(f) && (b[a[d]] = getValue(c + a[d]))
      }
      return b
    },
    savePreset: function() {
      for (var a = selectedStrip.name, b = [], b = b.concat(getKeys(a + "eq.")), b = b.concat(getKeys(a + "dyn.")), b = b.concat(getKeys(a + "gate.")), b = b.filter(function(a) {
          return !a.contains(".enabled")
        }), b = b.filter(function(a) {
          return !a.contains(".bypass")
        }), b = b.filter(function(a) {
          return !a.contains(".prmod")
        }), c = {}, d = 0; d < b.length; d++) {
        var f = b[d],
          e = b[d].replace(a,
            ".");
        c[e] = getValue(f)
      }
      return c
    },
    loadPreset: function(a, b) {
      var c = selectedStrip.name.slice(0, -1);
      applyPreset(c, a);
      regUpdate(editWidget)
    },
    setOffset: function(a, b) {
      if ((this.offsetX | 0) != (a | 0)) {
        var c = this.vis * measures.mixerStripWidth - this.w;
        0 > c && (c = 0);
        this.offsetXold = this.offsetX = bound(a | 0, 0, c);
        regUpdate(this)
      }
    },
    calcGeometry: function() {
      this.w = screenWidth - measures.mixerRightMargin;
      slideOutWidget.enabled && (this.w -= slideOutWidget.w);
      this.h = screenHeight - this.y - bottomWidget.h
    },
    paint: function() {
      ctx.fillStyle = color.bg;
      ctx.fillRect(this.offsetX, 0, this.w, this.h);
      if (this.vis * measures.mixerStripWidth < this.w)
        for (var a = this.vis * measures.mixerStripWidth; a < this.w; a += measures.mixerStripWidth) fillVertPattern(res.blStripTile, this.h, a), drawImage(res.blStripBottom, a, this.h - res.blStripBottom.h()), drawImage(res.blStripTop, a, 0)
    }
  }),
  GainMixer = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "GainMixer";
      this.y = measures.topWidgetHeight;
      this.needClip = !0;
      this.color = color.red;
      this.strips = [];
      this.vis = 0;
      this.createStrips()
    },
    onShow: function() {
      for (var a = 0; a < this.strips.length; a++) this.strips[a].onShow()
    },
    arrangeStrips: function() {
      for (var a = 0, b = 0; b < this.strips.length; b++) this.strips[b].enabled && (this.strips[b].x = a++ * measures.mixerStripWidth);
      this.vis = a;
      this.syncLine()
    },
    createStrips: function() {
      for (var a = curSetup.input, b = 0, c = 0; c < a; c++) {
        var d = inStrips[c],
          f = new GainStrip(this, d.id);
        0 == c && (f.firstInGroup = !0);
        c == a - 1 && (f.lastInGroup = !0);
        f.id = inStrips[c].id;
        f.color = this.color;
        f.text = inStrips[c].text;
        f.st = d;
        this.strips.push(f);
        gainStrips.push(f);
        b++
      }
      if (HAVE_ROUTING)
        for (c = 0; c < a; c++) d = inStrips[c], f = new GainStrip2(this, b, c), f.color = this.color, f.st = d, this.strips.push(f), gainStrips2.push(f), b++;
      this.arrangeStrips()
    },
    showAll: function() {
      this.strips.each(function(a) {
        a.show()
      });
      this.arrangeStrips();
      regUpdate(this)
    },
    setVG: function(a) {
      a && a.length && (gainStrips.each(function(b) {
        a.contains(b.id) ? b.show() : b.hide()
      }), this.arrangeStrips(), regUpdate(this))
    },
    syncLine: function() {
      for (var a = -1, b = null, c = this.strips, d = 0; d < c.length; d++) {
        var f = c[d];
        f.enabled ? (a !=
          f.type ? (f.firstInGroup = !0, f.lastInGroup = !1, null != b && (b.lastInGroup = !0), a = f.type) : (f.firstInGroup = !1, f.lastInGroup = !1), b = f) : (f.firstInGroup = !1, f.lastInGroup = !1)
      }
      null != b && (b.lastInGroup = !0)
    },
    syncVG: function() {
      inView && inView.length ? this.setVG(inView) : this.showAll()
    },
    syncOffset: function() {
      mode != E_MODE.MODALS && (bottomWidget.setOffset2(this.offsetX), bottomWidget.offsetX != this.offsetX && this.setOffset(bottomWidget.offsetX))
    },
    setOffset: function(a) {
      this.offsetX = a;
      0 > this.offsetX && (this.offsetX = 0);
      a = this.strips.length *
        measures.mixerStripWidth - this.w;
      0 > a && (a = 0);
      this.offsetX > a && (this.offsetX = a);
      this.offsetXold = this.offsetX;
      regUpdate(this)
    },
    calcGeometry: function() {
      this.w = screenWidth - measures.mixerRightMargin;
      slideOutWidget.enabled && (this.w -= slideOutWidget.w);
      this.h = screenHeight - this.y - bottomWidget.h;
      var a = this.strips.length * measures.mixerStripWidth - this.w;
      0 > a && (a = 0);
      this.offsetX > a && this.setOffset(this.offsetX)
    },
    paint: function() {
      ctx.fillStyle = color.bg;
      ctx.fillRect(this.offsetX, 0, this.w, this.h);
      if (this.vis * measures.mixerStripWidth <
        this.w)
        for (var a = this.vis * measures.mixerStripWidth; a < this.w; a += measures.mixerStripWidth) fillVertPattern(res.blStripTile, this.h, a), drawImage(res.blStripBottom, a, this.h - res.blStripBottom.h()), drawImage(res.blStripTop, a, 0)
    }
  }),
  SlideOut = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "SlideOut";
      this.y = measures.topWidgetHeight;
      this.w = measures.mixerStripWidth;
      this.mode = 0;
      this.cachedStrip = null;
      this.cachedStripHeight = 0;
      this.initWidgets();
      this.enabled = !1;
      this.muteg.click()
    },
    calcGeometry: function() {
      this.x =
        screenWidth - this.w;
      this.y = topWidget.enabled ? topWidget.h : 0;
      this.h = screenHeight - this.y
    },
    setMode: function(a) {
      this.mode = a
    },
    clearGotoButtons: function() {
      this.inp.state && this.inp.setState(0);
      this.fx.state && this.fx.setState(0);
      this.aux.state && this.aux.setState(0);
      this.sub.state && this.sub.setState(0)
    },
    clearViewButtons: function() {
      for (var a = 0; a < this.buttonsVG.length; a++) this.buttonsVG[a].state && this.buttonsVG[a].setState(0)
    },
    initWidgets: function() {
      var a = this,
        b = 9;
      this.inp = new CheckBox(this);
      this.inp.setPos(6,
        b);
      this.inp.setImages(res.bINPUTS_OFF, res.bINPUTS_ON);
      this.inp.idx = 100;
      this.inp.getState = function() {
        this.state = activeViewGroup == this.idx ? 1 : 0
      };
      this.inp.onToggleUp = function() {
        mode != E_MODE.MIX && setMode(E_MODE.MIX);
        mixerWidget.showInputsGroup()
      };
      this.inp.onToggleDown = function() {
        resumeLastActiveVG()
      };
      this.fx = new CheckBox(this);
      this.fx.setPos(6, b += 41);
      this.fx.setImages(res.bFXRet_OFF, res.bFXRet_ON);
      this.fx.idx = 101;
      this.fx.getState = function() {
        this.state = activeViewGroup == this.idx ? 1 : 0
      };
      this.fx.onToggleUp =
        function() {
          mode != E_MODE.MIX && setMode(E_MODE.MIX);
          mixerWidget.showFxGroup()
        };
      this.fx.onToggleDown = function() {
        resumeLastActiveVG()
      };
      this.sub = new CheckBox(this);
      this.sub.longClickMark = !0;
      this.sub.setPos(6, b += 41);
      this.sub.setImages(res.bSUBGr_OFF, res.bSUBGr_ON);
      this.sub.getState = function() {
        this.state = 102 == activeViewGroup ? 1 : 0
      };
      this.sub.onToggleUp = function() {
        mode != E_MODE.MIX && setMode(E_MODE.MIX);
        mixerWidget.showSubGroup()
      };
      this.sub.onToggleDown = function() {
        100 > lastActiveViewGroup ? mixerWidget.showViewGroup(lastActiveViewGroup) :
          200 <= lastActiveViewGroup && mixerWidget.showSG(lastActiveViewGroup - 200);
        lastActiveViewGroup = -1
      };
      this.sub.onHold = function() {
        modalsWidget.setMode(E_MODAL_MODE.SUBS);
        setMode(E_MODE.MODALS)
      };
      this.aux = new CheckBox(this);
      this.aux.setPos(6, b += 41);
      this.aux.setImages(res.bAUXMast_OFF, res.bAUXMast_ON);
      this.aux.getState = function() {
        this.state = 103 == activeViewGroup ? 1 : 0
      };
      this.aux.onToggleUp = function() {
        mode != E_MODE.MIX && setMode(E_MODE.MIX);
        mixerWidget.showAuxGroup()
      };
      this.aux.onToggleDown = function() {
        resumeLastActiveVG()
      };
      this.vca = new CheckBox(this);
      this.vca.setImages(res.SO_B_BTN_OFF, res.SO_B_BTN_YLW);
      this.vca.setAnchors(6, b + 41);
      this.vca.textParam.font = "11pt open_sans_condensedbold";
      this.vca.idx = E_VG.VCAS;
      this.vca.text = formatButtonText(lang.VCA_MASTERS);
      this.vca.getState = function() {
        this.state = activeViewGroup == this.idx ? 1 : 0
      };
      this.vca.onToggleUp = function() {
        mode != E_MODE.MIX && setMode(E_MODE.MIX);
        mixerWidget.showVCAGroup()
      };
      this.vca.onToggleDown = function() {
        resumeLastActiveVG()
      };
      this.vca.hide();
      this.GOTOS = [this.inp, this.fx,
        this.sub, this.aux
      ];
      this.buttonsB = [];
      this.buttonsVG = [];
      this.buttonsMG = [];
      this.viewg = new EQButton(this);
      this.viewg.needBG = !1;
      this.viewg.longClickMark = !0;
      this.viewg.mode = 1;
      this.viewg.setPos(6, 184);
      this.viewg.setImages(res.bVIEWGr_OFF, res.bVIEWGr_ON);
      this.viewg.valueFunc = function() {
        for (var b = 0; b < a.buttonsVG.length; b++) a.buttonsVG[b].enabled = !0;
        for (b = 0; b < a.buttonsMG.length; b++) a.buttonsMG[b].enabled = !1
      };
      this.viewg.onHold = function() {
        modalsWidget.setMode(E_MODAL_MODE.VIEWS);
        setMode(E_MODE.MODALS)
      };
      this.muteg =
        new EQButton(this);
      this.muteg.needBG = !1;
      this.muteg.longClickMark = !0;
      this.muteg.mode = 2;
      this.muteg.setPos(6, 225);
      this.muteg.setImages(res.bMuteGr_OFF, res.bMuteGr_ON);
      this.muteg.valueFunc = function() {
        for (var b = 0; b < a.buttonsVG.length; b++) a.buttonsVG[b].enabled = !1;
        for (b = 0; b < a.buttonsMG.length; b++) a.buttonsMG[b].enabled = !0
      };
      this.muteg.onHold = function() {
        modalsWidget.setMode(E_MODAL_MODE.MUTES);
        setMode(E_MODE.MODALS)
      };
      for (b = 0; 6 > b; b++) {
        var c = new CheckBox(this);
        c.setPos(0 == b % 2 ? 6 : 65, 273 + 40 * (b / 2 | 0));
        c.setImages(res["b" +
          (b + 1)], res["b" + (b + 1) + "B"]);
        c.setSize(40, 30);
        c.idx = b;
        c.getState = function() {
          this.state = activeViewGroup == this.idx ? 1 : 0
        };
        c.onToggleUp = function() {
          0 == settings.viewGroups[this.idx].length ? (showPopupMsg(lang.NO_ASSIGNED_VIEWGROUP.format(this.idx + 1), 800), this.state = 0) : mixerWidget.showViewGroup(this.idx)
        };
        c.onToggleDown = function() {
          mixerWidget.showAll()
        };
        this.buttonsVG.push(c)
      }
      for (b = 0; 6 > b; b++) c = new CheckBox(this), c.setPos(0 == b % 2 ? 6 : 65, 273 + 40 * (b / 2 | 0)), c.setImages(res["b" + (b + 1)], res["b" + (b + 1) + "R"]), c.setSize(40,
        30), c.idx = b, c.getState = function() {
        this.state = getMGroupState(this.idx)
      }, c.onToggleUp = function() {
        muteGroupON(this.idx)
      }, c.onToggleDown = function() {
        muteGroupOFF(this.idx)
      }, this.buttonsMG.push(c);
      this.tap = new Button(this);
      this.tap.lastTapTime = 0;
      this.tap.longClickMark = !0;
      this.tap.setImages(res.bTAP, res.bTAP_Pressed);
      this.tap.setPos(6, 400);
      this.tap.valueFunc = bpmTapHandler;
      this.tap.onHold = askBpm;
      this.mutefx = new CheckBox(this);
      this.mutefx.setPos(63, 458);
      this.mutefx.setImages(res.bMuteFX_OFF, res.bMuteFX_ON);
      this.mutefx.getState = function() {
        this.state = checkBit(getValue("mgmask"), MUTEFX_BIT_IDX) ? 1 : 0
      };
      this.mutefx.onToggleUp = function() {
        mixerWidget.muteFX()
      };
      this.mutefx.onToggleDown = function() {
        mixerWidget.unMuteFX()
      };
      this.muteall = new CheckBox(this);
      this.muteall.setPos(6, 458);
      this.muteall.setImages(res.bMuteAll_OFF, res.bMuteAll_ON);
      this.muteall.getState = function() {
        this.state = checkBit(getValue("mgmask"), MUTEALL_BIT_IDX) ? 1 : 0
      };
      this.muteall.onToggleUp = function() {
        mixerWidget.muteAll()
      };
      this.muteall.onToggleDown =
        function() {
          mixerWidget.cancelMuteAll()
        };
      this.MOREME = new Button(this);
      this.MOREME.setImages(res.MOME_OFF, res.MOME_ON);
      this.MOREME.setPos(6, 518);
      this.MOREME.onPress = function() {
        modalsWidget.setMode(E_MODAL_MODE.MOREME);
        setMode(E_MODE.MODALS)
      }
    },
    onShow: function() {},
    onHide: function() {},
    paint: function() {
      this.cachedStripHeight != this.w && this.cachePaint();
      ctx.drawImage(this.cachedStrip, 0, 0, this.w, this.h);
      var a = 174;
      ctx.fillStyle = "rgba(0,0,0,0.1)";
      ctx.fillRect(10, a - 1, this.w - 20, 3);
      ctx.fillStyle = "rgba(255,255,255,0.3)";
      ctx.fillRect(10, a, this.w - 20, 1);
      a = 392;
      ctx.fillStyle = "rgba(0,0,0,0.1)";
      ctx.fillRect(10, a - 1, this.w - 20, 3);
      ctx.fillStyle = "rgba(255,255,255,0.3)";
      ctx.fillRect(10, a, this.w - 20, 1);
      a = 508;
      ctx.fillStyle = "rgba(0,0,0,0.1)";
      ctx.fillRect(10, a - 1, this.w - 20, 3);
      ctx.fillStyle = "rgba(255,255,255,0.3)";
      ctx.fillRect(10, a, this.w - 20, 1);
      666 < this.h && drawImage(res.soBottom, 0, this.h - res.soBottom.h() + (697 > this.h ? 16 : 0))
    },
    cachePaint: function() {
      null != this.cachedStrip && delete this.cachedStrip;
      this.cachedStrip = document.createElement("canvas");
      var a = this.cachedStrip.getContext("2d");
      isRetina ? (this.cachedStrip.width = 2 * this.w, this.cachedStrip.height = 2 * this.h, a.scale(2, 2)) : (this.cachedStrip.width = this.w, this.cachedStrip.height = this.h);
      fillVertPatternCtx(res.soTile, this.h, a);
      drawImageCtx(res.soTop, 0, 0, a);
      this.cachedStripHeight = this.w
    }
  }),
  SlideOut2 = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "SlideOut2";
      this.y = measures.topWidgetHeight;
      this.w = 2 * measures.mixerStripWidth;
      this.view = 0;
      this.color = "#1593C0";
      this.cachedStrip =
        null;
      this.cachedStripHeight = 0;
      this.condensed = 740 > Math.min(screenHeight, screenWidth);
      this.initWidgets();
      this.mode = 0;
      this.enabled = !1
    },
    setView: function(a) {
      this.view = a;
      this.BANKS_B.each(function(a) {
        a.hide()
      });
      this.PLAYER_B.each(function(a) {
        a.hide()
      });
      this.FUNCS_B.each(function(a) {
        a.hide()
      });
      switch (a) {
        case 0:
          this.BANKS_B.each(function(a) {
            a.show()
          });
          break;
        case 1:
          this.PLAYER_B.each(function(a) {
            a.show()
          });
          break;
        case 2:
          this.FUNCS_B.each(function(a) {
            a.show()
          })
      }
      regUpdate(this)
    },
    calcGeometry: function() {
      this.x =
        screenWidth - this.w;
      this.y = topWidget.enabled ? topWidget.h : 0;
      this.h = screenHeight - this.y
    },
    clearGotoButtons: function() {
      regUpdate(this)
    },
    clearViewButtons: function() {
      regUpdate(this)
    },
    setMode: function(a) {
      this.mode = a;
      regUpdate(this)
    },
    nextMode: function() {
      for (var a = this.view + 1; a < this.buttons.length; a++)
        if (this.buttons[a].enabled) {
          this.buttons[a].click();
          return
        }
      for (a = 0; a < this.view; a++) this.buttons[a].enabled && this.buttons[a].click()
    },
    initWidgets: function() {
      var a = this,
        b = 6,
        c = 7;
      this.banks = new CHECKBUTTON(this);
      this.banks.text = lang.BANKS;
      this.banks.setAnchors(c, b);
      this.banks.w = 65;
      this.banks.color = "#1FC8F2";
      this.banks.bgColor = "#2555A4";
      this.banks.strokeColor = "#1AA6C9";
      this.banks.textColor = "#e9e9f9";
      this.banks.idx = 0;
      this.banks.getState = function() {
        this.state = a.view == this.idx
      };
      this.banks.onToggleUp = function() {
        a.setView(this.idx)
      };
      this.player = new CHECKBUTTON(this);
      this.player.setAnchors(c + this.banks.w + 2, b);
      this.player.w = 65;
      this.player.text = lang.PLAYER;
      this.player.color = "#1FC8F2";
      this.player.bgColor = "#2555A4";
      this.player.strokeColor = "#1AA6C9";
      this.player.textColor = "#e9e9f9";
      this.player.idx = 1;
      this.player.getState = function() {
        this.state = a.view == this.idx
      };
      this.player.onToggleUp = function() {
        a.setView(this.idx)
      };
      this.funcs = new CHECKBUTTON(this);
      this.funcs.setAnchors(c + this.banks.w + 2 + this.player.w + 2, b);
      this.funcs.w = 76;
      this.funcs.text = lang.FUNCTIONS;
      this.funcs.color = "#1FC8F2";
      this.funcs.bgColor = "#2555A4";
      this.funcs.strokeColor = "#1AA6C9";
      this.funcs.textColor = "#e9e9f9";
      this.funcs.idx = 2;
      this.funcs.getState = function() {
        this.state =
          a.view == this.idx
      };
      this.funcs.onToggleUp = function() {
        a.setView(this.idx)
      };
      this.buttons = [this.banks, this.player, this.funcs];
      var b = 50,
        d = 41,
        c = 40;
      this.BANKS_B = [];
      this.PLAYER_B = [];
      this.FUNCS_B = [];
      c = 41;
      this.bank_l = new TButton(this);
      this.bank_l.setAnchors(c, b + d + 1);
      this.bank_l.setImages(res.FFUNC_B_OFF, res.FFUNC_B_YLW);
      this.bank_l.text = "<";
      this.bank_l.onPress = function() {
        mixerWidget.goLeft()
      };
      this.bank_r = new TButton(this);
      this.bank_r.setAnchors(null, b + d + 1, c);
      this.bank_r.setImages(res.FFUNC_B_OFF, res.FFUNC_B_YLW);
      this.bank_r.text = ">";
      this.bank_r.onPress = function() {
        mixerWidget.goRight()
      };
      this.bank_s = new TButton(this);
      this.bank_s.setAnchors(c, b + 1);
      this.bank_s.setImages(res.FFUNC_B_OFF, res.FFUNC_B_YLW);
      this.bank_s.text = lang.START;
      this.bank_s.onPress = function() {
        mixerWidget.gotoStart()
      };
      this.bank_e = new TButton(this);
      this.bank_e.setAnchors(null, b + 1, c);
      this.bank_e.setImages(res.FFUNC_B_OFF, res.FFUNC_B_YLW);
      this.bank_e.text = lang.END;
      this.bank_e.onPress = function() {
        mixerWidget.gotoEnd()
      };
      this.BANKS_B.push(this.bank_l);
      this.BANKS_B.push(this.bank_r);
      this.BANKS_B.push(this.bank_s);
      this.BANKS_B.push(this.bank_e);
      c = 40;
      this.pl = new CheckBox(this);
      this.pl.setAnchors(c, b + d);
      this.pl.setImages(res.PLAYS_OFF, res.PLAYS_STOP);
      this.pl.regKey("var.currentState");
      this.pl.regKey("var.present");
      this.pl.getState = function() {
        this.disabled = 0 == getValue("var.present");
        this.state = 2 == getValue("var.currentState") ? 1 : 0
      };
      this.pl.onToggle = function() {
        doFfunc(E_FFUNC.PLAY)
      };
      this.rec = new CheckBox(this);
      this.rec.setAnchors(null, b + d, c);
      this.rec.setImages(res.RECS_OFF,
        res.RECS_STOP);
      this.rec.regKey("var.recBusy");
      this.rec.regKey("var.isRecording");
      this.rec.regKey("var.present");
      this.rec.getState = function() {
        this.state = getValue("var.isRecording");
        this.disabled = 0 == getValue("var.present") || .5 < getValue("var.recBusy")
      };
      this.rec.onToggle = function() {
        doFfunc(E_FFUNC.REC)
      };
      this.mtkpl = new CheckBox(this);
      this.mtkpl.setAnchors(c, b);
      this.mtkpl.setImages(res.MTK_PLAY, res.MTK_STOP);
      this.mtkpl.regKey("var.mtk.currentState");
      this.mtkpl.regKey("var.mtk.rec.currentState");
      this.mtkpl.regKey("var.mtk.rec.busy");
      this.mtkpl.regKey("var.mtk.present");
      this.mtkpl.getState = function() {
        this.state = 2 == getValue("var.mtk.currentState") ? 1 : 0;
        this.disabled = 0 == getValue("var.mtk.present") || .5 < getValue("var.mtk.rec.busy") || .5 < getValue("var.mtk.rec.currentState")
      };
      this.mtkpl.onToggle = function() {
        doFfunc(E_FFUNC.MTK_PLAY)
      };
      this.mtkrec = new CheckBox(this);
      this.mtkrec.setAnchors(null, b, c);
      this.mtkrec.setImages(res.MTK_REC_OFF, res.MTK_REC_ON);
      this.mtkrec.regKey("var.mtk.rec.currentState");
      this.mtkrec.regKey("var.mtk.rec.busy");
      this.mtkrec.regKey("var.mtk.currentState");
      this.mtkrec.regKey("var.mtk.present");
      this.mtkrec.getState = function() {
        this.state = getValue("var.mtk.rec.currentState");
        this.disabled = 0 == getValue("var.mtk.present") || .5 < getValue("var.mtk.rec.busy") || 0 != getValue("var.mtk.currentState")
      };
      this.mtkrec.onToggle = function() {
        doFfunc(E_FFUNC.MTK_REC)
      };
      this.PLAYER_B.push(this.pl);
      this.PLAYER_B.push(this.rec);
      this.PLAYER_B.push(this.mtkpl);
      this.PLAYER_B.push(this.mtkrec);
      this.newsnap = new Button(this);
      this.newsnap.setAnchors(null,
        b, c);
      this.newsnap.setImages(res.SS_OFF, res.SS_ON);
      this.newsnap.onPress = function() {
        doFfunc(E_FFUNC.NEWSNAP)
      };
      this.nextsnap = new Button(this);
      this.nextsnap.setAnchors(null, b + d, c);
      this.nextsnap.setImages(res.NXT_SNP_OFF, res.NXT_SNP_ON);
      this.nextsnap.onPress = function() {
        doFfunc(E_FFUNC.NEXT_SNAP)
      };
      this.updsnap = new Button(this);
      this.updsnap.setAnchors(c, b);
      this.updsnap.setImages(res.SSUPD_OFF, res.SSUPD_ON);
      this.updsnap.onPress = function() {
        doFfunc(E_FFUNC.UPDCURSNAP)
      };
      this.prevsnap = new Button(this);
      this.prevsnap.setAnchors(c,
        b + d);
      this.prevsnap.setImages(res.PRV_SNP_OFF, res.PRV_SNP_ON);
      this.prevsnap.onPress = function() {
        doFfunc(E_FFUNC.PREV_SNAP)
      };
      this.FUNCS_B.push(this.newsnap);
      this.FUNCS_B.push(this.nextsnap);
      this.FUNCS_B.push(this.updsnap);
      this.FUNCS_B.push(this.prevsnap);
      this.PLAYER_B.each(function(a) {
        a.hide()
      });
      this.FUNCS_B.each(function(a) {
        a.hide()
      });
      c = 16;
      b = 164;
      this.condensed && (b = 158);
      this.views = new CheckBox(this);
      this.views.setImages(res.SO_M_BTN_OFF, res.SO_M_BTN_TUR);
      this.views.setAnchors(c, b);
      this.views.text = lang.VIEWS;
      this.views.textParam.offsetY = -3;
      this.views.getState = function() {
        this.state = 0 == a.mode
      };
      this.views.onToggleUp = function() {
        a.setMode(0)
      };
      this.mutes = new CheckBox(this);
      this.mutes.setImages(res.SO_M_BTN_OFF, res.SO_M_BTN_RED);
      this.mutes.setAnchors(null, b, c);
      this.mutes.text = lang.MUTES;
      this.mutes.textParam.offsetY = -3;
      this.mutes.getState = function() {
        this.state = 1 == a.mode
      };
      this.mutes.onToggleUp = function() {
        a.setMode(1)
      };
      b = 213;
      this.condensed && (b = 202);
      for (var d = 40, f = 0; 6 > f; f++) {
        var e = new CheckBox(this);
        e.setImages(res.SO_L_BTN_OFF,
          res.SO_L_BTN_RED);
        e.setPos(c, b + d * f);
        e.idx = f;
        e.clickOnUp = !0;
        e.longClickMark = !0;
        e.textParam.offsetY = -3;
        e.text = "NAMED GROUP " + f;
        e.getState = function() {
          if (0 == a.mode) {
            var b = 0 == (settings.viewGroups[this.idx] || []).length;
            this.state = activeViewGroup == this.idx ? 1 : 0;
            var c = settings.viewGroupsNames[this.idx];
            c || (c = lang.VIEW_GROUP + " " + (this.idx + 1));
            this.text = c;
            this.textColor = b ? color.gray : color.vgText;
            this.img1 = res.SO_L_BTN_TUR
          } else b = muteGroupEmpty(this.idx), this.state = getMGroupState(this.idx), this.text = getValue("mg." +
            this.idx + ".name") || lang.MUTE_GROUP + " " + (this.idx + 1), this.textColor = b ? color.gray : color.mgText, this.img1 = res.SO_L_BTN_RED
        };
        e.onToggleUp = function() {
          0 == a.mode ? 0 == settings.viewGroups[this.idx].length ? (showPopupMsg(lang.NO_ASSIGNED_VIEWGROUP.format(this.idx + 1), 800), this.state = 0) : mixerWidget.showViewGroup(this.idx) : muteGroupON(this.idx)
        };
        e.onToggleDown = function() {
          0 == a.mode ? mixerWidget.showAll() : muteGroupOFF(this.idx)
        };
        e.onHold = function() {
          0 == a.mode ? (modalsWidget.setMode(E_MODAL_MODE.VIEWS), modalsWidget.pages[E_MODAL_MODE.VIEWS].setMode(this.idx)) :
            (modalsWidget.setMode(E_MODAL_MODE.MUTES), modalsWidget.pages[E_MODAL_MODE.MUTES].setMode(this.idx));
          setMode(E_MODE.MODALS)
        }
      }
      b = 462;
      this.condensed && (b = 450);
      this.mutefx = new CheckBox(this);
      this.mutefx.setPos(c, b);
      this.mutefx.setImages(res.SO_M_BTN_OFF, res.SO_M_BTN_BLU);
      this.mutefx.text = lang.MUTE_FX;
      this.mutefx.textParam.offsetY = -3;
      this.mutefx.getState = function() {
        this.state = checkBit(getValue("mgmask"), MUTEFX_BIT_IDX) ? 1 : 0
      };
      this.mutefx.onToggleUp = function() {
        mixerWidget.muteFX()
      };
      this.mutefx.onToggleDown =
        function() {
          mixerWidget.unMuteFX()
        };
      this.tap = new Button(this);
      this.tap.setAnchors(null, b, c);
      this.tap.lastTapTime = 0;
      this.tap.longClickMark = !0;
      this.tap.textParam.offsetY = -3;
      this.tap.setImages(res.SO_M_BTN_OFF, res.SO_M_BTN_RED);
      this.tap.text = lang.TAP_TEMPO;
      this.tap.valueFunc = bpmTapHandler;
      this.tap.onHold = askBpm;
      b = 539;
      this.condensed && (b = 513);
      this.inp = new CheckBox(this);
      this.inp.setImages(res.SO_B_BTN_OFF, res.SO_B_BTN_YLW);
      this.inp.setAnchors(c, b);
      this.inp.text = lang.INPUTS;
      this.inp.textColor = color.INPUT;
      this.inp.idx = E_VG.INPUTS;
      this.inp.textParam.offsetY = -3;
      this.inp.getState = function() {
        this.state = activeViewGroup == this.idx ? 1 : 0
      };
      this.inp.onToggleUp = function() {
        mode != E_MODE.MIX && setMode(E_MODE.MIX);
        mixerWidget.showInputsGroup()
      };
      this.inp.onToggleDown = function() {
        resumeLastActiveVG()
      };
      this.inp.hide();
      this.fx = new CheckBox(this);
      this.fx.setImages(res.AUXM_OFF, res.AUXM_ON);
      this.fx.setAnchors(c, b);
      this.fx.textColor = "#76A8D6";
      this.fx.text = formatButtonText(lang.FX_MASTERS);
      this.fx.textParam.font = "11pt open_sans_condensedbold";
      this.fx.textParam.offsetY = -3;
      this.fx.idx = E_VG.FXS;
      this.fx.getState = function() {
        this.state = activeViewGroup == this.idx ? 1 : 0
      };
      this.fx.onToggleUp = function() {
        mode != E_MODE.MIX && setMode(E_MODE.MIX);
        mixerWidget.showFxGroup()
      };
      this.fx.onToggleDown = function() {
        resumeLastActiveVG()
      };
      this.fx.contains = function(b, c) {
        if (!this.enabled || !this.visible) return !1;
        var d = b - a.home.x,
          e = c - a.home.y,
          f = a.home.w / 2,
          g = a.home.h / 2;
        return this.enabled && this.visible ? this.x <= b && this.x + this.w > b && this.y <= c && this.y + this.h > c && !isInCircle(f,
          g, 24, d, e) : !1
      };
      this.sub = new CheckBox(this);
      this.sub.setImages(res.FXM_OFF, res.FXM_ON);
      this.sub.setAnchors(null, b, c);
      this.sub.textColor = "#D8A5B9";
      this.sub.textParam.font = "11pt open_sans_condensedbold";
      this.sub.textParam.offsetY = -3;
      this.sub.idx = E_VG.SUBS;
      this.sub.text = formatButtonText(lang.SUB_GROUPS);
      this.sub.getState = function() {
        this.state = activeViewGroup == this.idx ? 1 : 0
      };
      this.sub.onToggleUp = function() {
        mode != E_MODE.MIX && setMode(E_MODE.MIX);
        mixerWidget.showSubGroup()
      };
      this.sub.onToggleDown = function() {
        resumeLastActiveVG()
      };
      this.sub.onHold = function() {
        modalsWidget.setMode(E_MODAL_MODE.SUBS);
        setMode(E_MODE.MODALS)
      };
      this.sub.contains = function(b, c) {
        if (!this.enabled || !this.visible) return !1;
        var d = b - a.home.x,
          e = c - a.home.y,
          f = a.home.w / 2,
          g = a.home.h / 2;
        return this.enabled && this.visible ? this.x <= b && this.x + this.w > b && this.y <= c && this.y + this.h > c && !isInCircle(f, g, 24, d, e) : !1
      };
      this.aux = new CheckBox(this);
      this.aux.setImages(res.SUBG_OFF, res.SUBG_ON);
      this.aux.setAnchors(c, b + 71);
      this.aux.textColor = "#DBCB7A";
      this.aux.textParam.font = "11pt open_sans_condensedbold";
      this.aux.textParam.offsetY = -3;
      this.aux.idx = E_VG.AUXS;
      this.aux.text = formatButtonText(lang.AUX_MASTERS);
      this.aux.getState = function() {
        this.state = activeViewGroup == this.idx ? 1 : 0
      };
      this.aux.onToggleUp = function() {
        mode != E_MODE.MIX && setMode(E_MODE.MIX);
        mixerWidget.showAuxGroup()
      };
      this.aux.onToggleDown = function() {
        resumeLastActiveVG()
      };
      this.aux.contains = function(b, c) {
        if (!this.enabled || !this.visible) return !1;
        var d = b - a.home.x,
          e = c - a.home.y,
          f = a.home.w / 2,
          g = a.home.h / 2;
        return this.enabled && this.visible ? this.x <= b && this.x +
          this.w > b && this.y <= c && this.y + this.h > c && !isInCircle(f, g, 24, d, e) : !1
      };
      this.vca = new CheckBox(this);
      this.vca.setImages(res.VCA_OFF, res.VCA_ON);
      this.vca.setAnchors(null, b + 71, c);
      this.vca.textColor = "#8BD08B";
      this.vca.textParam.font = "11pt open_sans_condensedbold";
      this.vca.textParam.offsetY = -3;
      this.vca.idx = E_VG.VCAS;
      this.vca.text = formatButtonText(lang.VCA_MASTERS);
      this.vca.getState = function() {
        this.state = activeViewGroup == this.idx ? 1 : 0
      };
      this.vca.onToggleUp = function() {
        mode != E_MODE.MIX && setMode(E_MODE.MIX);
        mixerWidget.showVCAGroup()
      };
      this.vca.onToggleDown = function() {
        resumeLastActiveVG()
      };
      this.vca.contains = function(b, c) {
        if (!this.enabled || !this.visible) return !1;
        var d = b - a.home.x,
          e = c - a.home.y,
          f = a.home.w / 2,
          g = a.home.h / 2;
        return this.enabled && this.visible ? this.x <= b && this.x + this.w > b && this.y <= c && this.y + this.h > c && !isInCircle(f, g, 24, d, e) : !1
      };
      this.home = new Button(this);
      this.home.setImages(res.HOME_OFF, res.HOME_ON);
      this.home.setAnchors(c + 71, b + 37);
      this.home.contains = function(a, b) {
        return this.enabled && this.visible ? isInCircle(this.w / 2, this.h /
          2, 24, a - this.x, b - this.y) : !1
      };
      this.home.onPress = function() {
        mixerWidget.showAll()
      }
    },
    onShow: function() {},
    onHide: function() {},
    paint: function() {
      this.cachedStripHeight != this.w && this.cachePaint();
      ctx.drawImage(this.cachedStrip, 0, 0, this.w, this.h)
    },
    drawHeader: function(a, b, c) {
      c.font = "12pt open_sans_condensedbold";
      var d = c.measureText(a).width,
        d = (this.w - d - 20 - 34) / 2 | 0;
      c.fillStyle = "#0A1957";
      c.fillRect(17, b - 2, d, 2);
      c.fillRect(this.w - 17, b - 2, -d, 2);
      c.fillStyle = "#3A88E1";
      c.fillRect(17, b, d, 1);
      c.fillRect(this.w - 17, b, -d,
        1);
      this.condensed && (b += 10);
      c.drawText(a, this.w / 2, b - 6, {
        shadow: [color.black, 0, 1, 1],
        color: "#E0E0E0",
        align: "center",
        font: "12pt open_sans_condensedbold"
      })
    },
    cachePaint: function() {
      null != this.cachedStrip && delete this.cachedStrip;
      this.cachedStrip = document.createElement("canvas");
      var a = this.cachedStrip.getContext("2d");
      isRetina ? (this.cachedStrip.width = 2 * this.w, this.cachedStrip.height = 2 * this.h, a.scale(2, 2)) : (this.cachedStrip.width = this.w, this.cachedStrip.height = this.h);
      a.fillStyle = "#2353A2";
      a.fillRect(0, 0, this.w,
        this.h);
      fillVertPatternCtx(res.SO2_TILE, this.h, a);
      drawImageCtx(res.SO2_BOTTOM, 0, this.h - res.soBottom.h(), a);
      drawImageCtx(res.SO2_TOP, 0, 0, a);
      a.fillStyle = "#1FC8F2";
      a.fillRect(7, 37, this.w - 14, 3);
      this.condensed ? (this.drawHeader(lang.GROUPS, 144, a), this.drawHeader(lang.MASTERS, 500, a)) : (this.drawHeader(lang.GROUPS, 151, a), this.drawHeader(lang.MASTERS, 527, a));
      this.cachedStripHeight = this.w
    }
  });

function saveLastActiveVG() {
  100 <= activeViewGroup && 200 > activeViewGroup || 300 <= activeViewGroup || (lastActiveViewPosition = mixerWidget.offsetX, lastActiveViewGroup = activeViewGroup)
}

function resumeLastActiveVG() {
  100 > lastActiveViewGroup ? mixerWidget.showViewGroup(lastActiveViewGroup) : 300 <= lastActiveViewGroup ? mixerWidget.showVCA(lastActiveViewGroup - 300) : 200 <= lastActiveViewGroup && mixerWidget.showSG(lastActiveViewGroup - 200);
  bottomWidget.setOffset(lastActiveViewPosition);
  lastActiveViewGroup = -1
}

function muteGroupReset(a) {
  if (isBlocked("mixlvl")) showPopupMsg(lang.LOCKED, 1E3);
  else {
    var b = getValue("mgmask"),
      c = 1 << a;
    b & c && muteGroupOFF(a);
    a = mixerWidget.strips;
    for (b = 0; b < a.length; b++) {
      var d = a[b],
        f = d.getNameValue("mgmask"),
        f = f & ~c;
      d.setNameValue("mgmask", f);
      setValue("var.unsaved.mutegroups", 1)
    }
  }
}

function getMGroupState(a) {
  return 0 != (getValue("mgmask") & 1 << a) ? 1 : 0
}

function muteGroupON(a) {
  if (isBlocked("mixlvl")) showPopupMsg(lang.LOCKED, 1E3);
  else {
    for (var b = getValue("mgmask"), c = 1 << a, b = b | c, d = [], f = mixerWidget.strips, e = 0; e < f.length; e++) {
      var g = f[e];
      if (g.getNameValue("mgmask") & c && (d.push(g), g.type == E_STRIP_TYPE.VCA))
        for (var h = 0; h < inStrips.length; h++) inStrips[h].getNameValue("vca") == g.subId && d.push(inStrips[h])
    }
    d = d.uniq();
    c = d.length;
    for (e = 0; e < d.length; e++) g = d[e], g.setNameValue("forceunmute", 0);
    0 == c ? showPopupMsg(lang.NO_ASSIGNED_MG.format(a + 1), 700) : (setValue("mgmask",
      b), showPopupMsg(lang.MUTEGROUP_1_ACTIVATED.format(a + 1), 700), handle_mgmask(!1))
  }
}

function muteGroupOFF(a) {
  if (isBlocked("mixlvl")) showPopupMsg(lang.LOCKED, 1E3);
  else {
    var b = getValue("mgmask"),
      c = b & ~(1 << a);
    checkBit(b, MUTEALL_BIT_IDX);
    checkBit(b, MUTEFX_BIT_IDX);
    b = mixerWidget.strips;
    setValue("mgmask", c);
    for (c = 0; c < b.length; c++) {
      var d = b[c];
      1 != d.getNameValue("forceunmute") || d.getMuteState(!0, !0) || (d.setNameValue("forceunmute", 0), d.setNameValue("mute", 0))
    }
    showPopupMsg(lang.MUTEGROUP_1_DEACTIVATED.format(a + 1), 700);
    handle_mgmask(!1)
  }
}

function muteGroupToggle(a) {
  getMGroupState(a) ? muteGroupOFF(a) : muteGroupON(a)
}

function muteGroupEmpty(a) {
  a = 1 << a;
  for (var b = mixerWidget.strips, c = 0; c < b.length; c++)
    if (b[c].getNameValue("mgmask") & a) return !1;
  return !0
}
var STRIPMENU = Class.create(Widget, {
  initialize: function($super, b, c) {
    $super(b);
    this.widgetName = "SUBMENU";
    this.w = 200;
    this.h = 380;
    this.needMoveEvt = !0;
    this.items = [];
    this.colors = Array(10);
    this.subs = {};
    this.title = c.getName();
    this.titleColor = c.color;
    this.target = c;
    this.tID = c.id;
    switch (c.type) {
      case E_STRIP_TYPE.VCA:
        this.items = [lang.RENAME, lang.RESET_CHANNEL];
        break;
      case E_STRIP_TYPE.IN:
      case E_STRIP_TYPE.LINEIN:
      case E_STRIP_TYPE.MEDIA:
        this.items = [lang.CHANNEL_PRESETS, lang.RENAME, lang.COPY_SETTINGS];
        settingsBufferType ==
          c.type && this.items.push(lang.PASTE_SETTINGS);
        b = this.target.getNameValue("subgroup");
        0 <= b ? (this.subs[this.items.length] = -1, this.items.push(lang.UNASSIGN_SUB_GROUP.format(b + 1))) : this.items.push(lang.ASSIGN_SUB_GROUP.replace(" {0}", ""));
        this.colors[this.items.length - 1] = "#40202C";
        IS_UI_24 && c.haveVCA && (b = this.target.getNameValue("vca"), null != b && 0 <= b ? this.items.push(lang.UNASSIGN_VCA + " " + (b + 1)) : this.items.push(lang.ASSIGN_VCA), this.colors[this.items.length - 1] = "#1A401A"); - 1 != c.getNameValue("stereoIndex") ||
          c.lastInGroup2 || (b = allStrips[c.id + 1]) && -1 == b.getNameValue("stereoIndex") && this.items.push(lang.STEREO_LINK); - 1 != c.getNameValue("stereoIndex") && this.items.push(lang.DISABLE_STEREO_LINK);
        this.items.push(lang.RESET_CHANNEL);
        c.type == E_STRIP_TYPE.MEDIA && this.items.push(settings.mediaFirst ? lang.PLACE_AFTER_INPUTS : lang.PLACE_BEFORE_INPUTS);
        settings.me.contains(c.id) ? this.items.push(lang.UNASSIGN_ME) : this.items.push(lang.ASSIGN_ME);
        this.colors[this.items.length - 1] = "#402600";
        break;
      case E_STRIP_TYPE.FX:
        this.items = [lang.CHANNEL_PRESETS, lang.RENAME, lang.COPY_SETTINGS];
        settingsBufferType == c.type && this.items.push(lang.PASTE_SETTINGS);
        IS_UI_24 && c.haveVCA && (b = this.target.getNameValue("vca"), null != b && 0 <= b ? this.items.push(lang.UNASSIGN_VCA + " " + (b + 1)) : this.items.push(lang.ASSIGN_VCA), this.colors[this.items.length - 1] = "#1A401A");
        this.items.push(lang.RESET_CHANNEL);
        break;
      case E_STRIP_TYPE.SUB:
        this.items = [lang.CHANNEL_PRESETS, lang.RENAME, lang.COPY_SETTINGS];
        settingsBufferType == c.type && this.items.push(lang.PASTE_SETTINGS);
        this.items.push(lang.RESET_CHANNEL);
        mode != E_MODE.MIX && mode != E_MODE.EDIT || activeSubGroup == c.subId || this.items.push(lang.SUB_GROUP_SPREAD);
        break;
      case E_STRIP_TYPE.AUX:
        this.items = [lang.CHANNEL_PRESETS, lang.RENAME, lang.COPY_SETTINGS];
        settingsBufferType == c.type && this.items.push(lang.PASTE_SETTINGS); - 1 != c.getNameValue("stereoIndex") || c.lastInGroup2 || (b = allStrips[c.id + 1], -1 == b.getNameValue("stereoIndex") && this.items.push(lang.STEREO_LINK)); - 1 != c.getNameValue("stereoIndex") && this.items.push(lang.DISABLE_STEREO_LINK);
        this.items.push(lang.RESET_CHANNEL);
        HAVE_MATRIX && (b = c.getNameValue("matrix"), this.items.push(b ? lang.SWITCH_TO_AUX : lang.SWITCH_TO_MATRIX));
        mode == E_MODE.AUX && HAVE_LATENCY && (b = VtoLATENCY(c.getNameValue("delay")), this.items.push(lang.SET_OUTPUT_DELAY + " (" + b + ")"));
        this.items.push(settings.meout == c.subId ? lang.UNASSIGN_MY_OUT : lang.ASSIGN_MY_OUT);
        break;
      case E_STRIP_TYPE.MASTER:
        this.items = [lang.SET_TO_ZERO_DB, lang.MASTER_PRESETS], IS_UI_24 && this.items.push(lang.TOGGLE_DIM), HAVE_LATENCY && (b = VtoLATENCY(getValue("m.delayL")),
          c = VtoLATENCY(getValue("m.delayR")), this.items.push(lang.SET_OUTPUT_DELAY_LEFT + " (" + b + ")"), this.items.push(lang.SET_OUTPUT_DELAY_RIGHT + " (" + c + ")"))
    }!inView || mode != E_MODE.MIX && mode != E_MODE.GAIN && mode != E_MODE.EDIT || this.items.push(lang.SHOW_ALL_CHANNELS);
    this.rh = 30;
    this.h = 94 + this.rh * this.items.length;
    this.mstart = 50;
    this.selected = -1;
    this.startPoint = [-1, -1];
    this.lastPoint = [-1, -1];
    this.poplineX = 50
  },
  onDown: function(a, b) {
    this.startPoint = this.lastPoint = [a, b];
    var c = Math.floor((b - this.globalY() - this.mstart) /
      this.rh);
    c >= this.items.length || 0 > c || (this.selected = c, regUpdate(this))
  },
  onMove: function(a, b) {
    this.lastPoint = [a, b];
    if (40 < Math.abs(this.lastPoint[0] - this.startPoint[0]) || 40 < Math.abs(this.lastPoint[1] - this.startPoint[1])) this.selected = -1;
    regUpdate(this)
  },
  onUp: function() {
    if (20 < Math.abs(this.lastPoint[0] - this.startPoint[0]) || 20 < Math.abs(this.lastPoint[1] - this.startPoint[1])) this.selected = -1; - 1 != this.selected && this.doFunc()
  },
  doFunc: function() {
    var a = this.items[this.selected];
    if (a.contains(lang.UNASSIGN_SUB_GROUP.replace(" {0}",
        ""))) {
      var b = activeSubGroup == this.target.getNameValue("subgroup");
      this.target.setNameValue("subgroup", -1);
      b && mixerWidget.showSG(activeSubGroup);
      updateByKey(this.target.name + "subgroup")
    }
    a.contains(lang.UNASSIGN_VCA) && (this.target.setNameValue("vca", -1), updateByKey(this.target.name + "vca"));
    var c = this.target;
    a.startsWith(lang.SET_OUTPUT_DELAY_LEFT) ? askForDelay(masterWidget, MAX_DELAY_OUTPUT, "delayL", lang.MASTER + " " + lang.OUTPUT_DELAY + " (" + lang.LEFT + ")") : a.startsWith(lang.SET_OUTPUT_DELAY_RIGHT) ? askForDelay(masterWidget,
      MAX_DELAY_OUTPUT, "delayR", lang.MASTER + " " + lang.OUTPUT_DELAY + " (" + lang.RIGHT + ")") : a.startsWith(lang.SET_OUTPUT_DELAY) && askForDelay(c, MAX_DELAY_OUTPUT, "delay", c.getName() + " " + lang.OUTPUT_DELAY);
    switch (a) {
      case lang.TOGGLE_DIM:
        setValue("m.dim", getValue("m.dim") ? 0 : 1);
        regUpdate(masterWidget);
        break;
      case lang.SWITCH_TO_MATRIX:
        c.setNameValue("matrix", 1);
        mode == E_MODE.AUX && auxWidget.upd();
        break;
      case lang.SWITCH_TO_AUX:
        c.setNameValue("matrix", 0);
        mode == E_MODE.AUX && auxWidget.upd();
        break;
      case lang.MASTER_PRESETS:
        clearModals();
        masterWidget.showPresets();
        return;
      case lang.SET_TO_ZERO_DB:
        c.setNameValue("mix", zeroDbPos);
        regUpdate(c);
        break;
      case lang.UNASSIGN_ME:
        settings.me.deleteItem(this.target.id);
        switch (this.target.getNameValue("stereoIndex")) {
          case 0:
            settings.me.deleteItem(this.target.id + 1);
            regUpdate(allStrips[this.target.id + 1]);
            break;
          case 1:
            settings.me.deleteItem(this.target.id - 1), regUpdate(allStrips[this.target.id - 1])
        }
        settingsStorage.save();
        break;
      case lang.ASSIGN_ME:
        settings.me.push(this.target.id);
        switch (this.target.getNameValue("stereoIndex")) {
          case 0:
            settings.me.push(this.target.id +
              1);
            regUpdate(allStrips[this.target.id + 1]);
            break;
          case 1:
            settings.me.push(this.target.id - 1), regUpdate(allStrips[this.target.id - 1])
        }
        settingsStorage.save();
        break;
      case lang.UNASSIGN_MY_OUT:
        settings.meout = -1;
        settingsStorage.save();
        drawAll();
        break;
      case lang.ASSIGN_MY_OUT:
        settings.meout = this.target.subId;
        settingsStorage.save();
        drawAll();
        break;
      case lang.ASSIGN_SUB_GROUP.replace(" {0}", ""):
        clearModals();
        assignMenu = new ASSIGNSG_MENU(this.target);
        return;
      case lang.ASSIGN_VCA:
        clearModals();
        assignMenu = new ASSIGN_VCA_MENU(this.target);
        return;
      case lang.RENAME:
        editOk.valueFunc = function() {
          var a = editBox2.value.toUpperCase();
          c.setName(a);
          drawAll("RENAMING")
        };
        a = c.getNameValue("name");
        showEditBox2(lang.RENAME_CHANNEL.format(c.text), a);
        break;
      case lang.COPY_SETTINGS:
        this.target.copySettings();
        break;
      case lang.PASTE_SETTINGS:
        this.target.pasteSettings();
        break;
      case lang.RESET_CHANNEL:
        confOk.valueFunc = function() {
          var a = c.getNameValue("subgroup");
          c.reset();
          0 <= a && activeSubGroup == a && mixerWidget.showSG(activeSubGroup);
          mode == E_MODE.AUX && (auxWidget.onShow(),
            auxWidget.setMode(auxWidget.mode))
        };
        showConfBox(lang.RESET_CHANNEL);
        break;
      case lang.STEREO_LINK:
        this.target.setLinked(!0);
        mode == E_MODE.AUX && (auxWidget.onShow(), auxWidget.setMode(auxWidget.mode));
        mode == E_MODE.FXSENDS && (fxSendsWidget.onShow(), fxSendsWidget.setMode(auxWidget.mode));
        break;
      case lang.DISABLE_STEREO_LINK:
        this.target.setLinked(!1);
        mode == E_MODE.AUX && (auxWidget.onShow(), auxWidget.setMode(auxWidget.mode));
        break;
      case lang.SUB_GROUP_SPREAD:
        mixerWidget.showSG(this.target.subId);
        break;
      case lang.VCA_GROUP_SPREAD:
        mixerWidget.showVCA(this.target.subId);
        break;
      case lang.SHOW_ALL_CHANNELS:
        mixerWidget.showAll();
        break;
      case lang.PLACE_AFTER_INPUTS:
        settingsStorage.set("mediaFirst", 0);
        mode == E_MODE.EDIT && editStripWidget.unStrip();
        mixerWidget.arrangeStrips("PLACE_AFTER_INPUTS");
        bottomWidget.upd();
        mode == E_MODE.EDIT && editStripWidget.setStrip();
        bottomWidget.gotoID2(selectedChannel);
        break;
      case lang.PLACE_BEFORE_INPUTS:
        settingsStorage.set("mediaFirst", 1);
        mode == E_MODE.EDIT && editStripWidget.unStrip();
        mixerWidget.arrangeStrips("PLACE_BEFORE_INPUTS");
        bottomWidget.upd();
        mode == E_MODE.EDIT && editStripWidget.setStrip();
        bottomWidget.gotoStart();
        break;
      case lang.CHANNEL_PRESETS:
        clearModals();
        mixerWidget.showPresets();
        return
    }
    clearModals()
  },
  onDelete: function() {},
  calcGeometry: function() {
    this.x = this.target.globalX() - 20;
    0 > this.x && (this.x = 0);
    this.y = screenHeight - this.h - measures.bottomWidgetHeight
  },
  paint: function() {
    var a = this.w,
      b = this.h,
      c = b - 20;
    ctx.fillStyle = "#111";
    ctx.strokeStyle = "#BBB";
    ctx.lineWidth = 2;
    ctx.beginPath();
    ctx.moveTo(14, 0);
    ctx.arcTo(a, 0, a, c, 14);
    ctx.arcTo(a, c, 0, c, 14);
    ctx.lineTo(this.poplineX + 20, c);
    ctx.lineTo(this.poplineX, b);
    ctx.lineTo(this.poplineX - 20, c);
    ctx.arcTo(0, c, 0, 0, 14);
    ctx.arcTo(0, 0, a, 0, 14);
    ctx.closePath();
    ctx.fill();
    ctx.stroke();
    c = ctx.createLinearGradient(0, 0, 0, this.h);
    c.addColorStop(0, "rgba(255,255,255,0.1)");
    c.addColorStop(.2, "rgba(255,255,255,0)");
    c.addColorStop(1, "rgba(255,255,255,0)");
    ctx.fillStyle = c;
    ctx.fill();
    ctx.font = font.tabTextSel;
    ctx.textAlign = "center";
    ctx.fillStyle = this.titleColor;
    ctx.drawText(this.title, this.w / 2, 30, {
      max: this.w - 6,
      shadow: [color.black,
        0, 1, 1
      ]
    });
    ctx.fillStyle = "#f0f0f0";
    ctx.beginPath();
    ctx.roundRect(4, 50, a - 8, b - 50 - 40, 6);
    ctx.closePath();
    ctx.fill();
    ctx.fillStyle = "black";
    ctx.textAlign = "left";
    b = this.rh / 2 | 0;
    ctx.textBaseline = "middle";
    ctx.setShadow(null);
    for (c = 0; c < this.items.length; c++) ctx.fillStyle = this.colors[c] || color.black, this.selected == c && (ctx.fillStyle = "rgba(0,0,0,0.1)", ctx.fillRect(6, this.mstart + c * this.rh, a - 12, this.rh), ctx.fillStyle = "red"), ctx.fillText(this.items[c], 12, this.mstart + c * this.rh + b, this.w - 18), ctx.fillStyle = "rgba(0,0,0,0.2)",
      ctx.fillRect(6, this.mstart + (c + 1) * this.rh, a - 12, 1)
  }
});
assignMenu = null;
var ASSIGNSG_MENU = Class.create(Widget, {
    initialize: function($super, b) {
      $super(-1);
      this.widgetName = "ASSIGNSG_MENU";
      this.w = 190;
      this.h = 130;
      this.t = b.name;
      this.tar = b;
      this.text = lang.ASSIGN_SUB_GROUP.format("(" + this.tar.text + ")");
      this.init2();
      this.initWidgets();
      this.calcGeometry();
      regUpdate(this)
    },
    init2: function() {
      this.color = color.sub
    },
    valueFunc: function(a) {
      setValue(this.t + "subgroup", a);
      activeSubGroup == a && mixerWidget.showSG(activeSubGroup);
      this.close()
    },
    initWidgets: function() {
      var a = 10,
        b = this,
        c = 0;
      this.b1 = new SButton(this);
      this.b1.idx = c++;
      this.b1.text = "1";
      this.b1.textColor = this.color;
      this.b1.setPos(a, 28);
      this.b1.setSize(50, 40);
      this.b1.onPress = function() {
        b.valueFunc(this.idx)
      };
      this.b2 = new SButton(this);
      this.b2.idx = c++;
      this.b2.text = "2";
      this.b2.textColor = this.color;
      this.b2.setPos(a += 60, 28);
      this.b2.setSize(50, 40);
      this.b2.onPress = function() {
        b.valueFunc(this.idx)
      };
      this.b3 = new SButton(this);
      this.b3.idx = c++;
      this.b3.text = "3";
      this.b3.textColor = this.color;
      this.b3.setPos(a += 60, 28);
      this.b3.setSize(50, 40);
      this.b3.onPress = function() {
        b.valueFunc(this.idx)
      };
      a = 10;
      this.b4 = new SButton(this);
      this.b4.idx = c++;
      this.b4.text = "4";
      this.b4.textColor = this.color;
      this.b4.setPos(a, 80);
      this.b4.setSize(50, 40);
      this.b4.onPress = function() {
        b.valueFunc(this.idx)
      };
      this.b5 = new SButton(this);
      this.b5.idx = c++;
      this.b5.text = "5";
      this.b5.textColor = this.color;
      this.b5.setPos(a += 60, 80);
      this.b5.setSize(50, 40);
      this.b5.onPress = function() {
        b.valueFunc(this.idx)
      };
      this.b6 = new SButton(this);
      this.b6.idx = c++;
      this.b6.text = "6";
      this.b6.textColor = this.color;
      this.b6.setPos(a += 60, 80);
      this.b6.setSize(50,
        40);
      this.b6.onPress = function() {
        b.valueFunc(this.idx)
      };
      3 > curSetup.sub && this.b3.hide();
      4 > curSetup.sub && this.b4.hide();
      5 > curSetup.sub && this.b5.hide();
      6 > curSetup.sub && this.b6.hide()
    },
    calcGeometry: function() {
      this.x = (screenWidth - this.w) / 2 | 0;
      this.y = (screenHeight - this.h) / 2 | 0
    },
    onDelete: function() {},
    paint: function() {
      ctx.fillStyle = "#111";
      ctx.fillRoundRect(0, 0, this.w, this.h, 10);
      var a = ctx.createLinearGradient(0, 0, this.w, this.h);
      a.addColorStop(0, "rgba(255,255,255,0)");
      a.addColorStop(.2, "rgba(255,255,255,0)");
      a.addColorStop(.5,
        "rgba(255,255,255,0.15)");
      a.addColorStop(.8, "rgba(255,255,255,0)");
      a.addColorStop(1, "rgba(255,255,255,0)");
      ctx.fillStyle = a;
      ctx.fillRoundRect(0, 0, this.w, this.h, 10);
      ctx.roundRect(0, 0, this.w, this.h, 10);
      ctx.strokeStyle = "#333";
      ctx.lineWidth = 2;
      ctx.stroke();
      ctx.drawText(this.text, this.w / 2, 13, {
        font: font.tabText,
        color: this.color,
        shadow: Shadow.main,
        align: "center",
        valign: "middle"
      })
    }
  }),
  ASSIGN_VCA_MENU = Class.create(ASSIGNSG_MENU, {
    init2: function() {
      this.color = color.green;
      this.text = lang.ASSIGN_VCA + " (" + this.tar.text +
        ")"
    },
    valueFunc: function(a) {
      setValue(this.t + "vca", a);
      this.close()
    }
  });

function hasHIZ(a) {
  switch (a.type) {
    case E_STRIP_TYPE.IN:
    case E_STRIP_TYPE.GAIN:
    case E_STRIP_TYPE.HW:
      break;
    default:
      return !1
  }
  if (HAVE_ROUTING) {
    if (a.type == E_STRIP_TYPE.HW) return !!a.hiz;
    switch (a.getNameValue("src")) {
      case "hw.0":
      case "hw.1":
      case "hw.24":
      case "hw.25":
        return !0
    }
  } else switch (a.subId) {
    case 0:
    case 1:
    case 24:
    case 25:
      return !0
  }
  return !1
}

function hasDigi(a) {
  switch (a.type) {
    case E_STRIP_TYPE.IN:
    case E_STRIP_TYPE.GAIN:
      break;
    default:
      return !1
  }
  switch (a.subId) {
    case 0:
    case 1:
    case 24:
    case 25:
      return !0
  }
  return !1
}
var EDIT_PAGE = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "EDIT_PAGE";
      this.buttons = [];
      this.pages = [];
      this.mode = -1;
      this.color = color.white;
      this.lineOverGrad = null;
      this.arr = [];
      this.E_MODE = {
        digi: 0,
        eqch: 1,
        eqaux: 2,
        eqm: 3,
        gate: 4,
        dyn: 5,
        fx: 6,
        aux: 7,
        uix: 8,
        misc: 9
      };
      this.initWidgets();
      this.setMode(0)
    },
    initWidgets: function() {
      this.stereo = new STEREOSEL(this);
      this.stereo.setPos(440, 3);
      this.pages.push(new DIGITECH(this));
      this.pages.push(new EQChannel(this));
      this.pages.push(new EQAux(this));
      this.pages.push(new EQMaster(this));
      this.pages.push(new GATE_PAGE(this));
      this.pages.push(new DYNSubPage(this));
      this.pages.push(new FX_SENDS_EDIT_PAGE(this));
      this.pages.push(new AUX_EDIT_PAGE(this));
      this.pages.push(new UIX_PAGE(this));
      this.pages.push(new ROUTING_EDIT_PAGE(this));
      var a = 0,
        b = new TabButton(this);
      b.textColor = b.color = "#A3A1A2";
      b.mode = a++;
      b.setImage(res.digitech_logo, 5, 8);
      b.setSize(112, 30);
      b.getState = function() {
        this.state = this.parent.mode == this.mode ? 1 : 0;
        this.it = 0 == selectedStrip.getNameValue("digitech.enabled")
      };
      this.buttons.push(b);
      var c = [lang.EQ, lang.EQ, lang.EQ, lang.GATE];
      c.push(HAVE_GATE ? lang.COMP : lang.DYN);
      c.push(lang.FX_SENDS, lang.AUX_SENDS);
      var d = [color.EQ, color.EQ, color.EQ, color.GATE, color.DYN, color.FX, color.AUX],
        f = ["#BF4545", "#BF4545", "#BF4545", color.GATE, color.DYN, color.FX, "#CCB337"];
      c.push("Ui X");
      d.push(color.orange);
      f.push(color.orange);
      HAVE_ROUTING && (c.push(lang.PATCHING), d.push(color.purple), f.push("#9A44AB"));
      for (var e = 0; e < f.length; e++) f[e] = LightenDarkenColor(f[e], 10);
      for (e = 0; e < c.length; e++) b =
        new TabButton(this), b.color = d[e], b.textColor = f[e], b.mode = a++, b.font = "13pt open_sans_condensedbold", b.text = c[e], b.setSize(112, 30), this.buttons.push(b)
    },
    setMode: function(a) {
      if (this.mode != a)
        if (-1 == a) {
          for (var b = 0; b < this.pages.length; b++) this.pages[b].hide();
          regUpdate(this)
        } else if ("undefined" != typeof this.buttons && "undefined" != typeof this.buttons[a] && this.buttons[a].enabled) {
        this.mode = a;
        for (b = 0; b < this.pages.length; b++) this.pages[b].enabled && this.pages[b].hide();
        this.pages[a].show();
        this.color = this.buttons[a].color;
        topWidget.bEDIT.clr1 = this.buttons[a].color;
        regUpdate(topWidget);
        regUpdate(bottomWidget);
        regUpdate(this)
      }
    },
    nextMode: function() {
      for (var a = this.mode + 1; a < this.buttons.length; a++)
        if (this.buttons[a].enabled) {
          this.buttons[a].click();
          return
        }
      for (a = 0; a < this.mode; a++) this.buttons[a].enabled && this.buttons[a].click()
    },
    showPresets: function() {
      this.pages[this.mode].showPresets && this.pages[this.mode].showPresets()
    },
    onShow: function() {
      this.upd()
    },
    upd: function() {
      if (null != selectedStrip) {
        var a = selectedStrip.stereo;
        a ||
          (a = 1 == selectedStrip.getNameValue("stereo") || -1 != selectedStrip.getNameValue("stereoIndex"));
        for (var b = 0; b < this.buttons.length; b++) this.buttons[b].enabled = !1;
        selectedStrip.getNameValue("src");
        var c = [];
        switch (selectedStrip.type) {
          case E_STRIP_TYPE.IN:
          case E_STRIP_TYPE.LINEIN:
          case E_STRIP_TYPE.MEDIA:
            c = [this.E_MODE.eqch, this.E_MODE.dyn];
            HAVE_GATE && c.push(this.E_MODE.gate);
            c.push(this.E_MODE.fx, this.E_MODE.aux);
            hasDigi(selectedStrip) && c.push(this.E_MODE.digi);
            HAVE_ROUTING && selectedStrip.type != E_STRIP_TYPE.MEDIA &&
              c.push(this.E_MODE.misc);
            break;
          case E_STRIP_TYPE.FX:
            c = [this.E_MODE.eqch, this.E_MODE.dyn];
            HAVE_GATE && c.push(this.E_MODE.gate);
            c.push(this.E_MODE.fx, this.E_MODE.aux);
            break;
          case E_STRIP_TYPE.SUB:
            c = [this.E_MODE.eqch, this.E_MODE.dyn];
            HAVE_GATE && c.push(this.E_MODE.gate);
            c.push(this.E_MODE.fx);
            break;
          case E_STRIP_TYPE.AUX:
            c = [this.E_MODE.eqaux, this.E_MODE.dyn];
            HAVE_GATE && c.push(this.E_MODE.gate);
            c.push(this.E_MODE.fx);
            break;
          case E_STRIP_TYPE.MASTER:
            c = [this.E_MODE.eqm, this.E_MODE.dyn], c.push(this.E_MODE.fx,
              this.E_MODE.aux)
        }
        for (b = 0; b < c.length; b++) this.buttons[c[b]].enabled = !0;
        0 == c.length ? this.setMode(-1) : (-1 == c.indexOf(this.mode) && this.setMode(c[0]), this.arr = c, this.calcGeometry(), this.pages[this.mode].enabled || this.pages[this.mode].show(), this.pages[this.mode].onShow(), this.stereo.enabled = !(920 > this.w && 6 < this.arr.length), this.stereo.enabled && (this.stereo.enabled = a), regUpdate(this))
      }
    },
    calcGeometry: function() {
      this.x = editStripWidget.w;
      this.y = topWidget.h;
      this.w = screenWidth - this.x;
      masterWidget.enabled && (this.w -=
        masterWidget.w);
      fxoutWidget.enabled && (this.w -= fxoutWidget.w);
      this.h = screenHeight - this.y - bottomWidget.h;
      var a = 0,
        b = 0;
      this.needClip = 700 > this.w;
      for (var c = 0; c < this.buttons.length; c++) this.buttons[c].enabled && b++;
      (c = selectedStrip.stereo) || (c = 1 == selectedStrip.getNameValue("stereo") || -1 != selectedStrip.getNameValue("stereoIndex"));
      this.stereo.enabled = !(920 > this.w && 6 < this.arr.length);
      this.stereo.enabled && (this.stereo.enabled = c);
      this.stereo.x = this.w - this.stereo.w - 10;
      if (HAVE_ROUTING) {
        for (var b = 0, d = 112, c = 0; c <
          this.buttons.length; c++) this.buttons[c].enabled && b++;
        this.stereo.enabled && b++;
        807 > this.w && 6 < b && (d = 100);
        for (c = 1; c < this.buttons.length; c++) this.buttons[c].w = d
      }
      b = 17;
      for (c = 0; c < this.buttons.length; c++) this.buttons[c].enabled && (this.buttons[c].setPos(b, 5), b += this.buttons[c].w + 1, a++)
    },
    paint: function() {
      ctx.fillStyle = color.eqBg;
      ctx.fillRect(0, 0, this.w, this.h);
      ctx.fillStyle = this.color;
      ctx.fillRect(0, this.h - 3, this.w, 3);
      ctx.fillRect(0, 35, this.w, 4);
      ctx.fillStyle = "#ff0";
      ctx.font = "20pt open_sans_condensedbold";
      ctx.textAlign = "center";
      ctx.fillText(lang.NO_CONTROLS_FOR_THIS_CHANNEL, this.w / 2 | 0, this.h / 2 | 0)
    }
  }),
  EDIT_STRIP = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "EDIT_STRIP";
      this.strip = this.buff = null;
      this.lastClickTime = -1;
      this.onLabel = !1
    },
    onShow: function() {
      this.setStrip()
    },
    onHide: function() {
      this.unStrip()
    },
    setStrip: function() {
      null != this.strip && this.unStrip(); - 1 != selectedChannel && (this.strip = mixerWidget.strips[selectedChannel], this.strip.parent = this, this.buff = [this.strip.x, this.strip.enabled,
        this.strip.lastInGroup, this.strip.firstInGroup
      ], this.strip.x = 0, this.strip.enabled = !0, this.strip.lastInGroup = !0, this.strip.firstInGroup = !0, this.strip.updateGeometry(), this.widgets.push(this.strip))
    },
    unStrip: function() {
      null != this.strip && (this.widgets.pop(), this.strip.parent = mixerWidget, this.buff && (this.strip.x = this.buff[0], this.strip.enabled = this.buff[1], this.strip.lastInGroup = this.buff[2], this.strip.firstInGroup = this.buff[3]), this.buff = this.strip = null)
    },
    calcGeometry: function() {
      this.x = 0;
      this.y = measures.topWidgetHeight;
      this.w = measures.mixerStripWidth;
      this.h = screenHeight - this.y - bottomWidget.h
    },
    paint: function() {
      if (null != this.strip) {
        ctx.fillStyle = color.bg;
        ctx.fillRect(0, 0, this.w, this.h + bottomWidget.h);
        ctx.fillStyle = color.botBG;
        ctx.fillRect(0, 0, this.w, this.h);
        drawImage(res.stripLabel, 0, this.h);
        ctx.fillStyle = this.strip.color;
        ctx.fillRect(2, this.h, this.w - 4, bottomWidget.h - 2);
        ctx.font = font.botChLabel;
        ctx.textAlign = "center";
        var a = this.strip.getName();
        ctx.fillStyle = color.black;
        ctx.fillText(a, this.w / 2 + 2 | 0, this.h + 24 + 1, this.w -
          6);
        ctx.fillStyle = color.labelText;
        ctx.fillText(a, this.w / 2 | 0, this.h + 24, this.w - 6)
      } else fillVertPattern(res.blStripTile, this.h), drawImage(res.blStripBottom, 0, this.h - res.blStripBottom.h()), drawImage(res.blStripLabel, 0, this.h), drawImage(res.blStripTop, 0, 0)
    }
  }),
  USB_SLOTS = 22,
  DAW_SLOTS = 32,
  ROUTING_EDIT_PAGE = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "MISC_PAGE";
      this.needClip = !0;
      this.y = 40;
      this.enabled = !1;
      this.color = color.purple;
      this.inmode = this.scmode = 0;
      this.left = !0;
      this.offsetY =
        0;
      this.hh = this.maxY = 900;
      this.needMoveEvt = this.needClip = !0;
      this.BUTTONS = [];
      this.BUTTONS2 = [];
      this.initWidgets()
    },
    onDown: function(a, b, c) {
      this.lastPressPoint = this.pressPoint;
      this.pressPoint = [a, b + this.offsetY]
    },
    onMove: function(a, b, c) {},
    onUp: function(a) {
      var b = Date.now(),
        c = Math.abs(this.lastPressPoint[0] - this.pressPoint[0]),
        d = Math.abs(this.lastPressPoint[1] - this.pressPoint[1]);
      2 < mouseTargets.length || isDefined(tHash[a]) && 2 < tHash[a].length || (30 > c && 30 > d && b - this.lastClickTime < DBL_CLK_TIME ? (this.onDouble(), this.lastClickTime =
        b - DBL_CLK_TIME) : this.lastClickTime = b)
    },
    onDouble: function() {
      setMode(E_MODE.MIX)
    },
    setMode: function(a) {
      this.scmode = a;
      this.inmode = 0;
      this.sync();
      regUpdate(this)
    },
    setInsertMode: function(a) {
      this.scmode = 0;
      this.inmode = a;
      this.sync();
      regUpdate(this)
    },
    setLeft: function(a) {
      this.left = a;
      this.sync();
      regUpdate(this)
    },
    sync: function() {
      var a = 1 == this.inmode,
        b = selectedStrip.getNameValue(1 == this.scmode ? "scsrc" : "src"),
        c = 0;
      if (isString(b)) switch (b.split(".")[0]) {
        case "ua":
        case "uc":
          c = 1;
          break;
        case "ub":
        case "ud":
          c = 2;
          break;
        default:
          c =
            0
      }
      if (a || !this.insource.enabled) c = 2;
      this.insource.state = c;
      CASCADE_MODE && (20 > selectedStrip.subId ? this.insource.setItems([lang.M_LOCAL, lang.M_USB_A, lang.M_USB_B]) : this.insource.setItems([lang.S_LOCAL, lang.S_USB_A, lang.S_USB_B]))
    },
    onShow: function() {
      this.inmode = 0;
      this.left = !0;
      this.sync()
    },
    calcGeometry: function() {
      this.w = this.parent.w - this.x;
      this.h = this.parent.h - this.y - 5;
      this.maxY = this.hh - this.h;
      0 > this.maxY && (this.maxY = 0);
      this.offsetY = bound(this.offsetY, 0, this.maxY)
    },
    initWidgets: function() {
      var a = this,
        b =
        60,
        c = 0;
      this.clrArr = ["#D08561", "#C35353", color.yellow, color.green];
      this.overview = new MENUBUTTON(this);
      this.overview.text = lang.OVERVIEW;
      this.overview.setPos(15, 30);
      this.overview.setSize(86, 40);
      this.overview.textColor = "#e44";
      this.overview.onPress = function() {
        settingsWidget.setMode(4);
        setMode(E_MODE.SETTINGS)
      };
      ROUTING_TEST_MODE ? (this.clrArr = ["#D08561", color.yellow], this.insource = new SWITCHBOX(this), this.insource.setItems([lang.LOCAL, lang.USB_B]), this.insource.setItemWidth(124), this.insource.setPos(381,
        30), this.insource.h = 40, this.insource.colors = this.clrArr, this.insource.font = font.settingsLabel, this.insource.setState = function(a) {
        this.state = a
      }) : (this.insource = new SWITCHBOX(this), this.insource.setItems([lang.LOCAL, lang.USB_A, lang.USB_B]), this.insource.setItemWidth(124), this.insource.setPos(207, 30), this.insource.h = 40, this.insource.colors = this.clrArr, this.insource.font = font.settingsLabel, this.insource.setState = function(b) {
        a.inmode && (b = 2);
        this.state = b
      });
      this.insource.valueFunc = function() {
        regUpdate(a)
      };
      this.none = new CHECKBUTTON(this);
      this.none.setSize(86, 40);
      ROUTING_TEST_MODE && this.none.setPos(207, 30);
      this.none.text = lang.NONE;
      this.none.color = color.gray;
      this.none.textColor = color.gray;
      this.none.textColor2 = color.white;
      this.none.font = font.sans13pt;
      this.none.getState = function() {
        var b = "src";
        1 == a.scmode && (b = "scsrc");
        this.state = "none" == selectedStrip.getNameValue(b)
      };
      this.none.onToggleUp = function() {
        var b = "src";
        1 == a.scmode && (b = "scsrc");
        selectedStrip.setNameValue(b, "none");
        regUpdate(a)
      };
      this.none.onToggleDown =
        function() {
          1 == a.scmode && (selectedStrip.setNameValue("scsrc", "none"), regUpdate(a))
        };
      this.scheck = new CHECKBUTTON(this);
      this.scheck.setAnchors(687, 30);
      this.scheck.setSize(86, 40);
      this.scheck.text = formatButtonText(lang.SOUNDCHECK_ASSIGN);
      this.scheck.font = font.stripChannel;
      this.scheck.dy = 15;
      this.scheck.textColor = this.scheck.color = color.green;
      this.scheck.textColor2 = color.white;
      this.scheck.getState = function() {
        this.state = a.scmode;
        this.textColor = selectedStrip.getNameValue("scsrc") ? color.green : "#888"
      };
      this.scheck.onToggleUp =
        function() {
          a.setMode(1)
        };
      this.scheck.onToggleDown = function() {
        a.setMode(0)
      };
      for (var b = 58, d = 0; 32 > d; d++) {
        var f = new CHECKBUTTON(this);
        0 == d % 8 && 0 != d && c++;
        f.setSize(86, 46);
        f.setPos(15 + 96 * (d - 8 * c), 86 + b * c);
        f.idx = d;
        f.idx_orig = d;
        f.text = "" + (d + 1);
        f.textColor = color.white;
        f.textColor2 = color.white;
        f.font = font.sans13pt;
        f.getState = function() {
          var b = a.insource.state;
          ROUTING_TEST_MODE && (b = a.insource.state ? 2 : 0);
          var c = 1 == a.scmode;
          this.state = !1;
          this.idx = this.idx_orig;
          CASCADE_MODE && 20 <= selectedStrip.subId && 0 == b && (this.idx +=
            20);
          var d = "",
            f = "";
          switch (b) {
            case 0:
              20 <= this.idx_orig ? (d = lang.LINE_IN + " " + (this.idx_orig % 2 ? "R" : "L"), f = "li", this.idx = this.idx_orig % 2) : (d = lang.INPUT + " " + (this.idx_orig % 22 + 1), f = "hw");
              this.hidden = 22 <= this.idx_orig;
              break;
            case 1:
              d = lang.SLOT + " " + (this.idx + 1);
              f = "ua";
              this.hidden = this.idx_orig >= USB_SLOTS;
              break;
            case 2:
              d = lang.SLOT + " " + (this.idx + 1);
              this.hidden = this.idx_orig >= DAW_SLOTS;
              f = "ub";
              break;
            case 3:
              d = lang.SLOT + " " + (this.idx + 1)
          }
          this.color = this.textColor = a.clrArr[a.insource.state];
          this.text = d;
          d = "src";
          c && (d =
            "scsrc");
          c = selectedStrip.getNameValue(d);
          if (isString(c)) {
            var c = c.split("."),
              d = parseInt(c[1]),
              m = -1;
            switch (c[0]) {
              case "hw":
                m = E_CH_SRC_TYPE.HARDWARE;
                break;
              case "li":
                m = E_CH_SRC_TYPE.HARDWARE;
                break;
              case "ua":
                m = E_CH_SRC_TYPE.USB_A;
                break;
              case "ub":
                m = E_CH_SRC_TYPE.USB_B;
                break;
              case "uc":
                m = E_CH_SRC_TYPE.USB_A;
                break;
              case "ud":
                m = E_CH_SRC_TYPE.USB_B
            }
            CASCADE_MODE && 22 <= selectedStrip.subId && 0 != b && (b += 2);
            this.state = m == b && this.idx == d && f == c[0]
          }
        };
        f.onToggleUp = function() {
          var b = a.insource.state;
          ROUTING_TEST_MODE && (b = a.insource.state ?
            2 : 0);
          var c = 1 == a.scmode;
          CASCADE_MODE && 20 <= selectedStrip.subId && 0 != b && (b += 2);
          var d = "";
          switch (b) {
            case 0:
              d = 20 <= this.idx_orig ? "li." : "hw.";
              break;
            case 1:
              d = "ua.";
              break;
            case 2:
              d = "ub.";
              break;
            case 3:
              d = "uc.";
              break;
            case 4:
              d = "ud."
          }
          var b = this.idx,
            f = "src";
          c && (f = "scsrc");
          selectedStrip.setNameValue(f, d + b);
          regUpdate(a)
        };
        f.onToggleDown = function() {
          1 == a.scmode ? (selectedStrip.setNameValue("scsrc", "none"), regUpdate(a)) : ROUTING_TEST_MODE && (selectedStrip.setNameValue("src", "none"), regUpdate(a))
        };
        this.BUTTONS.push(f)
      }
      c++;
      ROUTING_TEST_MODE ||
        this.none.setPos(687, 86 + b * c);
      this.reset = new MENUBUTTON(this);
      this.reset.text = lang.RESET;
      this.reset.setAnchors(15, 86 + b * c, null, null);
      this.reset.color = color.purple;
      this.reset.w = 86;
      this.reset.h = 40;
      this.reset.onPress = function() {
        var b = 1 == a.scmode,
          c = selectedStrip,
          d = c.subId;
        c.type == E_STRIP_TYPE.IN && (c.setNameValue("src", "hw." + c.subId), c.setNameValue("scsrc", ROUTING_TEST_MODE ? "ub." + c.subId : "ua." + c.subId));
        c.type == E_STRIP_TYPE.LINEIN && (c.setNameValue("src", "li." + c.subId), d += 20, c.setNameValue("scsrc", ROUTING_TEST_MODE ?
          "ub." + d : "ua." + d));
        a.insource.state = b ? ROUTING_TEST_MODE ? 2 : 1 : 0;
        regUpdate(a)
      };
      this.hh = 86 + b * c + b - 10
    },
    paint: function() {
      ctx.fillStyle = color.eqBg;
      ctx.fillRect(0, this.offsetY, this.w, this.h);
      this.scmode && (ctx.fillStyle = "rgba(0,255,0,0.1)", ctx.fillRect(3, 3, this.w - 6, this.none.y + this.none.h + 3));
      this.inmode && (ctx.fillStyle = "rgba(255,100,0,0.1)", ctx.fillRect(9, this.offsetY + 75, 770, 231));
      ctx.textAlign = "center";
      ctx.font = font.settingsLabel;
      var a = lang.CHANNEL_SOURCE + ":";
      ctx.fillStyle = color.white;
      this.insource.enabled &&
        ctx.fillText(a, this.insource.x + this.insource.w / 2, this.insource.y - 8)
    }
  }),
  UIX_PAGE = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "UIX_PAGE";
      this.needClip = !0;
      this.y = 40;
      this.enabled = !1;
      this.color = color.orange;
      this.initWidgets()
    },
    onShow: function() {
      this.sync()
    },
    sync: function() {},
    initWidgets: function() {},
    calcGeometry: function() {
      this.w = this.parent.w - this.x;
      this.h = this.parent.h - this.y - 5
    },
    paint: function() {
      ctx.fillStyle = "#0B0B0B";
      ctx.fillRect(0, this.offsetY, this.w, this.h);
      getValue("settings.demo") &&
        drawImage(res.UIX, (this.w - res.UIX.w()) / 2, (this.h - res.UIX.h()) / 2)
    }
  });

function formatValue(a, b, c, d, f) {
  d = d || !1;
  c = c || "";
  if (isDefined(f) && a <= f) return "-∞";
  b = "" + precision(a, b) + c;
  d && 0 < a && (b = "+" + b);
  return b
}

function VtoGATE_THRESH(a) {
  return 96 * a - 90
}

function VtoGATE_ATTACK(a) {
  return 1 * Math.pow(400, desqr(a))
}

function VtoGATE_RELEASE(a) {
  return 5 * Math.pow(400, desqr(a))
}

function VtoGATE_HOLD(a) {
  return 1 * Math.pow(2E3, desqr(a))
}

function VtoGATE_DEPTH(a) {
  return 60 * a - 60
}
var GATE_PAGE = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "GATE_PAGE";
      this.y = 40;
      this.enabled = !1;
      this.color = color.GATE;
      this.initWidgets()
    },
    calcGeometry: function() {
      this.w = this.parent.w - this.x;
      this.h = this.parent.h - this.y - 5
    },
    onShow: function() {
      this.syncSliders()
    },
    onDown: function(a, b) {
      this.lastPressPoint = this.pressPoint;
      this.pressPoint = [a, b]
    },
    onUp: function(a) {
      var b = Date.now(),
        c = Math.abs(this.lastPressPoint[0] - this.pressPoint[0]),
        d = Math.abs(this.lastPressPoint[1] - this.pressPoint[1]);
      2 < mouseTargets.length || isDefined(tHash[a]) && 2 < tHash[a].length || (30 > c && 30 > d && b - this.lastClickTime < DBL_CLK_TIME ? (this.onDouble(), this.lastClickTime = b - DBL_CLK_TIME) : this.lastClickTime = b)
    },
    onDouble: function() {
      setMode(E_MODE.MIX)
    },
    syncSliders: function() {
      this.enabled && null != selectedStrip && (this.keyPrefix = selectedStrip.name, this.led_thresh.setKeyPrefix(this.keyPrefix), this.led_attack.setKeyPrefix(this.keyPrefix), this.led_release.setKeyPrefix(this.keyPrefix), this.led_hold.setKeyPrefix(this.keyPrefix), this.led_depth.setKeyPrefix(this.keyPrefix),
        this.slTHRESH.setKeyPrefix(this.keyPrefix), this.slATTACK.setKeyPrefix(this.keyPrefix), this.slRELEASE.setKeyPrefix(this.keyPrefix), this.slHOLD.setKeyPrefix(this.keyPrefix), this.slDEPTH.setKeyPrefix(this.keyPrefix), this.bypass.setKeyPrefix(this.keyPrefix))
    },
    initWidgets: function() {
      var a = this;
      this.gate = new GATE_WIDGET(this);
      this.gate.setAnchors(40, 32, 396, 86);
      this.vuIN = new DYNVU(this);
      this.vuIN.setAnchors(null, 30, 370, 86);
      this.vuIN.needGate = !0;
      this.vuOUT = new DYNVU(this);
      this.vuOUT.setAnchors(null, 30, 346,
        86);
      this.led_thresh = new FXLEDPlain(this);
      this.led_thresh.setAnchors(null, null, 336, 13);
      this.led_thresh.keyPart = "gate.thresh";
      this.led_thresh.label = lang.THRESHOLD;
      this.led_thresh.sign = lang.DB;
      this.led_thresh.formatValue = function(a) {
        return formatValue(VtoGATE_THRESH(a), 1, "", !1, -90)
      };
      this.slTHRESH = new EQHSlider2(this);
      this.slTHRESH.setAnchors(16, null, 416, -1);
      this.slTHRESH.keyPart = "gate.thresh";
      this.slTHRESH.defaultValue = -1;
      this.slTHRESH.valueFunc = function() {
        regUpdate(a.gate);
        regUpdate(a.vuIN);
        regUpdate(a.led_thresh);
        selectedStrip.setNameValue("gate.prmod", 1)
      };
      this.led_attack = new FXLEDPlain(this);
      this.led_attack.setAnchors(null, 46, 261, null);
      this.led_attack.w = 60;
      this.led_attack.keyPart = "gate.attack";
      this.led_attack.label = lang.ATTACK;
      this.led_attack.sign = lang.MS;
      this.led_attack.formatValue = function(a) {
        return formatValue(VtoGATE_ATTACK(a), 0)
      };
      this.slATTACK = new EQSlider(this);
      this.slATTACK.setAnchors(null, 90, 267, 87);
      this.slATTACK.keyPart = "gate.attack";
      this.slATTACK.textBot = lang.ATTACK;
      this.slATTACK.mV = [1, findV(VtoGATE_ATTACK,
        10), findV(VtoGATE_ATTACK, 50), findV(VtoGATE_ATTACK, 100), findV(VtoGATE_ATTACK, 200), findV(VtoGATE_ATTACK, 300), 0];
      this.slATTACK.valueFunc = function() {
        regUpdate(a.led_attack);
        0 == selectedStrip.getNameValue("gate.prmod") && (selectedStrip.setNameValue("gate.prmod", 1), regUpdate(a.gate))
      };
      this.led_release = new FXLEDPlain(this);
      this.led_release.setAnchors(null, 46, 95, null);
      this.led_release.w = 60;
      this.led_release.keyPart = "gate.release";
      this.led_release.label = lang.RELEASE;
      this.led_release.sign = lang.MS;
      this.led_release.formatValue =
        function(a) {
          return formatValue(VtoGATE_RELEASE(a), 0)
        };
      this.slRELEASE = new EQSlider(this);
      this.slRELEASE.setAnchors(null, 90, 101, 87);
      this.slRELEASE.keyPart = "gate.release";
      this.slRELEASE.textBot = lang.RELEASE;
      this.slRELEASE.mV = [1, findV(VtoGATE_RELEASE, 10), findV(VtoGATE_RELEASE, 50), findV(VtoGATE_RELEASE, 100), findV(VtoGATE_RELEASE, 200), findV(VtoGATE_RELEASE, 500), findV(VtoGATE_RELEASE, 1E3), 0];
      this.slRELEASE.valueFunc = function() {
        regUpdate(a.led_release);
        0 == selectedStrip.getNameValue("gate.prmod") && (selectedStrip.setNameValue("gate.prmod",
          1), regUpdate(a.gate))
      };
      this.led_hold = new FXLEDPlain(this);
      this.led_hold.setAnchors(null, 46, 178, null);
      this.led_hold.w = 60;
      this.led_hold.keyPart = "gate.hold";
      this.led_hold.label = lang.HOLD;
      this.led_hold.sign = lang.MS;
      this.led_hold.formatValue = function(a) {
        return formatValue(VtoGATE_HOLD(a), 0)
      };
      this.slHOLD = new EQSlider(this);
      this.slHOLD.setAnchors(null, 90, 184, 87);
      this.slHOLD.keyPart = "gate.hold";
      this.slHOLD.textBot = lang.HOLD;
      this.slHOLD.mV = [1, findV(VtoGATE_HOLD, 10), findV(VtoGATE_HOLD, 100), findV(VtoGATE_HOLD,
        200), findV(VtoGATE_HOLD, 500), findV(VtoGATE_HOLD, 1E3), 0];
      this.slHOLD.valueFunc = function() {
        regUpdate(a.led_hold);
        0 == selectedStrip.getNameValue("gate.prmod") && (selectedStrip.setNameValue("gate.prmod", 1), regUpdate(a.gate))
      };
      this.led_depth = new FXLEDPlain(this);
      this.led_depth.setAnchors(null, 46, 12, null);
      this.led_depth.w = 60;
      this.led_depth.keyPart = "gate.depth";
      this.led_depth.label = lang.DEPTH;
      this.led_depth.sign = lang.DB;
      this.led_depth.formatValue = function(a) {
        return formatValue(VtoGATE_DEPTH(a), 1, "", !1, -60)
      };
      this.slDEPTH = new EQSlider(this);
      this.slDEPTH.setAnchors(null, 90, 18, 87);
      this.slDEPTH.keyPart = "gate.depth";
      this.slDEPTH.textBot = lang.DEPTH;
      this.slDEPTH.mV = [1, findV(VtoGATE_DEPTH, -10), findV(VtoGATE_DEPTH, -20), findV(VtoGATE_DEPTH, -30), findV(VtoGATE_DEPTH, -40), findV(VtoGATE_DEPTH, -50), 0];
      this.slDEPTH.valueFunc = function() {
        regUpdate(a.gate);
        regUpdate(a.led_depth);
        0 == selectedStrip.getNameValue("gate.prmod") && selectedStrip.setNameValue("gate.prmod", 1)
      };
      this.bypass = new CheckBox(this);
      this.bypass.keyPart = "gate.bypass";
      this.bypass.setAnchors(null, null, 18, 10);
      this.bypass.setImages(res.bBYPASS_OFF, res.bBYPASS_ON);
      this.bypass.onToggleUp = function() {
        regUpdate(a)
      };
      this.bypass.onToggleDown = function() {
        regUpdate(a)
      };
      this.reset = new Button(this);
      this.reset.setAnchors(null, null, 244, 10);
      this.reset.setImages(res.bRESET_OFF, res.bRESET_ON);
      this.reset.valueFunc = function() {
        a.doReset()
      };
      this.preset = new MENUBUTTON(this);
      this.preset.setSize(130, 29);
      this.preset.setAnchors(null, 10, 10, null);
      this.preset.text = lang.PRESETS;
      this.preset.color =
        color.green;
      this.preset.onPress = function() {
        a.showPresets()
      }
    },
    resetVUs: function() {
      this.vuIN.reset();
      this.vuOUT.reset()
    },
    doReset: function() {
      resetGate(selectedChID);
      regUpdate(this)
    },
    showPresets: function() {
      this.menu = new PRESET_MENU2(null, "gate", this, this.parent.color);
      regUpdate(this.menu)
    },
    savePreset: function(a) {
      var b = [".gate.thresh", ".gate.attack", ".gate.release", ".gate.hold", ".gate.depth"],
        c = {},
        d = this.keyPrefix.split(".");
      key = d[0] + "." + d[1];
      for (d = 0; d < b.length; d++) c[b[d]] = getValue(key + b[d]);
      selectedStrip.setNameValue("gate.prmod",
        0);
      selectedStrip.setNameValue("gate.prname", a || "");
      return c
    },
    loadPreset: function(a, b) {
      log(a);
      var c = selectedStrip.name.slice(0, -1);
      applyPreset(c, a);
      selectedStrip.setNameValue("gate.prmod", 0);
      selectedStrip.setNameValue("gate.prname", b || "");
      regUpdate(this)
    },
    paint: function() {
      ctx.fillStyle = color.eqBg;
      ctx.fillRect(0, 0, this.w, this.h);
      drawImage(res.dbx, this.preset.x - 48, 13);
      ctx.fillStyle = "#101115";
      ctx.fillRect(16, 10, this.w - 16 - 335, this.h - 10 - 60);
      ctx.translate(16, 10);
      ctx.fillStyle = color.grad1;
      ctx.fillRect(1,
        0, this.w - 16 - 335 - 2, 7);
      ctx.translate(-16, -10);
      ctx.textAlign = "center";
      ctx.font = "10px open_sans_condensedbold";
      ctx.fillStyle = "#747577";
      ctx.fillText("IN", this.vuIN.x + 4, this.vuIN.y + this.vuIN.h + 15);
      ctx.fillText("OUT", this.vuOUT.x + 4, this.vuOUT.y + this.vuOUT.h + 15);
      var a = this.gate.h,
        b = this.gate.w,
        c = b / 96,
        d = a / 96;
      ctx.font = font.eqMarks;
      ctx.fillStyle = color.graphMarks;
      var f = "-90 -80 -70 -60 -50 -40 -30 -20 -10 0 +6".split(" ");
      ctx.save();
      ctx.translate(this.gate.x, this.gate.y);
      ctx.textAlign = "left";
      ctx.fillText("-90",
        0, a + 15);
      ctx.fillText("+6", b - 10, a + 15);
      ctx.textAlign = "center";
      for (var b = 1, e = 10; 90 >= e; e += 10) ctx.fillText(f[b++], c * e, a + 15);
      b = 1;
      ctx.textAlign = "right";
      ctx.fillText("-90", -5, a - 2);
      ctx.fillText("+6", -5, 9);
      for (e = 10; 90 >= e; e += 10) ctx.fillText(f[b++], -5, a - d * e + 4);
      ctx.restore()
    }
  }),
  GATE_WIDGET = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "GATE_WIDGET";
      this.needMoveEvt = this.needClip = !0;
      this.grad = null;
      this.bypass = !1;
      this.cachedBgBypass = this.cachedBg = null;
      this.cachedBgW = this.cachedBgH =
        0;
      this.lineColor = "#5ada72";
      this.gradColor1 = "#0a3a24";
      this.gradColor2 = "#00eb58";
      this.touchRadius = 32;
      this.idx = 2;
      this.showPreset = !0;
      this.lastClickIdx = -1;
      this.lastClickPos = [-1, -1];
      this.clickPos = [-1, -1];
      this.lastClickTime = -1;
      this.lastP = !1
    },
    calcGeometry: function() {
      var a = 0 < this.w ? this.w : 1,
        b = 0 < this.h ? this.h : 1;
      this.grad = ctx.createRadialGradient(a / 2, -10, a / 10, a / 2, -10, a / 2 + 10);
      this.grad.addColorStop(0, "rgba(255,255,255,0.2)");
      this.grad.addColorStop(1, "rgba(255,255,255,0)");
      this.grad_active = ctx.createLinearGradient(0,
        b, a / 2, 0);
      this.grad_active.addColorStop(0, this.gradColor2);
      this.grad_active.addColorStop(1, this.gradColor1);
      this.grad_bypass = ctx.createLinearGradient(0, b, a / 2, 0);
      this.grad_bypass.addColorStop(0, "#A0A0A0");
      this.grad_bypass.addColorStop(1, "#505050")
    },
    onDown: function(a, b, c) {
      if (!this.pressed) {
        a -= this.globalX();
        b -= this.globalY();
        this.clickPos = [a, b];
        this.touchID = c;
        this.pressed = !1;
        this.delta = [0, 0];
        c = this.w;
        var d = this.h,
          f = this.h / 96,
          e = selectedStrip.getNameValue("gate.thresh"),
          g = selectedStrip.getNameValue("gate.depth");
        c *= e;
        d *= 1 - e;
        f = bound(d + -(60 * g - 60) * f, d, this.h - 7);
        g = this.touchRadius + 5;
        e = this.touchRadius + 5;
        if (20 > c || c > this.w - 20 || 20 > d || d > this.h - 20) g = this.touchRadius + 14;
        if (20 > c || c > this.w - 20 || 20 > f || f > this.h - 20) e = this.touchRadius + 14;
        isInCircle(c, d, g, a, b) ? (this.idx = 0, this.delta = [c - a, d - b], this.pressed = !0) : isInCircle(c, f, e, a, b) && (this.idx = 1, this.delta = [c - a, f - b], this.pressed = !0);
        regUpdate(this)
      }
    },
    onMove: function(a, b, c) {
      if (this.pressed && this.touchID == c) {
        a += this.delta[0];
        b += this.delta[1];
        a = bound(a - this.globalX(), 0, this.w);
        b = bound(b - this.globalY(), 0, this.h);
        var d = this.h;
        c = this.h / 96;
        var f = selectedStrip.getNameValue("gate.thresh");
        selectedStrip.getNameValue("gate.depth");
        d *= 1 - f;
        switch (this.idx) {
          case 0:
            a = bound(a / this.w, 0, 1);
            selectedStrip.setNameValue("gate.thresh", a);
            regUpdate(this.parent);
            break;
          case 1:
            a = b > this.h - 4 ? 0 : (60 - bound(b - d, 0, this.h - d) / c) / 60, a = bound(a, 0, 1), selectedStrip.setNameValue("gate.depth", a), regUpdate(this.parent)
        }
        regUpdate(this)
      }
    },
    onUp: function(a) {
      if (this.touchID == a) {
        this.delta = [0, 0];
        a = Date.now();
        var b =
          Math.abs(this.lastClickPos[0] - this.clickPos[0]),
          c = Math.abs(this.lastClickPos[1] - this.clickPos[1]);
        a - this.lastClickTime < DBL_CLK_TIME && 30 > b && 30 > c && this.lastClickIdx == this.idx && this.lastP == !this.pressed && setMode(E_MODE.MIX);
        this.moved || (this.lastClickTime = a);
        this.lastClickPos = this.clickPos;
        this.lastClickIdx = this.idx;
        this.lastP = !this.peakGrab;
        this.pressed = !1;
        this.touchID = -1
      }
    },
    drawCircle: function(a, b, c, d, f) {
      d = d || "#fff";
      c = c || !1;
      ctx.lineWidth = c ? 3 : 2;
      ctx.fillStyle = d;
      ctx.strokeStyle = d;
      this.bypass && (ctx.fillStyle =
        "rgba(255,255,255,0.4)", ctx.strokeStyle = "rgba(255,255,255,0.3)");
      ctx.beginPath();
      ctx.arc(a, b, 13, 0, 2 * Math.PI);
      ctx.fill();
      ctx.beginPath();
      ctx.arc(a, b, this.touchRadius + 0, 0, 2 * Math.PI);
      ctx.globalAlpha = .38;
      ctx.fill();
      ctx.globalAlpha = 1;
      c && ctx.stroke();
      ctx.drawText(f, a, b, {
        align: "center",
        valign: "middle",
        font: "bold 14px open_sans_condensedbold",
        color: "#f0f0f0",
        shadow: ["#060606", 0, 1, 1]
      })
    },
    paint: function() {
      ctx.shadowColor = "transparent";
      var a = selectedStrip.getNameValue("gate.bypass"),
        b = selectedStrip.getNameValue("gate.enabled"),
        c = selectedStrip.getNameValue("gate.thresh"),
        d = selectedStrip.getNameValue("gate.depth");
      this.cachedBgW == this.w && this.cachedBgH == this.h || this.cachePaint();
      ctx.drawImage(this.cachedBg, 0, 0, this.w, this.h);
      var f = this.w,
        e = this.h,
        g = this.w / 96,
        h = this.h / 96;
      !a && b ? (ctx.fillStyle = this.grad_active, ctx.strokeStyle = this.lineColor) : (ctx.fillStyle = this.grad_bypass, ctx.strokeStyle = "#555");
      ctx.lineWidth = 2;
      ctx.lineCap = "round";
      var l = c * f,
        b = c * e,
        g = -(60 * d - 60) * g,
        h = -(60 * d - 60) * h;
      ctx.beginPath();
      .001 < d ? (ctx.moveTo(g, e), ctx.lineTo(l,
        e - b + h)) : ctx.moveTo(l, e);
      ctx.lineTo(l, e - b);
      ctx.lineTo(f, 0);
      ctx.stroke();
      ctx.lineTo(f, e);
      ctx.closePath();
      ctx.globalAlpha = .4;
      ctx.fill();
      ctx.globalAlpha = 1;
      l = c * f;
      c = (1 - c) * e;
      g = l;
      b = e - b + h;
      l = bound(l, 7, this.w - 7);
      c = bound(c, 7, this.h - 7);
      g = bound(g, 7, this.w - 7);
      b = bound(b, c, this.h - 7);
      this.drawCircle(g, b, 1 == this.idx, a ? "#666" : 1E-4 > d ? "#8a8" : "#00eb58", "D");
      this.drawCircle(l, c, 0 == this.idx, a ? "#666" : "#00eb58", "T");
      ctx.lineWidth = 1;
      ctx.strokeStyle = "#222";
      ctx.strokeRect(.5, .5, f - 1, e - 1);
      this.showPreset && (a = 1 == selectedStrip.getNameValue("gate.prmod"),
        d = selectedStrip.getNameValue("gate.prname"), ctx.textAlign = "left", ctx.fillStyle = a ? "#444" : color.green, ctx.font = "18px open_sans_condensedbold", ctx.fillText(d, 4, 18, this.w - 10))
    },
    cachePaint: function() {
      null != this.cachedBg && delete this.cachedBg;
      this.cachedBg = document.createElement("canvas");
      var a = this.cachedBg.getContext("2d");
      isRetina ? (this.cachedBg.width = 2 * this.w, this.cachedBg.height = 2 * this.h, a.scale(2, 2)) : (this.cachedBg.width = this.w, this.cachedBg.height = this.h);
      var b = this.w,
        c = this.h,
        d = this.w / 96,
        f = this.h /
        96;
      a.fillStyle = "#0A0B0C";
      a.fillRect(0, 0, b, c);
      isSmall || (a.fillStyle = this.grad, a.fillRect(0, 0, b, c));
      a.strokeStyle = "rgba(255,255,255,0.04)";
      a.lineWidth = 1;
      a.beginPath();
      for (var e = 0; 90 >= e; e += 10) a.moveTo((d * e | 0) + .5, 0), a.lineTo((d * e | 0) + .5, c), a.moveTo(0, (c - f * e | 0) + .5), a.lineTo(b, (c - f * e | 0) + .5);
      a.stroke();
      a.lineWidth = 1;
      a.strokeStyle = "#222";
      a.strokeRect(.5, .5, b - 1, c - 1);
      this.cachedBgW = this.w;
      this.cachedBgH = this.h
    }
  }),
  DIGITECH = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "DIGITECH";
      this.y = this.x = 0;
      this.bgColor = color.eqBg;
      this.bgColor2 = "#000";
      this.setAnchors(0, 40, 0, 5);
      this.needClip = !0;
      this.color = color.DIGI;
      this.mode = 0;
      this.initWidgets();
      this.PEDALS[0].onDown()
    },
    onShow: function() {
      this.connectKeys()
    },
    connectKeys: function() {
      var a = selectedStrip.name;
      this.SWITCHER.setKey(a + "digitech.enabled");
      HAVE_ROUTING || this.hiz.setKey(a + "hiz", !0);
      this.sl1.setKey(a + "digitech.gain");
      this.sl2.setKey(a + "digitech.level");
      this.sl3.setKey(a + "digitech.bass");
      this.sl4.setKey(a + "digitech.mid");
      this.sl5.setKey(a +
        "digitech.treble");
      this.led1.setKey(a + "digitech.gain");
      this.led2.setKey(a + "digitech.level");
      this.led3.setKey(a + "digitech.bass");
      this.led4.setKey(a + "digitech.mid");
      this.led5.setKey(a + "digitech.treble")
    },
    onDown: function(a, b) {},
    setMode: function(a) {
      this.mode = a;
      regUpdate(this)
    },
    initWidgets: function() {
      var a = this,
        b = this.parent,
        c = 10;
      this.SWITCHER = new SWITCHBOX(this);
      this.SWITCHER.setItems([lang.OFF, lang.ON]);
      this.SWITCHER.setAnchors(null, c, 10, null);
      this.SWITCHER.valueFunc = function() {
        regUpdate(b)
      };
      this.hiz =
        new CHECKBUTTON(this);
      this.hiz.setAnchors(null, c, 160, null);
      this.hiz.w = 50;
      this.hiz.text = lang.HI_Z;
      this.hiz.color = this.hiz.textColor = color.yellow;
      this.hiz.textColor2 = color.white;
      this.hiz.onToggleUp = function() {
        1 == selectedStrip.getNameValue("phantom") && (selectedStrip.setNameValue("phantom", 0), blockStrip(selectedStrip.id, PHANTOM_OFF_DELAY))
      };
      if (HAVE_ROUTING) {
        this.hiz.regKey("i.0.src");
        this.hiz.regKey("i.1.src");
        for (var d = 0; d < gainStrips2.length; d++) this.hiz.regKey(gainStrips2[d].gainName + "hiz");
        this.hiz.onToggleUp =
          function() {};
        this.hiz.getState = function() {
          this.state = 0;
          this.disabled = !hasHIZ(selectedStrip);
          if (!this.disabled) {
            var a = selectedStrip.getNameValue("src");
            this.state = getValue(a + ".hiz")
          }
        };
        this.hiz.onToggle = function() {
          var a = gainStrips[selectedStrip.subId];
          a.updGain();
          a.hiz.enabled && a.hiz.doClick()
        }
      }
      this.preset = new MENUBUTTON(this);
      this.preset.setSize(130, 30);
      this.preset.text = lang.PRESETS;
      this.preset.setAnchors(null, c, 262, null);
      this.preset.onPress = function() {
        a.showPresets()
      };
      this.PEDALS = [];
      c = [{
        name: "FX 1 REVERB",
        color: color.blue,
        regKeys: ["f.0.fxtype"],
        getState: function() {
          this.text = fxStrips[0].getName();
          this.state = selectedStrip.getNameValue("fx.0.mute") ? 0 : 1;
          1 == this.state && (this.state = .001 < selectedStrip.getNameValue("fx.0.value"))
        },
        func: function() {
          a.l1.hide();
          a.s1.hide();
          a.l2.show();
          a.s2.show();
          a.l2.label = lang.FX_SEND;
          a.l2.sign = lang.DB;
          a.l2.formatValue = VtoDB2;
          a.l2.setKey(selectedStrip.name + "fx.0.value");
          a.s2.setKey(selectedStrip.name + "fx.0.value");
          var b = this;
          a.s2.valueFunc = function() {
            regUpdate(a.l2);
            regUpdate(b)
          };
          a.s2.dbMarks = !0;
          a.s2.fader = res.eqVFaderBlue;
          a.s2.maxValue = 1;
          a.l3.hide();
          a.s3.hide();
          a.l4.hide();
          a.s4.hide();
          a.l5.hide();
          a.s5.hide();
          a.setMode(this.idx)
        }
      }];
      2 <= curSetup.fx && c.push({
        name: "FX 2",
        color: color.orange,
        regKeys: ["f.1.fxtype"],
        getState: function() {
          this.text = fxStrips[1].getName();
          this.state = selectedStrip.getNameValue("fx.1.mute") ? 0 : 1;
          1 == this.state && (this.state = .001 < selectedStrip.getNameValue("fx.1.value"))
        },
        func: function() {
          a.l2.show();
          a.s2.show();
          a.l2.label = lang.FX_SEND;
          a.l2.sign = lang.DB;
          a.l2.formatValue =
            VtoDB2;
          a.l2.setKey(selectedStrip.name + "fx.1.value");
          a.s2.setKey(selectedStrip.name + "fx.1.value");
          a.s2.dbMarks = !0;
          a.s2.fader = res.eqVFaderOrange;
          var b = this;
          a.s2.valueFunc = function() {
            regUpdate(a.l2);
            regUpdate(b)
          };
          a.l1.hide();
          a.s1.hide();
          a.l3.hide();
          a.s3.hide();
          a.l4.hide();
          a.s4.hide();
          a.l5.hide();
          a.s5.hide();
          a.setMode(this.idx)
        }
      });
      3 <= curSetup.fx && c.push({
        name: "FX 3",
        color: color.purple,
        regKeys: ["f.2.fxtype"],
        getState: function() {
          this.text = fxStrips[2].getName();
          this.state = selectedStrip.getNameValue("fx.2.mute") ?
            0 : 1;
          1 == this.state && (this.state = .001 < selectedStrip.getNameValue("fx.2.value"))
        },
        func: function() {
          a.l2.show();
          a.s2.show();
          a.l2.label = lang.FX_SEND;
          a.l2.sign = lang.DB;
          a.l2.formatValue = VtoDB2;
          a.l2.setKey(selectedStrip.name + "fx.2.value");
          a.s2.setKey(selectedStrip.name + "fx.2.value");
          a.s2.dbMarks = !0;
          a.s2.fader = res.eqVFaderPurple;
          a.s2.maxValue = 1;
          var b = this;
          a.s2.valueFunc = function() {
            regUpdate(a.l2);
            regUpdate(b)
          };
          a.l1.hide();
          a.s1.hide();
          a.l3.hide();
          a.s3.hide();
          a.l4.hide();
          a.s4.hide();
          a.l5.hide();
          a.s5.hide();
          a.setMode(this.idx)
        }
      });
      4 <= curSetup.fx && c.push({
        name: "FX 4",
        regKeys: ["f.3.fxtype"],
        color: color.green,
        getState: function() {
          this.text = fxStrips[3].getName();
          this.state = selectedStrip.getNameValue("fx.3.mute") ? 0 : 1;
          1 == this.state && (this.state = .001 < selectedStrip.getNameValue("fx.3.value"))
        },
        func: function() {
          a.l2.show();
          a.s2.show();
          a.l2.label = lang.FX_SEND;
          a.l2.sign = lang.DB;
          a.l2.formatValue = VtoDB2;
          a.l2.setKey(selectedStrip.name + "fx.3.value");
          a.s2.setKey(selectedStrip.name + "fx.3.value");
          a.s2.dbMarks = !0;
          a.s2.fader = res.eqVFaderGreen;
          a.s2.maxValue =
            1;
          var b = this;
          a.s2.valueFunc = function() {
            regUpdate(a.l2);
            regUpdate(b)
          };
          a.l1.hide();
          a.s1.hide();
          a.l3.hide();
          a.s3.hide();
          a.l4.hide();
          a.s4.hide();
          a.l5.hide();
          a.s5.hide();
          a.setMode(this.idx)
        }
      });
      c.push({
        name: lang.HPF,
        color: color.red,
        getState: function() {
          this.state = 0 < selectedStrip.getNameValue("eq.hpf.freq")
        },
        func: function() {
          a.l2.show();
          a.s2.show();
          a.l2.label = lang.HPF_FREQ;
          a.l2.sign = "hZ";
          a.l2.formatValue = VtoHPFfreq;
          a.l2.setKey(selectedStrip.name + "eq.hpf.freq");
          a.s2.setKey(selectedStrip.name + "eq.hpf.freq");
          a.s2.dbMarks = !1;
          a.s2.fader = res.eqVFaderGray;
          a.s2.maxValue = FREQtoV(1E3);
          a.s2.mV = [0, findV(VtoFREQ, 50), findV(VtoFREQ, 100), findV(VtoFREQ, 200), findV(VtoFREQ, 500), findV(VtoFREQ, 1E3)];
          a.s2.setDefaultValue(null);
          var b = this;
          a.s2.valueFunc = function() {
            regUpdate(a.l2);
            regUpdate(b)
          };
          a.l1.hide();
          a.s1.hide();
          a.l3.hide();
          a.s3.hide();
          a.l4.hide();
          a.s4.hide();
          a.l5.hide();
          a.s5.hide();
          a.setMode(this.idx)
        }
      }, {
        name: lang.NOTCH_F,
        color: color.red,
        getState: function() {
          var a = selectedStrip.name + "eq.b4.";
          if (this.state = isNear(getValue(a +
              "q"), 1)) this.state = isNear(getValue(a + "gain"), 0)
        },
        func: function() {
          a.l2.show();
          a.s2.show();
          a.l2.label = lang.NOTCH_FREQ;
          a.l2.sign = "hZ";
          a.l2.setKey(selectedStrip.name + "eq.b4.freq");
          a.l2.formatValue = VtoFREQ;
          a.s2.setKey(selectedStrip.name + "eq.b4.freq");
          a.s2.dbMarks = !1;
          a.s2.fader = res.eqVFaderPurple;
          a.s2.maxValue = 1;
          a.s2.mV = [0, findV(VtoFREQ, 50), findV(VtoFREQ, 100), findV(VtoFREQ, 200), findV(VtoFREQ, 500), findV(VtoFREQ, 1E3), findV(VtoFREQ, 2E3), findV(VtoFREQ, 5E3), findV(VtoFREQ, 1E4), 1];
          a.s2.setDefaultValue(null);
          var b =
            this;
          a.s2.valueFunc = function(c) {
            var d = selectedStrip.name + "eq.b4.";
            setValue(d + "freq", c);
            setValue(d + "q", 1);
            setValue(d + "gain", 0);
            regUpdate(a.l2);
            regUpdate(b)
          };
          a.l1.hide();
          a.s1.hide();
          a.l3.hide();
          a.s3.hide();
          a.l4.hide();
          a.s4.hide();
          a.l5.hide();
          a.s5.hide();
          a.setMode(this.idx)
        }
      }, {
        name: lang.COMPRESSOR,
        color: color.DYN,
        getState: function() {
          this.state = selectedStrip.getNameValue("dyn.bypass") ? 0 : 1
        },
        func: function() {
          a.l4.show();
          a.s4.show();
          a.l4.label = lang.THRESHOLD;
          a.l4.sign = lang.DB;
          a.l4.setKey(selectedStrip.name +
            "dyn.threshold");
          a.l4.formatValue = function(a) {
            a = VtoTHRESH(a) + ""; - 1 == a.indexOf(".") && (a += ".0");
            return a
          };
          a.s4.setKey(selectedStrip.name + "dyn.threshold");
          a.s4.dbMarks = !1;
          a.s4.mV = [0, findV(VtoTHRESH, 0), findV(VtoTHRESH, -10), findV(VtoTHRESH, -20), findV(VtoTHRESH, -30), findV(VtoTHRESH, -40), findV(VtoTHRESH, -50), findV(VtoTHRESH, -60), findV(VtoTHRESH, -70), findV(VtoTHRESH, -80), 1];
          a.s4.setDefaultValue(findV(VtoTHRESH, -6), !1);
          a.s4.fader = res.eqVFaderGray;
          a.l1.show();
          a.s1.show();
          a.l1.label = lang.RATIO;
          a.l1.sign = "";
          a.l1.setKey(selectedStrip.name + "dyn.ratio");
          a.l1.formatValue = function(a) {
            a = VtoRATIO(a);
            return a = 60 < a ? "inf" : 2 > a ? precision(a, 2) + "" : precision(a, 1) + ""
          };
          a.s1.setKey(selectedStrip.name + "dyn.ratio");
          a.s1.dbMarks = !1;
          a.s1.mV = [1, 1 / 1.2, .625, .5, 1 / 3, .2, .1, 0];
          a.s1.setDefaultValue(1, !1);
          a.s1.fader = res.eqVFaderYellow;
          a.l2.show();
          a.s1.show();
          a.l2.label = lang.ATTACK;
          a.l2.sign = lang.MS;
          a.l2.setKey(selectedStrip.name + "dyn.attack");
          a.l2.formatValue = VtoATTACK;
          a.s2.setKey(selectedStrip.name + "dyn.attack");
          a.s2.dbMarks = !1;
          a.s2.maxValue = 1;
          a.s2.mV = [1, findV(VtoATTACK, 300), findV(VtoATTACK, 200), findV(VtoATTACK, 100), findV(VtoATTACK, 20), 0];
          a.s2.setDefaultValue(findV(VtoATTACK, 30), !1);
          a.s2.fader = res.eqVFaderGray;
          a.l3.show();
          a.s3.show();
          a.l3.label = lang.RELEASE;
          a.l3.sign = lang.MS;
          a.l3.formatValue = VtoREL;
          a.l3.setKey(selectedStrip.name + "dyn.release");
          a.s3.setKey(selectedStrip.name + "dyn.release");
          a.s3.dbMarks = !1;
          a.s3.mV = [1, findV(VtoREL, 100), findV(VtoREL, 500), findV(VtoREL, 1E3), findV(VtoREL, 1500), 0];
          a.s3.setDefaultValue(findV(VtoREL,
            500), !1);
          a.s3.fader = res.eqVFaderGray;
          a.l5.show();
          a.s5.show();
          a.l5.label = lang.GAIN;
          a.l5.sign = lang.DB;
          a.l5.setKey(selectedStrip.name + "dyn.outgain");
          a.l5.formatValue = function(a) {
            return precision(VtoDYNOUTGAIN(a), 1)
          };
          a.s5.setKey(selectedStrip.name + "dyn.outgain");
          a.s5.dbMarks = !1;
          a.s5.fader = res.eqVFaderRed;
          a.s5.setDefaultValue(findV(VtoDYNOUTGAIN, 0));
          a.s5.mV = [1, findV(VtoDYNOUTGAIN, -12), findV(VtoDYNOUTGAIN, 12), findV(VtoDYNOUTGAIN, 24), findV(VtoDYNOUTGAIN, 36), 0];
          a.setMode(this.idx)
        }
      });
      HAVE_GATE ? c.push({
        name: lang.GATE,
        color: color.GATE,
        getState: function() {
          this.state = selectedStrip.getNameValue("gate.enabled") && !selectedStrip.getNameValue("gate.bypass")
        },
        func: function() {
          var b = this;
          a.l4.show();
          a.s4.show();
          a.l4.label = lang.THRESHOLD;
          a.l4.sign = lang.DB;
          a.l4.setKey(selectedStrip.name + "gate.thresh");
          a.l4.formatValue = function(a) {
            return formatValue(VtoGATE_THRESH(a), 1, "", !1, -90)
          };
          a.s4.setKey(selectedStrip.name + "gate.thresh");
          a.s4.dbMarks = !1;
          a.s4.maxValue = 1;
          a.s4.setDefaultValue(0, !1);
          a.s4.mV = [0, findV(VtoGATE_THRESH, 0), findV(VtoGATE_THRESH, -10), findV(VtoGATE_THRESH, -20), findV(VtoGATE_THRESH, -30), findV(VtoGATE_THRESH, -40), findV(VtoGATE_THRESH, -50), findV(VtoGATE_THRESH, -60), findV(VtoGATE_THRESH, -70), findV(VtoGATE_THRESH, -80), 1];
          a.s4.fader = res.eqVFaderGray;
          a.s4.valueFunc = function() {
            regUpdate(a.l4);
            regUpdate(b);
            selectedStrip.setNameValue("gate.prmod", 1)
          };
          a.l1.show();
          a.s1.show();
          a.l1.label = lang.ATTACK;
          a.l1.sign = lang.MS;
          a.l1.setKey(selectedStrip.name + "gate.attack");
          a.l1.formatValue = function(a) {
            return formatValue(VtoGATE_ATTACK(a), 0)
          };
          a.s1.setKey(selectedStrip.name +
            "gate.attack");
          a.s1.dbMarks = !1;
          a.s1.maxValue = 1;
          a.s1.mV = [1, findV(VtoGATE_ATTACK, 10), findV(VtoGATE_ATTACK, 50), findV(VtoGATE_ATTACK, 100), findV(VtoGATE_ATTACK, 200), findV(VtoGATE_ATTACK, 300), 0];
          a.s1.fader = res.eqVFaderGray;
          a.s1.valueFunc = function() {
            regUpdate(a.l1);
            regUpdate(b);
            selectedStrip.setNameValue("gate.prmod", 1)
          };
          a.l2.show();
          a.s2.show();
          a.l2.label = lang.HOLD;
          a.l2.sign = lang.MS;
          a.l2.setKey(selectedStrip.name + "gate.hold");
          a.l2.formatValue = function(a) {
            return formatValue(VtoGATE_HOLD(a), 0)
          };
          a.s2.setKey(selectedStrip.name +
            "gate.hold");
          a.s2.dbMarks = !1;
          a.s2.maxValue = 1;
          a.s2.mV = [1, findV(VtoGATE_HOLD, 10), findV(VtoGATE_HOLD, 100), findV(VtoGATE_HOLD, 200), findV(VtoGATE_HOLD, 500), findV(VtoGATE_HOLD, 1E3), 0];
          a.s2.fader = res.eqVFaderGray;
          a.s2.valueFunc = function() {
            regUpdate(a.l2);
            regUpdate(b);
            selectedStrip.setNameValue("gate.prmod", 1)
          };
          a.l3.show();
          a.s3.show();
          a.l3.label = lang.RELEASE;
          a.l3.sign = lang.MS;
          a.l3.setKey(selectedStrip.name + "gate.release");
          a.l3.formatValue = function(a) {
            return formatValue(VtoGATE_RELEASE(a), 0)
          };
          a.s3.setKey(selectedStrip.name +
            "gate.release");
          a.s3.dbMarks = !1;
          a.s3.maxValue = 1;
          a.s3.mV = [1, findV(VtoGATE_RELEASE, 10), findV(VtoGATE_RELEASE, 50), findV(VtoGATE_RELEASE, 100), findV(VtoGATE_RELEASE, 200), findV(VtoGATE_RELEASE, 500), findV(VtoGATE_RELEASE, 1E3), 0];
          a.s3.fader = res.eqVFaderGray;
          a.s3.valueFunc = function() {
            regUpdate(a.l3);
            regUpdate(b);
            selectedStrip.setNameValue("gate.prmod", 1)
          };
          a.l5.show();
          a.s5.show();
          a.l5.label = lang.DEPTH;
          a.l5.sign = lang.DB;
          a.l5.setKey(selectedStrip.name + "gate.depth");
          a.l5.formatValue = function(a) {
            return formatValue(VtoGATE_DEPTH(a),
              1, "", !1, -60)
          };
          a.s5.setKey(selectedStrip.name + "gate.depth");
          a.s5.dbMarks = !1;
          a.s5.maxValue = 1;
          a.s5.mV = [1, findV(VtoGATE_DEPTH, -10), findV(VtoGATE_DEPTH, -20), findV(VtoGATE_DEPTH, -30), findV(VtoGATE_DEPTH, -40), findV(VtoGATE_DEPTH, -50), 0];
          a.s5.fader = res.eqVFaderGray;
          a.s5.valueFunc = function() {
            regUpdate(a.l5);
            regUpdate(b);
            selectedStrip.setNameValue("gate.prmod", 1)
          };
          a.setMode(this.idx)
        }
      }) : c.push({
        name: lang.GATE,
        color: color.GATE,
        getState: function() {
          this.state = .001 < selectedStrip.getNameValue("gate.thresh")
        },
        func: function() {
          a.l2.show();
          a.s2.show();
          a.l2.label = lang.THRESHOLD;
          a.l2.sign = lang.DB;
          a.l2.setKey(selectedStrip.name + "gate.thresh");
          a.l2.formatValue = function(a) {
            return formatValue(VtoGATE_THRESH(a), 1, "", !1, -90)
          };
          a.s2.setKey(selectedStrip.name + "gate.thresh");
          a.s2.dbMarks = !1;
          a.s2.maxValue = 1;
          a.s2.setDefaultValue(0, !1);
          a.s2.mV = [0, findV(VtoGATE_THRESH, 0), findV(VtoGATE_THRESH, -10), findV(VtoGATE_THRESH, -20), findV(VtoGATE_THRESH, -30), findV(VtoGATE_THRESH, -40), findV(VtoGATE_THRESH, -50), findV(VtoGATE_THRESH, -60), findV(VtoGATE_THRESH, -70),
            findV(VtoGATE_THRESH, -80), 1
          ];
          a.s2.fader = res.eqVFaderGreen;
          var b = this;
          a.s2.valueFunc = function() {
            regUpdate(a.l2);
            regUpdate(b)
          };
          a.l1.hide();
          a.s1.hide();
          a.l3.hide();
          a.s3.hide();
          a.l4.hide();
          a.s4.hide();
          a.l5.hide();
          a.s5.hide();
          a.setMode(this.idx)
        }
      });
      for (var f = 0, d = 0; d < c.length; d++) {
        var e = c[d],
          g = new PEDAL(this);
        g.setAnchors(10 + d % 5 * (g.w + 10), 55 + 90 * (d / 5 | 0), null, null);
        g.text = e.name;
        g.idx = d;
        g.color = e.color;
        e.onLong && (g.onLong = e.onLong);
        (e.regKeys || []).each(function(a) {
          g.regKey(a)
        });
        g.onDown = e.func;
        g.getState =
          e.getState;
        this.PEDALS.push(g);
        0 < d && 0 == d % 5 && f++
      }
      this.CABS = new DIGI_CAB(this);
      this.AMPS = new DIGI_AMP(this);
      d = 11;
      f = d - 11;
      e = 73;
      c = 280;
      this.s1 = new EQSlider(this);
      this.s1.setAnchors(d + 1 * e, 330, null, 10);
      this.s1.fader = res.eqVFaderGreen;
      this.s1.valueFunc = function(b) {
        regUpdate(a.l1)
      };
      this.l1 = new FXLEDPlain(this);
      this.l1.setAnchors(f + 1 * e, c, null, null);
      this.l1.label = "PAR1";
      this.l1.sign = "%";
      this.l1.formatValue = VtoPERCENT;
      this.s2 = new EQSlider(this);
      this.s2.setAnchors(d + 2 * e, 330, null, 10);
      this.s2.fader = res.eqVFaderBlue;
      this.s2.valueFunc = function(b) {
        regUpdate(a.l2)
      };
      this.l2 = new FXLEDPlain(this);
      this.l2.setAnchors(f + 2 * e, c, null, null);
      this.l2.label = "PAR2";
      this.l2.sign = "%";
      this.l2.formatValue = VtoPERCENT;
      this.s3 = new EQSlider(this);
      this.s3.setAnchors(d + 3 * e, 330, null, 10);
      this.s3.fader = res.eqVFaderYellow;
      this.s3.valueFunc = function(b) {
        regUpdate(a.l3)
      };
      this.l3 = new FXLEDPlain(this);
      this.l3.setAnchors(f + 3 * e, c, null, null);
      this.l3.label = "PAR3";
      this.l3.sign = "%";
      this.l3.formatValue = VtoPERCENT;
      this.s4 = new EQSlider(this);
      this.s4.setAnchors(d +
        0 * e, 330, null, 10);
      this.s4.fader = res.eqVFaderYellow;
      this.s4.valueFunc = function(b) {
        regUpdate(a.l4)
      };
      this.l4 = new FXLEDPlain(this);
      this.l4.setAnchors(f + 0 * e, c, null, null);
      this.l4.label = "PAR4";
      this.l4.sign = "%";
      this.l4.formatValue = VtoPERCENT;
      this.s5 = new EQSlider(this);
      this.s5.setAnchors(d + 4 * e, 330, null, 10);
      this.s5.fader = res.eqVFaderYellow;
      this.s5.valueFunc = function(b) {
        regUpdate(a.l5)
      };
      this.l5 = new FXLEDPlain(this);
      this.l5.setAnchors(f + 4 * e, c, null, null);
      this.l5.label = "PAR5";
      this.l5.sign = "%";
      this.l5.formatValue =
        VtoPERCENT;
      d = 15;
      f = d - 11;
      e = 80;
      this.sl5 = new EQSlider(this);
      this.sl5.setAnchors(null, 330, d + 0 * e, 10);
      this.sl5.setDefaultValue(.5);
      this.sl5.fader = res.eqVFaderPurple;
      this.sl5.valueFunc = function(b) {
        regUpdate(a.led5)
      };
      this.sl5.getState = function() {
        this.disabled = 0 == selectedStrip.getNameValue("digitech.enabled")
      };
      this.led5 = new FXLEDPlain(this);
      this.led5.setAnchors(null, c, f + 0 * e, null);
      this.led5.label = lang.TREBLE;
      this.led5.sign = "%";
      this.led5.formatValue = function(a) {
        return (.5 < a ? "+" : "") + (VtoLINRANGE(a, -100, 100) | 0)
      };
      this.sl4 = new EQSlider(this);
      this.sl4.setAnchors(null, 330, d + 1 * e, 10);
      this.sl4.setDefaultValue(.5);
      this.sl4.fader = res.eqVFaderRed;
      this.sl4.valueFunc = function(b) {
        regUpdate(a.led4)
      };
      this.sl4.getState = function() {
        this.disabled = 0 == selectedStrip.getNameValue("digitech.enabled")
      };
      this.led4 = new FXLEDPlain(this);
      this.led4.setAnchors(null, c, f + 1 * e, null);
      this.led4.label = lang.MID;
      this.led4.sign = "%";
      this.led4.formatValue = function(a) {
        return (.5 < a ? "+" : "") + (VtoLINRANGE(a, -100, 100) | 0)
      };
      this.sl3 = new EQSlider(this);
      this.sl3.setAnchors(null,
        330, d + 2 * e, 10);
      this.sl3.setDefaultValue(.5);
      this.sl3.fader = res.eqVFaderGreen;
      this.sl3.valueFunc = function(b) {
        regUpdate(a.led3)
      };
      this.sl3.getState = function() {
        this.disabled = 0 == selectedStrip.getNameValue("digitech.enabled")
      };
      this.led3 = new FXLEDPlain(this);
      this.led3.setAnchors(null, c, f + 2 * e, null);
      this.led3.label = lang.BASS;
      this.led3.sign = "%";
      this.led3.formatValue = function(a) {
        return (.5 < a ? "+" : "") + (VtoLINRANGE(a, -100, 100) | 0)
      };
      this.sl2 = new EQSlider(this);
      this.sl2.setAnchors(null, 330, d + 3 * e, 10);
      this.sl2.valueFunc =
        function(b) {
          regUpdate(a.led2)
        };
      this.sl2.getState = function() {
        this.disabled = 0 == selectedStrip.getNameValue("digitech.enabled")
      };
      this.led2 = new FXLEDPlain(this);
      this.led2.setAnchors(null, c, f + 3 * e, null);
      this.led2.label = lang.LEVEL;
      this.led2.sign = "%";
      this.led2.formatValue = function(a) {
        return VtoPERCENT(a)
      };
      this.sl1 = new EQSlider(this);
      this.sl1.setAnchors(null, 330, d + 4 * e, 10);
      this.sl1.fader = res.eqVFaderOrange;
      this.sl1.valueFunc = function(b) {
        regUpdate(a.led1)
      };
      this.sl1.getState = function() {
        this.disabled = 0 == selectedStrip.getNameValue("digitech.enabled")
      };
      this.led1 = new FXLEDPlain(this);
      this.led1.setAnchors(null, c, f + 4 * e, null);
      this.led1.label = lang.GAIN;
      this.led1.sign = "%";
      this.led1.formatValue = function(a) {
        return VtoPERCENT(a)
      }
    },
    calcGeometry: function() {
      res.AMP_D.h();
      res.CAB_D.h();
      var a = this.w - res.CAB_D.w() + 10,
        b = a + 36,
        c = 50 + res.AMP_D.h();
      this.CABS.setPos(a, c);
      this.AMPS.setPos(b, 50)
    },
    showPresets: function() {
      var a = selectedStrip.getNameValue("digitech.prname");
      this.menu = new PRESET_MENU2(null, "digi", this, "#999", a);
      regUpdate(this.menu)
    },
    savePreset: function() {
      for (var a =
          ".digitech.amp .digitech.bass .digitech.cab .digitech.gain .digitech.level .digitech.mid .digitech.treble .eq.hpf.freq .gate.thresh .dyn.threshold .dyn.ratio .dyn.softknee .dyn.attack .dyn.outgain .dyn.release".split(" "), b = {}, c = selectedStrip.name.split("."), c = c[0] + "." + c[1], d = 0; d < a.length; d++) b[a[d]] = getValue(c + a[d]);
      return b
    },
    loadPreset: function(a, b) {
      var c = selectedStrip.name.slice(0, -1);
      applyPreset(c, a);
      isDefined(b) && setValue(c + ".digitech.prname", b);
      regUpdate(this)
    },
    paint: function() {
      ctx.fillStyle =
        this.bgColor;
      ctx.fillRect(0, 0, this.w, this.h);
      drawText(lang.SHORTCUTS + ":", 12, 36, {
        color: color.white,
        font: "15pt open_sans_condensedbold",
        align: "left"
      })
    }
  }),
  DIGI_CAB = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "DIGI_CAB";
      this.w = res.CAB_D.w();
      this.h = 86;
      this.needClip = !0;
      this.mode = 0;
      this.ena = !1;
      this.data = E_CABS2;
      this.keys = Object.keys(E_CABS2);
      this.vals = Object.keys(E_CABS2).map(function(b) {
        return E_CABS2[b]
      })
    },
    onDown: function() {
      var a = this;
      this.ena && (this.modal = new LIST(-1),
        this.modal.setItems(this.vals), this.modal.setGeometry(this.globalX(), this.globalY(), this.w, 400), this.modal.keys = this.keys, this.modal.getActiveItem = function() {
          var a = "" + getValue(selectedStrip.name + "digitech.cab");
          this.selected = this.keys.indexOf(a)
        }, this.modal.onSelect = function() {
          setValue(selectedStrip.name + "digitech.cab", (this.keys[this.selected] || 0) | 0);
          regUpdate(a);
          clearModals()
        }, this.modal.getActiveItem(), this.modal.gotoSelected())
    },
    getState: function() {
      this.mode = "" + getValue(selectedStrip.name + "digitech.cab");
      this.ena = getValue(selectedStrip.name + "digitech.enabled")
    },
    paint: function() {
      this.getState();
      ctx.fillStyle = color.eqBg;
      ctx.fillRect(0, 0, this.w, this.h);
      this.ena ? drawImage(res.CAB_D, 0, 0) : drawImage(res.CAB_G, 0, 0);
      this.ena && ctx.drawText(this.data[this.mode], this.w / 2, this.h / 2, {
        font: font.botChLabel,
        align: "center",
        valign: "middle",
        color: "#B7B7B7",
        shadow: Shadow.main
      })
    }
  }),
  DIGI_AMP = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "DIGI_AMP";
      this.w = res.AMP_D.w();
      this.h = res.AMP_D.h();
      this.mode = 0;
      this.ena = !1;
      this.data = E_AMPS2;
      this.keys = Object.keys(E_AMPS2);
      this.vals = Object.keys(E_AMPS2).map(function(b) {
        return E_AMPS2[b]
      })
    },
    onDown: function() {
      var a = this;
      this.ena && (this.modal = new LIST(-1), this.modal.setItems(this.vals), this.modal.keys = this.keys, this.modal.setGeometry(this.globalX(), this.globalY(), this.w, 400), this.modal.getActiveItem = function() {
        var a = "" + getValue(selectedStrip.name + "digitech.amp");
        this.selected = this.keys.indexOf(a)
      }, this.modal.onSelect = function() {
        setValue(selectedStrip.name +
          "digitech.amp", (this.keys[this.selected] || 0) | 0);
        regUpdate(a);
        clearModals()
      }, this.modal.getActiveItem(), this.modal.gotoSelected())
    },
    getState: function() {
      this.mode = "" + getValue(selectedStrip.name + "digitech.amp");
      this.ena = getValue(selectedStrip.name + "digitech.enabled")
    },
    paint: function() {
      this.getState();
      ctx.fillStyle = color.eqBg;
      ctx.fillRect(0, 0, this.w, this.h);
      this.ena ? drawImage(res.AMP_D, 0, 0) : drawImage(res.AMP_G, 0, 0);
      this.ena && ctx.drawText(this.data[this.mode], this.w / 2, this.h / 2 + 9, {
        font: font.botChLabel,
        align: "center",
        valign: "middle",
        color: "#B7B7B7",
        shadow: Shadow.main
      })
    }
  }),
  RadialKnob = Class.create(Widget, {
    initialize: function($super, b, c) {
      $super(b);
      this.widgetName = "RadialKnob";
      this.h = this.w = 60;
      this.needMoveEvt = !0;
      this.value = .4;
      this.slide = this.pressed = !1;
      this.touchID = -1;
      this.lastPressPoint = [-1, -1];
      this.d = 0;
      this.holdTimer = null
    },
    onDown: function(a, b, c) {
      clearTimeout(this.holdTimer);
      this.d = this.value;
      regUpdate(this)
    },
    onMove: function(a, b, c) {
      a = b - this.globalY();
      this.value = bound(this.d - a / 1E3, 0, 1);
      regUpdate(this)
    },
    onUp: function(a) {},
    onhold: function() {},
    onDouble: function() {},
    onWheel: function(a) {
      if (!this.master || !settings.masterLock) {
        var b = this.getVal(),
          b = bound(b + a / 120 / 30, 0, 1);
        this.setVal(b);
        regUpdate(this.parent)
      }
    },
    setValue: function(a) {
      this.setVal(a);
      this.onValue();
      regUpdate(this.parent)
    },
    onFocus: function() {},
    onValue: function() {},
    paint: function() {
      var a = this.w / 2;
      ctx.strokeStyle = "rgba(255,255,255,0.2)";
      ctx.lineWidth = 1;
      ctx.fillStyle = "#000";
      ctx.circle(a, a, a);
      ctx.fill();
      ctx.fillStyle = "#911";
      ctx.beginPath();
      ctx.arc(a,
        a, a - 2, Math.PI, Math.PI + 2 * Math.PI * this.value, !1);
      ctx.lineTo(a, a);
      ctx.closePath();
      ctx.fill()
    }
  }),
  PEDAL = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "PEDAL";
      this.w = 62;
      this.h = 76;
      this.mode = this.idx = 0;
      this.text = "PEDAL XXX";
      this.color = "#999";
      this.state = 0
    },
    setMode: function(a) {
      this.mode = bound(a | 0, 0, 3);
      regUpdate(this)
    },
    onDown: function(a, b, c) {
      this.globalX();
      this.globalY()
    },
    getState: function() {},
    paint: function() {
      this.getState();
      ctx.fillStyle = color.eqBg;
      ctx.fillRect(0, 0, this.w, this.h);
      ctx.globalAlpha = this.parent.mode == this.idx ? 1 : .7;
      drawImage(res.pedal_grey, 0, 0);
      this.state && drawImage(res.pedal_light, 2, 3);
      drawText(this.text, this.w / 2 | 0, 21, {
        max: this.w - 6,
        font: "9pt open_sans_condensedbold",
        align: "center",
        valign: "middle",
        color: "#161616",
        sColor: "#aaa",
        sX: 1,
        sY: 1,
        sBlur: 0
      })
    }
  }),
  TButton = Class.create(Button, {
    initialize: function($super, b) {
      $super(b);
      this.text = "0 ms";
      this.font = "14px open_sans_condensedbold";
      this.textColorActive = this.textColor = color.black2;
      this.textParam = {
        font: "14px open_sans_condensedbold",
        x: null,
        y: null,
        offsetX: 0,
        offsetY: -2,
        pressOffsetX: 0,
        pressOffsetY: 1,
        align: "center",
        valign: "middle",
        shadow: ["#ccc", 0, 1, 1],
        dy: 20
      }
    }
  }),
  TCheckBox = Class.create(Button, {
    initialize: function($super, b) {
      $super(b);
      this.font = "14px open_sans_condensedbold";
      this.textColorActive = this.textColor = color.black2;
      this.textParam = {
        font: "14px open_sans_condensedbold",
        x: null,
        y: null,
        offsetX: 0,
        offsetY: -2,
        pressOffsetX: 0,
        pressOffsetY: 1,
        align: "center",
        valign: "middle",
        shadow: ["#ccc", 0, 1, 1],
        dy: 20
      }
    }
  }),
  PerfGraph = Class.create(Widget, {
    initialize: function($super,
      b) {
      $super(b);
      this.widgetName = "PerfGraph";
      this.w = 200;
      this.h = 60;
      this.timer = null;
      this.bgColor = color.black;
      this.color = "rgba(255,255,0,0.6)";
      this.color2 = "rgba(0,255,0,0.6)";
      this.data = Util.filledArray(200);
      this.data2 = Util.filledArray(200);
      regTick(this)
    },
    tick: function() {
      this.data.shift();
      this.data.push(0);
      this.data2.shift();
      this.data2.push(0);
      regUpdate(this);
      regTick(this)
    },
    addValue: function(a) {
      this.data[this.data.length - 1] += a
    },
    addValue2: function(a) {
      this.data2[this.data.length - 1] += a
    },
    paint: function() {
      ctx.fillStyle =
        this.bgColor;
      ctx.fillRect(0, 0, this.w, this.h);
      for (var a = Math.max(this.data.max(), this.data2.max()), b = this.data.avg() + this.data2.avg(), c = a - 0, d = 0, f = this.data.length; d < f; d++) {
        var e = this.data[d];
        .01 < e && (e = (e - 0) / c, e *= this.h, ctx.fillStyle = this.color, ctx.fillRect(d, this.h, 1, -e | 0));
        e = this.data2[d];
        .01 < e && (e = (e - 0) / c, e *= this.h, ctx.fillStyle = this.color2, ctx.fillRect(d, this.h, 1, -e | 0))
      }
      ctx.fillStyle = color.white;
      ctx.font = font.stripMarks;
      ctx.textAlign = "right";
      ctx.fillText(precision(a, 2) + "ms max", this.w - 2, 10);
      ctx.fillText(precision(b,
        2) + "ms avg", this.w - 2, 20)
    }
  });

function VtoLINRANGE(a, b, c) {
  return a * (c - b) + b
}

function VtoLOGRANGE(a, b, c) {
  return Math.round(b * Math.pow(c, a))
}

function VtoRATIO_DE(a) {
  return 1 / a
}

function VtoFREQ(a) {
  return Math.round(20 * Math.pow(1102.5, a))
}

function VtoFREQ20(a) {
  return Math.round(20 * Math.pow(1E3, a))
}

function VtoQ(a) {
  return .05 * Math.pow(300, a)
}

function VtoEQGAIN20(a) {
  return 40 * a - 20
}

function VtoEQGAIN15(a) {
  return precision(30 * a - 15, 1)
}

function VtoPERCENT(a) {
  return 100 * a | 0
}

function QtoV(a) {
  return bound(Math.log(a / .05) / Math.log(300), 0, 1)
}

function VtoHPFfreq(a) {
  return 0 == a ? lang.OFF : VtoFREQ(a)
}

function VtoLPFfreq(a) {
  return 1 == a ? lang.OFF : VtoFREQ(a)
}

function VtoDS_RATIO(a) {
  1E-5 > a && (a = 1E-5);
  a = VtoRATIO_DE(a);
  return a = 60 < a ? "∞" : 2 > a ? precision(a, 2) + "" : precision(a, 1) + ""
}

function addDotZero1(a) {
  a += "";
  return -1 == a.indexOf(".") ? a + ".0" : a
}

function addDotZero2(a) {
  return parseInt(a) + "." + parseInt(10 * a) % 10 + "" + parseInt(100 * a) % 10
}

function formatFreq(a) {
  return 1E3 > a ? a | 0 : 1E4 > a ? addDotZero2(a / 1E3) + "k" : addDotZero1(precision(a / 1E3, 1)) + "k"
}

function DeesserVtoFREQ(a) {
  return 2E3 * Math.pow(7.5, a)
}

function FREQtoX(a, b) {
  return (b - 1) * Math.log(a / 20) / Math.log(1102.5)
}

function chopLastDot(a) {
  if (null == a || "" == a) return a;
  a += "";
  return a.endsWith(".") ? a.substr(0, a.length - 1) : a
}
var EQChannel = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "EQChannel";
      this.y = 40;
      this.enabled = !1;
      this.buttons = [];
      this.mode = 1;
      this.bypass = !1;
      this.keyPrefix = null;
      this.initWidgets()
    },
    setMode: function(a) {
      this.mode = a;
      77 == a && 0 == this.SWITCHER.state && this.SWITCHER.setState(1);
      77 != a && 1 == this.SWITCHER.state && this.SWITCHER.setState(0);
      var b = selectedStrip.name + "eq.";
      77 == a ? this.SWITCHER.setState(1) : this.SWITCHER.setState(0);
      switch (this.mode) {
        case 0:
          b += "hpf.";
          break;
        case 1:
          b += "b1.";
          break;
        case 2:
          b += "b2.";
          break;
        case 3:
          b += "b3.";
          break;
        case 4:
          b += "b4.";
          break;
        case 5:
          b += "lpf."
      }
      this.led_kp = b;
      this.slFREQ.setKeyPrefix(b);
      this.slQ.setKeyPrefix(b);
      this.slGAIN.setKeyPrefix(b);
      this.checkState();
      regUpdate(this)
    },
    onShow: function() {
      this.eq.isClipping = !1;
      this.syncSliders();
      this.calcGeometry()
    },
    connectKeys: function() {
      if (null != selectedStrip) {
        var a = selectedStrip.name + "eq.";
        this.keyPrefix2 = this.keyPrefix = a;
        this.bBYPASS.setKeyPrefix(this.keyPrefix);
        this.bDESSER.setKeyPrefix(selectedStrip.name);
        this.BASS.setKeyPrefix(a);
        this.MID.setKeyPrefix(a);
        this.TREBLE.setKeyPrefix(a);
        this.D1.setKeyPrefix(selectedStrip.name);
        this.D2.setKeyPrefix(selectedStrip.name);
        this.D3.setKeyPrefix(selectedStrip.name);
        switch (this.mode) {
          case 0:
            a += "hpf.";
            break;
          case 1:
            a += "b1.";
            break;
          case 2:
            a += "b2.";
            break;
          case 3:
            a += "b3.";
            break;
          case 4:
            a += "b4.";
            break;
          case 5:
            a += "lpf."
        }
        this.led_kp = a;
        this.slFREQ.setKeyPrefix(a);
        this.slQ.setKeyPrefix(a);
        this.slGAIN.setKeyPrefix(a);
        this.polarity && this.polarity.setKey(selectedStrip.name + "invert");
        this.eq.rta = null;
        this.checkState();
        this.bypass = toBool(getValue(this.keyPrefix + "bypass"))
      }
    },
    checkState: function() {
      IS_UI_24 && selectedStrip.type == E_STRIP_TYPE.IN || 5 != this.mode || this.setMode(1);
      var a = getValue(this.keyPrefix + "easy");
      this.dbu1.hide();
      this.dbu2.hide();
      this.dbu3.hide();
      if (a) this.led_bass.show(), this.led_mid.show(), this.led_high.show(), this.led_freq.hide(), this.led_q.hide(), this.led_gain.hide(), this.BASS.show(), this.MID.show(), this.TREBLE.show(), this.slFREQ.hide(), this.slQ.hide(), this.slGAIN.hide();
      else if (this.led_freq.show(),
        this.led_q.show(), this.led_gain.show(), this.led_bass.hide(), this.led_mid.hide(), this.led_high.hide(), this.BASS.hide(), this.MID.hide(), this.TREBLE.hide(), this.slFREQ.show(), this.slQ.show(), this.slGAIN.show(), 0 == this.mode || 5 == this.mode) this.slQ.hide(), this.slGAIN.hide();
      if (0 == this.SWITCHER.state) this.D1.hide(), this.D2.hide(), this.D3.hide(), this.led_d1.hide(), this.led_d2.hide(), this.led_d3.hide();
      else {
        this.D1.show();
        this.D2.show();
        this.D3.show();
        this.led_d1.show();
        this.led_d2.show();
        this.led_d3.show();
        for (var b = 0; b < this.LEDS.length; b++) this.LEDS[b].hide();
        for (b = 0; b < this.SLIDERS.length; b++) this.SLIDERS[b].hide()
      }
      selectedStrip.type == E_STRIP_TYPE.IN ? (this.bDESSER.show(), this.SWITCHER.show(), this.polarity && this.polarity.show()) : (1 == this.SWITCHER.state && this.SWITCHER.setState(0), this.SWITCHER.hide(), this.bDESSER.hide(), this.polarity && this.polarity.hide());
      0 == this.SWITCHER.state && 0 == a && (0 == this.mode || 5 == this.mode ? (this.slQ.hide(), this.slGAIN.hide(), this.led_q.hide(), this.led_gain.hide(), IS_UI_24 && (this.dbu1.show(),
        this.dbu2.show(), this.dbu3.show())) : (this.slQ.show(), this.slGAIN.show(), this.led_q.show(), this.led_gain.show()))
    },
    syncSliders: function() {
      this.enabled && this.connectKeys()
    },
    calcGeometry: function() {
      this.w = this.parent.w - this.x;
      this.h = this.parent.h - this.y - 5;
      if (isDefined(this.slFREQ)) {
        this.eq.setSize(this.w - this.eq.x - 240, this.h - this.eq.y - 66);
        var a = -208;
        this.led_freq.setPos(this.w + a - 9, 46);
        this.led_q.setPos(this.w + a - 9 + 70, 46);
        this.led_gain.setPos(this.w + a - 9 + 140, 46);
        this.led_bass.setPos(this.w + a - 9, 46);
        this.led_mid.setPos(this.w +
          a - 9 + 70, 46);
        this.led_high.setPos(this.w + a - 9 + 140, 46);
        this.led_d1.setPos(this.w + a - 9 + 0, 46);
        this.led_d2.setPos(this.w + a - 9 + 70, 46);
        this.led_d3.setPos(this.w + a - 9 + 140, 46);
        this.slFREQ.x = this.w + a + 0;
        this.slQ.x = this.w + a + 70;
        this.slGAIN.x = this.w + a + 140;
        this.BASS.x = this.w + a + 0;
        this.MID.x = this.w + a + 70;
        this.TREBLE.x = this.w + a + 140;
        this.D1.x = this.w + a + 0 | 0;
        this.D2.x = this.w + a + 70 | 0;
        this.D3.x = this.w + a + 140 | 0;
        this.slFREQ.y = this.slQ.y = this.slGAIN.y = this.BASS.y = this.MID.y = this.TREBLE.y = this.D1.y = this.D2.y = this.D3.y = 130;
        this.slGAIN.h =
          this.slQ.h = this.slFREQ.h = this.BASS.h = this.MID.h = this.TREBLE.h = this.h - this.slGAIN.y - 41 - 30;
        this.D1.h = this.D2.h = this.D3.h = this.h - this.slGAIN.y - 41 - 30;
        for (var b = this.h - 41, a = this.eq.x, c = [], d = 0; d < this.btns.length; d++) this.btns[d].enabled && c.push(this.btns[d]);
        for (var f = (this.eq.w - this.btns[2].w) / (c.length - 1), d = 0; d < c.length; d++) c[d].setPos(a + d * f | 0, b)
      }
    },
    initWidgets: function() {
      var a = this;
      this.preset = new MENUBUTTON(this);
      this.preset.setSize(130, 29);
      this.preset.setAnchors(null, 10, 10, null);
      this.preset.text = lang.PRESETS;
      this.preset.color = color.red;
      this.preset.onPress = function() {
        a.showPresets()
      };
      this.eq = new EQParamWidget(this);
      this.eq.setPos(40, 23);
      var b = this.eq;
      this.led_freq = new FXLEDPlain(this);
      this.led_freq.label = "FREQ";
      this.led_freq.sign = "hZ";
      this.led_freq.getState = function() {
        return getValue(a.led_kp + "freq")
      };
      this.led_freq.formatValue = function(b) {
        var c = VtoFREQ(b),
          c = formatFreq(c) + "";
        0 == a.mode && 0 == b && (c = lang.OFF);
        return c
      };
      this.led_q = new FXLEDPlain(this);
      this.led_q.label = "Q";
      this.led_q.sign = "";
      this.led_q.getState =
        function() {
          return getValue(a.led_kp + "q")
        };
      this.led_q.formatValue = function(a) {
        var b = "...";
        0 != this.parent.mode && (b = VtoQ(a), b = addDotZero2(b + 1E-5) + "");
        return b
      };
      this.led_gain = new FXLEDPlain(this);
      this.led_gain.label = "GAIN";
      this.led_gain.sign = "dB";
      this.led_gain.getState = function() {
        return getValue(a.led_kp + "gain")
      };
      this.led_gain.formatValue = function(a) {
        var b = "...";
        0 != this.parent.mode && (b = VtoEQGAIN20(a), b = (0 < b ? "+" : "") + addDotZero1(precision(b, 1)) + "");
        return b
      };
      this.led_bass = new FXLEDPlain(this);
      this.led_bass.label =
        "BASS";
      this.led_bass.sign = "dB";
      this.led_bass.getState = function() {
        return getValue(a.keyPrefix + "b1.gain")
      };
      this.led_bass.formatValue = function(a) {
        a = VtoEQGAIN20(a);
        return a = (0 < a ? "+" : "") + addDotZero1(precision(a, 1)) + ""
      };
      this.led_mid = new FXLEDPlain(this);
      this.led_mid.label = "MID";
      this.led_mid.sign = "dB";
      this.led_mid.getState = function() {
        return getValue(a.keyPrefix + "b2.gain")
      };
      this.led_mid.formatValue = function(a) {
        a = VtoEQGAIN20(a);
        return a = (0 < a ? "+" : "") + addDotZero1(precision(a, 1)) + ""
      };
      this.led_high = new FXLEDPlain(this);
      this.led_high.label = "TREBLE";
      this.led_high.sign = "dB";
      this.led_high.getState = function() {
        return getValue(a.keyPrefix + "b3.gain")
      };
      this.led_high.formatValue = function(a) {
        a = VtoEQGAIN20(a);
        return a = (0 < a ? "+" : "") + addDotZero1(precision(a, 1)) + ""
      };
      this.LEDS = [this.led_freq, this.led_q, this.led_gain, this.led_bass, this.led_mid, this.led_high];
      this.slFREQ = new EQSlider(this);
      this.slFREQ.keyPart = "freq";
      this.slFREQ.setPos(600, 100);
      this.slFREQ.textUp = "22kHz";
      this.slFREQ.textBot = "20Hz";
      this.slFREQ.mV = [1, findV(VtoFREQ, 50),
        findV(VtoFREQ, 100), findV(VtoFREQ, 200), findV(VtoFREQ, 500), findV(VtoFREQ, 1E3), findV(VtoFREQ, 2E3), findV(VtoFREQ, 5E3), findV(VtoFREQ, 1E4), 0
      ];
      this.slFREQ.onDouble = function() {
        switch (this.parent.mode) {
          case 1:
            this.setValue(FREQtoV(200));
            break;
          case 2:
            this.setValue(FREQtoV(1E3));
            break;
          case 3:
            this.setValue(FREQtoV(4E3));
            break;
          case 4:
            this.setValue(FREQtoV(1E4))
        }
      };
      this.slFREQ.setVal = function(b) {
        0 == a.mode && b > FREQtoV(1E3) && (b = FREQtoV(1E3));
        5 == a.mode && b < FREQtoV(1E3) && (b = FREQtoV(1E3));
        null != this.key ? setValue(this.key,
          b) : log("setVal: " + this.name + " no PARAM-KEY!")
      };
      this.slFREQ.valueFunc = function() {
        selectedStrip.setNameValue("eq.prmod", 1);
        regUpdate(b);
        regUpdate(a.led_freq)
      };
      this.slQ = new EQSlider(this);
      this.slQ.keyPart = "q";
      this.slQ.setPos(660, 100);
      this.slQ.textUp = "15";
      this.slQ.textBot = "0.05";
      this.slQ.setDefaultValue(findV(VtoQ, 1));
      this.slQ.mV = [1, findV(VtoQ, 10), findV(VtoQ, 5), findV(VtoQ, 2), findV(VtoQ, .5), findV(VtoQ, .2), findV(VtoQ, .1), 0];
      this.slQ.valueFunc = function() {
        selectedStrip.setNameValue("eq.prmod", 1);
        regUpdate(b);
        regUpdate(a.led_q)
      };
      this.slGAIN = new EQSlider(this);
      this.slGAIN.keyPart = "gain";
      this.slGAIN.fader = res.eqVFaderRed;
      this.slGAIN.setPos(720, 100);
      this.slGAIN.textUp = "+20dB";
      this.slGAIN.textBot = "-20dB";
      this.slGAIN.setDefaultValue(.5);
      this.slGAIN.mV = [1, findV(VtoEQGAIN20, 15), findV(VtoEQGAIN20, 10), findV(VtoEQGAIN20, 5), findV(VtoEQGAIN20, -5), findV(VtoEQGAIN20, -10), findV(VtoEQGAIN20, -15), 0];
      this.slGAIN.valueFunc = function() {
        selectedStrip.setNameValue("eq.prmod", 1);
        regUpdate(b);
        regUpdate(a.led_gain)
      };
      this.BASS =
        new EQSlider(this);
      this.BASS.keyPart = "b1.gain";
      this.BASS.setPos(600, 100);
      this.BASS.textUp = "+20dB";
      this.BASS.textBot = "-20dB";
      this.BASS.fader = res.eqVFaderGreen;
      this.BASS.setDefaultValue(.5);
      this.BASS.valueFunc = function(c) {
        var d = a.keyPrefix2 + "b1.";
        setValue(d + "gain", c);
        setValue(d + "q", .16);
        setValue(d + "freq", FREQtoV(20));
        selectedStrip.setNameValue("eq.prmod", 1);
        regUpdate(b);
        regUpdate(a.led_bass)
      };
      this.MID = new EQSlider(this);
      this.MID.keyPart = "b2.gain";
      this.MID.setPos(660, 100);
      this.MID.textUp = "+20dB";
      this.MID.textBot =
        "-20dB";
      this.MID.fader = res.eqVFaderRed;
      this.MID.setDefaultValue(.5);
      this.MID.valueFunc = function(c) {
        var d = a.keyPrefix2 + "b2.";
        setValue(d + "gain", c);
        setValue(d + "q", .222);
        setValue(d + "freq", FREQtoV(1E3));
        selectedStrip.setNameValue("eq.prmod", 1);
        regUpdate(b);
        regUpdate(a.led_mid)
      };
      this.TREBLE = new EQSlider(this);
      this.TREBLE.keyPart = "b3.gain";
      this.TREBLE.setPos(720, 100);
      this.TREBLE.textUp = "+20dB";
      this.TREBLE.textBot = "-20dB";
      this.TREBLE.fader = res.eqVFaderPurple;
      this.TREBLE.setDefaultValue(.5);
      this.TREBLE.valueFunc =
        function(c) {
          var d = a.keyPrefix2 + "b3.";
          setValue(d + "gain", c);
          setValue(d + "q", .33);
          setValue(d + "freq", FREQtoV(22050));
          selectedStrip.setNameValue("eq.prmod", 1);
          regUpdate(b);
          regUpdate(a.led_high)
        };
      this.SLIDERS = [this.BASS, this.MID, this.TREBLE, this.slFREQ, this.slQ, this.slGAIN];
      this.bRTA = new CheckBox(this);
      this.bRTA.setSize(70, 30);
      this.bRTA.setImages(res.RTA_OFF, res.RTA_ON);
      this.bRTA.getState = function() {
        var a = selectedStrip.name,
          b = getValue("var.rta") + ".";
        this.state = a == b ? 1 : 0
      };
      this.bRTA.onToggleUp = function() {
        setValue("var.rta",
          chopLastDot(selectedStrip.name))
      };
      this.bRTA.onToggleDown = function() {
        setValue("var.rta", "");
        a.eq.rta = null;
        regUpdate(a.eq)
      };
      this.bRESET = new Button(this);
      this.bRESET.setSize(70, 30);
      this.bRESET.setImages(res.bRESET_OFF, res.bRESET_ON);
      this.bRESET.valueFunc = function() {
        resetParEQ(selectedChID);
        a.checkState();
        regUpdate(this)
      };
      this.bEASY = new CheckBox(this);
      this.bEASY.needBG = !0;
      this.bEASY.setSize(70, 30);
      this.bEASY.setImages(res.bEZEQ_OFF, res.bEZEQ_ON);
      this.bEASY.getState = function() {
        this.state = getValue(a.keyPrefix +
          "easy")
      };
      this.bEASY.onToggleUp = function() {
        var b = !1;
        isNear(getValue(a.keyPrefix2 + "hpf.freq"), 0) ? IS_UI_24 && !isNear(getValue(a.keyPrefix2 + "lpf.freq"), 1) ? b = !0 : isNear(getValue(a.keyPrefix2 + "b4.gain"), .5) ? isNear(getValue(a.keyPrefix2 + "b1.freq"), FREQtoV(20)) ? isNear(getValue(a.keyPrefix2 + "b2.freq"), FREQtoV(1E3)) ? isNear(getValue(a.keyPrefix2 + "b3.freq"), FREQtoV(22050)) || (b = !0) : b = !0 : b = !0 : b = !0 : b = !0;
        b ? (confOk.valueFunc = function() {
          resetParEQ(selectedChID, !0);
          setValue(a.keyPrefix2 + "b1.freq", FREQtoV(20));
          setValue(a.keyPrefix2 +
            "b2.freq", FREQtoV(1E3));
          setValue(a.keyPrefix2 + "b3.freq", FREQtoV(22050));
          setValue(a.keyPrefix2 + "b1.gain", .5);
          setValue(a.keyPrefix2 + "b2.gain", .5);
          setValue(a.keyPrefix2 + "b3.gain", .5);
          setValue(a.keyPrefix2 + "b1.q", .16);
          setValue(a.keyPrefix2 + "b2.q", .222);
          setValue(a.keyPrefix2 + "b3.q", .33);
          setValue(a.keyPrefix + "easy", 1);
          a.checkState();
          regUpdate(a)
        }, showConfBox(lang.CURRENT_VALUES_WILL_BE_LOST)) : (setValue(a.keyPrefix + "easy", 1), a.checkState(), regUpdate(this))
      };
      this.bEASY.onToggleDown = function() {
        setValue(a.keyPrefix +
          "easy", 0);
        a.checkState();
        regUpdate(this)
      };
      this.bDESSER = new CheckBox(this);
      this.bDESSER.setSize(70, 30);
      this.bDESSER.keyPart = "deesser.enabled";
      this.bDESSER.setImages(res.DESS_OFF, res.DESS_ON);
      this.bDESSER.onToggleUp = function() {
        a.SWITCHER.setState(1);
        a.checkState();
        regUpdate(a)
      };
      this.bDESSER.onToggleDown = function() {
        a.SWITCHER.setState(0);
        a.checkState();
        regUpdate(a)
      };
      this.bBYPASS = new CheckBox(this);
      this.bBYPASS.keyPart = "bypass";
      this.bBYPASS.setSize(70, 30);
      this.bBYPASS.setImages(res.bBYPASS_OFF, res.bBYPASS_ON);
      this.bBYPASS.onToggleUp = function() {
        a.bypass = !0;
        regUpdate(a)
      };
      this.bBYPASS.onToggleDown = function() {
        a.bypass = !1;
        regUpdate(a)
      };
      IS_UI_24 ? (this.polarity = new CheckBox(this), this.polarity.setPos(37, 7), this.polarity.setImages(res.bPIOff, res.bPIOn), this.btns = [this.polarity, this.bEASY, this.bRTA, this.bDESSER, this.bRESET, this.bBYPASS]) : this.btns = [this.bEASY, this.bRTA, this.bDESSER, this.bRESET, this.bBYPASS];
      this.SWITCHER = new SWITCHBOX(this);
      this.SWITCHER.setItems([lang.EQ, lang.DEESSER]);
      this.SWITCHER.setItemWidth(96);
      this.SWITCHER.setAnchors(null, null, 17, 9);
      this.SWITCHER.valueFunc = function() {
        a.checkState();
        regUpdate(a)
      };
      this.led_d1 = new FXLEDPlain(this);
      this.led_d1.label = "FREQ";
      this.led_d1.sign = "hZ";
      this.led_d1.getState = function() {
        return getValue(selectedStrip.name + "deesser.freq")
      };
      this.led_d1.formatValue = function(a) {
        return formatFreq(DeesserVtoFREQ(a)) + ""
      };
      this.led_d2 = new FXLEDPlain(this);
      this.led_d2.label = "THRESH";
      this.led_d2.sign = "dB";
      this.led_d2.getState = function() {
        return getValue(selectedStrip.name + "deesser.threshold")
      };
      this.led_d2.formatValue = VtoTHRESH;
      this.led_d3 = new FXLEDPlain(this);
      this.led_d3.label = "RATIO";
      this.led_d3.sign = "";
      this.led_d3.getState = function() {
        return getValue(selectedStrip.name + "deesser.ratio")
      };
      this.led_d3.formatValue = VtoDS_RATIO;
      this.D1 = new EQSlider(this);
      this.D1.keyPart = "deesser.freq";
      this.D1.setPos(720, 100);
      this.D1.textUp = "15kHz";
      this.D1.textBot = "2000Hz";
      this.D1.fader = res.eqVFaderGreen;
      this.D1.valueFunc = function() {
        regUpdate(b);
        regUpdate(a.led_d1)
      };
      this.D2 = new EQSlider(this);
      this.D2.keyPart =
        "deesser.threshold";
      this.D2.setPos(720, 100);
      this.D2.textUp = "6 dB";
      this.D2.textBot = "-90";
      this.D2.fader = res.eqVFaderYellow;
      this.D2.valueFunc = function() {
        regUpdate(b);
        regUpdate(a.led_d2)
      };
      this.D3 = new EQSlider(this);
      this.D3.keyPart = "deesser.ratio";
      this.D3.setPos(720, 100);
      this.D3.fader = res.eqVFaderYellow;
      this.D3.textUp = "1:1";
      this.D3.textBot = "∞:1";
      this.D3.valueFunc = function() {
        regUpdate(b);
        regUpdate(a.led_d3)
      };
      this.dbu1 = new CHECKBUTTON(this);
      this.dbu1.setAnchors(null, 100, 33, null);
      this.dbu1.setSize(90, 30);
      this.dbu1.text = "12 dBu";
      this.dbu1.idx = 0;
      this.dbu1.color = color.orange;
      this.dbu1.getState = function() {
        this.state = getValue(selectedStrip.name + "eq." + (5 == a.mode ? "lpf." : "hpf.") + "slope") == this.idx
      };
      this.dbu1.onToggleUp = function() {
        setValue(selectedStrip.name + "eq." + (5 == a.mode ? "lpf." : "hpf.") + "slope", this.idx);
        regUpdate(a)
      };
      this.dbu2 = new CHECKBUTTON(this);
      this.dbu2.setAnchors(null, 140, 33, null);
      this.dbu2.setSize(90, 30);
      this.dbu2.text = "24 dBu";
      this.dbu2.idx = 1;
      this.dbu2.color = color.orange;
      this.dbu2.getState = function() {
        this.state =
          getValue(selectedStrip.name + "eq." + (5 == a.mode ? "lpf." : "hpf.") + "slope") == this.idx
      };
      this.dbu2.onToggleUp = function() {
        setValue(selectedStrip.name + "eq." + (5 == a.mode ? "lpf." : "hpf.") + "slope", this.idx);
        regUpdate(a)
      };
      this.dbu3 = new CHECKBUTTON(this);
      this.dbu3.setAnchors(null, 180, 33, null);
      this.dbu3.setSize(90, 30);
      this.dbu3.text = "36 dBu";
      this.dbu3.idx = 2;
      this.dbu3.color = color.orange;
      this.dbu3.getState = function() {
        this.state = getValue(selectedStrip.name + "eq." + (5 == a.mode ? "lpf." : "hpf.") + "slope") == this.idx
      };
      this.dbu3.onToggleUp =
        function() {
          setValue(selectedStrip.name + "eq." + (5 == a.mode ? "lpf." : "hpf.") + "slope", this.idx);
          regUpdate(a)
        };
      this.dbu1.hide();
      this.dbu2.hide();
      this.dbu3.hide()
    },
    onDown: function(a, b) {
      this.lastPressPoint = this.pressPoint;
      this.pressPoint = [a, b]
    },
    onUp: function(a) {
      var b = Date.now(),
        c = Math.abs(this.lastPressPoint[0] - this.pressPoint[0]),
        d = Math.abs(this.lastPressPoint[1] - this.pressPoint[1]);
      2 < mouseTargets.length || isDefined(tHash[a]) && 2 < tHash[a].length || (30 > c && 30 > d && b - this.lastClickTime < DBL_CLK_TIME ? (this.onDouble(),
        this.lastClickTime = b - DBL_CLK_TIME) : this.lastClickTime = b)
    },
    onDouble: function() {
      setMode(E_MODE.MIX)
    },
    showPresets: function() {
      this.menu = new PRESET_MENU2(null, "eqch", this, this.parent.color);
      regUpdate(this.menu)
    },
    loadPreset: function(a, b) {
      var c = selectedStrip.name.slice(0, -1);
      applyPreset(c, a);
      selectedStrip.setNameValue("eq.prmod", 0);
      isDefined(b) && selectedStrip.setNameValue("eq.prname", b);
      this.checkState()
    },
    savePreset: function(a) {
      var b = ".eq.easy .eq.hpf.freq .eq.b1.freq .eq.b1.q .eq.b1.gain .eq.b2.freq .eq.b2.q .eq.b2.gain .eq.b3.freq .eq.b3.q .eq.b3.gain .eq.b4.freq .eq.b4.q .eq.b4.gain .deesser.enabled .deesser.freq .deesser.threshold .deesser.ratio".split(" ");
      IS_UI_24 && (b.push(".eq.lpf.freq"), b.push(".eq.lpf.slope"), b.push(".eq.hpf.slope"));
      for (var c = {}, d = this.keyPrefix.split("."), d = d[0] + "." + d[1], f = 0; f < b.length; f++) null != getValue(d + b[f]) && (c[b[f]] = getValue(d + b[f]));
      selectedStrip.setNameValue("eq.prmod", 0);
      isDefined(a) && selectedStrip.setNameValue("eq.prname", a);
      return c
    },
    paint: function() {
      ctx.fillStyle = color.eqBg;
      ctx.fillRect(0, 0, this.w, this.h);
      this.paintMarks();
      this.dbu1.enabled && drawText(lang.SLOPE, this.dbu1.x + this.dbu1.w / 2, this.dbu1.y - 20, {
        font: font.tabText,
        color: color.white,
        align: "center",
        valign: "middle"
      });
      this.preset && drawImage(res.dbx, this.preset.x - 48, 13)
    },
    paintMarks: function() {
      ctx.font = font.eqMarks;
      ctx.textAlign = "center";
      var a = this.eq.h,
        b = this.eq.w,
        c = a / 4,
        d = a / 2 | 0,
        f = [50, 100, 200, 500, 1E3, 2E3, 5E3, 1E4],
        e = "50 100 200 500 1k 2k 5k 10k".split(" ");
      ctx.fillStyle = "#101115";
      ctx.fillRect(16, this.eq.y - 12, this.w - 16 - 230, this.eq.h + 34);
      ctx.translate(16, this.eq.y - 12);
      ctx.fillStyle = color.grad1;
      ctx.fillRect(0, 0, this.w - 16 - 230, 7);
      ctx.translate(-16, -(this.eq.y - 12));
      ctx.save();
      ctx.translate(this.eq.x, this.eq.y);
      ctx.fillStyle = color.graphMarks;
      ctx.textAlign = "right";
      ctx.fillText("+20", -4, 9);
      ctx.fillText("+10", -4, c + 4);
      ctx.fillText("0", -4, d + 3);
      ctx.fillText("-10", -4, 3 * c + 4);
      ctx.fillText("-20", -4, a - 1);
      ctx.textAlign = "left";
      ctx.fillText("20", 0, a + 15);
      ctx.fillText("22k", b - 18, a + 15);
      ctx.textAlign = "center";
      for (c = 0; c < f.length; c++) ctx.fillText(e[c], FREQtoX(f[c], b), a + 15);
      ctx.restore()
    }
  }),
  EQAux = Class.create(EQChannel, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "EQAux";
      this.keyPrefixAfs =
        this.keyPrefix = "";
      this.idx = 0
    },
    connectKeys: function() {
      if (null != selectedStrip) {
        var a = selectedStrip.name;
        this.keyPrefix = a + "eq.peak.";
        this.keyPrefixAfs = a;
        this.eq.setKey(a);
        this.eq.haveFilters = IS_UI_24 && 2 > selectedStrip.subId;
        this.connectIdx();
        this.AFS_OFF.setKey(selectedStrip.name + "afs.enabled");
        this.bBYPASS.setKeyPrefix(a + "eq.");
        this.bypass = toBool(getValue(a + "eq.bypass"));
        this.polarity && this.polarity.setKey(selectedStrip.name + "invert")
      }
    },
    connectIdx: function() {
      if (0 <= this.eq.idx) {
        var a = this.keyPrefix + this.eq.idx;
        this.led.setKey(a);
        this.slGAIN.setKeyPrefix(a);
        regUpdate(this.slGAIN)
      }
    },
    syncSliders: function() {
      this.enabled && selectedStrip.type == E_STRIP_TYPE.AUX && (this.eq.rta = null, this.connectKeys())
    },
    onShow: function() {
      this.eq.isClipping = !1;
      this.syncSliders()
    },
    calcGeometry: function($super) {
      this.w = this.parent.w - this.x;
      this.h = this.parent.h - this.y - 5;
      for (var b = this.h - 40, c = (this.w - 276 - 160) / 2, d = 80, f = 0; f < this.btns.length; f++) switch (this.btns[f].setPos(d | 0, b), f) {
        case 0:
          d += this.btns[0].w + 10;
          break;
        case 1:
          d += c;
          break;
        case 2:
          d +=
            c;
          break;
        case 3:
          d += this.btns[0].w + 10
      }
    },
    initWidgets: function() {
      var a = this;
      this.preset = new MENUBUTTON(this);
      this.preset.setSize(130, 29);
      this.preset.setAnchors(null, 10, 10, null);
      this.preset.text = lang.PRESETS;
      this.preset.color = color.red;
      this.preset.onPress = function() {
        a.showPresets()
      };
      this.sEQ = new GEQ_SMALL(this);
      this.sEQ.setAnchors(40, 6);
      this.eq = new GEQ_GRAPH(this);
      this.eq.setAnchors(40, 78, 120, 64);
      this.eq.onSelect = function(b) {
        a.connectIdx()
      };
      this.eq.onChange = function() {
        regUpdate(this);
        regUpdate(a.slGAIN);
        regUpdate(a.led);
        regUpdate(a.sEQ)
      };
      this.led = new FXLEDPlain(this);
      this.led.setAnchors(null, 56, 26, null);
      this.led.w = 60;
      this.led.label = lang.GAIN;
      this.led.sign = "dB";
      this.led.formatValue = function(a) {
        a = VtoEQGAIN15(a);
        return a = (0 < a ? "+" : "") + precision(a, 1) + ""
      };
      this.slGAIN = new EQSlider(this);
      this.slGAIN.keyPart = "";
      this.slGAIN.fader = res.eqVFaderRed;
      this.slGAIN.setAnchors(null, 144, 32, 41);
      this.slGAIN.textUp = "+15dB";
      this.slGAIN.textBot = "-15dB";
      this.slGAIN.setDefaultValue(.5);
      this.slGAIN.mV = [1, findV(VtoEQGAIN15,
        10), findV(VtoEQGAIN15, 5), findV(VtoEQGAIN15, -5), findV(VtoEQGAIN15, -10), 0];
      this.slGAIN.valueFunc = function() {
        regUpdate(a.eq);
        regUpdate(a.led);
        regUpdate(a.sEQ);
        selectedStrip.setNameValue("eq.prmod", 1)
      };
      this.AFS_SETTINGS = new Button(this);
      this.AFS_SETTINGS.setImages(res.SETUP_OFF, res.SETUP_ON);
      this.AFS_SETTINGS.onPress = function() {
        var b = new AFS_POPUP(null, a),
          c = a.eq.globalX() + a.eq.w,
          d = a.eq.globalY(),
          f = a.globalX(),
          e = a.globalY() + a.h;
        b.setSize(c - f, e - d);
        b.setPos(f, d);
        b.updateGeometry();
        regUpdate(b)
      };
      this.AFS_OFF =
        new CheckBox(this);
      this.AFS_OFF.setImages(res.OFF_OFF, res.ON_ON);
      this.AFS_OFF.getState = function() {
        this.disabled = 0 == getValue("afs.enabled")
      };
      this.bRTA = new CheckBox(this);
      this.bRTA.setSize(70, 30);
      this.bRTA.setImages(res.RTA_OFF, res.RTA_ON);
      this.bRTA.getState = function() {
        var a = selectedStrip.name,
          c = getValue("var.rta") + ".";
        this.state = a == c ? 1 : 0
      };
      this.bRTA.onToggleUp = function() {
        setValue("var.rta", chopLastDot(selectedStrip.name))
      };
      this.bRTA.onToggleDown = function() {
        setValue("var.rta", "");
        a.eq.rta = null;
        regUpdate(a.eq)
      };
      this.bRESET = new Button(this);
      this.bRESET.setImages(res.bRESET_OFF, res.bRESET_ON);
      this.bRESET.valueFunc = function() {
        resetGraphEQ(selectedChID);
        regUpdate(this)
      };
      this.bBYPASS = new CheckBox(this);
      this.bBYPASS.keyPart = "bypass";
      this.bBYPASS.setImages(res.bBYPASS_OFF, res.bBYPASS_ON);
      this.bBYPASS.onToggleUp = function() {
        a.bypass = !0;
        regUpdate(a)
      };
      this.bBYPASS.onToggleDown = function() {
        a.bypass = !1;
        regUpdate(a)
      };
      IS_UI_24 && (this.polarity = new CheckBox(this), this.polarity.setAnchors(260, null, null, 3), this.polarity.setImages(res.bPIOff,
        res.bPIOn));
      this.btns = [this.AFS_SETTINGS, this.AFS_OFF, this.bRTA, this.bRESET, this.bBYPASS]
    },
    paintMarks: function() {
      ctx.font = font.eqMarks;
      ctx.textAlign = "center";
      var a = this.eq.h,
        b = a / 6,
        c = a / 2 | 0;
      ctx.fillStyle = "#101115";
      ctx.fillRect(16, this.eq.y - 20, this.eq.w + 35, this.eq.h + 20 + 20);
      ctx.translate(16, this.eq.y - 20);
      ctx.fillStyle = color.grad1;
      ctx.fillRect(1, 0, this.w - 16 - 110 - 2 + 2, 7);
      ctx.translate(-16, -(this.eq.y - 20));
      ctx.save();
      ctx.translate(this.eq.x, this.eq.y);
      ctx.textAlign = "right";
      ctx.fillStyle = color.graphMarks;
      ctx.fillText("+15", -3, 9);
      ctx.fillText("+10", -3, c - 2 * b + 3);
      ctx.fillText("+5", -3, c - b + 3);
      ctx.fillText("0", -3, c + 3);
      ctx.fillText("-5", -3, c + b + 3);
      ctx.fillText("-10", -3, c + 2 * b + 3);
      ctx.fillText("-15", -3, a - 3);
      ctx.restore()
    },
    showPresets: function() {
      this.menu = new PRESET_MENU2(null, "eqaux", this, this.parent.color);
      regUpdate(this.menu)
    },
    savePreset: function(a) {
      for (var b = [], c = 0; c < this.eq.bands; c++) b.push(".eq.peak." + c);
      IS_UI_24 && (b.push(".eq.lpf"), b.push(".eq.hpf"));
      for (var d = {}, c = this.keyPrefix.split("."), f = c[0] + "." + c[1], c = 0; c < b.length; c++) null !=
        getValue(f + b[c]) && (d[b[c]] = getValue(f + b[c]));
      selectedStrip.setNameValue("eq.prmod", 0);
      isDefined(a) && selectedStrip.setNameValue("eq.prname", a);
      return d
    },
    loadPreset: function(a, b) {
      var c = selectedStrip.name.slice(0, -1);
      applyPreset(c, a);
      selectedStrip.setNameValue("eq.prmod", 0);
      isDefined(b) && selectedStrip.setNameValue("eq.prname", b);
      regUpdate(this)
    },
    paint: function() {
      ctx.fillStyle = color.eqBg;
      ctx.fillRect(0, 0, this.w, this.h);
      this.paintMarks();
      this.preset && drawImage(res.dbx, this.preset.x - 48, 13);
      drawImage(res.AFS2LOGO,
        30, this.h - 35);
      ctx.fillStyle = "rgba(255,255,255,0.1)";
      ctx.fillRoundRect(16, this.h - 42, this.AFS_OFF.x + this.AFS_OFF.w + 12 - 16, 40, 4)
    }
  }),
  EQMaster = Class.create(EQAux, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "EQMaster";
      this.left = !0
    },
    setLeft: function(a) {
      this.left = a;
      this.eq.setRight(!a);
      this.syncSliders();
      regUpdate(this);
      regUpdate(this.parent.stereo)
    },
    setLinked: function(a) {
      var b = this.left ? "l" : "r",
        c = this.left ? "r" : "l";
      if (a)
        for (var d = 0; 31 > d; d++) setValue("m.eq.peak." + c + "." + d, getValue("m.eq.peak." +
          b + "." + d));
      setValue("m.eq.hpf." + c, getValue("m.eq.hpf." + b));
      setValue("m.eq.lpf." + c, getValue("m.eq.lpf." + b));
      setValue("m.eq.linked", a ? 1 : 0);
      this.setLeft(!0)
    },
    connectKeys: function() {
      this.keyPrefix = "m.eq.peak.";
      this.kp = "m.eq.";
      this.keyPrefixAfs = "m.";
      this.idx = this.eq.idx;
      this.connectIdx()
    },
    connectIdx: function() {
      if (0 <= this.eq.idx) {
        var a = this.keyPrefix + (this.left ? "l." : "r.") + this.eq.idx;
        this.led.setKey(a);
        this.slGAIN.setKeyPrefix(a);
        regUpdate(this.slGAIN)
      }
    },
    doReset: function() {
      resetGraphEQ("m");
      regUpdate(editWidget)
    },
    syncSliders: function() {
      this.enabled && (this.eq.rta = null, this.connectKeys())
    },
    onShow: function() {
      this.eq.isClipping = !1;
      this.syncSliders()
    },
    calcGeometry: function($super) {
      this.w = this.parent.w - this.x;
      this.h = this.parent.h - this.y - 5;
      for (var b = this.h - 40, c = (this.w - 276 - 160) / 2, d = 80, f = 0; f < this.btns.length; f++) switch (this.btns[f].setPos(d | 0, b), f) {
        case 0:
          d += this.btns[0].w + 10;
          break;
        case 1:
          d += c;
          break;
        case 2:
          d += c;
          break;
        case 3:
          d += this.btns[0].w + 10
      }
    },
    initWidgets: function() {
      var a = this;
      this.preset = new MENUBUTTON(this);
      this.preset.setSize(130, 29);
      this.preset.setAnchors(null, 10, 10, null);
      this.preset.text = lang.PRESETS;
      this.preset.color = color.red;
      this.preset.onPress = function() {
        a.showPresets()
      };
      this.sEQ = new GEQ_SMALL(this);
      this.sEQ.setAnchors(40, 6);
      this.sEQ.master = !0;
      this.sEQ.left = !0;
      this.sEQ2 = new GEQ_SMALL(this);
      this.sEQ2.setAnchors(40 + this.sEQ.w + 2, 6);
      this.sEQ2.master = !0;
      this.sEQ2.left = !1;
      this.eq = new GEQ_GRAPH(this);
      this.eq.setAnchors(40, 78, 120, 64);
      this.eq.stereo = !0;
      this.eq.setKey("m.");
      this.eq.haveFilters = IS_UI_24;
      this.eq.onSelect = function(b) {
        a.connectIdx()
      };
      this.eq.onChange = function() {
        regUpdate(this);
        regUpdate(a.slGAIN);
        regUpdate(a.led);
        regUpdate(a.sEQ);
        regUpdate(a.sEQ2)
      };
      this.led = new FXLEDPlain(this);
      this.led.setAnchors(null, 56, 26, null);
      this.led.w = 60;
      this.led.label = lang.GAIN;
      this.led.sign = "dB";
      this.led.formatValue = function(a) {
        a = VtoEQGAIN15(a);
        return a = (0 < a ? "+" : "") + precision(a, 1) + ""
      };
      this.slGAIN = new EQSlider(this);
      this.slGAIN.keyPart = "";
      this.slGAIN.fader = res.eqVFaderRed;
      this.slGAIN.setAnchors(null, 144, 32,
        41);
      this.slGAIN.textUp = "+15dB";
      this.slGAIN.textBot = "-15dB";
      this.slGAIN.setDefaultValue(.5);
      this.slGAIN.mV = [1, findV(VtoEQGAIN15, 10), findV(VtoEQGAIN15, 5), findV(VtoEQGAIN15, -5), findV(VtoEQGAIN15, -10), 0];
      this.slGAIN.valueFunc = function(b) {
        1 == getValue("m.eq.linked") && setValue(this.key.replace(".l.", ".r."), b);
        selectedStrip.setNameValue("eq.prmod", 1);
        regUpdate(a.eq);
        regUpdate(a.led);
        regUpdate(a.sEQ);
        regUpdate(a.sEQ2)
      };
      this.AFS_SETTINGS = new Button(this);
      this.AFS_SETTINGS.setImages(res.SETUP_OFF, res.SETUP_ON);
      this.AFS_SETTINGS.onPress = function() {
        var b = new AFS_POPUP(null, a),
          c = a.eq.globalX() + a.eq.w,
          d = a.eq.globalY(),
          f = a.globalX(),
          e = a.globalY() + a.h;
        b.setSize(c - f, e - d);
        b.setPos(f, d);
        b.updateGeometry();
        regUpdate(b)
      };
      this.AFS_OFF = new CheckBox(this);
      this.AFS_OFF.setImages(res.OFF_OFF, res.ON_ON);
      this.AFS_OFF.setKey("m.afs.enabled");
      this.AFS_OFF.getState = function() {
        this.disabled = 0 == getValue("afs.enabled")
      };
      this.bRTA = new CheckBox(this);
      this.bRTA.setSize(70, 30);
      this.bRTA.setImages(res.RTA_OFF, res.RTA_ON);
      this.bRTA.getState =
        function() {
          var a = selectedStrip.name,
            c = getValue("var.rta") + ".";
          this.state = a == c ? 1 : 0
        };
      this.bRTA.onToggleUp = function() {
        setValue("var.rta", chopLastDot(selectedStrip.name))
      };
      this.bRTA.onToggleDown = function() {
        setValue("var.rta", "");
        a.eq.rta = null;
        regUpdate(a.eq)
      };
      this.bRESET = new Button(this);
      this.bRESET.setSize(70, 30);
      this.bRESET.setImages(res.bRESET_OFF, res.bRESET_ON);
      this.bRESET.valueFunc = function() {
        a.doReset()
      };
      this.bBYPASS = new CheckBox(this);
      this.bBYPASS.keyPart = "bypass";
      this.bBYPASS.setKeyPrefix("m.eq.");
      this.bBYPASS.setSize(70, 30);
      this.bBYPASS.setImages(res.bBYPASS_OFF, res.bBYPASS_ON);
      this.bBYPASS.onToggle = function() {
        regUpdate(a)
      };
      IS_UI_24 && (this.polarity_l = new CheckBox(this), this.polarity_l.setAnchors(260, null, null, 3), this.polarity_l.setImages(res.bPIOff, res.bPIOn), this.polarity_l.setKey("m.l.invert"), this.polarity_r = new CheckBox(this), this.polarity_r.setAnchors(null, null, 300, 3), this.polarity_r.setImages(res.bPIOff, res.bPIOn), this.polarity_r.setKey("m.r.invert"));
      this.btns = [this.AFS_SETTINGS, this.AFS_OFF,
        this.bRTA, this.bRESET, this.bBYPASS
      ]
    },
    paintMarks: function() {
      ctx.textAlign = "center";
      var a = this.eq.h,
        b = a / 6,
        c = a / 2 | 0;
      ctx.fillStyle = "#101115";
      ctx.fillRect(16, this.eq.y - 20, this.eq.w + 35, this.eq.h + 20 + 20);
      ctx.fillStyle = "#999";
      ctx.setShadow(color.black, 4, 1, 1);
      ctx.font = "23px open_sans_condensedbold";
      ctx.fillText(lang.L, this.sEQ.x - 13, this.sEQ.y + 31);
      ctx.fillText(lang.R, this.sEQ2.x + this.sEQ2.w + 13, this.sEQ.y + 31);
      IS_UI_24 && (ctx.fillText(lang.L, this.polarity_l.x - 6, this.polarity_l.y + 24), ctx.fillText(lang.R, this.polarity_r.x +
        56, this.polarity_r.y + 24));
      ctx.shadowColor = "transparent";
      ctx.font = font.eqMarks;
      ctx.translate(16, this.eq.y - 20);
      ctx.fillStyle = color.grad1;
      ctx.fillRect(1, 0, this.w - 16 - 110 - 2 + 2, 7);
      ctx.translate(-16, -(this.eq.y - 20));
      ctx.save();
      ctx.translate(this.eq.x, this.eq.y);
      ctx.textAlign = "right";
      ctx.fillStyle = color.graphMarks;
      ctx.fillText("+15", -3, 9);
      ctx.fillText("+10", -3, c - 2 * b + 3);
      ctx.fillText("+5", -3, c - b + 3);
      ctx.fillText("0", -3, c + 3);
      ctx.fillText("-5", -3, c + b + 3);
      ctx.fillText("-10", -3, c + 2 * b + 3);
      ctx.fillText("-15", -3, a - 3);
      ctx.restore()
    },
    showPresets: function() {
      this.menu = new PRESET_MENU2(null, "eqm", this, this.parent.color);
      regUpdate(this.menu)
    },
    savePreset: function(a) {
      var b = [];
      b.push(".eq.linked");
      for (var c = 0; c < this.eq.bands; c++) b.push(".eq.peak.l." + c), b.push(".eq.peak.r." + c);
      IS_UI_24 && (b.push(".eq.lpf.l"), b.push(".eq.lpf.r"), b.push(".eq.hpf.l"), b.push(".eq.hpf.r"));
      for (var d = {}, c = 0; c < b.length; c++) null != getValue("m" + b[c]) && (d[b[c]] = getValue("m" + b[c]));
      selectedStrip.setNameValue("eq.prmod", 0);
      isDefined(a) && selectedStrip.setNameValue("eq.prname",
        a);
      return d
    },
    loadPreset: function(a, b) {
      applyPreset("m", a);
      selectedStrip.setNameValue("eq.prmod", 0);
      isDefined(b) && selectedStrip.setNameValue("eq.prname", b);
      regUpdate(editWidget)
    }
  }),
  EQParamWidget = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "EQParamWidget";
      this.needMoveEvt = this.needClip = !0;
      this.touchRadius = 32;
      this.RATE = 48E3;
      this.pressed = !1;
      this.touchID = -1;
      this.peaks = this.grd = null;
      this.bypass = !1;
      this.bands = 5;
      this.colors = ["#2D5EAA", "#2c8f29", "#b23535", "#752E99", "#C7AB35",
        color.orange
      ];
      this.isClipping = !1;
      this.timer = null;
      this.point1 = [-1, -1];
      this.point1id = -1;
      this.point2 = [-1, -1];
      this.point2id = -2;
      this.p1 = [-1, -1];
      this.p2 = [-1, -1];
      this.tn = 0;
      this.dist = -1;
      this.moved = this.easy = !1;
      this.stY = -1;
      this.cachedBgBypass = this.cachedBg = null;
      this.cachedBgW = this.cachedBgH = 0;
      this.lastP = !1;
      this.arr = "hpf b1 b2 b3 b4 lpf".split(" ");
      this.rtaTimer = this.rta = this.egrad = null;
      this.delta = [0, 0];
      this.ds = !1;
      this.lp_slope = this.hp_slope = this.ds_thr = this.ds_ratio = this.ds_freq = 0;
      this.showPreset = !0;
      this.showCurrentCurve = !isLocal
    },
    calcGeometry: function() {
      var a = this.w;
      this.grd = ctx.createRadialGradient(a / 2, -10, a / 10, a / 2, -10, a / 2 + 10);
      this.grd.addColorStop(0, "rgba(255,255,255,0.2)");
      this.grd.addColorStop(1, "rgba(255,255,255,0)")
    },
    getValues: function() {
      this.peaks = [];
      var a = this.parent.keyPrefix;
      this.bypass = toBool(getValue(a + "bypass"));
      this.easy = toBool(getValue(a + "easy"));
      selectedStrip.type == E_STRIP_TYPE.IN ? (this.ds = 1 == selectedStrip.getNameValue("deesser.enabled"), this.ds_freq = selectedStrip.getNameValue("deesser.freq"), this.ds_ratio =
        selectedStrip.getNameValue("deesser.ratio"), this.ds_thr = selectedStrip.getNameValue("deesser.threshold")) : this.ds = !1;
      var b = "hpf b1 b2 b3 b4 lpf".split(" ");
      this.bands = IS_UI_24 && selectedStrip.type == E_STRIP_TYPE.IN ? 6 : 5;
      IS_UI_24 && (this.hp_slope = selectedStrip.getNameValue("eq.hpf.slope"), this.lp_slope = selectedStrip.getNameValue("eq.lpf.slope"));
      for (var c = 0; c < this.bands; c++) {
        var d = a + b[c],
          f = VtoFREQ(getValue(d + ".freq"));
        if (0 == c || 5 == c) this.peaks.push([f, 1, 0]);
        else {
          var e = VtoQ(getValue(d + ".q")),
            d = VtoEQGAIN20(getValue(d +
              ".gain"));
          this.peaks.push([f, e, d])
        }
      }
    },
    onDown: function(a, b, c) {
      a -= this.globalX();
      var d = b - this.globalY();
      this.stY = b;
      this.moved = !1;
      switch (this.tn) {
        case 0:
          this.point1id = c;
          this.point1 = [a, d];
          break;
        case 1:
          this.point2id = c, this.point2 = [a, d]
      }
      this.tn++;
      if (!this.pressed) {
        b = .5 * this.h / 20;
        var f = this.h / 2 | 0;
        this.getValues();
        for (var e = 0; e < this.bands; e++) {
          if (this.easy) {
            if (0 == e) continue;
            if (4 == e) continue;
            if (5 == e) continue
          }
          var g = this.freqToX(this.peaks[e][0]),
            h = f - this.peaks[e][2] * b;
          this.easy && (1 == e && (g += this.w / 6), 3 == e &&
            (g -= this.w / 6));
          var l = this.touchRadius;
          if (20 > g || g > this.w - 20 || 20 > h || h > this.h - 20) l += this.touchRadius;
          if (isInCircle(g, h, l, a, d)) {
            this.parent.setMode(e);
            this.pressed = !0;
            this.touchID = c;
            this.delta = [g - a, h - d];
            return
          }
        }
        this.ds && (g = this.freqToX(DeesserVtoFREQ(this.ds_freq)), h = 3 + (1 - this.ds_thr / 2) * (this.h - 6) | 0, isInCircle(g, h, this.touchRadius, a, d) && (this.parent.setMode(77), this.pressed = !0, this.touchID = c, this.delta = [g - a, h - d], regUpdate(this)))
      }
    },
    onMove: function(a, b, c) {
      var d = this.parent;
      5 < Math.abs(b - this.stY) && (this.moved = !0);
      this.pressed && this.touchID == c && (a += this.delta[0], b += this.delta[1]);
      a = bound(a - this.globalX(), 0, this.w);
      b = bound(b - this.globalY(), 0, this.h);
      switch (c) {
        case this.point1id:
          this.point1 = [a, b];
          break;
        case this.point2id:
          this.point2 = [a, b]
      }
      if (2 == this.tn) {
        c = Math.sqrt(Math.pow(this.point1[0] - this.point2[0], 2) + Math.pow(this.point1[1] - this.point2[1], 2));
        b = bound(c - this.dist, -20, 20) / this.w * .6;
        if (0 < this.dist) switch (d.mode) {
          case 1:
          case 2:
          case 3:
          case 4:
            a = this.parent.slQ.getVal();
            a = bound(a - b, 0, 1);
            this.parent.slQ.setValue(a);
            regUpdate(this);
            regUpdate(d.led_q);
            regUpdate(d.slQ);
            selectedStrip.setNameValue("eq.prmod", 1);
            break;
          case 77:
            a = selectedStrip.getNameValue("deesser.ratio"), a = bound(a - b, 0, 1), selectedStrip.setNameValue("deesser.ratio", a), regUpdate(this), regUpdate(d.led_d3), regUpdate(d.D3)
        }
        this.dist = c
      } else if (this.pressed && this.touchID == c) {
        switch (d.mode) {
          case 0:
            d.slFREQ.setValue(bound(a / this.w, 0, .5588));
            selectedStrip.setNameValue("eq.prmod", 1);
            break;
          case 5:
            d.slFREQ.setValue(bound(a / this.w, .5588, 1));
            selectedStrip.setNameValue("eq.prmod",
              1);
            break;
          case 1:
          case 2:
          case 3:
          case 4:
            if (this.easy) {
              a = 1 - b / this.h;
              switch (d.mode) {
                case 1:
                  d.BASS.setValue(a);
                  break;
                case 2:
                  d.MID.setValue(a);
                  break;
                case 3:
                  d.TREBLE.setValue(a)
              }
              regUpdate(this)
            } else d.slFREQ.setValue(a / this.w), d.slGAIN.setValue(1 - b / this.h);
            selectedStrip.setNameValue("eq.prmod", 1);
            break;
          case 77:
            c = bound(a, this.freqToX(2E3) | 0, this.freqToX(15E3) | 0) - this.freqToX(2E3);
            a = this.freqToX(15E3) - this.freqToX(2E3);
            b = bound(b, this.h / 2 | 0, this.h) - this.h / 2 | 0;
            var f = this.h / 2 | 0;
            d.D1.setValue(c / a);
            d.D2.setValue(1 -
              b / f)
        }
        regUpdate(this);
        regUpdate(d.led)
      }
    },
    onUp: function(a) {
      this.dist = -1;
      switch (this.tn) {
        case 1:
          this.point1 = [-1, -1];
          break;
        case 2:
          this.point2 = [-1, -1], this.lastClickTime = 0
      }
      this.tn--;
      a = this.parent;
      var b = Date.now();
      if (b - this.lastClickTime < DBL_CLK_TIME && this.lastClickIdx == a.mode && this.lastP == this.pressed) {
        if (this.pressed)
          if (77 == a.mode) a.D1.setValue(.773310034), a.D2.setValue(.46875), a.D3.setValue(.4);
          else if (this.easy) switch (a.mode) {
          case 1:
            a.BASS.setValue(.5);
            break;
          case 2:
            a.MID.setValue(.5);
            break;
          case 3:
            a.TREBLE.setValue(.5)
        } else {
          if (0 !=
            a.mode && 5 != a.mode) a.slGAIN.setValue(.5);
          else if (a.dbu1 && a.dbu1.enabled) a.dbu1.onDown();
          switch (a.mode) {
            case 0:
              a.slFREQ.setValue(0);
              break;
            case 1:
              a.slFREQ.setValue(FREQtoV(200));
              break;
            case 2:
              a.slFREQ.setValue(FREQtoV(1E3));
              break;
            case 3:
              a.slFREQ.setValue(FREQtoV(4E3));
              break;
            case 4:
              a.slFREQ.setValue(FREQtoV(1E4));
              break;
            case 5:
              a.slFREQ.setValue(1)
          }
        } else setMode(E_MODE.MIX);
        regUpdate(this)
      }
      this.lastP = this.pressed;
      this.pressed = !1;
      this.moved || 0 != this.tn || (this.lastClickTime = b);
      this.lastClickIdx = a.mode;
      this.touchID = -1
    },
    onWheel: function(a) {
      var b = this.parent;
      switch (b.mode) {
        case 0:
        case 5:
          var c = selectedStrip.name + "eq." + (5 == b.mode ? "lpf." : "hpf.") + "slope",
            d = getValue(c);
          0 < a ? d-- : d++;
          d = bound(d, 0, 2);
          setValue(c, d);
          regUpdate(b);
          break;
        case 1:
        case 2:
        case 3:
        case 4:
          if (this.easy) break;
          c = "eq." + this.arr[this.parent.mode] + ".q";
          d = selectedStrip.getNameValue(c);
          d = bound(d + a / 120 / 30, 0, 1);
          selectedStrip.setNameValue(c, d);
          regUpdate(this);
          regUpdate(b.led_q);
          regUpdate(b.slQ);
          break;
        case 77:
          d = selectedStrip.getNameValue("deesser.ratio"), d = bound(d +
            a / 120 / 30, 0, 1), selectedStrip.setNameValue("deesser.ratio", d), regUpdate(this), regUpdate(b.led_d3), regUpdate(b.D3)
      }
    },
    freqToX: function(a) {
      return (this.w - 1) * Math.log(a / 20) / Math.log(1102.5)
    },
    designPeak: function(a, b, c, d) {
      if (-.001 <= d && .001 >= d) return [1, 0, 0, 1, 0, 0];
      d = Math.pow(10, d / 40);
      b = 2 * Math.PI * b / a;
      a = Math.cos(b);
      c = b * (2 * Math.PI - b) / (c * (4 * Math.PI - b));
      b = 1 + c / d;
      var f = Math.pow(10, 0) / b;
      return [(1 + c * d) * f, -(2 * a) * f, (1 - c * d) * f, 1, -(2 * a) / b, (1 - c / d) / b]
    },
    designHP: function(a, b, c) {
      if (20.1 > b) return [1, 0, 0, 1, 0, 0];
      b = 2 * Math.PI * b / a;
      a = Math.cos(b);
      c = Math.sin(b) / (2 * c);
      b = 1 + c;
      var d = Math.pow(10, 0) / b;
      return [.5 * (1 + a) * d, -(1 + a) * d, .5 * (1 + a) * d, 1, -(2 * a) / b, (1 - c) / b]
    },
    designLP: function(a, b, c) {
      if (22049.9 < b) return [1, 0, 0, 1, 0, 0];
      b = 2 * Math.PI * b / a;
      a = Math.cos(b);
      c = Math.sin(b) / (2 * c);
      b = 1 + c;
      var d = Math.pow(10, 0) / b;
      return [.5 * (1 - a) * d, (1 - a) * d, .5 * (1 - a) * d, 1, -(2 * a) / b, (1 - c) / b]
    },
    showClip: function() {
      this.isClipping = !0;
      regUpdate(this);
      var a = this;
      clearTimeout(this.timer);
      this.timer = setTimeout(function() {
        a.isClipping = !1;
        regUpdate(a)
      }, 3E3)
    },
    setRTA: function(a) {
      this.rta =
        a;
      var b = this;
      clearTimeout(this.rtaTimer);
      this.rtaTimer = setTimeout(function() {
        b.rta = null;
        regUpdate(b)
      }, 1E3);
      regUpdate(this)
    },
    paint: function() {
      this.getValues();
      this.cachedBgW == this.w && this.cachedBgH == this.h || this.cachePaint();
      ctx.drawImage(this.cachedBg, 0, 0, this.w, this.h);
      this.bypass && (ctx.fillStyle = "rgba(255,255,255,0.04)", ctx.fillRect(0, 0, this.w, this.h));
      null != this.rta && this.drawRTA();
      this.easy && (ctx.globalAlpha = .07, ctx.fillStyle = this.egrad, ctx.fillRect(0, 0, this.w, this.h), ctx.globalAlpha = 1);
      var a =
        this.w,
        b = this.h,
        c = this.peaks,
        d = .5 * b / 20,
        f = b / 2 | 0;
      if (null == this.freqPlot || this.freqPlot.length != a) {
        this.freqPlot = Array(a);
        this.freqPlot2 = Array(a);
        this.xToFreq = Array(a);
        this.xToAngular = Array(a);
        this.xCos1 = Array(a);
        this.xCos2 = Array(a);
        for (var e = 0; e < a; e++) {
          var b = 20 * Math.pow(1102.5, 1 * e / a),
            g = 2 * b * Math.PI / this.RATE,
            h = Math.cos(g),
            l = Math.cos(2 * g);
          this.xToFreq[e] = b;
          this.xToAngular[e] = g;
          this.xCos1[e] = h;
          this.xCos2[e] = l
        }
      }
      for (b = 0; b < a; b++) this.freqPlot[b] = 0, this.freqPlot2[b] = 0;
      for (b = 0; b < this.bands; b++) {
        var m, g = 1;
        switch (b) {
          case 0:
            m =
              this.designHP(this.RATE, bound(c[b][0], 20, 1E3), Math.sqrt(2) / 2);
            g = this.hp_slope + 1;
            break;
          case 5:
            m = this.designLP(this.RATE, bound(c[b][0], 1E3, 22050), Math.sqrt(2) / 2);
            g = this.lp_slope + 1;
            break;
          default:
            m = this.designPeak(this.RATE, c[b][0], c[b][1], c[b][2])
        }
        var e = m[3],
          n = m[0],
          p = m[1],
          r = m[2],
          q = m[4],
          h = m[5];
        m = n * n + p * p + r * r;
        for (var p = 2 * p * (n + r), n = 2 * n * r, r = e * e + q * q + h * h, q = 2 * q * (e + h), t = 2 * e * h, e = 0; e < a; e++) h = this.xCos1[e], l = this.xCos2[e], h = 4.3429448190325175 * Math.log((m + p * h + n * l) / (r + q * h + t * l)), h *= g | 0, this.freqPlot[e] += h, b == this.parent.mode &&
          (this.freqPlot2[e] += h)
      }
      ctx.lineWidth = 2;
      ctx.lineJoin = "round";
      if (this.showCurrentCurve) {
        ctx.beginPath();
        for (e = 0; e < a; e++)
          if (!(1 == (e & 1) && e < a - 1) || this.freqPlot2[e] > this.freqPlot2[e - 1] && this.freqPlot2[e] > this.freqPlot2[e + 1] || this.freqPlot2[e] < this.freqPlot2[e - 1] && this.freqPlot2[e] < this.freqPlot2[e + 1]) g = f - d * this.freqPlot2[e], 0 == e && ctx.moveTo(e, g), ctx.lineTo(e, g);
        ctx.lineWidth = 1;
        ctx.strokeStyle = this.colors[this.parent.mode];
        ctx.fillStyle = hexToRGBA(this.colors[this.parent.mode], .1);
        ctx.stroke();
        ctx.lineTo(a,
          f);
        ctx.lineTo(0, f);
        ctx.closePath();
        ctx.fill()
      }
      ctx.fillStyle = "#666";
      ctx.fillRect(0, f - 1, a, 2);
      ctx.beginPath();
      ctx.fillStyle = "rgba(255,255,255,0.12)";
      ctx.strokeStyle = "#ffffff";
      ctx.lineWidth = 2;
      for (e = 0; e < a; e++)
        if (!(1 == (e & 1) && e < a - 1) || this.freqPlot[e] > this.freqPlot[e - 1] && this.freqPlot[e] > this.freqPlot[e + 1] || this.freqPlot[e] < this.freqPlot[e - 1] && this.freqPlot[e] < this.freqPlot[e + 1]) g = f - d * this.freqPlot[e], 0 == e && ctx.moveTo(e, g), ctx.lineTo(e, g);
      ctx.stroke();
      ctx.lineTo(a, f);
      ctx.lineTo(0, f);
      ctx.closePath();
      ctx.fill();
      ctx.textAlign = "center";
      if (this.easy)
        for (ctx.strokeStyle = "rgba(255,255,255,0.5)", ctx.font = "bold 15px open_sans_condensedbold", p = ["B", "M", "T"], a = [1, 2, 3], m = 0; m < p.length; m++) b = a[m], e = this.freqToX(c[b][0]), 1 == b && (e += this.w / 6), 3 == b && (e -= this.w / 6), g = f - c[b][2] * d, ctx.lineWidth = "3", this.bypass && 0 != b ? (ctx.fillStyle = "rgba(255,255,255,0.4)", ctx.strokeStyle = "rgba(255,255,255,0.3)") : (ctx.fillStyle = this.colors[b], ctx.strokeStyle = this.colors[b]), ctx.globalAlpha = .9, ctx.beginPath(), ctx.arc(e, g, 16, 0, 2 * Math.PI), ctx.fill(),
          ctx.globalAlpha = 1, ctx.beginPath(), ctx.arc(e, g, this.touchRadius, 0, 2 * Math.PI), ctx.globalAlpha = .38, ctx.fill(), ctx.globalAlpha = 1, this.mode == b && ctx.stroke(), ctx.fillStyle = "#060606", ctx.fillText(p[m], e - (0 == b ? 1 : 0) + 1, g + 5 + 1), ctx.fillStyle = "#F0F0F0", ctx.fillText(p[m], e - (0 == b ? 1 : 0), g + 5);
      else
        for (ctx.strokeStyle = "rgba(255,255,255,0.5)", ctx.font = "bold 14px open_sans_condensedbold", p = "HPF 1 2 3 4 LPF".split(" "), b = 0; b < this.bands; b++) e = this.freqToX(c[b][0]), g = f - c[b][2] * d, ctx.lineWidth = "3", this.bypass && 0 != b && 5 != b ?
          (ctx.fillStyle = "rgba(255,255,255,0.4)", ctx.strokeStyle = "rgba(255,255,255,0.3)") : (ctx.fillStyle = this.colors[b], ctx.strokeStyle = this.colors[b]), ctx.globalAlpha = .9, ctx.beginPath(), ctx.arc(e, g, 13, 0, 2 * Math.PI), ctx.fill(), ctx.globalAlpha = 1, ctx.beginPath(), ctx.arc(e, g, this.touchRadius, 0, 2 * Math.PI), ctx.globalAlpha = .38, ctx.fill(), ctx.globalAlpha = 1, this.parent.mode == b && ctx.stroke(), ctx.fillStyle = "#060606", ctx.fillText(p[b], e + 1, g + 6), ctx.fillStyle = "#F0F0F0", ctx.fillText(p[b], e, g + 5);
      this.easy && (ctx.font = "21px open_sans_condensedbold",
        ctx.fillStyle = color.white, ctx.textAlign = "center", ctx.fillText(lang.BASS, this.freqToX(50) | 0, this.h - 20), ctx.fillText(lang.MID, this.freqToX(1E3) | 0, this.h - 20), ctx.fillText(lang.TREBLE, this.freqToX(8E3) | 0, this.h - 20));
      this.ds && (ctx.strokeStyle = "rgba(0,250,0,0.2)", ctx.lineWidth = 2, c = this.freqToX(DeesserVtoFREQ(this.ds_freq)) | 0, d = 3 + (1 - this.ds_thr) * (this.h - 6) | 0, ctx.beginPath(), ctx.dashedLine(c, 0, c, this.h, 10), ctx.stroke(), f = this.freqToX(5E3) - this.freqToX(2E3), ctx.beginPath(), ctx.moveTo(c - f, this.h), ctx.quadraticCurveTo(c,
        d, c + f, this.h), ctx.closePath(), d = precision(.07 * this.ds_ratio, 4), ctx.fillStyle = "rgba(0,255,0," + d + ")", ctx.fill(), ctx.stroke(), e = c, g = 3 + (1 - this.ds_thr / 2) * (this.h - 6) | 0, ctx.lineWidth = 3, ctx.strokeStyle = "rgba(100,255,100,0.3)", ctx.fillStyle = "rgba(100,255,100,0.4)", ctx.globalAlpha = 1, ctx.beginPath(), ctx.arc(e, g, this.touchRadius, 0, 2 * Math.PI), ctx.globalAlpha = .38, ctx.fill(), ctx.globalAlpha = 1, 77 == this.parent.mode && ctx.stroke(), ctx.fillStyle = "rgba(0,0,0,0.4)", ctx.globalAlpha = .9, ctx.beginPath(), ctx.arc(e, g, 13, 0, 2 *
        Math.PI), ctx.fill(), ctx.fillStyle = "#F0F0F0", ctx.font = "bold 15px open_sans_condensedbold", ctx.fillText("DS", e - (0 == b ? 1 : 0), g + 5), ctx.shadowColor = "transparent");
      ctx.lineWidth = 1;
      ctx.strokeStyle = "#222";
      ctx.strokeRect(.5, .5, this.w - 1, this.h - 1);
      this.showPreset && (ctx.textAlign = "left", ctx.fillStyle = 1 == selectedStrip.getNameValue("eq.prmod") ? "#444" : color.red, ctx.setShadow(color.black, 0, 2, 2), ctx.font = "18px open_sans_condensedbold", ctx.fillText(selectedStrip.getNameValue("eq.prname"), 4, 18))
    },
    drawRTA: function() {
      var a =
        this.w,
        b = this.h - 2,
        c = this.rta,
        d = FREQtoX(20.6, a),
        f = FREQtoX(22350.6, a) / (c.length - 1);
      ctx.strokeStyle = "#0f0";
      ctx.lineWidth = 1;
      ctx.lineCap = "round";
      ctx.fillStyle = "rgba(255,255,255,0.1)";
      ctx.beginPath();
      var e = c[0];
      ctx.moveTo(0, b * (1 - e) | 0);
      for (var g = 0; g < c.length; g++) {
        e = c[g];
        e = b * (1 - e) | 0;
        ctx.lineTo(d, e);
        if (d >= a) break;
        d += f
      }
      ctx.lineTo(a, b);
      ctx.lineTo(0, b);
      ctx.closePath();
      ctx.fill()
    },
    cachePaint: function() {
      null != this.cachedBg && delete this.cachedBg;
      this.cachedBg = document.createElement("canvas");
      var a = this.cachedBg.getContext("2d");
      isRetina ? (this.cachedBg.width = 2 * this.w, this.cachedBg.height = 2 * this.h, a.scale(2, 2)) : (this.cachedBg.width = this.w, this.cachedBg.height = this.h);
      var b = this.w,
        c = this.h,
        d = .5 * c / 20,
        f = c / 2 | 0;
      a.fillStyle = "#0A0B0C";
      a.fillRect(0, 0, this.w, this.h);
      isSmall || (a.fillStyle = this.grd, a.fillRect(0, 0, b, c));
      a.font = font.eqMarks;
      a.textAlign = "center";
      a.lineWidth = 1;
      a.fillStyle = "rgba(255,255,255,0.1)";
      a.fillRect(0, f - 10 * d | 0, b, .5);
      a.fillRect(0, f + 10 * d | 0, b, .5);
      a.strokeStyle = "rgba(255,255,255,0.15)";
      a.lineWidth = .5;
      a.beginPath();
      a.moveTo(0,
        f - 1);
      a.lineTo(b, f - 1);
      a.fillStyle = color.labelText;
      for (b = 30; 100 >= b; b += 10) d = (this.freqToX(b) | 0) + .5, a.moveTo(d, 0), a.lineTo(d, c - 1);
      for (b = 100; 1E3 >= b; b += 100) d = (this.freqToX(b) | 0) + .5, a.moveTo(d, 0), a.lineTo(d, c - 1);
      for (b = 1E3; 1E4 >= b; b += 1E3) d = (this.freqToX(b) | 0) + .5, a.moveTo(d, 0), a.lineTo(d, c - 1);
      a.stroke();
      this.egrad = ctx.createLinearGradient(0, 0, this.w, 0);
      this.egrad.addColorStop(0, this.colors[1]);
      this.egrad.addColorStop(.5, this.colors[2]);
      this.egrad.addColorStop(1, this.colors[3]);
      this.cachedBgW = this.w;
      this.cachedBgH =
        this.h
    }
  }),
  EQGraphicWidget = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "EQGraphicWidget";
      this.needMoveEvt = this.needClip = !0;
      this.master = !1;
      this.left = !0;
      this.selecting = this.pressed = !1;
      this.idx = 0;
      this.touchID = -1;
      this.grd = null;
      this.bands = 31;
      this.vBands = 16;
      this.moved = this.isClipping = this.bankB = !1;
      this.stY = -1;
      this.bypass = !1;
      this.cachedBgBypass = this.cachedBg = null;
      this.cachedBgW = this.cachedBgH = 0;
      this.lastP = !1;
      this.rtaTimer = this.rta = null;
      this.delta = [0, 0];
      this.afsEnabled = !1;
      this.afs = [];
      this.barColors = "#b93737 #bb3e39 #bd433a #bf473c #c24d3e #c4533f #c65a41 #c86043 #cb7c44 #cc8a44 #ce9944 #bca533 #bea735 #c1a837 #c3aa39 #c5ac3a #c8af3c #cab13e #ccb340 #cfb342 #d1b544 #51b350 #60b95f #6ec06d #3576b1 #3a79b3 #3f7db5 #4480b7 #4883b9 #4d87bb #528abd".split(" ");
      this.showPreset = !0
    },
    onDown: function(a, b, c) {
      if (!this.pressed) {
        this.stY = b;
        this.moved = !1;
        var d = a - this.globalX(),
          f = b - this.globalY(),
          e = this.w / this.vBands,
          g = this.h / 2 | 0;
        this.selecting = !0;
        for (var h = 0; h < this.vBands; h++) {
          var l =
            2 * (-this.getPeak(h) + .5) * g | 0,
            m = e * h,
            l = g + l;
          isInRect(m, l - e, e, 2 * e, d, f) && (this.pressed = !0, this.selecting = !1, this.idx = h, this.delta = [m - d, l - f], this.parent.connectKeys(), this.onMove(a, b, c))
        }
        this.selecting && (this.idx = bound(d / e | 0, 0, this.vBands), this.parent.connectKeys());
        this.touchID = c;
        regUpdate(this.parent.sEQ);
        this.master && regUpdate(this.parent.sEQ2);
        regUpdate(this)
      }
    },
    onMove: function(a, b, c) {
      this.selecting && (a = bound(a - this.globalX(), 0, this.w - 1), a = bound(a / (this.w / this.vBands) | 0, 0, this.vBands), this.idx != a && (this.idx =
        a, this.parent.connectKeys(), regUpdate(this.parent.sEQ), this.master && regUpdate(this.parent.sEQ2), regUpdate(this)));
      this.pressed && this.touchID == c && (b += this.delta[1], 5 < Math.abs(b - this.stY) && (this.moved = !0), b = bound(b - this.globalY(), 0, this.h), b = bound(1 - b / this.h, 0, 1), this.setPeak(this.idx, b), regUpdate(this.parent.slGAIN), regUpdate(this.parent.led), regUpdate(this.parent.sEQ), this.master && regUpdate(this.parent.sEQ2), regUpdate(this))
    },
    onUp: function(a) {
      this.touchID != a ? this.lastClickTime = 0 : (this.delta = [0, 0],
        a = Date.now(), a - this.lastClickTime < DBL_CLK_TIME && this.lastClickIdx == this.idx && this.lastP == !this.selecting && (this.pressed ? (this.setPeak(this.idx, .5), this.pressed = !1, this.touchID = -1, regUpdate(this), regUpdate(this.parent.sEQ), this.master && regUpdate(this.parent.sEQ2), regUpdate(this.parent.slGAIN)) : setMode(E_MODE.MIX)), this.moved || (this.lastClickTime = a), this.lastClickIdx = this.idx, this.lastP = !this.selecting, this.pressed = !1, this.touchID = -1)
    },
    onWheel: function(a) {
      if (!this.easy) {
        var b = this.getPeak(this.idx),
          b = bound(b + a / 120 / 30, 0, 1);
        this.setPeak(this.idx, b);
        regUpdate(this.parent.slGAIN);
        regUpdate(this.parent.led);
        regUpdate(this.parent.sEQ);
        this.master && regUpdate(this.parent.sEQ2);
        regUpdate(this)
      }
    },
    calcGeometry: function() {
      var a = this.w;
      this.grd = ctx.createRadialGradient(a / 2, -10, a / 10, a / 2, -10, a / 2 + 10);
      this.grd.addColorStop(0, "rgba(255,255,255,0.2)");
      this.grd.addColorStop(1, "rgba(255,255,255,0)")
    },
    getPeak: function(a) {
      if (0 > a || a >= this.bands) return log("peak out of bounds"), 0;
      this.bankB && (a += 15);
      return this.master ?
        getValue("m.eq.peak." + (this.left ? "l." : "r.") + a) : getValue(this.parent.keyPrefix + a)
    },
    setPeak: function(a, b) {
      if (0 > a || a >= this.bands) log("peak out of bounds");
      else {
        this.bankB && (a += 15);
        if (this.master) {
          var c = "m.eq.peak." + (this.left ? "l." : "r.") + a;
          setValue(c, b);
          1 == getValue("m.eq.linked") && setValue(c.replace(".l.", ".r."), b)
        } else setValue(this.parent.keyPrefix + a, b);
        selectedStrip.setNameValue("eq.prmod", 1)
      }
    },
    setRTA: function(a) {
      this.rta = a;
      var b = this;
      clearTimeout(this.rtaTimer);
      this.rtaTimer = setTimeout(function() {
        b.rta =
          null;
        regUpdate(b)
      }, 1E3);
      regUpdate(this)
    },
    showClip: function() {
      this.isClipping = !0;
      regUpdate(this);
      var a = this;
      clearTimeout(this.timer);
      this.timer = setTimeout(function() {
        a.isClipping = !1;
        regUpdate(a)
      }, 3E3)
    },
    paint: function() {
      this.bypass = 1 == selectedStrip.getNameValue("eq.bypass");
      if (this.afsEnabled = 1 == getValue("afs.enabled")) this.afsEnabled = 0 != selectedStrip.getNameValue("afs.enabled");
      this.cachedBgW == this.w && this.cachedBgH == this.h || this.cachePaint();
      ctx.drawImage(this.cachedBg, 0, 0, this.w, this.h);
      this.bypass &&
        (ctx.fillStyle = "rgba(255,255,255,0.04)", ctx.fillRect(0, 0, this.w, this.h));
      null != this.rta && this.drawRTA();
      var a = this.w / this.vBands,
        b = this.h / 2 | 0;
      this.afsEnabled && this.drawAFS(a, b);
      ctx.fillStyle = "#51608C";
      ctx.lineWidth = 2;
      ctx.strokeStyle = "rgba(255,255,255,0.5)";
      for (var c = 0; c < this.vBands; c++) {
        this.idx == c && (ctx.fillStyle = "rgba(255,255,255,0.04)", ctx.fillRect(a * c | 0, 0, a, this.h));
        var d = 2 * (-1 * this.getPeak(c) + .5) * b | 0;
        ctx.globalAlpha = .4;
        this.bypass ? (ctx.fillStyle = "rgba(255,255,255,0.4)", ctx.strokeStyle = "rgba(255,255,255,0.3)") :
          ctx.strokeStyle = ctx.fillStyle = this.barColors[c + (this.bankB ? 15 : 0)];
        ctx.fillRect(a * c + 2 | 0, b, a - 3 | 0, d);
        ctx.lineWidth = this.idx == c ? 3 : 2;
        10 < a && (ctx.beginPath(), ctx.arc(a * c + a / 2, b + d, a / 2 - 3, 0, 2 * Math.PI), ctx.fill(), this.idx == c && (ctx.globalAlpha = 1), ctx.stroke());
        ctx.globalAlpha = 1
      }
      ctx.fillStyle = "#0A0B0C";
      ctx.fillRect(0, b - 2, this.w, 4);
      ctx.fillStyle = "#9D9D9D";
      ctx.fillRect(0, b - 1, this.w, 2);
      ctx.lineWidth = 1;
      ctx.strokeStyle = "#222";
      ctx.strokeRect(.5, .5, this.w - 1, this.h - 1);
      ctx.fillStyle = "rgba(255,255,255,0.1)";
      this.bankB ? ctx.fillTriangle2(1,
        10, 9, 2, 9, 18) : ctx.fillTriangle2(this.w - 1, 10, this.w - 9, 2, this.w - 9, 18);
      this.showPreset && (ctx.textAlign = "left", ctx.fillStyle = 1 == selectedStrip.getNameValue("eq.prmod") ? "#444" : color.red, ctx.setShadow(color.black, 0, 1, 1), ctx.font = "18px open_sans_condensedbold", ctx.fillText(selectedStrip.getNameValue("eq.prname"), 4, 18))
    },
    drawAFS: function(a, b) {
      ctx.lineWidth = 3;
      for (var c = this.parent.keyPrefixAfs + "afs.eq.", d = 0; 12 > d; d++) {
        var f = getValue(c + d),
          e = JSON.parse("[" + f + "]"),
          f = e[3];
        if (2 != f) {
          var g = e[0],
            e = bound(e[2], -15, 0);
          0 != e && (g = FREQtoX(g, 31 * this.w / 16), this.bankB && (g -= this.w / 16 * 15), e = b - e / 15 * b, e = bound(e, b, this.h), ctx.strokeStyle = 2 == f ? color.afsGraphPeakLive : color.afsGraphPeakFixed, ctx.beginPath(), ctx.moveTo(g - a / 2, b), ctx.quadraticCurveTo(g, b, g, e), ctx.quadraticCurveTo(g, b, g + a / 2, b), ctx.lineTo(g + a / 2, b), ctx.stroke())
        }
      }
      for (d = 0; 12 > d; d++) f = getValue(c + d), e = JSON.parse("[" + f + "]"), f = e[3], 2 == f && (g = e[0], e = bound(e[2], -15, 0), 0 != e && (g = FREQtoX(g, 31 * this.w / 16), this.bankB && (g -= this.w / 16 * 15), e = b - e / 15 * b, e = bound(e, b, this.h), ctx.strokeStyle =
        2 == f ? color.afsGraphPeakLive : color.afsGraphPeakFixed, ctx.beginPath(), ctx.moveTo(g - a / 2, b), ctx.quadraticCurveTo(g, b, g, e), ctx.quadraticCurveTo(g, b, g + a / 2, b), ctx.lineTo(g + a / 2, b), ctx.stroke()))
    },
    drawRTA: function() {
      var a = this.w,
        b = this.h - 2,
        c = this.rta;
      ctx.strokeStyle = "#0f0";
      ctx.lineWidth = 1;
      ctx.lineCap = "round";
      ctx.fillStyle = "rgba(255,255,255,0.1)";
      ctx.beginPath();
      var d = 0,
        f = c.length / 31 * 16 | 0;
      this.bankB && (d = c.length / 31 * 15 | 0, f = c.length);
      var e = FREQtoX(20.6, a),
        g = FREQtoX(22350.6, a) / (f - d - 1),
        h = c[0];
      for (ctx.moveTo(0,
          b * (1 - h) | 0); d < f; d++) {
        h = c[d];
        h = b * (1 - h) | 0;
        ctx.lineTo(e, h);
        if (e >= a) break;
        e += g
      }
      ctx.lineTo(a, b);
      ctx.lineTo(0, b);
      ctx.closePath();
      ctx.fill()
    },
    cachePaint: function() {
      null != this.cachedBg && delete this.cachedBg;
      this.cachedBg = document.createElement("canvas");
      var a = this.cachedBg.getContext("2d");
      isRetina ? (this.cachedBg.width = 2 * this.w, this.cachedBg.height = 2 * this.h, a.scale(2, 2)) : (this.cachedBg.width = this.w, this.cachedBg.height = this.h);
      var b = this.w,
        c = this.h,
        d = this.w / this.vBands,
        f = this.h / 6;
      a.fillStyle = "#0A0B0C";
      a.fillRect(0,
        0, b, c);
      isSmall || (a.fillStyle = this.grd, a.fillRect(0, 0, b, c));
      a.lineWidth = .5;
      a.strokeStyle = "rgba(255,255,255,0.1)";
      a.beginPath();
      for (b = 0; b < this.vBands; b++) a.moveTo(.5 + (d * b | 0), 0), a.lineTo(.5 + (d * b | 0), this.h);
      for (b = 0; 6 > b; b++) a.moveTo(0, .5 + (f * b | 0)), a.lineTo(this.w, .5 + (f * b | 0));
      a.stroke();
      this.cachedBgW = this.w;
      this.cachedBgH = this.h
    }
  }),
  Scroller2 = Class.create({
    initialize: function(a) {
      this.timeStamp = this.lastPos = this.amplitude = this.velocity = 0;
      this.trackParamName = "vOffset";
      this.setPositionName = "setOffset";
      this.setFunc =
        function(b) {
          a.dx = b;
          a.update()
        };
      this.maxPosName = "";
      this.maxPosFunc = function() {
        return 9999
      };
      this.target = a;
      this.ticker = null;
      this.scaleFactor = .3;
      this.timeConstant = 1E3 / fps;
      this.step = this.position = 0
    },
    velStart: function() {
      this.amplitude = this.velocity = 0;
      this.timeStamp = Date.now();
      clearInterval(this.ticker);
      this.target && (this.lastPos = this.target[this.trackParamName]);
      var a = this;
      this.ticker = setInterval(function() {
        a.velTrack()
      }, 1E3 / fps)
    },
    velTrack: function() {
      var a = Date.now(),
        b = a - this.timeStamp;
      this.timeStamp = a;
      a = this.target[this.trackParamName] - this.lastPos;
      this.lastPos = this.target[this.trackParamName];
      b = 1E3 * a / (1 + b);
      this.velocity = 0 == this.velocity ? b : .3 * b + .7 * this.velocity
    },
    velRelease: function() {
      Date.now() - this.timestamp < 1E3 / fps && this.velTrack();
      clearInterval(this.ticker);
      60 < Math.abs(this.velocity) && this.startScroll(this.velocity)
    },
    startScroll: function(a) {
      GLOBAL_STOP_SCROLL = !1;
      this.position = this.target[this.trackParamName];
      this.amplitude = a * this.scaleFactor;
      this.step = 0;
      var b = this;
      clearInterval(this.ticker);
      this.ticker = setInterval(function() {
        b.scrollTick()
      }, 1E3 / fps)
    },
    scrollTick: function() {
      GLOBAL_STOP_SCROLL && (clearInterval(this.ticker), GLOBAL_STOP_SCROLL = !1);
      var a = this.amplitude / this.timeConstant * 2;
      this.position += a;
      this.amplitude -= a;
      this.step += 1;
      .5 > Math.abs(a) && clearInterval(this.ticker);
      this.step > 3 * fps && clearInterval(this.ticker);
      a = this.maxPosFunc();
      if (0 >= this.position || this.position > this.maxPosFunc()) clearInterval(this.ticker), this.position = bound(this.position, 0, a);
      this.target[this.trackParamName] !=
        (this.position | 0) && this.setFunc(this.position | 0)
    },
    stop: function() {
      this.scrollStop()
    },
    scrollStop: function() {
      clearInterval(this.ticker)
    }
  }),
  GEQ_GRAPH = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "GEQ_GRAPH";
      this.needClip = !0;
      this.w = 600;
      this.h = 400;
      this.selected = 0;
      this.bands = 31;
      this.vBands = 16;
      this.right = !1;
      this.needMoveEvt = !0;
      this.bypass = !1;
      this.rtaTimer = this.rta = null;
      this.bgColor = "#111";
      this.bandWidth = 50;
      this.r = this.bandWidth / 2;
      this.rw = this.bands * this.bandWidth;
      this.maxdx =
        0;
      this.gain = 15;
      this.barColors = "#b93737 #bb3e39 #bd433a #bf473c #c24d3e #c4533f #c65a41 #c86043 #cb7c44 #cc8a44 #ce9944 #bca533 #bea735 #c1a837 #c3aa39 #c5ac3a #c8af3c #cab13e #ccb340 #cfb342 #d1b544 #51b350 #60b95f #6ec06d #3576b1 #3a79b3 #3f7db5 #4480b7 #4883b9 #4d87bb #528abd".split(" ");
      this.freqs = "20 25 32 40 50 63 80 100 125 160 200 250 315 400 500 630 800 1000 1.25k 1.6k 2k 2.5k 3.15k 4k 5k 6.3k 8k 10k 12.5k 16k 20k 22k".split(" ");
      this.idx = this.offsetX = 0;
      this.right = this.stereo = !1;
      this.scroller =
        new Scroller2(this);
      this.scroller.trackParamName = "offsetX";
      this.scroller.setFunc = this.setScroll.bind(this);
      this.peakGrab = !1;
      this.lastClickIdx = -1;
      this.moved = this.lastP = !1;
      this.lastClickPos = [-1, -1];
      this.clickPos = [-1, -1];
      this.haveFilters = !0;
      this.hpf_freq = .16274;
      this.lpf_freq = .9
    },
    setBandWidth: function(a) {
      this.bandWidth = a;
      this.r = this.bandWidth / 2;
      this.rw = this.bands * this.bandWidth;
      this.onResize();
      regUpdate(this)
    },
    setKey: function(a) {
      this.unRegAllKeys();
      this.key = a;
      this.regKey(a + "eq.bypass");
      this.regKey(a +
        "eq.enabled");
      this.haveFilters && (this.stereo ? (this.regKey(a + "eq.hpf"), this.regKey(a + "eq.lpf")) : (this.regKey(a + "eq.hpf.l"), this.regKey(a + "eq.hpf.r"), this.regKey(a + "eq.lpf.l"), this.regKey(a + "eq.lpf.r")));
      for (var b = 0; b < this.bands; b++) this.stereo ? this.regKey(a + "eq.peak." + b) : (this.regKey(a + "eq.peak.l." + b), this.regKey(a + "eq.peak.r." + b))
    },
    setLeft: function(a) {
      this.right = !a;
      regUpdate(this)
    },
    setRight: function(a) {
      this.right = a;
      regUpdate(this)
    },
    getState: function() {
      this.bypass = null != this.key ? getValue(this.key +
        "eq.bypass") : !1
    },
    getPeak: function(a) {
      return null == this.key ? .03 * a : getValue(this.key + (this.stereo ? this.right ? "eq.peak.r." : "eq.peak.l." : "eq.peak.") + a)
    },
    setPeak: function(a) {
      null != this.key && (a = bound(a, 0, 1), this.setPeakIdx(this.selected, a))
    },
    setPeakIdx: function(a, b) {
      null != this.key && (b = bound(b, 0, 1), getValue(this.key + "eq.linked") ? (setValue(this.key + "eq.peak.l." + a, b), setValue(this.key + "eq.peak.r." + a, b)) : setValue(this.key + (this.stereo ? this.right ? "eq.peak.r." : "eq.peak.l." : "eq.peak.") + a, b), regUpdate(this), this.onChange())
    },
    onChange: function() {},
    reset: function() {
      var a = this.key;
      setValue(a + "eq.enabled", 0);
      setValue(a + "eq.linked", 1);
      for (var b = 0; b < this.bands; b++) this.stereo ? (setValue(a + "eq.peak.l." + b, .5), setValue(a + "eq.peak.r." + b, .5)) : setValue(a + "eq.peak." + b, .5);
      regUpdate(this)
    },
    onDown: function(a, b, c) {
      if (!this.pressed) {
        this.pressed = !0;
        this.touchID = c;
        this.stY = b;
        this.peakGrab = this.moved = !1;
        a -= this.globalX();
        b -= this.globalY();
        this.clickPos = [a, b];
        c = (this.offsetX + a) / this.bandWidth | 0;
        var d = this.getPeak(c),
          d = this.h * (1 - d) | 0,
          f = this.rw *
          this.hpf_freq | 0,
          e = this.rw * this.lpf_freq | 0;
        this.haveFilters && isInRect(f - this.offsetX, 0, 2 * this.r, 2 * this.r, a, b) ? (this.peakGrab = !0, this.idx = -1, this.ddx = f - a) : this.haveFilters && isInRect(e - 2 * this.r - this.offsetX, 0, 2 * this.r, 2 * this.r, a, b) ? (this.peakGrab = !0, this.idx = -2, this.ddx = e - a) : b >= d - this.r && b <= d + this.r ? (this.peakGrab = !0, this.idx = this.selected = c, this.ddy = d - b, this.onSelect(c), regUpdate(this)) : (this.peakGrab = !1, this.ddx = this.offsetX + a, this.scroller && this.scroller.velStart())
      }
    },
    onMove: function(a, b, c) {
      this.touchID ==
        c && (a -= this.globalX(), c = b - this.globalY(), this.peakGrab ? this.haveFilters && -1 == this.idx ? (b = this.ddx + a, a = bound(b / this.rw, 0, .97), this.stereo && getValue(this.key + "eq.linked") ? (setValue(this.key + "eq.hpf.r", a), setValue(this.key + "eq.hpf.l", a)) : setValue(this.key + "eq.hpf" + (this.stereo ? this.right ? ".r" : ".l" : ""), a), regUpdate(this)) : this.haveFilters && -2 == this.idx ? (b = this.ddx + a, a = bound(b / this.rw, .03, 1), this.stereo && getValue(this.key + "eq.linked") ? (setValue(this.key + "eq.lpf.r", a), setValue(this.key + "eq.lpf.l", a)) : setValue(this.key +
          "eq.lpf" + (this.stereo ? this.right ? ".r" : ".l" : ""), a), regUpdate(this)) : (a = bound(1 - (this.ddy + c) / this.h, 0, 1), this.setPeak(a), 5 < Math.abs(b - this.stY) && (this.moved = !0)) : this.setScroll(this.ddx - a))
    },
    onUp: function(a) {
      if (this.touchID == a) {
        this.peakGrab || this.scroller && this.scroller.velRelease();
        this.delta = [0, 0];
        a = Date.now();
        var b = Math.abs(this.lastClickPos[0] - this.clickPos[0]),
          c = Math.abs(this.lastClickPos[1] - this.clickPos[1]);
        a - this.lastClickTime < DBL_CLK_TIME && 30 > b && 30 > c && this.lastClickIdx == this.idx && this.lastP ==
          !this.peakGrab && (this.peakGrab ? (this.setPeak(.5), this.onChange()) : setMode(E_MODE.MIX));
        this.moved || (this.lastClickTime = a);
        this.lastClickPos = this.clickPos;
        this.lastClickIdx = this.idx;
        this.lastP = !this.peakGrab;
        this.pressed = !1;
        this.touchID = -1
      }
    },
    onDouble: function() {
      this.peakGrab ? this.setPeak(.5) : modeBack()
    },
    onWheel: function(a, b, c) {
      b -= this.globalX();
      this.globalY();
      b = (this.offsetX + b) / this.bandWidth | 0;
      c = this.getPeak(b);
      c = bound(c + a / 120 / 30, 0, 1);
      this.setPeakIdx(b, c)
    },
    onSelect: function(a) {},
    setScroll: function(a) {
      a =
        bound(a, 0, this.maxdx);
      this.offsetX != a && (this.offsetX = a, regUpdate(this))
    },
    setRTA: function(a) {
      this.rta = a;
      regUpdate(this);
      var b = this;
      clearTimeout(this.rtaTimer);
      this.rtaTimer = setTimeout(function() {
        b.rta && (b.rta = null, regUpdate(b))
      }, 200)
    },
    calcGeometry: function() {
      1500 < this.w ? this.setBandWidth(this.w / this.bands) : this.setBandWidth(50)
    },
    onResize: function() {
      var a = this.rw - this.w;
      0 > a && (a = 0);
      this.maxdx = a;
      this.offsetX > a && this.setScroll(a);
      this.grd = ctx.createLinearGradient(0, 0, 0, this.h);
      this.grd.addColorStop(0,
        "rgba(255,255,255,0.0)");
      this.grd.addColorStop(.1, "rgba(255,255,255,0.0)");
      this.grd.addColorStop(.5, "rgba(255,255,255,0.25)");
      this.grd.addColorStop(.9, "rgba(255,255,255,0.0)");
      this.grd.addColorStop(1, "rgba(255,255,255,0.0)")
    },
    prePaint: function() {
      if (this.visible) {
        ctx.save();
        ctx.translate(this.x, this.y);
        this.enabled || (ctx.globalAlpha = .3);
        ctx.font = "11px open_sans_condensedbold";
        ctx.textAlign = "center";
        ctx.fillStyle = "#aaa";
        var a = {
            shadow: ["#000", 0, 1, 1]
          },
          b = this.h,
          c = b / 2 | 0;
        ctx.textAlign = "right";
        ctx.drawText("+15", -5, 9, a);
        ctx.drawText("0 ", -5, c + 3, a);
        ctx.drawText("-15", -5, b - 1, a);
        ctx.restore()
      }
    },
    paintBg: function() {},
    paint: function() {
      var a = this.w,
        b = this.h,
        c = this.bypass = getValue(this.key + "eq.bypass");
      if (this.afsEnabled = 1 == getValue("afs.enabled")) this.afsEnabled = 0 != selectedStrip.getNameValue("afs.enabled");
      ctx.fillStyle = "#101115";
      ctx.fillRect(this.offsetX, 0, this.w, b);
      null != this.rta && this.drawRTA();
      this.afsEnabled && this.drawAFS();
      ctx.fillStyle = this.grd;
      ctx.fillRect(0, 0, this.rw, b);
      var d = b / 2 | 0;
      if (this.haveFilters) {
        this.hpf_freq =
          getValue(this.key + "eq.hpf" + (this.stereo ? this.right ? ".r" : ".l" : ""));
        this.lpf_freq = getValue(this.key + "eq.lpf" + (this.stereo ? this.right ? ".r" : ".l" : ""));
        var f = this.hpf_freq * this.rw,
          e = this.lpf_freq * this.rw;
        ctx.fillStyle = "rgba(255,255,255,0.07)";
        var g = this.rw / 12.5,
          h = this.rw / 10,
          l = this.rw / 20;
        0 < this.hpf_freq && (ctx.beginPath(), ctx.moveTo(-g, d), ctx.lineTo(-g, b), ctx.lineTo(f - g, b), ctx.quadraticCurveTo(f - l, d, f + h, d), ctx.lineWidth = 1, ctx.strokeStyle = "rgba(255,255,255,0.1)", ctx.stroke(), ctx.closePath(), ctx.fill());
        1 >
          this.lpf_freq && (ctx.beginPath(), ctx.moveTo(this.rw + g, d), ctx.lineTo(this.rw + g, b), ctx.lineTo(e + g, b), ctx.quadraticCurveTo(e + l, d, e - h, d), ctx.lineWidth = 1, ctx.strokeStyle = "rgba(255,255,255,0.1)", ctx.stroke(), ctx.closePath(), ctx.fill())
      }
      ctx.strokeStyle = "rgba(0,0,0,0.2)";
      ctx.lineWidth = 1;
      for (f = 0; f < this.bands; f++) e = f * this.bandWidth, e > this.offsetX + a || e < this.offsetX - this.bandWidth || (h = c ? "#aaaaaa" : this.barColors[f], f % 2 && (ctx.fillStyle = "rgba(255,255,255,0.01)", ctx.fillRect(e, 0, this.bandWidth, b)), this.selected ==
        f && (ctx.fillStyle = hexToRGBA(h, .07), ctx.fillRect(e, 0, this.bandWidth, b)), g = this.getPeak(f), l = -d * (g - .5) * 2, ctx.fillStyle = hexToRGBA(h, c ? .35 : .66), ctx.fillRect(e, d, this.bandWidth, l), ctx.fillStyle = hexToRGBA(h, .38), ctx.fillRect(e, d + l - this.r, 2 * this.r, 2 * this.r), ctx.strokeRect(e + .5, d + l - this.r + .5, 2 * this.r - 1, 2 * this.r), ctx.drawText(this.freqs[f] + "hz", e + this.r, (1 - g) * b + 13 | 0, {
          color: "#090909",
          shadow: ["rgba(255,255,255,0.2)", 0, 1, 1],
          align: "center",
          valign: "middle",
          font: "14px open_sans_condensedbold"
        }), h = precision(VtoLINRANGE(g, -this.gain, this.gain), 1), h = (0 < h ? "+" : "") + h + lang.DB, ctx.drawText(h, e + this.r, (1 - g) * b - 12 | 0, {
          color: "#090909",
          shadow: ["rgba(255,255,255,0.2)", 0, 1, 1]
        }));
      this.haveFilters && (f = this.hpf_freq * this.rw, e = this.lpf_freq * this.rw, this.drawRect(f + this.r, this.r, "#405C66", 0 < this.hpf_freq ? formatFreq(VtoFREQ20(this.hpf_freq)) + "hz" : "OFF", "HPF"), this.drawRect(e - this.r, this.r, "#7A6346", 1 > this.lpf_freq ? formatFreq(VtoFREQ20(this.lpf_freq)) + "hz" : "OFF", "LPF"));
      ctx.lineWidth = 1;
      ctx.strokeStyle = "#333";
      ctx.drawLine(this.offsetX,
        d, this.offsetX + a, d);
      1 < this.maxdx && (ctx.fillStyle = "rgba(0,0,0,0.15)", ctx.fillRect(this.offsetX, b - 12, a, 12), ctx.fillStyle = "rgba(255,255,255,0.15)", g = a / this.rw * a, ctx.fillRect(this.offsetX + 2 + this.offsetX / this.maxdx * (a - 4 - g), b - 12 + 1, g, 9));
      ctx.strokeStyle = "#333";
      ctx.strokeRect(this.offsetX + .5, .5, a - 1, b - 1)
    },
    drawRect: function(a, b, c, d, f) {
      ctx.fillStyle = c;
      ctx.strokeStyle = "rgba(0,0,0,0.2)";
      ctx.lineWidth = 1;
      ctx.fillRect(a - this.r, b - this.r, 2 * this.r, 2 * this.r);
      ctx.strokeRect(a + .5 - this.r, b - this.r + .5, 2 * this.r - 1, 2 * this.r);
      ctx.drawText(d, a, b - 12 | 0, {
        color: "#090909",
        shadow: ["rgba(255,255,255,0.2)", 0, 1, 1],
        align: "center",
        valign: "middle",
        font: "14px open_sans_condensedbold"
      });
      ctx.drawText(f, a, b + 13 | 0, {
        color: "#090909",
        shadow: ["rgba(255,255,255,0.2)", 0, 1, 1]
      })
    },
    freqToX: function(a) {
      return FREQtoX(a, this.rw)
    },
    drawAFS: function() {
      var a = this.bandWidth,
        b = this.h / 2 + 1 | 0;
      ctx.lineWidth = 2;
      for (var c = this.parent.keyPrefixAfs + "afs.eq.", d = 0; 12 > d; d++) {
        var f = getValue(c + d),
          e = JSON.parse("[" + f + "]"),
          f = e[3];
        if (2 != f) {
          var g = e[0],
            e = bound(e[2], -15, 0);
          0 !=
            e && (g = FREQtoX(g, this.rw), e = b - e / 15 * b, e = bound(e, b, this.h), ctx.strokeStyle = 2 == f ? color.afsGraphPeakLive : color.afsGraphPeakFixed, ctx.beginPath(), ctx.moveTo(g - a / 2, b), ctx.quadraticCurveTo(g, b, g, e), ctx.quadraticCurveTo(g, b, g + a / 2, b), ctx.lineTo(g + a / 2, b), ctx.stroke())
        }
      }
      for (d = 0; 12 > d; d++) f = getValue(c + d), e = JSON.parse("[" + f + "]"), f = e[3], 2 == f && (g = e[0], e = bound(e[2], -15, 0), 0 != e && (g = FREQtoX(g, this.rw), e = b - e / 15 * b, e = bound(e, b, this.h), ctx.strokeStyle = 2 == f ? color.afsGraphPeakLive : color.afsGraphPeakFixed, ctx.beginPath(), ctx.moveTo(g -
        a / 2, b), ctx.quadraticCurveTo(g, b, g, e), ctx.quadraticCurveTo(g, b, g + a / 2, b), ctx.lineTo(g + a / 2, b), ctx.stroke()))
    },
    drawRTA: function() {
      var a = this.rw,
        b = this.h - 2,
        c = this.rta,
        d = this.freqToX(20.6),
        f = this.freqToX(22350.6) / (c.length - 1);
      ctx.lineCap = "butt";
      ctx.lineWidth = 1;
      ctx.strokeStyle = "rgba(255,255,255,0.15)";
      ctx.fillStyle = "rgba(255,255,255,0.1)";
      ctx.beginPath();
      var e = c[0];
      ctx.moveTo(0, b * (1 - e) | 0);
      for (var g = 0; g < c.length; g++) {
        e = c[g];
        e = b * (1 - e) | 0;
        ctx.lineTo(d, e);
        if (d >= a) break;
        d += f
      }
      ctx.lineTo(a, b);
      ctx.lineTo(0, b);
      ctx.closePath();
      ctx.fill()
    }
  }),
  GEQ_SMALL = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "EQ-PARAM-WIDGET";
      this.bands = 31;
      this.master = !1;
      this.left = !0;
      this.barColors = "#b93737 #bb3e39 #bd433a #bf473c #c24d3e #c4533f #c65a41 #c86043 #cb7c44 #cc8a44 #ce9944 #bca533 #bea735 #c1a837 #c3aa39 #c5ac3a #c8af3c #cab13e #ccb340 #cfb342 #d1b544 #51b350 #60b95f #6ec06d #3576b1 #3a79b3 #3f7db5 #4480b7 #4883b9 #4d87bb #528abd".split(" ");
      this.w = 248;
      this.h = 46;
      this.afsEnabled = !1
    },
    getPeak: function(a) {
      return this.master ?
        getValue("m.eq.peak" + (this.left ? ".l" : ".r") + "." + a) : getValue(this.parent.keyPrefix + a)
    },
    paint: function() {
      if (this.afsEnabled = 1 == getValue("afs.enabled")) this.afsEnabled = 0 != selectedStrip.getNameValue("afs.enabled");
      this.bypass = this.master ? toBool(getValue("m.eq.bypass")) : toBool(selectedStrip.getNameValue("eq.bypass"));
      ctx.fillStyle = "#101115";
      ctx.fillRect(0, 0, this.w, this.h);
      ctx.lineWidth = .5;
      ctx.strokeStyle = "rgba(255,255,255,0.1)";
      ctx.beginPath();
      for (var a = this.w / this.bands | 0, b = this.h / 2 | 0, c = 0; c < this.bands; c++) 0 !=
        c && (ctx.moveTo(a * c | 0, 0), ctx.lineTo(a * c | 0, this.h));
      ctx.stroke();
      if (this.afsEnabled)
        for (c = 0; 12 > c; c++) {
          var d = getValue(selectedStrip.name + "afs.eq." + c),
            f = JSON.parse("[" + d + "]"),
            e = f[0],
            d = bound(f[2], -15, 0),
            f = f[3];
          0 != d && (e = FREQtoX(e, this.w), e = bound(e, 1, this.w - 1), d = b - d / 15 * b, d = bound(d, b, this.h - 1), 0 > e || e > this.w || (ctx.fillStyle = 2 == f ? color.afsGraphPeakLive : color.afsGraphPeakFixed, ctx.fillRect(e - 1, d - 1, 2, 2)))
        }
      ctx.globalAlpha = .4;
      for (c = 0; c < this.bands; c++) ctx.fillStyle = this.barColors[c + (this.bankB ? 15 : 0)], this.bypass ?
        (ctx.fillStyle = "rgba(255,255,255,0.4)", ctx.strokeStyle = "rgba(255,255,255,0.3)") : ctx.strokeStyle = ctx.fillStyle = this.barColors[c + (this.bankB ? 15 : 0)], d = 2 * (-1 * this.getPeak(c) + .5) * b | 0, ctx.fillRect(a * c, b, a, d);
      ctx.globalAlpha = 1;
      ctx.fillStyle = "#666";
      ctx.fillRect(0, b, this.w, 1);
      ctx.fillStyle = "rgba(255,255,255,0.1)";
      ctx.lineWidth = 1;
      ctx.strokeStyle = "#333";
      ctx.strokeRect(.5, .5, this.w - 1, this.h - 1)
    }
  });
afsPopup = null;
var AFS_POPUP = Class.create(Widget, {
    initialize: function($super, b, c) {
      $super(b);
      this.widgetName = "AFS_POPUP";
      this.title = lang.PRESETS;
      this.color = "#eee";
      this.bg = "#31323A";
      this.borderColor = "#676869";
      this.rh = 150;
      this.rw = 570;
      this.bx = 70;
      this.by = 10;
      this.bw = 420;
      this.bh = 200;
      this.target = c;
      this.initWidgets();
      this.updateGeometry();
      afsPopup = this;
      mWidgets.push(widgets.pop())
    },
    initWidgets: function() {
      var a = this;
      this.AFS_SETTINGS = new Button(this);
      this.AFS_SETTINGS.setImages(res.SETUP_ON, res.SETUP_OFF);
      this.AFS_SETTINGS.onPress =
        function() {
          a.close()
        };
      this.AFS_SETTINGS.setAnchors(80, null, null, 3);
      this.AFS_OFF = new CheckBox(this);
      this.AFS_OFF.setImages(res.OFF_OFF, res.ON_ON);
      this.AFS_OFF.setKey(selectedStrip.name + "afs.enabled");
      this.AFS_OFF.getState = function() {
        this.disabled = 0 == getValue("afs.enabled")
      };
      this.AFS_OFF.setAnchors(162, null, null, 3);
      this.bAFS = new CheckBox(this);
      this.bAFS.setAnchors(510, null, null, 3);
      this.bAFS.setImages(res.AFSON_OFF, res.AFSON_ON);
      this.bAFS.setKey("afs.enabled");
      this.bAFS.onToggle = function() {
        regUpdate(editWidget)
      };
      this.SL1 = new EQHSlider2(this);
      this.SL1.setAnchors(20, null, null, 50);
      this.SL1.bg = this.bg;
      this.SL1.w = 320;
      this.SL1.setDefaultValue(.5);
      this.SL1.setKey(selectedStrip.name + "afs.sensitivity");
      this.led1 = new FXLEDPlain(this);
      this.led1.setAnchors(276, null, null, 104);
      this.led1.h = 24;
      this.led1.label = "";
      this.led1.oneLine = !0;
      this.led1.bgColor = this.bg;
      this.led1.sign = "dB";
      this.led1.setKey(selectedStrip.name + "afs.sensitivity");
      this.led1.formatValue = function(a) {
        return precision(VtoLINRANGE(a, -6, 6), 1)
      };
      this.FMODE = new SWITCHBOX(this);
      this.FMODE.setItems([lang.FIXED, lang.LIVE, lang.LOCK]);
      this.FMODE.setItemWidth(65);
      this.FMODE.setAnchors(360, null, null, 69);
      this.FMODE.getState = function() {
        var a = selectedStrip.name;
        this.state = 0 == (getValue(a + "afs.logic") | 0) ? 2 : 0 == (getValue(a + "afs.fmode") | 0) ? 0 : 1
      };
      this.FMODE.valueFunc = function() {
        var a = selectedStrip.name;
        setValue(a + "afs.logic", 2 == this.state ? 0 : 1);
        2 > this.state && setValue(a + "afs.fmode", this.state)
      };
      this.AFS_CLEAR_FIXED = new SButton(this);
      this.AFS_CLEAR_FIXED.text = lang.CLEAR_FIXED;
      this.AFS_CLEAR_FIXED.onPress =
        function() {
          setValue(selectedStrip.name + "afs.clearfixed", 1);
          setTimeout(function() {
            setValue(selectedStrip.name + "afs.clearfixed", 0)
          }, 500)
        };
      this.AFS_CLEAR_ALL = new SButton(this);
      this.AFS_CLEAR_ALL.text = lang.CLEAR_ALL;
      this.AFS_CLEAR_ALL.onPress = function() {
        setValue(selectedStrip.name + "afs.clearall", 1);
        setTimeout(function() {
          setValue(selectedStrip.name + "afs.clearall", 0)
        }, 500)
      };
      this.AFS_PRESETS = new SButton(this);
      this.AFS_PRESETS.text = lang.PRESETS;
      this.AFS_PRESETS.onPress = function() {
        if (selectedStrip.type == E_STRIP_TYPE.AUX &&
          isBlocked("auxproc", selectedStrip.subId)) showPopupMsg(lang.LOCKED, 1E3);
        else if (selectedStrip.type == E_STRIP_TYPE.MASTER && isBlocked("mproc")) showPopupMsg(lang.LOCKED, 1E3);
        else {
          clearModals();
          sendMessage("AFSUPDATEVAR");
          var a = new PRESET_MENU2(null, "afs", {
            savePreset: function() {
              var a = selectedStrip.subId + 1;
              selectedStrip.type == E_STRIP_TYPE.AUX && a++;
              a = {
                afs: getValue("var.afsdata").split("/")[a]
              };
              a.sens = selectedStrip.getNameValue("afs.sensitivity");
              a.mode = selectedStrip.getNameValue("afs.fmode");
              a.logic = selectedStrip.getNameValue("afs.logic");
              return a
            },
            loadPreset: function(a) {
              var b = selectedStrip.subId + 1;
              selectedStrip.type == E_STRIP_TYPE.AUX && b++;
              var c = a.afs;
              c && (sendMessage("AFSLOADCHAN^" + b + "^" + c), selectedStrip.setNameValue("afs.sensitivity", a.sens), selectedStrip.setNameValue("afs.logic", a.logic), selectedStrip.setNameValue("afs.fmode", a.mode), regUpdate(this), drawAll())
            }
          }, "#888");
          a.center = !0;
          a.updateGeometry();
          regUpdate(a)
        }
      };
      this.AFS_CLEAR_LIVE = new SButton(this);
      this.AFS_CLEAR_LIVE.text = lang.CLEAR_LIVE;
      this.AFS_CLEAR_LIVE.onPress = function() {
        setValue(selectedStrip.name +
          "afs.clearlive", 1);
        setTimeout(function() {
          setValue(selectedStrip.name + "afs.clearlive", 0)
        }, 500)
      }
    },
    onDown: function(a, b) {
      var c = a - this.globalX(),
        d = b - this.globalY();
      isInRect(0, this.h - this.rh, this.rw, this.rh, c, d) || isInRect(this.bx, this.by, this.bw, this.bh, c, d) || this.close()
    },
    close: function() {
      this.enabled = !1;
      clearModals()
    },
    onDelete: function() {
      afsPopup = null
    },
    calcGeometry: function() {
      this.AFS_CLEAR_FIXED.setPos(100, 164);
      this.AFS_CLEAR_ALL.setPos(235, 164);
      this.AFS_PRESETS.setPos(235, 116);
      this.AFS_CLEAR_LIVE.setPos(370,
        164);
      this.grd = ctx.createLinearGradient(0, this.h - this.rh, 0, this.h);
      this.grd.addColorStop(0, "rgba(255,255,255,0.2)");
      this.grd.addColorStop(.1, "rgba(255,255,255,0.0)");
      this.grd.addColorStop(1, "rgba(255,255,255,0.0)")
    },
    paint: function() {
      ctx.fillStyle = this.bg;
      ctx.strokeStyle = this.borderColor;
      ctx.lineWidth = 2;
      ctx.roundRect(0, this.h - this.rh, this.rw, this.rh, 14);
      ctx.fill();
      ctx.fillStyle = this.grd;
      ctx.fill();
      drawImage(res.AFS2LOGO, 30, this.h - 35);
      ctx.fillStyle = "rgba(255,255,255,0.1)";
      ctx.fillRoundRect(16, this.h -
        42, this.AFS_OFF.x + this.AFS_OFF.w + 12 - 16, 40, 4);
      0 == this.FMODE.state && (ctx.font = "12px open_sans_condensedbold", ctx.fillStyle = color.white, ctx.textAlign = "left", drawText(lang.AFS_FIXED_INFO, 260, this.h - 34, {
        dy: 14
      }));
      ctx.font = "15pt open_sans_condensedbold";
      ctx.textAlign = "center";
      ctx.fillStyle = color.white;
      ctx.fillText(lang.SENSITIVITY, 180, this.h - 110);
      ctx.fillText(lang.MODE, 457, this.h - 110);
      ctx.setShadow(null);
      ctx.fillStyle = "#161718";
      ctx.roundRect(70, 10, 420, 200, 14);
      ctx.fill();
      ctx.stroke();
      ctx.fillStyle = "#7F81FF";
      ctx.fillText(lang.FIXED, this.AFS_CLEAR_FIXED.x + 44, 40);
      ctx.fillStyle = color.afsLive;
      ctx.fillText(lang.LIVE, this.AFS_CLEAR_LIVE.x + 45, 40);
      var a = -16;
      drawImage(res.AFS2LOGO, this.AFS_CLEAR_ALL.x + 30, 40 + a);
      ctx.font = "14pt open_sans_condensedbold";
      ctx.fillStyle = "#D8D8D8";
      ctx.fillText(lang.FILTER, this.AFS_CLEAR_ALL.x + 45, 40 + a + 47);
      ctx.fillText(lang.DISPLAY, this.AFS_CLEAR_ALL.x + 45, 40 + a + 47 + 24);
      ctx.font = "12pt open_sans_condensedbold";
      for (var b = selectedStrip.name + "afs.eq.", c = 64, d = c, f = 0; 12 > f; f++) {
        var e = getValue(b + f),
          a = JSON.parse("[" + e + "]"),
          e = a[3],
          g = a[0] + .1 | 0,
          h = a[1],
          l = bound(a[2], -24, 0);
        if (!(0 == e || .001 > Math.abs(l))) {
          l = (10 * l | 0) / 10 + "";
          0 > l.indexOf(".") && (l += ".0");
          var h = h | 0,
            m = 1 == e ? this.AFS_CLEAR_FIXED.x + 24 : this.AFS_CLEAR_LIVE.x + 24;
          ctx.textAlign = "right";
          ctx.fillStyle = 1 == e ? "#7F81FF" : color.afsLive;
          a = 1 == e ? c : d;
          ctx.fillText(g + "", m, a);
          ctx.fillText(l + "dB", m + 80, a);
          ctx.globalAlpha = .6;
          ctx.textAlign = "center";
          ctx.fillText("q" + h, m + 20, a);
          ctx.globalAlpha = 1;
          1 == e ? c += 17 : d += 17
        }
      }
    }
  }),
  EQSlider = Class.create(Widget, {
    initialize: function($super,
      b) {
      $super(b);
      this.widgetName = "EQ_SLIDER";
      this.needMoveEvt = !0;
      this.lastClickTime = 0;
      this.background = color.eqBg;
      this.w = 50;
      this.h = 260;
      this.minValue = 0;
      this.maxValue = 1;
      this.oldValue = this.value = 0;
      this.defaultValue = -1;
      this.fader = res.eqVFaderGray;
      this.faderCenterY = 14;
      this.faderH = this.fader.h() - this.faderCenterY;
      this.faderW = this.fader.w();
      this.faderX = 10;
      this.fadd = 20;
      this.textBot = this.textUp = "";
      this.bigMark = -1;
      this.keyPart = null;
      this.dbMarks = this.slide = !1;
      this.mV = [1, .9, .8, .7, .6, .5, .4, .3, .2, .1, 0];
      this.smV = [];
      this.moved = !1;
      this.aclr = "#fff";
      this.disabled = this.rightArrow = this.leftArrow = !1
    },
    contains: function(a, b, c) {
      if (!this.enabled || !this.visible) return !1;
      if (c) return this.x <= a && this.x + this.w > a && this.y <= b && this.y + this.h > b;
      c = this.x;
      var d = this.y + (this.h - this.faderH) * (1 - this.getVal()),
        d = d | 0;
      return c <= a && c + this.w > a && d - 10 <= b && d + this.faderH + 10 > b
    },
    setFader: function(a, b) {
      this.fader = a;
      this.faderCenterY = b;
      this.faderH = this.fader.h() - this.faderCenterY;
      this.faderW = this.fader.w()
    },
    setDefaultValue: function(a, b) {
      isDefined(b) ||
        (b = !0);
      null != a && 0 <= a ? (this.defaultValue = bound(a, 0, 1), this.bigMark = b ? this.defaultValue : -1) : this.bigMark = this.defaultValue = -1
    },
    setValue: function(a) {
      a = bound(a, 0, 1);
      this.setVal(a);
      this.valueFunc(a);
      regUpdate(this)
    },
    onDown: function(a, b) {
      if (!this.disabled) {
        this.pressPoint = [a, b];
        this.moved = !1;
        var c = this.globalX() + 10,
          d = this.globalY() + (this.h - this.faderH) * (1 - this.getVal()),
          d = d | 0;
        if (this.slide = c - 10 <= a && c + this.faderW + 10 >= a && d - 10 <= b && d + this.faderH + 10 >= b) this.oldValue = this.getVal(), this.onFocus()
      }
    },
    onMove: function(a,
      b) {
      if (this.slide) {
        var c = b - this.pressPoint[1];
        5 < Math.abs(c) && (this.moved = !0);
        c = bound(this.oldValue - c / (this.h - this.faderH), this.minValue, this.maxValue);
        this.innerSet(c)
      }
    },
    innerSet: function(a) {
      this.setVal(a);
      this.onValueChange(a);
      this.valueFunc(a);
      regUpdate(this)
    },
    onUp: function() {
      this.oldValue = 0;
      this.pressPoint = [-1, -1];
      this.slide = !1;
      var a = Date.now();
      if (a - this.lastClickTime < DBL_CLK_TIME) this.onDouble();
      this.moved || (this.lastClickTime = a)
    },
    onWheel: function(a) {
      if (!this.disabled) {
        var b = this.getVal(),
          b = bound(b +
            a / 120 / 30, 0, 1);
        this.setVal(b);
        this.onValueChange();
        this.valueFunc(b);
        regUpdate(this.parent)
      }
    },
    onDouble: function() {
      0 > this.defaultValue || (this.setVal(this.defaultValue), this.onValueChange(), this.valueFunc(this.defaultValue), regUpdate(this.parent))
    },
    onValueChange: function() {},
    onFocus: function() {},
    valueFunc: function(a) {},
    getState: function() {},
    paint: function() {
      this.getState();
      ctx.fillStyle = this.background;
      ctx.fillRect(0, 0, this.w, this.h + 10);
      this.disabled && (ctx.globalAlpha = .15);
      ctx.beginPath();
      ctx.lineWidth =
        5;
      ctx.lineCap = "round";
      var a = this.w / 2 | 0;
      this.disabled || (ctx.strokeStyle = "rgba(255,255,255,0.5)", ctx.beginPath(), ctx.moveTo(a + .5, 4.6), ctx.lineTo(a + .5, this.h - 8 + .5), ctx.stroke());
      ctx.strokeStyle = color.black;
      ctx.beginPath();
      ctx.moveTo(a, 4);
      ctx.lineTo(a, this.h - 8);
      ctx.stroke();
      this.drawMarks();
      a = (this.h - this.faderH) * (1 - this.getVal());
      drawImage(this.fader, this.faderX, a | 0);
      a = a + 20 + this.faderCenterY;
      this.rightArrow && (ctx.fillStyle = this.aclr, ctx.fillTriangle2(this.w, a - 10, this.w - 8, a, this.w, a + 10));
      this.leftArrow &&
        (ctx.fillStyle = this.aclr, ctx.fillTriangle2(0, a - 10, 8, a, 0, a + 10))
    },
    drawMarks: function() {
      var a = this.h - this.faderH,
        b = this.fadd + this.faderCenterY,
        c = this.w / 2;
      if (this.dbMarks) {
        for (var c = [1, .8945, .634, .52941, .3752, .18, .0567, 0], d = 0; d < c.length; d++) {
          var f = a * (1 - c[d]) + b,
            f = f | 0;
          ctx.fillStyle = "rgba(0,0,0,0.6)";
          ctx.fillRect(0, f, 18, 1);
          ctx.fillRect(32, f, 18, 1);
          ctx.fillStyle = "rgba(255,255,255,0.2)";
          ctx.fillRect(0, f + 1, 18, 1);
          ctx.fillRect(32, f + 1, 18, 1)
        }
        f = a * (1 - zeroDbPos) + b;
        ctx.fillStyle = "#939394";
        ctx.fillRect(0, f, 18, 3);
        ctx.fillRect(32,
          f, 18, 3)
      } else {
        for (d = 0; d < this.mV.length; d++) f = a * (1 - this.mV[d]) + b, f |= 0, ctx.fillStyle = "rgba(0,0,0,0.6)", ctx.fillRect(c + 6, f, 18, 1), ctx.fillRect(c - 6, f, -18, 1), ctx.fillStyle = "rgba(255,255,255,0.2)", ctx.fillRect(c - 6, f + 1, -18, 1), ctx.fillRect(c + 6, f + 1, 18, 1);
        for (d = 0; d < this.smV.length; d++) f = a * (1 - this.smV[d]) + b, f |= 0, ctx.fillStyle = "rgba(0,0,0,0.6)", ctx.fillRect(6, f, 12, 1), ctx.fillRect(32, f, 12, 1), ctx.fillStyle = "rgba(255,255,255,0.2)", ctx.fillRect(6, f + 1, 12, 1), ctx.fillRect(32, f + 1, 12, 1);
        0 < this.bigMark && (f = a * (1 - this.bigMark) +
          b, f |= 0, ctx.fillStyle = "rgba(255,255,255,0.2)", ctx.fillRect(0, f, 18, 3), ctx.fillRect(32, f, 18, 3))
      }
      ctx.font = font.eqSlText;
      ctx.textAlign = "center";
      0 < this.textUp.length && (ctx.fillStyle = this.background, ctx.fillRect(0, -35, this.w, 20), ctx.fillStyle = "#000", ctx.fillText(this.textUp, this.w / 2 + 1, -19), ctx.fillStyle = color.tabText, ctx.fillText(this.textUp, this.w / 2, -20));
      if (0 < this.textBot.length)
        for (a = this.textBot.split(" "), d = 0; d < a.length; d++) ctx.fillStyle = this.background, ctx.fillRect(-4, this.h + 8 + 16 * d, this.w + 8, 16), ctx.fillStyle =
          "#000", ctx.fillText(a[d], this.w / 2 + 1, this.h + 23 + 16 * d + 1, this.w + 6), ctx.fillStyle = color.tabText, ctx.fillText(a[d], this.w / 2, this.h + 23 + 16 * d, this.w + 6)
    }
  }),
  EQHSlider2 = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "EQHSlider2";
      this.needMoveEvt = !0;
      this.lastClickTime = 0;
      this.w = 300;
      this.h = 56;
      this.laneY = 25;
      this.faderY = 9;
      this.defaultValue = this.oldValue = this.value = 0;
      this.fader = res.eqHFaderGray;
      this.faderW = this.fader.w();
      this.faderH = this.fader.h();
      this.faderCX = 36;
      this.keyPart = null;
      this.bg =
        color.eqBg;
      this.haveMarks = this.disableWheel = !1;
      this.marksArr = [0, .25, .5, .75, 1]
    },
    setDefaultValue: function(a) {
      this.defaultValue = bound(a, 0, 1)
    },
    setValue: function(a) {
      this.setVal(bound(a, 0, 1));
      regUpdate(this)
    },
    innerSet: function(a) {
      this.setVal(a);
      this.value = a;
      this.onValueChange();
      this.valueFunc(a);
      regUpdate(this)
    },
    onDown: function(a, b) {
      this.pressPoint = [a, b];
      var c = this.globalX() + (this.w - this.faderW) * this.getVal(),
        d = this.globalY() + 9,
        c = c | 0;
      if (this.slide = c - 10 <= a && c + this.faderW + 10 >= a && d - 10 <= b && d + this.faderH + 10 >=
        b) this.oldValue = this.getVal(), this.onFocus()
    },
    onMove: function(a, b) {
      if (this.slide) {
        var c = bound(this.oldValue + (a - this.pressPoint[0]) / (this.w - this.faderW), 0, 1);
        this.innerSet(c)
      }
    },
    onUp: function() {
      this.oldValue = this.value;
      this.pressPoint = [-1, -1];
      this.slide = !1;
      if (!(0 > this.defaultValue)) {
        var a = Date.now();
        a - this.lastClickTime < DBL_CLK_TIME && (this.setVal(this.defaultValue), this.onValueChange(), this.valueFunc(), regUpdate(this.parent));
        this.lastClickTime = a
      }
    },
    onWheel: function(a) {
      if (!this.disableWheel) {
        var b = this.getVal(),
          b = bound(b + a / 120 / 30, 0, 1);
        this.setVal(b);
        this.onValueChange();
        this.valueFunc(b);
        regUpdate(this.parent)
      }
    },
    onValueChange: function() {},
    onFocus: function() {},
    valueFunc: function() {},
    getState: function() {
      this.value = this.getVal()
    },
    paint: function() {
      this.getState();
      ctx.fillStyle = this.bg;
      ctx.fillRect(0, 0, this.w, this.h);
      if (this.haveMarks) {
        ctx.lineWidth = 1;
        ctx.strokeStyle = "rgba(0,0,0,0.35)";
        ctx.beginPath();
        for (var a = 0; a < this.marksArr.length; a++) {
          var b = this.faderCX + (this.w - this.faderW) * this.marksArr[a] | 0;
          ctx.moveTo(b +
            .5, 3);
          ctx.lineTo(b + .5, 12);
          ctx.moveTo(b + .5, this.h - 3 - 9);
          ctx.lineTo(b + .5, this.h - 3)
        }
        ctx.stroke();
        ctx.beginPath();
        ctx.strokeStyle = "rgba(255,255,255,0.25)";
        for (a = 0; a < this.marksArr.length; a++) b = this.faderCX + (this.w - this.faderW) * this.marksArr[a] | 0, ctx.moveTo(b - .5, 3), ctx.lineTo(b - .5, 12), ctx.moveTo(b - .5, this.h - 3 - 9), ctx.lineTo(b - .5, this.h - 3);
        ctx.stroke()
      }
      ctx.lineWidth = 5;
      ctx.lineCap = "round";
      a = this.w - 4;
      this.disabled || (ctx.strokeStyle = "#AAA", ctx.beginPath(), ctx.moveTo(4.5, this.laneY + .5), ctx.lineTo(a + .5, this.laneY +
        .5), ctx.stroke());
      ctx.strokeStyle = color.black;
      ctx.beginPath();
      ctx.moveTo(4, this.laneY);
      ctx.lineTo(a, this.laneY);
      ctx.stroke();
      drawImage(this.fader, (this.w - this.faderW) * this.value | 0, this.faderY)
    }
  }),
  EQButton = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "TabButton";
      this.w = 70;
      this.h = 30;
      this.mode = this.state = 0;
      this.color = color.purple;
      this.img1 = this.img0 = this.text = null;
      this.needBG = !0;
      this.invertedValue = this.longClickMark = !1;
      this.holdTimer = null
    },
    setImages: function(a, b) {
      this.img0 =
        a;
      this.img1 = b;
      this.w = this.img0.w();
      this.h = this.img0.h()
    },
    onDown: function() {
      0 == this.state && (this.state = 1, "undefined" != typeof this.parent.setMode && this.parent.setMode(this.mode));
      var a = this;
      this.holdTimer = setTimeout(function() {
        a.onHold()
      }, HOLD_TIME);
      this.valueFunc();
      regUpdate(this.parent)
    },
    onUp: function() {
      clearTimeout(this.holdTimer)
    },
    onHold: function() {},
    getState: function() {
      "undefined" != typeof this.parent.mode && (this.state = this.parent.mode == this.mode ? 1 : 0)
    },
    valueFunc: function() {},
    paint: function() {
      this.needBG &&
        (ctx.fillStyle = color.bg, ctx.fillRect(0, 0, this.w, this.h));
      this.getState();
      0 == this.state ? null != this.img0 ? drawImage(this.img0, 0, 0) : (ctx.strokeStyle = color.tabStroke, ctx.strokeRect(.5, .5, this.w - 1, this.h - 2), ctx.font = font.tabText, ctx.fillStyle = color.tabText, ctx.textAlign = "center", ctx.setShadow(color.shadow, 3, 1, 1), ctx.fillText(this.text, this.w / 2 | 0, 22, this.w)) : null != this.img1 ? drawImage(this.img1, 0, 0) : (ctx.fillStyle = this.color, ctx.fillRect(0, 0, this.w, this.h), ctx.font = font.tabText, ctx.fillStyle = color.tabTextSel,
        ctx.textAlign = "center", ctx.setShadow(color.shadow, 3, 1, 1), ctx.fillText(this.text, this.w / 2 | 0, 22, this.w));
      if (this.text) {
        var a = {
          align: "center",
          valign: "middle",
          color: this.state ? "#eee" : "#222",
          shadow: ["#bbb", 0, 1, 1],
          font: "15px open_sans_condensedbold"
        };
        this.state && (a.shadow[0] = "#333");
        ctx.drawText(this.text, this.w / 2 | 0, this.h / 2 | 0, a)
      }
      if (this.longClickMark) {
        a = 4;
        if (this.invertedValue && !this.state || !this.invertedValue && this.state) a += 1;
        ctx.fillStyle = color.longClickMark2;
        ctx.fillCircle(this.w - 6, a + 1, 3);
        ctx.fillStyle =
          color.longClickMark;
        ctx.fillCircle(this.w - 6, a + 1, 2)
      }
    }
  }),
  STEREOSEL = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "STEREOSEL";
      this.w = 120;
      this.h = 30;
      this.color = color.purple;
      this.stereo = !1;
      this.indicatorMode = this.left = this.link = !0
    },
    onDown: function(a) {
      if (this.visible && !this.indicatorMode) {
        a -= this.globalX();
        var b = this.parent;
        !this.link && (80 < a || 40 > a) && (this.left = !this.left, b.pages[b.mode].setLeft && b.pages[b.mode].setLeft(this.left));
        40 < a && 80 > a && (this.link = !this.link, this.left = !0, b.pages[b.mode].setLinked && b.pages[b.mode].setLinked(this.link));
        regUpdate(this)
      }
    },
    getState: function() {
      var a = this.parent;
      this.indicatorMode = !0;
      switch (selectedStrip.type) {
        case E_STRIP_TYPE.MASTER:
          switch (a.mode) {
            case a.E_MODE.eqm:
            case a.E_MODE.dyn:
            case a.E_MODE.misc:
              this.indicatorMode = !1
          }
          break;
        case E_STRIP_TYPE.SUB:
          switch (a.mode) {
            case a.E_MODE.misc:
              this.indicatorMode = !1
          }
      }
      a.mode == a.E_MODE.misc ? (this.link = !1, this.left = a.pages[a.E_MODE.misc].left) : a.mode == a.E_MODE.eqm ? (this.link = getValue("m.eq.linked"),
        this.left = a.pages[a.E_MODE.eqm].left) : a.mode == a.E_MODE.dyn && (this.link = getValue("m.dyn.linked"), this.left = a.pages[a.E_MODE.dyn].left)
    },
    paint: function() {
      this.getState();
      this.color = editWidget.buttons[editWidget.mode].color;
      ctx.fillStyle = color.eqBg;
      ctx.fillRect(0, 0, this.w, this.h);
      ctx.strokeStyle = "rgba(200,200,200,0.1)";
      ctx.lineWidth = 1;
      var a = !1,
        b = !1;
      this.indicatorMode && (this.link = !0);
      this.link ? (ctx.strokeStyle = "#fff", a = b = !0) : (ctx.strokeStyle = "#888", this.left ? a = !0 : b = !0);
      ctx.lineWidth = 2;
      ctx.beginPath();
      ctx.arc(55, 15, 10, 0, 2 * Math.PI);
      ctx.stroke();
      ctx.beginPath();
      ctx.arc(65, 15, 10, 0, 2 * Math.PI);
      ctx.stroke();
      ctx.beginPath();
      this.indicatorMode || (ctx.fillStyle = a ? this.color : "#444", ctx.fillRect(0, 0, 40, this.h), ctx.fillStyle = b ? this.color : "#444", ctx.fillRect(80, 0, 40, this.h));
      ctx.font = font.settingsLabel;
      ctx.fillStyle = color.tabTextSel;
      ctx.textAlign = "center";
      ctx.setShadow(color.black, 3, 1, 1);
      ctx.fillText(lang.L, 20, 21);
      ctx.fillText(lang.R, this.w - 20, 21);
      ctx.shadowColor = "transparent"
    }
  });

function VtoRATIO(a) {
  return 1 / a
}

function desqr(a) {
  return 1 - (1 - a) * (1 - a)
}

function idesqr(a) {
  return 1 - Math.sqrt(Math.abs(1 - a))
}

function VtoATTACK(a) {
  return 1 * Math.pow(400, desqr(a)) | 0
}

function VtoREL(a) {
  return 10 * Math.pow(200, desqr(a)) | 0
}

function VtoDYNGAIN(a) {
  return 96 * a - 72 | 0
}

function VtoDYNOUTGAIN(a) {
  return 72 * a - 24
}

function VtoDYNGATE(a) {
  return precision(-90 + 96 * a, 1)
}

function VtoTHRESH(a) {
  return precision(-90 + 96 * a, 1)
}

function RATIOtoV(a) {
  return 1E-4 > a ? 1 : bound(1 / a, 0, 1)
}

function modVu(a, b) {
  if (.001 > b || .001 > a) return 0;
  var c = a + .09047801706317746 * (-8.22581937262139 + Math.log(Math.exp(b * (23.90844819639692 + b * (-26.23877598214595 + (12.195249692570245 - .4878099877028098 * b) * b))) * (.055 > b ? Math.sin(28.559933214452666 * b) : 1)));
  0 > c ? c = 0 : 2 < c && (c = 2);
  return c
}
var AUXSendsPage = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "AUXSendsPage";
      this.mode = -1;
      this.y = measures.topWidgetHeight;
      this.enabled = !1;
      this.auxNum = curSetup.aux;
      this.buttons = [];
      this.color = color.AUX;
      this.bww = 6 < curSetup.aux ? 92 : 111;
      this.initWidgets();
      this.setMode(0)
    },
    setOffset: function(a) {
      this.page.enabled && this.page.setOffset(a);
      this.page2 && this.page2.enabled && this.page2.setOffset(a)
    },
    syncOffset: function() {
      HAVE_MATRIX && this.page2 && this.page2.enabled ? bottomWidget.setOffset2(this.page2.offsetX) :
        bottomWidget.setOffset2(this.page.offsetX)
    },
    setVU: function(a, b) {
      1 <= b && this.page.strips[a].clip.clip();
      this.page.strips[a].vu.setValue(b)
    },
    onShow: function() {
      this.page.arrangeStrips();
      bottomWidget.setOffset2(this.page.offsetX);
      for (var a = 0; a < this.buttons.length; a++) this.buttons[a].getState();
      this.upd()
    },
    upd: function() {
      this.setMode(this.mode, !0)
    },
    setMode: function(a, b) {
      if (!(this.mode == a && !b || 0 > a || a >= curSetup.aux || hideHPAUX && a > curSetup.aux - 3)) {
        this.mode = a;
        auxoutWidget.setAux(a);
        if (HAVE_MATRIX && auxStrips[this.mode].getNameValue("matrix")) {
          this.page.hide();
          this.page2.show();
          this.page2.auxID = a;
          for (var c = 0; c < mtxSendStrips.length; c++) mtxSendStrips[c].setMode(a);
          this.page2.arrangeStrips()
        } else {
          this.page.show();
          HAVE_MATRIX && this.page2.hide();
          this.page.auxID = a;
          for (c = 0; c < this.page.strips.length; c++) this.page.strips[c].setMode(a);
          this.page.arrangeStrips();
          HAVE_MATRIX && this.page2.arrangeStrips()
        }
        bottomWidget.upd();
        this.syncOffset();
        bottomWidget.update();
        regUpdate(this)
      }
    },
    nextMode: function() {
      this.mode == this.buttons.length - 1 || hideHPAUX && this.mode == this.buttons.length -
        3 ? this.setMode(0) : this.setMode(this.mode + 1)
    },
    initWidgets: function() {
      this.page = new AUXMixer(this, 0);
      HAVE_MATRIX && (this.page2 = new MTXMixer(this, 0));
      for (var a = 0; a < auxStrips.length; a++) {
        var b = new TabButton(this);
        b.textColor = b.color = this.color;
        b.mode = a;
        b.text = "NULL";
        b.setSize(this.bww, 30);
        b.getState = function() {
          this.mode > curSetup.aux - 3 && (this.dsbld = hideHPAUX);
          var a = auxStrips[this.mode],
            b = a.getNameValue("matrix") || 0;
          HAVE_MATRIX || (b = !1);
          a = a.getName();
          60 > this.w && (a = b ? lang.MTX + " " + (this.mode + 1) : lang.AUX + " " +
            (this.mode + 1));
          this.text = a.truncate(12);
          this.cosmetic = !1;
          this.state = this.parent.mode == this.mode ? 1 : 0;
          this.textColor = this.color = b ? color.MATRIX : color.AUX;
          b = auxStrips[this.parent.mode].getNameValue("stereoIndex");
          0 == b && this.parent.mode + 1 == this.mode && (this.cosmetic = !0, this.state = 1);
          1 == b && this.parent.mode - 1 == this.mode && (this.cosmetic = !0, this.state = 1)
        };
        this.buttons.push(b)
      }
    },
    calcGeometry: function() {
      this.w = screenWidth - this.x;
      masterWidget.enabled && (this.w -= masterWidget.w);
      auxoutWidget.enabled && (this.w -= masterWidget.w);
      slideOutWidget.enabled && (this.w -= slideOutWidget.w);
      this.h = screenHeight - this.y - bottomWidget.h;
      var a = 92;
      770 > this.w && 6 < this.buttons.length && (a = 81);
      16 == this.buttons.length && (a = Math.floor(this.w / this.buttons.length) - 1);
      this.buttons.length * a > this.w && (a = this.w / this.buttons.length - 1 | 0);
      for (var b = 0; b < this.buttons.length; b++) this.buttons[b].w = a, this.buttons[b].setPos(this.w - (this.buttons[b].w + 1) * (this.buttons.length - b), 5)
    },
    paint: function() {
      ctx.fillStyle = color.eqBg;
      ctx.fillRect(0, 0, this.w, this.h);
      var a = auxStrips[this.mode].getNameValue("matrix") ||
        0;
      ctx.fillStyle = a ? color.MATRIX : color.AUX;
      ctx.fillRect(0, 35, this.w, 4)
    }
  }),
  AUXMixer = Class.create(Widget, {
    initialize: function($super, b, c) {
      $super(b);
      this.widgetName = "AUX_MIXER";
      this.y = 40;
      this.needClip = !0;
      this.color = color.AUX;
      this.auxID = c;
      this.strips = [];
      this.regKey("settings.auxmutelink");
      this.createStrips()
    },
    arrangeStrips: function() {
      for (var a = 0; a < this.strips.length; a++);
    },
    createStrips: function() {
      for (var a = curSetup.input, b = curSetup.fx, c = curSetup.linein, d = 0, f = "aux." + this.auxID + ".", e = 0; e < a; e++) {
        var g = "i." +
          e + ".",
          h = inStrips[e],
          g = new AUXStrip(this, h.id, g, f);
        0 == e && (g.firstInGroup = !0);
        e == a - 1 && (g.lastInGroup = !0);
        g.id = inStrips[e].id;
        g.color = this.color;
        g.text = inStrips[e].text;
        g.st = h;
        this.strips.push(g);
        auxSendStrips.push(g);
        inStrips[e].AUXS.push(g);
        d++
      }
      for (e = 0; e < c; e++) g = "l." + e + ".", h = lineinStrips[e], g = new AUXStrip(this, h.id, g, f), 0 == e && (g.firstInGroup = !0), e == c - 1 && (g.lastInGroup = !0), g.id = h.id, g.color = h.color, g.text = h.text, g.st = h, this.strips.push(g), auxSendStrips.push(g), h.AUXS.push(g), d++;
      h = mediaStrips[0];
      g =
        new AUXStrip(this, h.id, "p.0.", f);
      g.firstInGroup = !0;
      g.id = mediaStrips[0].id;
      g.color = color.media;
      g.sl.color = color.media;
      g.sl.fader = res.fader;
      g.text = mediaStrips[0].text;
      g.st = h;
      this.strips.push(g);
      mediaStrips[0].AUXS.push(g);
      auxSendStrips.push(g);
      d++;
      h = mediaStrips[1];
      g = new AUXStrip(this, h.id, "p.1.", f);
      g.lastInGroup = !0;
      g.id = mediaStrips[1].id;
      g.color = color.media;
      g.sl.color = color.media;
      g.sl.fader = res.fader;
      g.text = mediaStrips[1].text;
      g.st = h;
      this.strips.push(g);
      mediaStrips[1].AUXS.push(g);
      auxSendStrips.push(g);
      d++;
      for (e = 0; e < b; e++) g = "f." + e + ".", h = fxStrips[e], g = new AUXStrip(this, h.id, g, f), 0 == e && (g.firstInGroup = !0), e == b - 1 && (g.lastInGroup = !0), g.id = fxStrips[e].id, g.color = color.blue, g.sl.color = color.blue, g.sl.fader = res.blueFader, g.text = fxStrips[e].text, g.st = h, this.strips.push(g), fxStrips[e].AUXS.push(g), auxSendStrips.push(g), d++
    },
    setOffset: function(a) {
      this.offsetX = a;
      0 > this.offsetX && (this.offsetX = 0);
      a = this.strips.length * measures.mixerStripWidth - this.w;
      0 > a && (a = 0);
      this.offsetX > a && (this.offsetX = a);
      this.offsetXold =
        this.offsetX;
      regUpdate(this)
    },
    calcGeometry: function() {
      this.w = this.parent.w - this.x;
      this.h = this.parent.h - this.y;
      var a = this.strips.length * measures.mixerStripWidth - this.w;
      0 > a && (a = 0);
      this.offsetX > a && this.setOffset(this.offsetX)
    },
    paint: function() {
      ctx.fillStyle = color.eqBg;
      ctx.fillRect(0, 0, this.w, this.h)
    }
  }),
  AUX_EDIT_PAGE = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "CH_AUX_PAGE";
      this.y = 40;
      this.color = color.AUX;
      this.needClip = this.needMoveEvt = !0;
      this.mode = 0;
      this.SLIDERS = [];
      this.LEDS = [];
      this.MUTES = [];
      this.POSTS = [];
      this.PROCS = [];
      this.VUS = [];
      this.CLIPS = [];
      this.maxX = 600;
      this.initWidgets();
      this.setMode(0);
      this.onShow()
    },
    setMode: function(a) {
      this.mode = a;
      regUpdate(this)
    },
    onDown: function(a, b) {
      this.lastPressPoint = this.pressPoint;
      this.pressPoint = [a, b];
      this.ppx = this.offsetX + a
    },
    onMove: function(a, b, c) {
      2 < mouseTargets.length || isDefined(tHash[c]) && 2 < tHash[c].length || this.setOffset(this.ppx - a)
    },
    onUp: function(a) {
      var b = Date.now(),
        c = Math.abs(this.lastPressPoint[0] - this.pressPoint[0]),
        d = Math.abs(this.lastPressPoint[1] -
          this.pressPoint[1]);
      2 < mouseTargets.length || isDefined(tHash[a]) && 2 < tHash[a].length || (30 > c && 30 > d && b - this.lastClickTime < DBL_CLK_TIME ? (this.onDouble(), this.lastClickTime = b - DBL_CLK_TIME) : this.lastClickTime = b)
    },
    onDouble: function() {
      setMode(E_MODE.MIX)
    },
    setOffset: function(a) {
      this.offsetX = bound(a | 0, 0, this.maxX);
      regUpdate(this)
    },
    onShow: function() {
      this.syncSliders()
    },
    syncSliders: function() {
      if (null != selectedStrip) {
        switch (selectedStrip.type) {
          case E_STRIP_TYPE.IN:
          case E_STRIP_TYPE.LINEIN:
          case E_STRIP_TYPE.MEDIA:
          case E_STRIP_TYPE.FX:
            this.keyPrefix =
              selectedStrip.name + "aux.";
            for (var a = 0; a < this.SLIDERS.length; a++) {
              var b = selectedStrip.name + "aux." + a + ".";
              this.SLIDERS[a].setKey(b + "value");
              this.SLIDERS[a].bigMark = -1;
              this.LEDS[a].setKey(b + "value");
              this.MUTES[a].setKey(b + "mute");
              this.MUTES[a].img0 = res.bMuteOff;
              this.MUTES[a].kp = b;
              this.MUTES[a].st = selectedStrip;
              this.MUTES[a].getState = function() {
                if (1 == auxStrips[this.mode].getNameValue("matrix")) this.state = 0, this.disabled = !0;
                else {
                  this.state = getValue(this.kp + "mute");
                  var a = getValue("settings.auxmutelink"),
                    b = getValue(this.kp + "post");
                  this.disabled = !1;
                  (a || b) && this.st.getMuteState() && (this.state = 1, this.disabled = !0)
                }
              };
              this.MUTES[a].onToggle = function() {};
              this.MUTES[a].onToggleUp = function() {};
              this.MUTES[a].onToggleDown = function() {};
              this.POSTS[a].show();
              this.POSTS[a].setKey(b + "post");
              this.PROCS[a] && (this.PROCS[a].show(), this.PROCS[a].setKey(b + "postproc"));
              this.VUS[a].hide();
              this.CLIPS[a].hide();
              this.SLIDERS[a].setFader(res.gainFader, 13);
              this.SLIDERS[a].background = color.eqBg
            }
            break;
          case E_STRIP_TYPE.MASTER:
            for (a =
              0; a < this.SLIDERS.length; a++) this.keyPrefix = "a." + a, b = auxStrips[a], this.SLIDERS[a].setKey(this.keyPrefix + ".mix"), this.SLIDERS[a].bigMark = zeroDbPos, this.LEDS[a].setKey(this.keyPrefix + ".mix"), this.MUTES[a].setKey(this.keyPrefix + ".mute"), this.MUTES[a].kkk = this.keyPrefix, this.MUTES[a].st = b, this.MUTES[a].getState = function() {
              selectedStrip.type == E_STRIP_TYPE.MASTER && (this.state = this.st.getMuteState(), this.img0 = this.st.getNameValue("forceunmute") ? res.bMuteOff_F : res.bMuteOff)
            }, this.MUTES[a].onToggle = function() {
              selectedStrip.type ==
                E_STRIP_TYPE.MASTER && checkMutes()
            }, this.MUTES[a].onToggleUp = function() {
              if (selectedStrip.type == E_STRIP_TYPE.MASTER) {
                var a = getValue("mgmask"),
                  b = getValue(this.kkk + ".mgmask"),
                  b = a & b,
                  a = checkBit(a, MUTEALL_BIT_IDX),
                  f = !1;
                if (IS_UI_24 && this.type == E_STRIP_TYPE.IN) {
                  var e = this.st.getNameValue("vca");
                  vcaStrips[e] && (f = vcaStrips[e].getMuteState())
                }
                b || a || f || this.st.setNameValue("mute", 1);
                this.st.setNameValue("forceunmute", 0)
              }
            }, this.MUTES[a].onToggleDown = function() {
              selectedStrip.type == E_STRIP_TYPE.MASTER && (this.st.getMuteState(!0, !0) ? this.st.setNameValue("forceunmute", 1) : this.st.setNameValue("mute", 0))
            }, this.POSTS[a].hide(), this.VUS[a].show(), this.CLIPS[a].show(), this.PROCS[a] && this.PROCS[a].hide(), this.SLIDERS[a].setFader(res.auxFader, 13), this.SLIDERS[a].background = color.eqBg
        }
        this.calcGeometry()
      }
    },
    initWidgets: function() {
      this.regKey("settings.auxmutelink");
      for (var a = this, b = 0; b < auxStrips.length; b++) {
        var c = new AUX_LED(this);
        c.mode = b;
        c.getState = function() {
          this.dsbld = 1 == auxStrips[this.mode].getNameValue("matrix")
        };
        this.LEDS.push(c);
        c = new CheckBox(this);
        c.setImages(res.bMuteOff, res.bMuteOn);
        c.mode = b;
        c.getState = function() {
          this.disabled = 1 == auxStrips[this.mode].getNameValue("matrix");
          selectedStrip.type == E_STRIP_TYPE.MASTER && (this.disabled = !1)
        };
        this.MUTES.push(c);
        c = new VUMeter(this);
        c.calcGeometry = function() {};
        this.VUS.push(c);
        c = new ClipBulb(this);
        this.CLIPS.push(c);
        c = new EQSlider(this);
        c.fader = res.eqVFaderGray;
        c.dbMarks = !0;
        c.mode = b;
        c.aclr = color.AUX;
        c.onFocus = function() {
          a.setMode(this.mode)
        };
        c.onValueChange = function() {
          regUpdate(a.LEDS[this.mode])
        };
        c.getState = function() {
          var a = 1 == auxStrips[this.mode].getNameValue("matrix");
          selectedStrip.type == E_STRIP_TYPE.MASTER ? (this.disabled = !1, this.fader = a ? res.mtxFader : res.auxFader) : (this.disabled = a, this.fader = res.auxFader);
          switch (auxStrips[this.mode].getNameValue("stereoIndex")) {
            case 0:
              this.leftArrow = !1;
              this.rightArrow = !0;
              break;
            case 1:
              this.rightArrow = !1;
              this.leftArrow = !0;
              break;
            default:
              this.rightArrow = this.leftArrow = !1
          }
        };
        this.SLIDERS.push(c);
        c = new CheckBox(this);
        c.mode = b;
        c.setImages(res.bPre, res.bPost);
        c.setSize(70,
          30);
        c.getState = function() {
          this.disabled = 1 == auxStrips[this.mode].getNameValue("matrix")
        };
        this.POSTS.push(c)
      }
    },
    sync: function() {
      for (var a = this.SLIDERS.length - 2; a < this.SLIDERS.length; a++) this.LEDS[a].dsbld = hideHPAUX, this.SLIDERS[a].disabled = hideHPAUX, this.MUTES[a].disabled = hideHPAUX, this.POSTS[a].disabled = hideHPAUX
    },
    calcGeometry: function() {
      this.w = this.parent.w;
      this.h = this.parent.h - this.y - 5;
      var a = (this.w - 90 * this.SLIDERS.length + this.SLIDERS[0].w) / 2 | 0;
      0 > a && (a = 30);
      for (var b = selectedStrip.type == E_STRIP_TYPE.MASTER,
          c = 0, d = 0; d < this.SLIDERS.length; d++) c = a + 90 * d, this.LEDS[d].setPos(c - 15, 38), this.MUTES[d].setPos(c, 76), this.SLIDERS[d].setPos(c + (b ? 10 : 0), 118), this.SLIDERS[d].h = this.h - this.SLIDERS[d].y - (b ? 50 : 100), this.POSTS[d].setPos(c, this.h - 86), b && (this.VUS[d].setPos(c - 16 + (b ? 10 : 0), this.SLIDERS[d].y + 18), this.VUS[d].setSize(11, this.SLIDERS[d].h - 20), this.CLIPS[d].setPos(c - 22 + (b ? 10 : 0), this.SLIDERS[d].y - 4));
      this.maxX = c + 70 - this.w;
      0 > this.maxX && (this.maxX = 0)
    },
    paint: function() {
      ctx.fillStyle = color.eqBg;
      ctx.fillRect(this.offsetX,
        0, this.w, this.h);
      var a = ctx.createLinearGradient(this.offsetX + 0, 0, this.offsetX + this.w, 0);
      a.addColorStop(0, "transparent");
      a.addColorStop(.5, color.AUX);
      a.addColorStop(1, "transparent");
      ctx.fillStyle = a;
      selectedStrip.type == E_STRIP_TYPE.MASTER && ctx.fillRect(this.offsetX, 0, this.w, 32);
      ctx.font = "bold 16pt open_sans_condensedbold";
      ctx.textAlign = "center";
      ctx.setShadow(color.black, 4, 2, 2);
      if (selectedStrip.type == E_STRIP_TYPE.MASTER) ctx.fillStyle = color.black, ctx.fillText(lang.AUX_MASTER_LEVELS, this.offsetX + Math.floor(this.w /
        2 + 1), 24), ctx.fillStyle = color.labelText, ctx.fillText(lang.AUX_MASTER_LEVELS, this.offsetX + Math.floor(this.w / 2), 23);
      else {
        var a = lang.AUX_SENDS_FOR.format(selectedStrip.getName()),
          b = this.offsetX + Math.floor((this.w - textWidth(a)) / 2);
        ctx.textAlign = "left";
        ctx.fillStyle = color.labelText;
        a = lang.AUX_SENDS_FOR.format("");
        ctx.fillText(a, b, 23);
        ctx.fillStyle = selectedStrip.color;
        ctx.fillText(selectedStrip.getName(), b + textWidth(a), 23)
      }
      40 < this.maxX && (ctx.fillStyle = color.labelText, ctx.fillText(">>", this.offsetX + this.w -
        40, 23), ctx.fillText("<<", this.offsetX + 30, 23));
      ctx.textAlign = "center";
      for (a = 0; a < this.POSTS.length; a++) {
        if (0 == auxStrips[a].getNameValue("stereoIndex")) {
          ctx.shadowColor = "transparent";
          ctx.fillStyle = color.AUX;
          var b = this.POSTS[a].x - 16,
            c = this.h - 9,
            d = b + 171;
          ctx.fillRect(b, c, 171, 3);
          ctx.fillTriangle2(b, c, b + 16 - 3, c, b, c - 16 + 3);
          ctx.fillTriangle2(d, c, d - 16 + 3, c, d, c - 16 + 3);
          c = 69;
          ctx.fillRect(b, c, 171, 3);
          ctx.fillTriangle2(b, c, b + 16, c, b, c + 16);
          ctx.fillTriangle2(d, c, d - 16, c, d, c + 16)
        }
        ctx.fillStyle = "rgb(183,183,183)";
        hideHPAUX &&
          a >= curSetup.aux - 2 && (ctx.fillStyle = "#555");
        ctx.setShadow(color.black, 4, 2, 2);
        auxStrips[a].getNameValue("matrix") ? ctx.fillText(lang.MTX + " " + (a + 1), this.POSTS[a].x + 26, this.h - 16) : ctx.fillText(lang.AUX + " " + (a + 1), this.POSTS[a].x + 26, this.h - 16)
      }
      ctx.shadowColor = "transparent"
    }
  }),
  AUX_LED = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "AUX-LED";
      this.bg = res.auxsLED;
      this.w = this.bg.w();
      this.h = this.bg.h();
      this.dsbld = !1;
      this.text = "...";
      this.bgColor = PATTERNED ? color.black : color.eqBg2
    },
    getState: function() {},
    paint: function() {
      this.getState();
      this.dsbld && (ctx.globalAlpha = .4);
      ctx.fillStyle = this.bgColor;
      ctx.fillRect(0, 0, this.w, this.h);
      this.bg && drawImage(this.bg, 0, 0, this.w, this.h);
      null != this.key && (this.text = VtoDB(getValue(this.key)));
      ctx.fillStyle = color.ledText;
      ctx.textAlign = "center";
      ctx.font = "16px umixled";
      ctx.fillText(this.text, this.w / 2 | 0, 21);
      this.dsbld && (ctx.globalAlpha = 1)
    }
  }),
  MTXMixer = Class.create(Widget, {
    initialize: function($super, b, c) {
      $super(b);
      this.widgetName = "MTX_MIXER";
      this.y = 40;
      this.needClip = !0;
      this.color =
        color.MATRIX;
      this.auxID = c;
      this.vis = 0;
      this.strips = [];
      this.createStrips()
    },
    onShow: function() {
      this.maxOffs = this.vis * measures.mixerStripWidth - this.w;
      0 > this.maxOffs && (this.maxOffs = 0);
      this.offsetX > this.maxOffs && this.setOffset(this.offsetX)
    },
    arrangeStrips: function() {
      for (var a = 0, b = this.vis = 0; b < curSetup.aux; b++) auxStrips[b].getNameValue("matrix") ? this.strips[b].enabled = !1 : this.strips[b].enabled = !0;
      for (var c = 0, b = 0; b < mtxSendStrips.length; b++) {
        var d = mtxSendStrips[b];
        d.enabled && (c++, d.x = a * measures.mixerStripWidth,
          a++)
      }
      for (var a = -1, f = null, b = 0; b < mtxSendStrips.length; b++) d = mtxSendStrips[b], d.enabled ? (a != d.type ? (d.firstInGroup = !0, d.lastInGroup = !1, null != f && (f.lastInGroup = !0), a = d.type) : (d.firstInGroup = !1, d.lastInGroup = !1), f = d) : (d.firstInGroup = !1, d.lastInGroup = !1);
      null != f && (f.lastInGroup = !0);
      this.realWidth = c * measures.mixerStripWidth;
      this.vis = c;
      this.setOffset(this.offsetX)
    },
    createStrips: function() {
      for (var a = curSetup.aux, b = curSetup.sub, c = 0, d = "mtx." + this.auxID + ".", f = 0; f < a; f++) {
        var e = "a." + f + ".",
          g = auxStrips[f],
          e = new MTXStrip(this,
            c, e, d);
        0 == f && (e.firstInGroup = !0);
        f == a - 1 && (e.lastInGroup = !0);
        e.id = g.id;
        e.type = 0;
        e.color = this.color;
        e.text = g.text;
        e.sl.fader = res.auxFader;
        g.MTX = e;
        this.strips.push(e);
        mtxSendStrips.push(e);
        c++
      }
      for (f = 0; f < b; f++) e = "s." + f + ".", g = subStrips[f], e = new MTXStrip(this, c, e, d), 0 == f && (e.firstInGroup = !0), f == b - 1 && (e.lastInGroup = !0), e.type = 1, e.id = g.id, e.stereo = !0, e.color = this.color, e.sl.fader = res.subFader, e.text = g.text, g.MTX = e, this.strips.push(e), mtxSendStrips.push(e), c++;
      g = masterWidget;
      e = new MTXStrip(this, c, "m.", d);
      e.firstInGroup = !0;
      e.lastInGroup = !0;
      e.type = 2;
      e.id = g.id;
      e.color = this.color;
      e.sl.fader = res.redFader;
      e.text = g.text;
      g.MTX = e;
      this.strips.push(e);
      mtxSendStrips.push(e)
    },
    setOffset: function(a) {
      this.offsetX == a || a > this.maxOffs || (this.offsetX = a, 0 > this.offsetX && (this.offsetX = 0), this.offsetX > this.maxOffs && (this.offsetX = this.maxOffs), this.offsetXold = this.offsetX, regUpdate(this))
    },
    calcGeometry: function() {
      this.w = this.parent.w - this.x;
      this.h = this.parent.h - this.y;
      this.maxOffs = this.vis * measures.mixerStripWidth - this.w;
      0 > this.maxOffs && (this.maxOffs = 0);
      this.offsetX > this.maxOffs && this.setOffset(this.offsetX)
    },
    paint: function() {
      ctx.fillStyle = color.bg;
      ctx.fillRect(this.offsetX, 0, this.w, this.h);
      if (this.vis * measures.mixerStripWidth < this.w)
        for (var a = this.vis * measures.mixerStripWidth; a < this.w; a += measures.mixerStripWidth) fillVertPattern(res.blStripTile, this.h, a), drawImage(res.blStripBottom, a, this.h - res.blStripBottom.h()), drawImage(res.blStripTop, a, 0)
    }
  }),
  DYNSubPage = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "DYN_SUBPAGE";
      this.y = 40;
      this.mode = 0;
      this.master = !1;
      this.left = !0;
      this.bypass = !1;
      this.keyPrefix = "";
      this.prType = "dynch";
      this.timer = null;
      this.initWidgets()
    },
    setMode: function(a) {
      this.mode = a
    },
    setLeft: function(a) {
      this.left = a;
      this.dyn.left = a;
      this.syncSliders();
      regUpdate(this)
    },
    setLinked: function(a) {
      if (a)
        for (var b = this.left ? "l" : "r", c = this.left ? "r" : "l", d = "threshold gain outgain ratio softknee attack hold release".split(" "), f = 0; f < d.length; f++) setValue("m.dyn." + c + "." + d[f], getValue("m.dyn." + b +
          "." + d[f]));
      setValue("m.dyn.linked", a ? 1 : 0);
      this.setLeft(!0)
    },
    setVU: function(a, b, c) {
      this.vuIN.setValue(a);
      this.vuOUT.setValue(b);
      this.vuCOMP.setValue(c)
    },
    resetVUs: function() {
      this.vuIN.reset();
      this.vuOUT.reset();
      this.vuCOMP.reset()
    },
    onShow: function() {
      this.resetVUs();
      var a = selectedChID,
        b = this;
      switch (selectedStrip.type) {
        case E_STRIP_TYPE.IN:
        case E_STRIP_TYPE.MEDIA:
        case E_STRIP_TYPE.FX:
        case E_STRIP_TYPE.SUB:
          this.prType = "dynch";
          break;
        case E_STRIP_TYPE.AUX:
          this.prType = "dynaux";
          break;
        case E_STRIP_TYPE.MASTER:
          this.prType =
            "dynm"
      }
      clearInterval(this.timer);
      this.timer = setInterval(function() {
        b.enabled && a == selectedChID && sendMessage("DYN^" + a)
      }, 1E3);
      this.syncSliders()
    },
    onHide: function() {
      clearInterval(this.timer)
    },
    onDown: function(a, b) {
      this.lastPressPoint = this.pressPoint;
      this.pressPoint = [a, b]
    },
    onUp: function(a) {
      var b = Date.now(),
        c = Math.abs(this.lastPressPoint[0] - this.pressPoint[0]),
        d = Math.abs(this.lastPressPoint[1] - this.pressPoint[1]);
      2 < mouseTargets.length || isDefined(tHash[a]) && 2 < tHash[a].length || (30 > c && 30 > d && b - this.lastClickTime <
        DBL_CLK_TIME ? (this.onDouble(), this.lastClickTime = b - DBL_CLK_TIME) : this.lastClickTime = b)
    },
    onDouble: function() {
      setMode(E_MODE.MIX)
    },
    syncSliders: function() {
      this.enabled && null != selectedStrip && (this.bBYPASS.setKeyPrefix(selectedStrip.name + "dyn."), this.keyPrefix = selectedStrip.name + "dyn.", selectedStrip.type == E_STRIP_TYPE.MASTER && (this.keyPrefix += this.left ? "l." : "r."), this.led_tre.setKeyPrefix(this.keyPrefix), this.led_gate.setKey(selectedStrip.name + "gate.thresh"), this.led_ratio.setKeyPrefix(this.keyPrefix),
        this.led_attack.setKeyPrefix(this.keyPrefix), this.led_release.setKeyPrefix(this.keyPrefix), this.led_gain.setKeyPrefix(this.keyPrefix), this.slTRE.setKeyPrefix(this.keyPrefix), this.slGATE.setKey(selectedStrip.name + "gate.thresh"), this.slRATIO.setKeyPrefix(this.keyPrefix), this.slATTACK.setKeyPrefix(this.keyPrefix), this.slGAIN.setKeyPrefix(this.keyPrefix), this.slRELEASE.setKeyPrefix(this.keyPrefix), this.bSOFTKNEE.setKeyPrefix(this.keyPrefix), this.mode = getValue(this.keyPrefix + "softknee") | 0)
    },
    doReset: function() {
      resetDyn(selectedChID, !HAVE_GATE);
      regUpdate(this)
    },
    initWidgets: function() {
      this.preset = new MENUBUTTON(this);
      this.preset.setSize(130, 29);
      this.preset.setAnchors(null, 10, 10, null);
      this.preset.text = lang.PRESETS;
      this.preset.color = color.green;
      this.preset.onPress = function() {
        a.showPresets()
      };
      this.dyn = new DYN_GRAPH(this);
      this.dyn.setPos(40, 32);
      this.vuIN = new DYNVU(this);
      this.vuIN.setPos(0, 30);
      this.vuIN.needGate = !0;
      this.vuOUT = new DYNVU(this);
      this.vuOUT.setPos(0, 30);
      this.vuCOMP = new DYNVU(this);
      this.vuCOMP.setPos(0, 30);
      this.vuCOMP.invert = !0;
      var a = this,
        b = this.dyn;
      this.slTRE = new EQHSlider2(this);
      this.slTRE.keyPart = "threshold";
      this.slTRE.defaultValue = -1;
      this.slTRE.setPos(16, 600);
      this.slTRE.valueFunc = function(c) {
        selectedStrip.type == E_STRIP_TYPE.MASTER && 1 == getValue("m.dyn.linked") && setValue(this.key.replace(".l.", ".r."), c);
        selectedStrip.setNameValue("dyn.prmod", 1);
        regUpdate(b);
        regUpdate(a.vuIN);
        regUpdate(a.led_tre)
      };
      this.slTRE.onFocus = function() {
        1 != b.idx && (b.idx = 1);
        regUpdate(b);
        regUpdate(a.led)
      };
      this.led_tre = new FXLEDPlain(this);
      this.led_tre.keyPart =
        "threshold";
      this.led_tre.label = lang.THRESHOLD;
      this.led_tre.sign = "dB";
      this.led_tre.formatValue = function(a) {
        a = VtoTHRESH(a) + ""; - 1 == a.indexOf(".") && (a += ".0");
        return a
      };
      this.led_gate = new FXLEDPlain(this);
      this.led_gate.w = 60;
      this.led_gate.label = lang.GATE;
      this.led_gate.sign = "dB";
      this.led_gate.formatValue = function(a) {
        a = VtoDYNGATE(a); - 89 > a && (a = "-inf");
        return a + ""
      };
      this.slGATE = new EQSlider(this);
      this.slGATE.fader = res.eqVFaderGreen;
      this.slGATE.setPos(500, 60);
      this.slGATE.textBot = lang.GATE;
      this.slGATE.mV = [1, .7827,
        .5239, .2556, 0
      ];
      this.slGATE.valueFunc = function(b) {
        selectedStrip.type == E_STRIP_TYPE.MASTER && 1 == getValue("m.dyn.linked") && setValue(this.key.replace(".l.", ".r."), b);
        a.vuIN.gateValue = b;
        selectedStrip.setNameValue("dyn.prmod", 1);
        regUpdate(a.vuIN);
        regUpdate(a.led_gate);
        regUpdate(a.dyn)
      };
      HAVE_GATE && (this.led_gate.hide(), this.slGATE.hide());
      this.led_ratio = new FXLEDPlain(this);
      this.led_ratio.w = 60;
      this.led_ratio.keyPart = "ratio";
      this.led_ratio.label = lang.RATIO;
      this.led_ratio.sign = "";
      this.led_ratio.formatValue =
        function(a) {
          a = VtoRATIO(a);
          return a = 60 < a ? "inf" : 2 > a ? precision(a, 2) + "" : precision(a, 1) + ""
        };
      this.slRATIO = new EQSlider(this);
      this.slRATIO.keyPart = "ratio";
      this.slRATIO.setPos(570, 60);
      this.slRATIO.fader = res.eqVFaderYellow;
      this.slRATIO.mV = [1, 1 / 1.2, .625, .5, 1 / 3, .2, .1, 0];
      this.slRATIO.textBot = lang.RATIO;
      this.slRATIO.valueFunc = function(c) {
        selectedStrip.type == E_STRIP_TYPE.MASTER && 1 == getValue("m.dyn.linked") && setValue(this.key.replace(".l.", ".r."), c);
        selectedStrip.setNameValue("dyn.prmod", 1);
        regUpdate(b);
        regUpdate(a.led_ratio)
      };
      this.slRATIO.onFocus = function() {
        2 != b.idx && (b.idx = 2);
        regUpdate(b)
      };
      this.led_attack = new FXLEDPlain(this);
      this.led_attack.w = 60;
      this.led_attack.keyPart = "attack";
      this.led_attack.label = lang.ATTACK;
      this.led_attack.sign = "ms";
      this.led_attack.formatValue = VtoATTACK;
      this.slATTACK = new EQSlider(this);
      this.slATTACK.keyPart = "attack";
      this.slATTACK.setPos(640, 60);
      this.slATTACK.textBot = lang.ATTACK;
      this.slATTACK.mV = [1, findV(VtoATTACK, 300), findV(VtoATTACK, 200), findV(VtoATTACK, 100), findV(VtoATTACK, 20), 0];
      this.slATTACK.valueFunc =
        function(b) {
          selectedStrip.type == E_STRIP_TYPE.MASTER && 1 == getValue("m.dyn.linked") && setValue(this.key.replace(".l.", ".r."), b);
          regUpdate(a.led_attack);
          selectedStrip.setNameValue("dyn.prmod", 1);
          regUpdate(a.dyn)
        };
      this.led_release = new FXLEDPlain(this);
      this.led_release.w = 60;
      this.led_release.keyPart = "release";
      this.led_release.label = lang.RELEASE;
      this.led_release.sign = "ms";
      this.led_release.formatValue = VtoREL;
      this.slRELEASE = new EQSlider(this);
      this.slRELEASE.keyPart = "release";
      this.slRELEASE.setPos(780, 60);
      this.slRELEASE.textBot =
        lang.RELEASE;
      this.slRELEASE.mV = [1, .7668, .6397, .4896, .25, 0];
      this.slRELEASE.valueFunc = function(b) {
        selectedStrip.type == E_STRIP_TYPE.MASTER && 1 == getValue("m.dyn.linked") && setValue(this.key.replace(".l.", ".r."), b);
        regUpdate(a.led_release);
        selectedStrip.setNameValue("dyn.prmod", 1);
        regUpdate(a.dyn)
      };
      this.led_gain = new FXLEDPlain(this);
      this.led_gain.w = 60;
      this.led_gain.keyPart = "outgain";
      this.led_gain.label = lang.GAIN;
      this.led_gain.sign = "dB";
      this.led_gain.formatValue = function(a) {
        return precision(VtoDYNOUTGAIN(a),
          1)
      };
      this.slGAIN = new EQSlider(this);
      this.slGAIN.fader = res.eqVFaderRed;
      this.slGAIN.keyPart = "outgain";
      this.slGAIN.setPos(710, 60);
      this.slGAIN.textBot = lang.GAIN;
      this.slGAIN.setDefaultValue(findV(VtoDYNOUTGAIN, 0));
      this.slGAIN.mV = [1, findV(VtoDYNOUTGAIN, 36), findV(VtoDYNOUTGAIN, 24), findV(VtoDYNOUTGAIN, 12), findV(VtoDYNOUTGAIN, -12), 0];
      this.slGAIN.valueFunc = function(b) {
        selectedStrip.type == E_STRIP_TYPE.MASTER && 1 == getValue("m.dyn.linked") && setValue(this.key.replace(".l.", ".r."), b);
        regUpdate(a.led_gain);
        selectedStrip.setNameValue("dyn.prmod",
          1);
        regUpdate(a.dyn)
      };
      this.bBYPASS = new CheckBox(this);
      this.bBYPASS.keyPart = "bypass";
      this.bBYPASS.setPos(40, 350);
      this.bBYPASS.setSize(70, 30);
      this.bBYPASS.setImages(res.bBYPASS_OFF, res.bBYPASS_ON);
      this.bBYPASS.onToggleUp = function() {
        regUpdate(a)
      };
      this.bBYPASS.onToggleDown = function() {
        regUpdate(a)
      };
      this.bRESET = new Button(this);
      this.bRESET.setPos(40, 350);
      this.bRESET.setSize(70, 30);
      this.bRESET.setImages(res.bRESET_OFF, res.bRESET_ON);
      this.bRESET.valueFunc = function() {
        a.doReset()
      };
      this.bSOFTKNEE = new CheckBox(this);
      this.bSOFTKNEE.setPos(40, 350);
      this.bSOFTKNEE.keyPart = "softknee";
      this.bSOFTKNEE.setSize(70, 30);
      this.bSOFTKNEE.setImages(res.bHARDKNEE_OFF, res.bSOFTKNEE_ON);
      this.bSOFTKNEE.valueFunc = function(a) {
        selectedStrip.type == E_STRIP_TYPE.MASTER && 1 == getValue("m.dyn.linked") && setValue(this.key.replace(".l.", ".r."), a);
        selectedStrip.setNameValue("dyn.prmod", 1)
      };
      this.syncSliders()
    },
    calcGeometry: function() {
      this.w = this.parent.w - this.x;
      this.h = this.parent.h - this.y - 5;
      this.dyn.setSize(this.w - this.dyn.x - 416, this.h - this.dyn.y -
        86);
      this.vuCOMP.x = this.w - 356;
      this.vuOUT.x = this.w - 380;
      this.vuIN.x = this.w - 404;
      this.vuIN.h = this.vuOUT.h = this.vuCOMP.h = this.h - this.vuIN.y - 86;
      var a = this.h - 47;
      this.led_tre.setPos(this.w - 406, a - 6);
      this.bSOFTKNEE.setPos(this.w - 316, a);
      this.bRESET.setPos(this.w - 202, a);
      this.bBYPASS.setPos(this.w - 90, a);
      a = HAVE_GATE ? 83 : 66;
      this.led_gate.x = this.w - (68 + 4 * a) - 4;
      this.led_ratio.x = this.w - (68 + 3 * a) - 4;
      this.led_attack.x = this.w - (68 + 2 * a) - 4;
      this.led_release.x = this.w - (68 + 1 * a) - 4;
      this.led_gain.x = this.w - (68 + 0 * a) - 4;
      this.led_gate.y =
        this.led_ratio.y = this.led_attack.y = this.led_release.y = this.led_gain.y = 46;
      this.slGAIN.x = this.w - (68 + 0 * a);
      this.slRELEASE.x = this.w - (68 + 1 * a);
      this.slATTACK.x = this.w - (68 + 2 * a);
      this.slRATIO.x = this.w - (68 + 3 * a);
      this.slGATE.x = this.w - (68 + 4 * a);
      this.slGAIN.y = this.slRELEASE.y = this.slATTACK.y = this.slRATIO.y = this.slGATE.y = 90;
      this.slATTACK.h = this.slRELEASE.h = this.slGAIN.h = this.slGATE.h = this.slRATIO.h = this.h - this.slGATE.y - 55 - 32;
      this.slTRE.y = this.h - 55;
      this.slTRE.w = this.w - this.slTRE.x - 416
    },
    paint: function() {
      ctx.fillStyle =
        color.eqBg;
      ctx.fillRect(0, 0, this.w, this.h);
      this.paintMarks();
      drawImage(res.dbx, this.preset.x - 48, 13)
    },
    paintMarks: function() {
      ctx.fillStyle = "#101115";
      ctx.fillRect(16, 10, this.w - 16 - 335, this.h - 10 - 60);
      ctx.translate(16, 10);
      ctx.fillStyle = color.grad1;
      ctx.fillRect(1, 0, this.w - 16 - 335 - 2, 7);
      ctx.translate(-16, -10);
      ctx.textAlign = "center";
      ctx.font = "10px open_sans_condensedbold";
      ctx.fillStyle = "#747577";
      ctx.fillText("IN", this.vuIN.x + 4, this.vuIN.y + this.vuIN.h + 15);
      ctx.fillText("OUT", this.vuOUT.x + 4, this.vuOUT.y + this.vuOUT.h +
        15);
      ctx.fillText("COMP", this.vuCOMP.x + 4, this.vuCOMP.y + this.vuCOMP.h + 15);
      ctx.fillStyle = color.tabText;
      ctx.font = font.eqSlText;
      ctx.textAlign = "left";
      var a = this.dyn.h,
        b = this.dyn.w,
        c = b / 96,
        d = a / 96;
      ctx.font = font.eqMarks;
      ctx.fillStyle = color.graphMarks;
      var f = "-90 -80 -70 -60 -50 -40 -30 -20 -10 0 +6".split(" ");
      ctx.save();
      ctx.translate(this.dyn.x, this.dyn.y);
      ctx.fillText("-90", 0, a + 15);
      ctx.fillText("+6", b - 10, a + 15);
      ctx.textAlign = "center";
      for (var b = 1, e = 10; 90 >= e; e += 10) ctx.fillText(f[b++], c * e, a + 15);
      b = 1;
      ctx.textAlign =
        "right";
      ctx.fillText("-90", -5, a - 2);
      ctx.fillText("+6", -5, 9);
      for (e = 10; 90 >= e; e += 10) ctx.fillText(f[b++], -5, a - d * e + 4);
      ctx.restore()
    },
    paintMarks2: function() {
      var a = this.dyn.h,
        b = this.dyn.w,
        c = b / 96;
      ctx.font = font.eqMarks;
      ctx.fillStyle = color.graphMarks;
      getValue(this.keyPrefix + "gain");
      var d = [-90, -80, -70, -60, -50, -40, -30, -20, -10, 0, 6];
      ctx.save();
      ctx.translate(this.dyn.x, this.dyn.y);
      ctx.fillStyle = "#101115";
      ctx.fillRect(-10, a, b + 20, 20);
      ctx.fillStyle = color.graphMarks;
      ctx.textAlign = "center";
      ctx.fillText("6", b, a + 15);
      for (var f =
          b = 0; 90 >= f; f += 10) ctx.fillText(d[b++] - 0 + "", c * f, a + 15);
      ctx.restore()
    },
    showPresets: function() {
      this.menu = new PRESET_MENU2(null, this.prType, this, this.parent.color);
      regUpdate(this.menu)
    },
    savePreset: function(a) {
      var b = ".dyn.threshold .dyn.ratio .dyn.softknee .dyn.attack .dyn.outgain .dyn.release".split(" ");
      HAVE_GATE || b.push(".gate.thresh");
      var c = {},
        d;
      "dynm" == this.prType ? (b = ".dyn.linked .dyn.l.threshold .dyn.l.ratio .dyn.l.softknee .dyn.l.attack .dyn.l.release .dyn.l.outgain .dyn.r.threshold .dyn.r.ratio .dyn.r.softknee .dyn.r.attack .dyn.r.release .dyn.r.outgain".split(" "),
        HAVE_GATE || b.push(".gate.thresh"), d = "m") : (d = this.keyPrefix.split("."), d = d[0] + "." + d[1]);
      for (var f = 0; f < b.length; f++) {
        var e = getValue(d + b[f]);
        null != e && (c[b[f]] = e)
      }
      selectedStrip.setNameValue("dyn.prmod", 0);
      isDefined(a) && selectedStrip.setNameValue("dyn.prname", a);
      return c
    },
    loadPreset: function(a, b) {
      var c = selectedStrip.name.slice(0, -1);
      "dynm" == this.prType && (c = "m");
      applyPreset(c, a);
      selectedStrip.setNameValue("dyn.prmod", 0);
      isDefined(b) && selectedStrip.setNameValue("dyn.prname", b);
      regUpdate(this)
    }
  }),
  DYNVU = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.w = measures.vuWidth - 1;
      this.ignoreEvents = !0;
      this.invert = !1;
      this.fallVelocity = this.curPos = this.valueBg = this.value = 0;
      this.treValue = this.gateValue = -1;
      this.needGate = !1;
      this.timer = null;
      this.isClipping = !1;
      null == vuPattern && (vuPattern = createPattern(res.vuTexture, "repeat-y"));
      this.fillTexture = vuPattern;
      this.isTicking = !1;
      this.vuGrad = null;
      this.vuGradH = -1
    },
    setValue: function(a) {
      if (this.globalEnabled()) {
        this.valueBg = bound(a, 0, 4);
        var b = !1,
          c = !1;
        this.value < this.valueBg ?
          (this.value = this.valueBg, c = !0) : (this.fallVelocity = GLOBAL_VU_FALL_SPEED, b = !0);
        if (1 <= a && !this.invert) {
          this.isClipping = !0;
          var d = this;
          clearTimeout(this.timer);
          this.timer = setTimeout(function() {
            d.isClipping = !1;
            regUpdate(d)
          }, 1500)
        }
        b && !this.isTicking && (this.isTicking = !0, regTick(this));
        c && regUpdate(this)
      } else this.value = this.valueBg = bound(a, 0, 4)
    },
    reset: function() {
      this.valueBg = this.value = 0;
      regUpdate(this)
    },
    tick: function() {
      var a = !1,
        b = !1;
      if (this.value <= this.valueBg) this.value = this.valueBg;
      else {
        this.value -= this.fallVelocity;
        this.fallVelocity += GLOBAL_VU_FALL_SPEED / fps;
        this.value < this.valueBg ? this.value = this.valueBg : a = !0;
        var c = this.h * this.value | 0;
        c > this.h % 12 && (c = 12 * (c / 12 | 0) + this.h % 12);
        this.curPos != c && (b = !0)
      }
      a ? regTick(this) : this.isTicking = !1;
      b && regUpdate(this)
    },
    calcGeometry: function() {},
    createGradient: function() {
      this.vuGradH == this.h || 1 > this.h || (this.vuGrad = this.invert ? ctx.createLinearGradient(0, 0, 0, this.h) : ctx.createLinearGradient(0, this.h, 0, 0), this.vuGrad.addColorStop(0, "green"), this.vuGrad.addColorStop(.5, "yellow"), this.vuGrad.addColorStop(1,
        "red"), this.vuGradH = this.h)
    },
    paint: function() {
      this.needGate && (this.gateValue = selectedStrip.getNameValue("gate.thresh"), this.treValue = getValue(this.parent.keyPrefix + "threshold"));
      this.createGradient();
      ctx.fillStyle = "#101115";
      ctx.fillRect(-6, -4, this.w + 12, this.h + 8);
      ctx.fillStyle = color.vuBg;
      ctx.fillRect(0, 0, this.w, this.h);
      ctx.fillStyle = this.isClipping ? "#E83B45" : this.vuGrad;
      var a = this.h * this.value | 0;
      a > this.h % 12 && (a = a - a % 12 + (this.invert ? 0 : this.h % 12));
      this.curPos = a;
      a > this.h && (a = this.h);
      this.invert ? ctx.fillRect(0,
        0, this.w, a) : ctx.fillRect(0, this.h, this.w, -a);
      if (selectedStrip.getNameValue("gate.enabled") && !selectedStrip.getNameValue("gate.bypass") && .015 <= this.gateValue) {
        1 < this.gateValue && (this.gateValue = 1);
        ctx.fillStyle = color.green;
        var b = (VtoDYNGATE(this.gateValue) + VU_RANGE) / VU_RANGE,
          a = this.h * (1 - b) | 0;
        0 <= b && 1 > b && 1 <= a && a < this.h && (ctx.fillTriangle2(-6, a - 5, -1, a, -6, a + 5), ctx.fillTriangle2(this.w + 6, a - 5, this.w + 1, a, this.w + 6, a + 5));
        a = this.h * b | 0;
        a > this.h && (a = this.h);
        0 < a && (ctx.fillStyle = "rgba(0,0,0,0.6)", ctx.fillRect(0,
          this.h, this.w, -a))
      }
      this.needGate && (ctx.fillStyle = "rgba(150,150,255,0.55)", b = (VtoTHRESH(this.treValue) + VU_RANGE) / VU_RANGE, a = this.h * (1 - b) | 0, 0 <= b && 1 > b && 1 <= a && a < this.h && (ctx.fillTriangle2(-6, a - 4, -1, a, -6, a + 4), ctx.fillTriangle2(this.w + 6, a - 4, this.w + 1, a, this.w + 6, a + 4)));
      ctx.fillStyle = this.fillTexture;
      ctx.fillRect(0, 0, this.w, this.h);
      ctx.fillStyle = "#090C12";
      ctx.fillRect(0, this.h - 3, this.w, 3);
      ctx.fillRect(0, 0, this.w, 3)
    }
  }),
  DYN_GRAPH = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "DYN_GRAPH";
      this.needMoveEvt = this.needClip = !0;
      this.pressed = this.master = !1;
      this.idx = 1;
      this.touchID = -1;
      this.left = !0;
      this.touchRadius = 32;
      this.grad = null;
      this.gradW = 0;
      this.grad3 = this.grad2 = null;
      this.points = {
        G: [0, 0],
        T: [0, 0],
        R: [0, 0]
      };
      this.bypass = !1;
      this.colors = ["#b23535", "#c27a2a", "#c7ab35", "#2c8f29"];
      this.cachedBgBypass = this.cachedBg = null;
      this.cachedBgW = this.cachedBgH = 0;
      this.lastP = !1;
      this.delta = [0, 0];
      this.showPreset = !0
    },
    calcGeometry: function() {
      var a = this.w,
        b = this.h;
      this.grad = ctx.createRadialGradient(a / 2, -10, a / 10, a /
        2, -10, a / 2 + 10);
      this.grad.addColorStop(0, "rgba(255,255,255,0.2)");
      this.grad.addColorStop(1, "rgba(255,255,255,0)");
      this.grad2 = ctx.createLinearGradient(0, b, a / 2, 0);
      this.grad2.addColorStop(0, "rgba(0,160,255,0.4)");
      this.grad2.addColorStop(.5, "rgba(0,160,255,0.33)");
      this.grad2.addColorStop(1, "rgba(0,80,176,0.26)");
      this.grad3 = ctx.createLinearGradient(0, b, a / 2, 0);
      this.grad3.addColorStop(0, "rgba(160,160,160,0.4)");
      this.grad3.addColorStop(.5, "rgba(160,160,160,0.33)");
      this.grad3.addColorStop(1, "rgba(80,80,80,0.26)")
    },
    onDown: function(a, b, c) {
      this.pressed || (a -= this.globalX(), b -= this.globalY(), this.idx = 0, this.touchID = c, this.pressed = !0, this.delta = [0, 0], this.calcPoints(), isInCircle(this.points.R[0], this.points.R[1], 2 * this.touchRadius, a, b) && (this.idx = 2, this.delta = [this.points.R[0] - a, this.points.R[1] - b]), isInCircle(this.points.T[0], this.points.T[1], 2 * this.touchRadius, a, b) && (this.idx = 1, this.delta = [this.points.T[0] - a, this.points.T[1] - b]), 0 != this.idx && regUpdate(this))
    },
    onMove: function(a, b, c) {
      if (this.pressed && this.touchID ==
        c && 0 != this.idx) {
        a += this.delta[0];
        b += this.delta[1];
        a = bound(a - this.globalX(), 0, this.w);
        b = bound(b - this.globalY(), 0, this.h);
        switch (this.idx) {
          case 1:
            b = bound(a / this.w, 0, 1);
            this.parent.slTRE.innerSet(b);
            regUpdate(this.parent.vuIN);
            regUpdate(this.parent.led_tre);
            selectedStrip.setNameValue("dyn.prmod", 1);
            break;
          case 2:
            if (1 > this.points.T[1]) return;
            b = bound(b, 0, this.points.T[1]);
            b = bound(1 - b / this.points.T[1], 0, 1);
            this.parent.slRATIO.innerSet(b);
            regUpdate(this.parent.led_ratio)
        }
        regUpdate(this)
      }
    },
    onUp: function(a) {
      this.touchID ==
        a && (this.delta = [0, 0], a = Date.now(), a - this.lastClickTime < DBL_CLK_TIME && this.lastP == this.idx && (0 == this.idx && setMode(E_MODE.MIX), regUpdate(this)), this.lastP = this.idx, this.lastClickTime = a, this.pressed = !1, this.touchID = -1)
    },
    calcPoints: function() {
      var a = this.w,
        b = this.h,
        c = getValue(this.parent.keyPrefix + "threshold"),
        d = getValue(this.parent.keyPrefix + "ratio"),
        f = 0 * b;
      this.points.G[0] = 0;
      this.points.G[1] = bound(b - f, 0, b);
      f = b * (1 - c) - f;
      this.points.T[0] = bound(a * c, 0, a);
      this.points.T[1] = bound(f, 0, b);
      this.points.R[0] = a;
      this.points.R[1] =
        bound(f - b * (1 - c) * d, 0, b)
    },
    paint: function() {
      ctx.shadowColor = "transparent";
      this.bypass = selectedStrip.type == E_STRIP_TYPE.MASTER ? toBool(getValue("m.dyn.bypass")) : toBool(getValue(this.parent.keyPrefix + "bypass"));
      this.cachedBgW == this.w && this.cachedBgH == this.h || this.cachePaint();
      drawImage(this.cachedBg, 0, 0, this.w, this.h);
      var a = this.w,
        b = this.h,
        c = this.h / 96,
        d = getValue(this.parent.keyPrefix + "threshold"),
        f = getValue(this.parent.keyPrefix + "ratio"),
        e = getValue(this.parent.keyPrefix + "softknee"),
        g = a * d;
      1 > g && (g = 1);
      var h =
        b * (1 - d) - 0;
      h > b - 2 && (h = b - 2);
      var l = b - b * (0 + d + (1 - d) * f);
      l > b - 2 && (l = b - 2);
      ctx.strokeStyle = "rgba(255,255,250,0.15)";
      ctx.lineWidth = 2;
      ctx.beginPath();
      ctx.moveTo(a * d, b);
      ctx.lineTo(a * d, 0);
      ctx.stroke();
      ctx.strokeStyle = "rgba(117,206,210,1.0)";
      this.bypass && (ctx.strokeStyle = "#999");
      ctx.lineWidth = 2;
      if (e) {
        var e = a * d * 1,
          d = b * (1 - 1 * d) - 0,
          m = g + .01 * (a - g),
          f = h - (b - h - 0) * f * .01;
        ctx.strokeStyle = "rgba(255,255,255,0.3)";
        ctx.lineWidth = 1;
        ctx.beginPath();
        ctx.moveTo(0, b);
        ctx.lineTo(g, h);
        ctx.stroke();
        ctx.beginPath();
        ctx.moveTo(g, h);
        ctx.lineTo(a,
          l);
        ctx.stroke();
        ctx.strokeStyle = "rgba(117,206,210,1.0)";
        ctx.lineWidth = 2;
        this.bypass && (ctx.strokeStyle = "white");
        ctx.beginPath();
        ctx.moveTo(0, b);
        ctx.bezierCurveTo(e, d, m, f, a, l)
      } else ctx.beginPath(), ctx.moveTo(0, b), ctx.lineTo(g, h), ctx.stroke(), ctx.beginPath(), ctx.moveTo(g, h), ctx.lineTo(a, l);
      ctx.stroke();
      ctx.lineTo(a, b);
      ctx.lineTo(0, b);
      ctx.fillStyle = this.bypass ? this.grad3 : this.grad2;
      ctx.fill();
      this.drawCircle(g, bound(h, 0, this.h), 1 == this.idx, 1, !1);
      this.drawCircle(a - 6, bound(l, 0, this.h - 0), 2 == this.idx, 2, !1);
      ctx.textAlign = "center";
      ctx.font = "bold 14px open_sans_condensedbold";
      ctx.fillStyle = "#060606";
      ctx.fillText("T", g + 1, bound(h, 0, this.h) + 5 + 1);
      ctx.fillText("R", a - 8 + 1, bound(l, 0, this.h - 0) + 5 + 1);
      ctx.fillStyle = "#f0f0f0";
      ctx.fillText("T", g, bound(h, 0, this.h) + 5);
      ctx.fillText("R", a - 8, bound(l, 0, this.h - 0) + 5);
      selectedStrip.getNameValue("gate.enabled") && !selectedStrip.getNameValue("gate.bypass") && (a = selectedStrip.getNameValue("gate.thresh"), b = selectedStrip.getNameValue("gate.depth"), a = VtoGATE_THRESH(a), b = VtoGATE_DEPTH(b),
        g = c * (90 + a), ctx.fillStyle = "rgba(10,58,36,0.3)", ctx.fillRect(0, this.h, this.w, -g), h = bound(c * -b, 0, g), -59.9999 >= b && (h = g), ctx.fillStyle = "rgba(10,58,36,0.5)", ctx.fillRect(0, this.h, this.w, -h), ctx.fillStyle = "rgba(90,218,114,0.4)", ctx.fillRect(0, this.h - c * (90 + a), this.w, 2));
      ctx.lineWidth = 1;
      ctx.strokeStyle = "#222";
      ctx.strokeRect(.5, .5, this.w - 1, this.h - 1);
      this.showPreset && (ctx.textAlign = "left", ctx.fillStyle = 1 == selectedStrip.getNameValue("dyn.prmod") ? "#444" : color.green, ctx.font = "18px open_sans_condensedbold", ctx.fillText(selectedStrip.getNameValue("dyn.prname"),
        4, 18, this.w - 10))
    },
    drawCircle: function(a, b, c, d, f) {
      c ? (ctx.fillStyle = "rgba(255,80,80,0.95)", ctx.strokeStyle = "rgba(200,0,0,0.6)", ctx.lineWidth = 3) : (ctx.fillStyle = "rgba(80,255,80,0.95)", ctx.strokeStyle = "rgba(255,255,255,0.5)", ctx.lineWidth = 2);
      ctx.fillStyle = this.colors[d];
      ctx.strokeStyle = this.colors[d];
      this.bypass && (ctx.fillStyle = "rgba(255,255,255,0.4)", ctx.strokeStyle = "rgba(255,255,255,0.3)");
      ctx.beginPath();
      ctx.arc(a, b, 13 + (f ? 10 : 0), 0, 2 * Math.PI);
      ctx.fill();
      ctx.beginPath();
      ctx.arc(a, b, this.touchRadius + (f ?
        12 : 0), 0, 2 * Math.PI);
      ctx.globalAlpha = .38;
      ctx.fill();
      ctx.globalAlpha = 1;
      c && ctx.stroke()
    },
    cachePaint: function() {
      null != this.cachedBg && delete this.cachedBg;
      this.cachedBg = document.createElement("canvas");
      var a = this.cachedBg.getContext("2d");
      isRetina ? (this.cachedBg.width = 2 * this.w, this.cachedBg.height = 2 * this.h, a.scale(2, 2)) : (this.cachedBg.width = this.w, this.cachedBg.height = this.h);
      var b = this.w,
        c = this.h,
        d = this.w / 96,
        f = this.h / 96;
      a.fillStyle = "#0A0B0C";
      a.fillRect(0, 0, b, c);
      isSmall || (a.fillStyle = this.grad, a.fillRect(0,
        0, b, c));
      a.strokeStyle = "rgba(255,255,255,0.04)";
      a.lineWidth = 1;
      a.beginPath();
      for (var e = 0; 90 >= e; e += 10) a.moveTo((d * e | 0) + .5, 0), a.lineTo((d * e | 0) + .5, c), a.moveTo(0, (c - f * e | 0) + .5), a.lineTo(b, (c - f * e | 0) + .5);
      a.stroke();
      this.cachedBgW = this.w;
      this.cachedBgH = this.h
    }
  });
percentFormula = function(a) {
  return 100 * a | 0
};
percent2Formula = function(a) {
  return 200 * a | 0
};
maxxRangeFormula = function(a) {
  return 60 * a + 20 | 0
};
hertzFormula = function(a) {
  return formatFreq(20 * Math.pow(1102.5, a))
};
hertzFormula320 = function(a) {
  return formatFreq(20 * Math.pow(16, a))
};
hpfFormula = function(a) {
  return formatFreq(20 * Math.pow(250, a))
};
lpfFormula = function(a) {
  return formatFreq(400 * Math.pow(55.125, a))
};
lenFormula = function(a) {
  return 300 * Math.pow(8 / .3, a) | 0
};
lenFormulaRoom = function(a) {
  return 100 * Math.pow(10, a) | 0
};

function VtoDETUNE(a) {
  return -100 + 200 * a | 0
}

function strDelayRatio(a) {
  if (.01 > Math.abs(a - 1)) return "1/1";
  if (.01 > Math.abs(a - 2)) return "2/1";
  if (.01 > Math.abs(a - .333)) return "1/3";
  if (.01 > Math.abs(a - .666)) return "2/3";
  if (.01 > Math.abs(a - 1.333)) return "4/3";
  for (var b = [1, 2, 3, 4, 6, 8, 12, 16, 18, 32, 0], c = 1; 3 >= c; c++)
    for (var d = 0; 0 != b[d]; d++) {
      var f = b[d];
      if (.005 > Math.abs(a - c / f)) return c + "/" + f
    }
  a = "" + (1E3 * a | 0) / 10; - 1 == a.indexOf(".") && (a += ".0");
  return a + "%"
}
var FX_SENDS_EDIT_PAGE = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "FX_SENDS_EDIT_PAGE";
      this.y = 40;
      this.color = color.blue;
      this.mode = 0;
      this.SLIDERS = [];
      this.LEDS = [];
      this.BUTTONS = [];
      this.MUTES = [];
      this.VUS = [];
      this.VUS2 = [];
      this.CLIPS = [];
      this.CLIPS2 = [];
      this.initWidgets();
      this.setMode(0)
    },
    calcGeometry: function() {
      this.w = this.parent.w;
      this.h = this.parent.h - this.y - 5;
      for (var a = selectedStrip.type == E_STRIP_TYPE.MASTER, b = 0; b < this.SLIDERS.length; b++) {
        var c = 30 + 90 * b;
        this.SLIDERS[b].x =
          c + (a ? 13 : 0);
        this.SLIDERS[b].h = this.h - this.SLIDERS[b].y - 66;
        this.BUTTONS[b].y = this.h - 50;
        this.VUS[b].setPos(c - 14 + (a ? 13 : 0), this.SLIDERS[b].y + 18);
        this.VUS[b].setSize(11, this.SLIDERS[b].h - 20);
        this.VUS2[b].setPos(c - 27 + (a ? 13 : 0), this.SLIDERS[b].y + 18);
        this.VUS2[b].setSize(11, this.SLIDERS[b].h - 20);
        this.CLIPS[b].setPos(c - 19 + (a ? 13 : 0), this.SLIDERS[b].y - 4);
        this.CLIPS2[b].setPos(c - 33 + (a ? 13 : 0), this.SLIDERS[b].y - 4)
      }
    },
    setMode: function(a) {
      this.mode = a;
      fxoutWidget.setFx(a);
      fxSendsWidget.setMode(a);
      this.fx.setMode(a);
      regUpdate(this)
    },
    onShow: function() {
      this.syncSliders()
    },
    onDown: function(a, b) {
      this.lastPressPoint = this.pressPoint;
      this.pressPoint = [a, b]
    },
    onUp: function(a) {
      var b = Date.now(),
        c = Math.abs(this.lastPressPoint[0] - this.pressPoint[0]),
        d = Math.abs(this.lastPressPoint[1] - this.pressPoint[1]);
      2 < mouseTargets.length || isDefined(tHash[a]) && 2 < tHash[a].length || (30 > c && 30 > d && b - this.lastClickTime < DBL_CLK_TIME ? (this.onDouble(), this.lastClickTime = b - DBL_CLK_TIME) : this.lastClickTime = b)
    },
    onDouble: function() {
      setMode(E_MODE.MIX)
    },
    syncSliders: function() {
      if (null !=
        selectedStrip) {
        this.setMode(this.mode);
        for (var a = 0; a < this.SLIDERS.length; a++) this.VUS[a].enabled = !1, this.VUS2[a].enabled = !1, this.CLIPS[a].enabled = !1, this.CLIPS2[a].enabled = !1;
        switch (selectedStrip.type) {
          case E_STRIP_TYPE.IN:
          case E_STRIP_TYPE.SUB:
          case E_STRIP_TYPE.MEDIA:
          case E_STRIP_TYPE.LINEIN:
            for (a = 0; a < this.SLIDERS.length; a++) this.SLIDERS[a].enabled = this.LEDS[a].enabled = this.MUTES[a].enabled = this.BUTTONS[a].enabled = !0;
            this.keyPrefix = selectedStrip.name + "fx.";
            for (a = 0; a < this.SLIDERS.length; a++) this.SLIDERS[a].setKey(this.keyPrefix +
              a + ".value"), this.LEDS[a].setKey(this.keyPrefix + a + ".value"), this.MUTES[a].setKey(this.keyPrefix + a + ".mute"), this.MUTES[a].img0 = res.bMuteOff, this.SLIDERS[a].fader = this.SLIDERS[a].defaultFader, this.VUS[a].enabled = !1, this.VUS2[a].enabled = !1, this.CLIPS[a].enabled = !1, this.CLIPS2[a].enabled = !1;
            break;
          case E_STRIP_TYPE.FX:
            for (a = 0; a < this.SLIDERS.length; a++) this.SLIDERS[a].enabled = this.LEDS[a].enabled = this.MUTES[a].enabled = this.BUTTONS[a].enabled = !1;
            isDefined(this.BUTTONS[selectedStrip.subId]) && (this.BUTTONS[selectedStrip.subId].enabled = !0);
            var b = bound(selectedStrip.id - fxStrips[0].id, 0, curSetup.fx - 1);
            this.setMode(b);
            break;
          case E_STRIP_TYPE.AUX:
            for (a = 0; a < this.SLIDERS.length; a++) this.SLIDERS[a].enabled = this.LEDS[a].enabled = this.MUTES[a].enabled = this.BUTTONS[a].enabled = !0;
            b = bound(selectedStrip.id - auxStrips[0].id, 0, curSetup.aux - 1);
            for (a = 0; a < this.SLIDERS.length; a++) this.keyPrefix = "f." + a + ".aux." + b, this.SLIDERS[a].setKey(this.keyPrefix + ".value"), this.LEDS[a].setKey(this.keyPrefix + ".value"), this.MUTES[a].setKey(this.keyPrefix + ".mute"), this.MUTES[a].img0 =
              res.bMuteOff, this.SLIDERS[a].fader = this.SLIDERS[a].defaultFader;
            break;
          case E_STRIP_TYPE.MASTER:
            for (a = 0; a < this.SLIDERS.length; a++) this.SLIDERS[a].enabled = this.LEDS[a].enabled = this.MUTES[a].enabled = this.BUTTONS[a].enabled = !0;
            for (a = 0; a < this.SLIDERS.length; a++) this.keyPrefix = "f." + a, this.SLIDERS[a].setKey(this.keyPrefix + ".mix"), this.LEDS[a].setKey(this.keyPrefix + ".mix"), this.MUTES[a].setKey(this.keyPrefix + ".mute"), this.MUTES[a].kkk = this.keyPrefix, this.MUTES[a].getState = function() {
              if (selectedStrip.type ==
                E_STRIP_TYPE.MASTER) {
                var a = getValue("mgmask"),
                  b = getValue(this.kkk + ".mgmask"),
                  f = checkBit(a, MUTEFX_BIT_IDX),
                  e = checkBit(a, MUTEALL_BIT_IDX);
                if (a & b || e || f) this.state = 1;
                1 == getValue(this.kkk + ".forceunmute") ? (this.state = 0, this.img0 = res.bMuteOff_F) : this.img0 = res.bMuteOff
              }
            }, this.MUTES[a].onToggleUp = function() {
              if (selectedStrip.type == E_STRIP_TYPE.MASTER) {
                var a = getValue("mgmask"),
                  b = getValue(this.kkk + ".mgmask"),
                  b = a & b,
                  f = checkBit(a, MUTEALL_BIT_IDX),
                  a = checkBit(a, MUTEFX_BIT_IDX);
                b || f || a || setValue(this.kkk + ".mute", 1);
                setValue(this.kkk + ".forceunmute", 0)
              }
            }, this.MUTES[a].onToggleDown = function() {
              if (selectedStrip.type == E_STRIP_TYPE.MASTER) {
                var a = getValue("mgmask"),
                  b = getValue(this.kkk + ".mgmask"),
                  b = a & b,
                  f = checkBit(a, MUTEALL_BIT_IDX),
                  a = checkBit(a, MUTEFX_BIT_IDX);
                b || f || a ? setValue(this.kkk + ".forceunmute", 1) : setValue(this.kkk + ".mute", 0)
              }
            }, this.MUTES[a].onToggle = function() {
              selectedStrip.type == E_STRIP_TYPE.MASTER && checkMutes()
            }, this.SLIDERS[a].fader = res.blueFader, this.VUS[a].enabled = !0, this.VUS2[a].enabled = !0, this.CLIPS[a].enabled = !0, this.CLIPS2[a].enabled = !0
        }
        this.calcGeometry()
      }
    },
    initWidgets: function() {
      var a = this;
      this.fx = new FX_SETUP(this);
      for (var b = 0; b < fxStrips.length; b++) {
        var c = new AUX_LED(this);
        c.setPos(20 + 90 * b - 5, 38);
        this.LEDS.push(c);
        c = new CheckBox(this);
        c.setPos(90 * b + 30, 76);
        c.setImages(res.bMuteOff, res.bMuteOn);
        c.getState = function() {
          this.disabled = 1 == selectedStrip.getNameValue("matrix")
        };
        this.MUTES.push(c);
        c = new VUMeter(this);
        c.setPos(30 + 90 * b, 118);
        c.calcGeometry = function() {};
        this.VUS.push(c);
        c = new VUMeter(this);
        c.calcGeometry =
          function() {};
        this.VUS2.push(c);
        c = new ClipBulb(this);
        this.CLIPS.push(c);
        c = new ClipBulb(this);
        this.CLIPS2.push(c);
        c = new EQSlider(this);
        switch (b) {
          case 0:
            c.fader = res.eqVFaderBlue;
            break;
          case 1:
            c.fader = res.eqVFaderOrange;
            break;
          case 2:
            c.fader = res.eqVFaderPurple;
            break;
          case 3:
            c.fader = res.eqVFaderGreen
        }
        c.defaultFader = c.fader;
        c.dbMarks = !0;
        c.setPos(30 + 90 * b, 118);
        c.mode = b;
        c.onFocus = function() {
          a.setMode(this.mode)
        };
        c.onValueChange = function() {
          regUpdate(a.LEDS[this.mode])
        };
        HAVE_MATRIX && (c.getState = function() {
          this.disabled =
            1 == selectedStrip.getNameValue("matrix")
        });
        this.SLIDERS.push(c);
        c = new EQButton(this);
        c.mode = b;
        c.setPos(20 + 90 * b, 89);
        c.getState = function() {
          if ("undefined" != typeof this.parent.mode) {
            this.state = this.parent.mode == this.mode;
            switch (this.mode) {
              case 0:
                this.setImages(res.FX_BTN_OFF, res.FX_BTN_BLU);
                break;
              case 1:
                this.setImages(res.FX_BTN_OFF, res.FX_BTN_OR);
                break;
              case 2:
                this.setImages(res.FX_BTN_OFF, res.FX_BTN_PUR);
                break;
              case 3:
                this.setImages(res.FX_BTN_OFF, res.FX_BTN_GR)
            }
            switch (fxStrips[this.mode].getNameValue("fxtype")) {
              case E_FX.REVERB:
                this.text =
                  lang.REVERB;
                break;
              case E_FX.DELAY:
                this.text = lang.DELAY;
                break;
              case E_FX.CHORUS:
                this.text = lang.CHORUS;
                break;
              case E_FX.ROOM:
                this.text = lang.ROOM
            }
          }
        };
        c.setSize(70, 30);
        var d = [
          [E_FX.REVERB],
          [E_FX.DELAY],
          [E_FX.CHORUS],
          [E_FX.ROOM, E_FX.DELAY]
        ];
        IS_UI_24 && (d = [
          [E_FX.REVERB],
          [E_FX.REVERB, E_FX.DELAY],
          [E_FX.DELAY, E_FX.CHORUS],
          [E_FX.ROOM, E_FX.DELAY]
        ]);
        var f = [lang.REVERB, lang.DELAY, lang.CHORUS, lang.ROOM],
          d = d[b];
        1 < d.length && (c.longClickMark = !0, c.fxs = d, c.onHold = function() {
          for (var b = [], c = 0; c < this.fxs.length; c++) b.push(f[this.fxs[c]]);
          c = new CONTEXT_MENU(null);
          c.fxs = this.fxs;
          c.setItems(b);
          c.setPos(this.globalX(), this.globalY() - c.h);
          c.valueFunc = function(b) {
            var c = fxStrips[a.mode].name;
            b = this.fxs[b];
            setValue(c + "bypass", 1);
            setValue(c + "fxtype", b);
            resetFX(c.slice(0, -1));
            setValue(c + "bypass", 0);
            regUpdate(a);
            a.onShow()
          };
          regUpdate(c)
        });
        this.BUTTONS.push(c)
      }
    },
    paint: function() {
      ctx.fillStyle = color.eqBg;
      ctx.fillRect(0, 0, this.w, this.h);
      var a = ctx.createLinearGradient(0, 0, this.w, 0);
      a.addColorStop(0, color.blue);
      a.addColorStop(.4, "transparent");
      a.addColorStop(.6,
        "transparent");
      a.addColorStop(1, color.blue);
      ctx.fillStyle = a;
      a = this.w / 2 | 0;
      selectedStrip.type == E_STRIP_TYPE.MASTER && ctx.fillRect(0, 0, a, 32);
      ctx.fillStyle = color.labelText;
      ctx.font = "bold 16pt open_sans_condensedbold";
      ctx.textAlign = "start";
      a = selectedStrip.getName();
      switch (selectedStrip.type) {
        case E_STRIP_TYPE.IN:
        case E_STRIP_TYPE.MEDIA:
        case E_STRIP_TYPE.SUB:
        case E_STRIP_TYPE.LINEIN:
          ctx.fillStyle = color.labelText;
          var b = lang.FX_SENDS + ": ";
          ctx.fillText(b, 15, 24);
          ctx.fillStyle = selectedStrip.color;
          ctx.fillText(a,
            15 + textWidth(b), 24, 260);
          break;
        case E_STRIP_TYPE.AUX:
          ctx.fillStyle = color.labelText;
          b = lang.FX_RETURNS_TO_AUX.format("");
          ctx.fillText(b, 15, 24);
          ctx.fillStyle = color.AUX;
          ctx.fillText(a, 15 + textWidth(b), 24, 220);
          break;
        case E_STRIP_TYPE.MASTER:
          b = lang.MASTER, ctx.fillStyle = color.black, ctx.fillText(b, 16, 25), ctx.fillStyle = "#D07979", ctx.fillText(b, 15, 24), a = 15 + textWidth(b) + 6, ctx.fillStyle = color.black, ctx.fillText(lang.FX_RETURNS, a + 1, 25), ctx.fillStyle = color.labelText, ctx.fillText(lang.FX_RETURNS, a, 24)
      }
    }
  }),
  FX_SETUP =
  Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "FX_SETUP";
      this.w = 400;
      this.bgColor2 = "#25262A";
      this.st = null;
      this.type = this.mode = 0;
      this.setAnchors(null, 0, 0, 0);
      this.initWidgets()
    },
    setMode: function(a) {
      this.mode = a;
      var b = res.eqVFaderBlue;
      switch (a) {
        case 0:
          b = res.fxFader_b;
          this.color = color.blue;
          break;
        case 1:
          b = res.fxFader_o;
          this.color = color.orange;
          break;
        case 2:
          b = res.fxFader_p;
          this.color = color.purple;
          break;
        case 3:
          b = res.fxFader_g, this.color = color.green
      }
      for (var c = 0; c < this.PARAM_SLIDERS.length; c++) this.PARAM_SLIDERS[c].fader =
        b;
      this.rack.setMode(a);
      this.st = fxStrips[a];
      a = this.st.getNameValue("fxtype");
      this.viewParams(a);
      regUpdate(this)
    },
    viewParams: function(a) {
      var b = this;
      this.type = a;
      var c = [lang.REVERB_TIME, lang.HF_DAMPING, lang.BASS_GAIN, lang.LOWPASS_FILTER, lang.HIGHPASS_FILTER],
        d = ["ms", "%", "%", "HZ", "HZ"],
        f = ["TIME", "HF", "BASS", "LPF", "HPF"],
        e = [lang.DELAY_LENGTH, lang.LENGTH_SUBDIVISION, lang.FEEDBACK_AMOUNT, lang.LOWPASS_FILTER],
        g = ["", "", "%", "HZ"],
        h = ["TIME", "DIV", "FBACK", "LPF"],
        l = [lang.DETUNE, lang.DENSITY, lang.LOWPASS_FILTER],
        m = ["c", "%", "HZ"],
        n = ["DETUNE", "DENSITY", "LPF"];
      this.bTAP.hide();
      this.TAP_LED.hide();
      this.MS_LED.hide();
      this.PARAM_LEDS[1].clickMark = !1;
      this.PARAM_LEDS[1].onDown = function() {};
      for (var p = 0; p < this.PARAM_SLIDERS.length; p++) this.PARAM_SLIDERS[p].hide(), this.PARAM_LEDS[p].hide();
      switch (a) {
        case E_FX.REVERB:
        case E_FX.ROOM:
          for (p = 0; p < c.length; p++) this.PARAM_SLIDERS[p].textBot = c[p], this.PARAM_SLIDERS[p].show(), this.PARAM_LEDS[p].label = f[p], this.PARAM_LEDS[p].sign = d[p], this.PARAM_LEDS[p].show();
          this.PARAM_LEDS[0].formatValue =
            a == E_FX.ROOM ? lenFormulaRoom : lenFormula;
          this.PARAM_LEDS[1].formatValue = percentFormula;
          this.PARAM_LEDS[2].formatValue = percentFormula;
          this.PARAM_LEDS[3].formatValue = lpfFormula;
          this.PARAM_LEDS[4].formatValue = hpfFormula;
          break;
        case E_FX.DELAY:
          for (p = 0; p < e.length; p++) this.PARAM_SLIDERS[p].textBot = e[p], this.PARAM_SLIDERS[p].show(), this.PARAM_LEDS[p].label = h[p], this.PARAM_LEDS[p].sign = g[p], this.PARAM_LEDS[p].show();
          this.TAP_LED.show();
          this.MS_LED.show();
          this.PARAM_LEDS[0].formatValue = function(a) {
            regUpdate(b.PARAM_LEDS[1]);
            return 0 === a ? "*DIV*" : (100 * Math.pow(10, desqr(a)) | 0) + "MS"
          };
          this.PARAM_LEDS[1].formatValue = function(a) {
            return 0 == getValue(b.st.name + "par1") ? strDelayRatio(2 * a) : "---"
          };
          this.PARAM_LEDS[1].clickMark = !0;
          this.PARAM_LEDS[1].onDown = function() {
            var a = new CONTEXT_MENU(null);
            a.setItems("2/1 1/1 3/4 2/3 1/2 1/3 1/4 1/6 1/8 1/16 1/32".split(" "));
            a.w = 47;
            a.setPos(this.globalX() + 13, this.globalY() + this.h + 1);
            a.doFunc = function(a) {
              a = eval(a);
              a = bound(a / 2, 0, 1);
              setValue(b.st.name + "par2", a);
              setValue(b.st.name + "par1", 0);
              regUpdate(b)
            };
            regUpdate(a)
          };
          this.PARAM_LEDS[2].formatValue = percentFormula;
          this.PARAM_LEDS[3].formatValue = hertzFormula;
          this.TAP_LED.setKey("f." + this.mode + ".bpm");
          this.MS_LED.key2 = "f." + this.mode + ".";
          this.MS_LED.unRegAllKeys();
          this.MS_LED.regKey("f." + this.mode + ".bpm");
          break;
        case E_FX.CHORUS:
          for (p = 0; p < l.length; p++) this.PARAM_SLIDERS[p].textBot = l[p], this.PARAM_SLIDERS[p].show(), this.PARAM_LEDS[p].label = n[p], this.PARAM_LEDS[p].sign = m[p], this.PARAM_LEDS[p].show();
          this.PARAM_LEDS[0].formatValue = VtoDETUNE;
          this.PARAM_LEDS[1].formatValue =
            percentFormula;
          this.PARAM_LEDS[2].formatValue = lpfFormula;
          break;
        default:
          regUpdate(this);
          return
      }
      a = fxStrips[this.mode].name;
      for (p = 0; p < this.PARAM_SLIDERS.length; p++) this.PARAM_SLIDERS[p].setKeyPrefix(a), this.PARAM_LEDS[p].setKeyPrefix(a);
      regUpdate(this)
    },
    initWidgets: function() {
      var a = this;
      this.rack = new FXRACK(this);
      this.rack.y = 34;
      this.bTAP = new Button(this);
      this.bTAP.setImages(res.bTAPT_OFF, res.bTAPT_ON);
      this.bTAP.setPos(400, 7);
      this.bTAP.hide();
      this.bTAP.idx = 1;
      this.bTAP.valueFunc = function() {
        bpmTapHandler(a.mode)
      };
      this.bTAP.longClickMark = !0;
      this.bTAP.onHold = function() {
        askBpm(a.mode)
      };
      this.TAP_LED = new FXLED2(this);
      this.TAP_LED.formatValue = function(a) {
        return a | 0
      };
      this.TAP_LED.label = "BPM";
      this.TAP_LED.sign = "";
      this.TAP_LED.hide();
      this.MS_LED = new FXLED2(this);
      this.MS_LED.formatValue = function(a) {
        return precision(a, 1)
      };
      this.MS_LED.label = "MS";
      this.MS_LED.sign = "";
      this.MS_LED.key2 = "";
      this.MS_LED.getState = function() {
        this.value = 6E4 / getValue(this.key2 + "bpm")
      };
      this.MS_LED.hide();
      this.PARAM_LEDS = [];
      this.PARAM_SLIDERS = [];
      for (var b = 0; 5 > b; b++) {
        var c = new EQSlider(this);
        c.keyPart = "par" + (b + 1);
        c.w += 2;
        c.faderX = 0;
        c.fadd = 0;
        PATTERNED || (c.background = this.bgColor2);
        c.setFader(res.fxFader, 11);
        c.setPos(0, 100);
        c.idx = b;
        c.valueFunc = function() {
          regUpdate(a.PARAM_LEDS[this.idx]);
          switch (a.type) {
            case E_FX.DELAY:
              0 === this.idx && regUpdate(a.PARAM_LEDS[1])
          }
        };
        this.PARAM_SLIDERS.push(c);
        c = new FXLED2(this);
        c.keyPart = "par" + (b + 1);
        this.PARAM_LEDS.push(c)
      }
    },
    calcGeometry: function() {
      this.rack.setPos(this.w - this.rack.w, 34);
      for (var a = 0; a < this.PARAM_LEDS.length; a++) this.PARAM_LEDS[a].setPos(this.w -
        80 * (this.PARAM_LEDS.length - a) - 11 + 15, 127), this.PARAM_SLIDERS[a].setPos(this.w - 80 * (this.PARAM_SLIDERS.length - a) + 15, 172), this.PARAM_SLIDERS[a].h = this.h - this.PARAM_SLIDERS[a].y - 60;
      this.TAP_LED.setPos(this.w - 80 - 1 + 5, 127);
      this.MS_LED.setPos(this.w - 80 - 1 + 5, 177);
      this.bTAP.setPos(this.w - 80 - 13, 172)
    },
    showPresets: function() {
      var a = "fxrev";
      switch (this.st.getNameValue("fxtype")) {
        case E_FX.REVERB:
          a = "fxrev";
          break;
        case E_FX.DELAY:
          a = "fxdel";
          break;
        case E_FX.CHORUS:
          a = "fxcho";
          break;
        case E_FX.ROOM:
          a = "fxroom"
      }
      this.menu = new PRESET_MENU2(null,
        a, this, this.color);
      this.menu.center = !0;
      this.menu.calcGeometry();
      regUpdate(this.menu)
    },
    loadPreset: function(a, b) {
      var c = this.st.name.slice(0, -1);
      applyPreset(c, a);
      this.st.setNameValue("prname", b);
      regUpdate(this)
    },
    savePreset: function(a) {
      for (var b = this.st.name.slice(0, -1), c = ".par1 .par2 .par3 .par4 .par5 .par6".split(" "), d = {}, f = 0; f < c.length; f++) d[c[f]] = getValue(b + c[f]);
      this.st.setNameValue("prname", a);
      return d
    },
    paint: function() {
      ctx.fillStyle = PATTERNED ? color.eqBg : "#25262A";
      ctx.fillRect(0, 0, this.w, this.h);
      ctx.textAlign = "right";
      ctx.font = "bold 16pt open_sans_condensedbold";
      var a = lang.PARAM_GLOBAL.format("");
      ctx.fillStyle = color.black;
      ctx.fillText(a, this.w - 18 + 1, 25);
      ctx.fillStyle = color.labelText;
      ctx.fillText(a, this.w - 18, 24);
      var b = fxStrips[this.mode].getName(),
        a = this.w - 18 - textWidth(a);
      ctx.fillStyle = color.black;
      ctx.fillText(b, a + 1, 25);
      ctx.fillStyle = "#76A8D6";
      ctx.fillText(b, a, 24);
      ctx.textAlign = "start"
    }
  }),
  CONTEXT_MENU = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "CONTEXT_MENU";
      this.items = [];
      this.w = 100;
      this.h = 90;
      this.needClip = !0;
      this.ih = 36;
      this.font = "16px open_sans_condensedbold";
      this.bg = "#262728";
      this.borderColor = "#676869";
      this.selected = -1;
      mWidgets.push(widgets.pop())
    },
    setItems: function(a) {
      this.items = a;
      this.h = this.items.length * this.ih;
      regUpdate(this)
    },
    doFunc: function(a) {
      log(this.widgetName + " DOFUNC: " + a)
    },
    valueFunc: function(a) {},
    onDown: function(a, b) {
      var c = b - this.globalY();
      this.selected = bound(Math.floor(c / this.ih), 0, this.items.length - 1);
      regUpdate(this)
    },
    onUp: function() {
      this.doFunc(this.items[this.selected]);
      this.valueFunc(this.selected);
      this.close()
    },
    calcGeometry: function() {},
    close: function() {
      this.enabled = !1;
      clearModals()
    },
    paint: function() {
      ctx.fillStyle = this.bg;
      ctx.strokeStyle = this.borderColor;
      ctx.roundRect(0, 0, this.w, this.h, 14);
      ctx.fill();
      ctx.stroke();
      ctx.font = this.font;
      ctx.textAlign = "left";
      ctx.textBaseline = "middle";
      for (var a = this.ih / 2 | 0, b = 0; b < this.items.length; b++) {
        var c = b * this.ih;
        ctx.fillStyle = this.selected == b ? color.red : color.white;
        ctx.fillText(this.items[b], 8, c + a, this.w - 10);
        b < this.items.length - 1 &&
          (ctx.fillStyle = "rgba(255,255,255,0.1)", ctx.fillRect(0, c + this.ih, this.w, -1))
      }
    }
  }),
  FXLED2 = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "FX-LED2";
      this.bg = res.fxLEDb;
      this.w = this.bg.w();
      this.h = this.bg.h();
      this.label = "PAR";
      this.sign = "%";
      this.v1 = "0";
      this.clickMark = !1;
      this.value = "";
      this.bgColor = PATTERNED ? color.black : color.eqBg2
    },
    setValue: function(a, b) {
      switch (a) {
        case 1:
          this.v1 = precision(b, 1) + ""
      }
      regUpdate(this)
    },
    formatValue: function(a) {
      return 100 * a | 0
    },
    standartFormat: function(a) {
      return 100 *
        a | 0
    },
    getState: function() {
      this.value = getValue(this.key)
    },
    paint: function() {
      this.getState();
      ctx.fillStyle = this.bgColor;
      ctx.fillRect(0, 0, this.w, this.h);
      drawImage(this.bg, 0, 0);
      this.clickMark && (ctx.fillStyle = color.white, ctx.fillTriangle(this.w - 12, 5, 3, 4));
      var a = this.w / 2 | 0;
      ctx.fillStyle = color.ledText;
      ctx.textAlign = "center";
      ctx.font = "16px umixled";
      ctx.fillText(this.label, a, 18);
      ctx.fillText(this.formatValue(this.value) + this.sign, a, 35, this.w - 10)
    }
  }),
  FXLEDPlain = Class.create(Widget, {
    initialize: function($super,
      b) {
      $super(b);
      this.widgetName = "FX-LED2";
      this.bgColor = color.eqBg;
      this.bg = res.fxLEDb;
      this.w = this.bg.w();
      this.h = this.bg.h();
      this.label = "PAR";
      this.sign = "%";
      this.v1 = "0";
      this.oneLine = this.clickMark = !1
    },
    setValue: function(a, b) {
      switch (a) {
        case 1:
          this.v1 = precision(b, 1) + ""
      }
      regUpdate(this)
    },
    formatValue: function(a) {
      return 100 * a | 0
    },
    standartFormat: function(a) {
      return 100 * a | 0
    },
    getState: function() {
      return getValue(this.key)
    },
    paint: function() {
      this.paintedMe = !0;
      ctx.fillStyle = this.bgColor;
      ctx.fillRect(0, 0, this.w, this.h);
      this.clickMark && (ctx.fillStyle = color.white, ctx.fillTriangle(this.w - 12, 5, 3, 4));
      var a = this.w / 2 | 0;
      ctx.setShadow("#0a0a0a", 0, 2, 2);
      this.oneLine || (ctx.fillStyle = "#999", ctx.textAlign = "center", ctx.font = font.eqSlText, ctx.fillText(this.label, a, 17));
      ctx.textAlign = "start";
      var a = this.getState(),
        b = this.formatValue(a) + "";
      ctx.font = "17px open_sansbold";
      var c = ctx.measureText(b).width;
      ctx.font = "14px open_sans_condensedbold";
      var d = ctx.measureText(this.sign).width,
        a = (this.w - c - d - 1) / 2 | 0;
      ctx.fillStyle = "#EEE";
      ctx.font = "17px open_sansbold";
      ctx.fillText(b, a, this.oneLine ? 17 : 36, this.w - 10);
      this.w - (a + c + 1) > d && (ctx.fillStyle = "#777", ctx.font = "14px open_sans_condensedbold", ctx.textAlign = "end", ctx.fillText(this.sign, a + c + 1 + d, this.oneLine ? 17 : 36, this.w - 10))
    }
  }),
  FXRACK = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "FXRACK";
      this.w = res.lex_reverb.w();
      this.h = res.lex_reverb.h();
      this.mode = 0;
      this.tap = new Button(this);
      this.tap.setImages(res.lex_tap_off, res.lex_tap_on);
      this.tap.setPos(262, 33);
      this.tap.valueFunc = function() {
        bpmTapHandler(b.mode);
        updateByKey("f." + b.mode + ".bpm")
      };
      this.tap.onHold = function() {
        askBpm(b.mode)
      };
      this.tap.hide();
      this.holdTimer = null
    },
    setMode: function(a) {
      this.mode = a;
      a = fxStrips[this.mode].getNameValue("fxtype");
      this.tap.enabled = a == E_FX.DELAY;
      regUpdate(this)
    },
    onDown: function(a, b, c) {
      a -= this.globalX();
      b -= this.globalY();
      b = isInRect(this.tap.x - 15, this.tap.y - 15, this.tap.w + 30, this.tap.h + 30, a, b);
      var d = this;
      this.tap.enabled && b ? this.holdTimer = setTimeout(function() {
        askBpm(d.mode)
      }, HOLD_TIME) : this.parent.showPresets()
    },
    onUp: function() {
      clearTimeout(this.holdTimer)
    },
    paint: function() {
      var a = 170;
      switch (fxStrips[this.mode].getNameValue("fxtype")) {
        case E_FX.REVERB:
          a = 198;
          drawImage(res.lex_reverb, 0, 0);
          break;
        case E_FX.DELAY:
          a = 174;
          drawImage(res.lex_delay_a, 0, 0);
          break;
        case E_FX.CHORUS:
          a = 198;
          drawImage(res.lex_chorus, 0, 0);
          break;
        case E_FX.ROOM:
          a = 198, drawImage(res.lex_room, 0, 0)
      }
      fxStrips[this.mode].getNameValue("fxmode");
      var b = fxStrips[this.mode].getNameValue("prname"),
        c = fxStrips[this.mode].getNameValue("prmod");
      "" == b && (b = "---");
      ctx.drawText(b, a, 48, {
        font: font.botChLabel,
        align: "center",
        valign: "middle",
        color: 0 == c ? "#FFFB89" : "#f00",
        shadow: [color.black, 0, 1, 1]
      })
    }
  }),
  FXSENDSPage = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "FX_EDIT_PAGE";
      this.mode = -1;
      this.y = measures.topWidgetHeight;
      this.enabled = !1;
      this.buttons = [];
      this.color = color.blue;
      this.pages = [];
      this.initWidgets();
      this.setMode(0)
    },
    onShow: function() {
      this.page.arrangeStrips();
      bottomWidget.setOffset2(this.page.offsetX)
    },
    setOffset: function(a) {
      this.page.setOffset(a)
    },
    setVU: function(a, b) {
      this.page.strips[a].vu.setValue(b);
      var c = this.page.strips[a].clip;
      1 <= b ? c.clip() : c.state && !c.releasing && c.release()
    },
    resetVUs: function() {
      for (var a = this.page.strips, b = 0; b < a.length; b++) a[b].vu.reset()
    },
    syncSliders: function() {},
    setMode: function(a) {
      this.mode != a && (this.mode = a, fxoutWidget.setFx(a), this.page.setMode(a), this.resetVUs(), regUpdate(this), bottomWidget.upd(), regUpdate(bottomWidget))
    },
    nextMode: function() {
      this.mode == curSetup.fx - 1 ? this.setMode(0) : this.setMode(this.mode + 1)
    },
    initWidgets: function() {
      for (var a = [color.blue, color.brown, color.purple,
          color.green
        ], b = 0; b < fxStrips.length; b++) {
        var c = new TabButton(this);
        c.textColor = LightenDarkenColor(a[b], 10);
        c.color = a[b];
        c.mode = b;
        c.text = "NULL";
        c.setSize(111, 30);
        c.getState = function() {
          this.cosmetic || (this.state = this.parent.mode == this.mode ? 1 : 0, this.text = fxStrips[this.mode].getName())
        };
        this.buttons.push(c)
      }
      this.page = new FXMixer(this, 0, color.blue)
    },
    calcGeometry: function() {
      this.w = screenWidth;
      masterWidget.enabled && (this.w -= masterWidget.w);
      fxoutWidget.enabled && (this.w -= fxoutWidget.w);
      slideOutWidget.enabled &&
        (this.w -= slideOutWidget.w);
      this.h = screenHeight - this.y - bottomWidget.h;
      for (var a = 0; a < this.buttons.length; a++) this.buttons[a].setPos(this.w - (this.buttons[a].w + 1) * (this.buttons.length - a), 5)
    },
    paint: function() {
      ctx.fillStyle = color.eqBg;
      ctx.fillRect(0, 0, this.w, this.h);
      ctx.fillStyle = [color.blue, color.brown, color.purple, color.green][this.mode];
      ctx.fillRect(0, 35, this.w, 4)
    }
  }),
  FXMixer = Class.create(Widget, {
    initialize: function($super, b, c, d) {
      $super(b);
      this.widgetName = "FX_MIXER";
      this.y = 40;
      this.mode = 0;
      this.needClip = !0;
      isDefined(d) ? this.color = d : this.color = color.blue;
      this.fxID = c;
      this.strips = [];
      this.createStrips()
    },
    setMode: function(a) {
      for (var b = this.mode = 0; b < this.strips.length; b++) this.strips[b].setMode(a)
    },
    createStrips: function() {
      for (var a = curSetup.input, b = curSetup.sub, c = curSetup.linein, d = 0, f = "fx." + this.fxID + ".", e = 0; e < a; e++) {
        var g = "i." + e + ".",
          h = inStrips[e],
          g = new FXStrip(this, d, g, f);
        0 == e && (g.firstInGroup = !0);
        e == a - 1 && (g.lastInGroup = !0);
        g.id = h.id;
        g.color = this.color;
        g.sl.color = this.color;
        g.text = h.text;
        this.strips.push(g);
        fxSendStrips.push(g);
        h.FXS.push(g);
        d++
      }
      for (e = 0; e < c; e++) g = "l." + e + ".", h = lineinStrips[e], g = new FXStrip(this, d, g, f), 0 == e && (g.firstInGroup = !0), e == c - 1 && (g.lastInGroup = !0), g.id = h.id, g.color = h.color, g.sl.color = this.color, g.text = h.text, this.strips.push(g), fxSendStrips.push(g), h.FXS.push(g), d++;
      h = mediaStrips[0];
      g = new FXStrip(this, d, "p.0.", f);
      g.firstInGroup = !0;
      g.id = h.id;
      g.color = color.media;
      g.sl.color = this.color;
      g.sl.fader = res.fader;
      g.text = h.text;
      this.strips.push(g);
      fxSendStrips.push(g);
      h.FXS.push(g);
      d++;
      h = mediaStrips[1];
      g = new FXStrip(this, d, "p.1.", f);
      g.lastInGroup = !0;
      g.id = h.id;
      g.color = color.media;
      g.sl.color = this.color;
      g.sl.fader = res.fader;
      g.text = h.text;
      this.strips.push(g);
      fxSendStrips.push(g);
      h.FXS.push(g);
      d++;
      for (e = 0; e < b; e++) g = "s." + e + ".", h = subStrips[e], g = new FXStrip(this, d, g, f), 0 == e && (g.firstInGroup = !0), e == b - 1 && (g.lastInGroup = !0), g.id = h.id, g.color = color.sub, g.sl.color = this.color, g.sl.fader = res.subFader, g.text = h.text, this.strips.push(g), fxSendStrips.push(g), h.FXS.push(g), d++
    },
    arrangeStrips: function() {
      for (var a = 0; a <
        this.strips.length; a++);
    },
    setOffset: function(a) {
      this.offsetX = a;
      0 > this.offsetX && (this.offsetX = 0);
      a = this.strips.length * measures.mixerStripWidth - this.w;
      0 > a && (a = 0);
      this.offsetX > a && (this.offsetX = a);
      this.offsetXold = this.offsetX;
      regUpdate(this)
    },
    calcGeometry: function() {
      this.w = this.parent.w - this.x;
      this.h = this.parent.h - this.y;
      var a = this.strips.length * measures.mixerStripWidth - this.w;
      0 > a && (a = 0);
      this.offsetX > a && this.setOffset(this.offsetX)
    },
    paint: function() {
      ctx.fillStyle = color.eqBg;
      ctx.fillRect(0, 0, this.w, this.h)
    }
  });
chSafesPage = showsPage = null;
var SETTINGS = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "SETTINGS";
      this.y = measures.topWidgetHeight;
      this.needClip = !0;
      this.mode = 0;
      this.color = color.red;
      this.tabButtons = [];
      this.initWidgets();
      this.setMode(3)
    },
    showIsoPage: function() {
      if (this.iso_page) {
        for (var a = 0; a < this.pages.length; a++) this.pages[a].hide();
        this.iso_page.show();
        regUpdate(this)
      }
    },
    hideIsoPage: function() {
      this.iso_page && this.setMode(2)
    },
    onShow: function() {
      if (isDefined(this.pages[this.mode])) this.pages[this.mode].onShow()
    },
    onHide: function() {
      for (var a =
          0; a < this.pages.length; a++)
        if (this.pages[a].enabled) this.pages[a].onHide()
    },
    setMode: function(a) {
      this.mode = a;
      this.iso_page && this.iso_page.hide();
      for (a = 0; a < this.pages.length; a++) this.pages[a].hide();
      this.mode < this.pages.length && this.pages[this.mode].show();
      regUpdate(this)
    },
    nextMode: function() {
      this.mode == this.pages.length - 1 ? this.setMode(0) : this.setMode(this.mode + 1)
    },
    initWidgets: function() {
      var a = [lang.NETWORK, lang.ACCESS, lang.SHOWS, lang.SETTINGS];
      HAVE_ROUTING && a.push(lang.PATCHING);
      CASCADE_MODE && a.push(lang.CASCADE);
      a.push(lang.ABOUT);
      for (var b = 0; b < a.length; b++) {
        var c = new TabButton(this);
        c.color = c.textColor = "hsl(" + 32 * (b + 1) + ",50%,45%)";
        c.mode = b;
        c.text = a[b];
        c.setSize(100, 30);
        this.tabButtons.push(c)
      }
      this.pages = [];
      this.pages.push(new NETWORK_PAGE(this));
      this.pages.push(new PERM_PAGE(this));
      this.pages.push(new SHOWS_PAGE(this));
      this.pages.push(new CONFIG_PAGE(this));
      HAVE_ROUTING && this.pages.push(new ROUTING_PAGE(this));
      CASCADE_MODE && this.pages.push(new CASCADE_SUBPAGE(this));
      this.pages.push(new ABOUTPage(this));
      this.iso_page =
        null;
      this.iso_page = new ISO_PAGE(this);
      this.iso_page.hide()
    },
    calcGeometry: function() {
      this.w = screenWidth - measures.mixerRightMargin;
      this.h = screenHeight - this.y;
      for (var a = 0; a < this.tabButtons.length; a++) this.tabButtons[a].setPos(this.w - (this.tabButtons[a].w + 1) * (this.tabButtons.length - a), 5)
    },
    paint: function() {
      ctx.fillStyle = color.eqBg;
      ctx.fillRect(0, 0, this.w, this.h);
      ctx.fillStyle = this.tabButtons[this.mode].color;
      ctx.fillRect(4, 35, this.w - 4, 4)
    }
  }),
  SETTINGS_SUBPAGE = Class.create(Widget, {
    initialize: function($super,
      b) {
      $super(b);
      this.widgetName = "SETTINGS_SUBPAGE";
      this.y = 40;
      this.enabled = !1;
      this.bgColor = color.eqBg
    },
    onDown: function(a, b) {
      this.lastPressPoint = this.pressPoint;
      this.pressPoint = [a, b]
    },
    onUp: function(a) {
      var b = Date.now(),
        c = Math.abs(this.lastPressPoint[0] - this.pressPoint[0]),
        d = Math.abs(this.lastPressPoint[1] - this.pressPoint[1]);
      2 < mouseTargets.length || isDefined(tHash[a]) && 2 < tHash[a].length || (30 > c && 30 > d && b - this.lastClickTime < DBL_CLK_TIME ? (this.onDouble(), this.lastClickTime = b - DBL_CLK_TIME) : this.lastClickTime =
        b)
    },
    onDouble: function() {
      setMode(E_MODE.MIX)
    },
    initWidgets: function() {},
    calcGeometry: function() {
      this.w = this.parent.w - this.x;
      this.h = this.parent.h - this.y
    },
    paint: function() {
      ctx.fillStyle = this.bgColor;
      ctx.fillRect(0, 0, this.w, this.h)
    }
  }),
  NETWORK_PAGE = Class.create(SETTINGS_SUBPAGE, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "NETWORK_PAGE";
      this.timer = null;
      this.initWidgets()
    },
    onShow: function() {
      sendMessage("NETCONFIG");
      clearInterval(this.timer);
      this.timer = setInterval(function() {
          sendMessage("NETCONFIG")
        },
        2E3)
    },
    onHide: function() {
      clearInterval(this.timer)
    },
    initWidgets: function() {
      this.bCONFIG = new MENUBUTTON(this);
      this.bCONFIG.setPos(60, 300);
      this.bCONFIG.setSize(100, 36);
      this.bCONFIG.text = lang.CONFIG;
      this.bCONFIG.textColor = "#d66";
      this.bCONFIG.color = "#d66";
      this.bCONFIG.onPress = function() {
        EMULATE ? showPopupMsg(lang.DEMO_VERSION) : isLocal ? (editOk.valueFunc = function() {
          var a = editBox2.value;
          if (a) {
            var b = netConfig.adminPassword,
              c = b.slice(0, 32),
              d = md5(c + a + c);
            c + d == b ? (b = document.URL, b = b.replace(/:\/\//, "://admin:" +
              a + "@"), b = b.replace(/\/mixer\.html/, "/config.html"), document.location = b) : showPopupMsg(lang.WRONG_PASSWORD)
          }
        }, showEditBox2(lang.PASSWORD, "")) : document.location = "/config.html"
      }
    },
    paint: function() {
      ctx.fillStyle = color.eqBg;
      ctx.fillRect(0, 0, this.w, this.h);
      ctx.font = font.editbox;
      ctx.textAlign = "left";
      ctx.fillStyle = color.white;
      ctx.fillText(lang.WIRELESS_NETWORK, 60, 50);
      ctx.fillText(lang.ETHERNET, 660, 50);
      JSON.stringify(netConfig);
      ctx.textAlign = "left";
      var a = color.yellow + lang.HOTSPOT + "<br>{0}<br>{1}<br>#C8C9C9" +
        lang.CHANNEL + ": {2}<br>SSID: {3}",
        a = a.format(netConfig.ap_enabled ? color.green + lang.ENABLED : color.red + lang.DISABLED, netConfig.ap_up ? color.green + lang.UP : color.red + lang.DOWN, netConfig.wlan_up ? lang.OVERRIDDEN_BY_WIFI : netConfig.ap_channel, netConfig.ap_ssid);
      netConfig.ap_mac && (a += "<br>MAC: " + netConfig.ap_mac);
      drawText(a, 60, 110, {
        dy: 30
      });
      a = color.yellow + "WI-FI<br>{0}<br>{1}".format(netConfig.wlan_enabled ? color.green + lang.ENABLED : color.red + lang.DISABLED, netConfig.wlan_up ? color.green + lang.UP : color.red + lang.DOWN);
      netConfig.wlan_up && (a += "<br>#C8C9C9IP: {0}<br>NETMASK: {1}".format(0 == netConfig.wlan_mode ? netConfig.wlan_dhcp_ip + " (DHCP)" : netConfig.wlan_ip, 0 == netConfig.wlan_mode ? netConfig.wlan_dhcp_netmask : netConfig.wlan_netmask));
      netConfig.wlan_mac && (a += "<br>#C8C9C9MAC: " + netConfig.wlan_mac);
      drawText(a, 360, 110, {
        dy: 30
      });
      a = color.yellow + "LAN<br>{0}<br>{1}".format(netConfig.eth_enabled ? color.green + lang.ENABLED : color.red + lang.DISABLED, netConfig.eth_up ? color.green + lang.UP : color.red + lang.DOWN);
      netConfig.eth_up && (a +=
        "<br>#C8C9C9IP: {0}<br>NETMASK: {1}".format(0 == netConfig.eth_mode ? netConfig.eth_dhcp_ip + " (DHCP)" : netConfig.eth_ip, 0 == netConfig.eth_mode ? netConfig.eth_dhcp_netmask : netConfig.eth_netmask));
      netConfig.eth_mac && (a += "<br>#C8C9C9MAC: " + netConfig.eth_mac);
      drawText(a, 660, 110, {
        dy: 30
      })
    }
  });

function saveToCurrentShow() {
  var a = getValue("var.currentShow");
  a && (sendMessage(E_COMMANDS.SAVESHOW + "^" + a), setValue("var.unsaved.chsafes", 0))
}
var ISO_PAGE = Class.create(SETTINGS_SUBPAGE, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "ISO_PAGE";
      this.color = "#22aa22";
      this.offsetY = 0;
      this.hh = this.maxY = 900;
      this.needMoveEvt = this.needClip = !0;
      this.buttons = [];
      this.initWidgets();
      chSafesPage = this
    },
    setOffset: function(a) {
      this.offsetY = bound(a | 0, 0, this.maxY);
      regUpdate(this)
    },
    onDown: function(a, b, c) {
      this.lastPressPoint = this.pressPoint;
      this.pressPoint = [a, b + this.offsetY];
      this.ppy = this.offsetY + b;
      this.d = this.offsetY
    },
    onMove: function(a, b, c) {
      2 < mouseTargets.length ||
        isDefined(tHash[c]) && 2 < tHash[c].length || this.setOffset(this.ppy - b)
    },
    onUp: function(a) {
      var b = Date.now(),
        c = Math.abs(this.lastPressPoint[0] - this.pressPoint[0]),
        d = Math.abs(this.lastPressPoint[1] - this.pressPoint[1]),
        f = Math.abs(this.d - this.offsetY);
      2 < mouseTargets.length || isDefined(tHash[a]) && 2 < tHash[a].length || (10 > f && 30 > c && 30 > d && b - this.lastClickTime < DBL_CLK_TIME ? (this.onDouble(), this.lastClickTime = b - DBL_CLK_TIME) : this.lastClickTime = b)
    },
    onWheel: function(a) {
      clearInterval(ticker);
      this.setOffset(this.offsetY -
        Math.round(a / 3))
    },
    onShow: function() {},
    initWidgets: function() {
      var a = this,
        b = 40;
      this.back = new MENUBUTTON(this);
      this.back.setAnchors(b + 200, 19, null, null);
      this.back.setSize(90, 40);
      this.back.text = lang.BACK;
      this.back.onPress = function() {
        a.parent.hideIsoPage()
      };
      this.bRESET = new MENUBUTTON(this);
      this.bRESET.setAnchors(b + 700, 19, null, null);
      this.bRESET.setSize(90, 40);
      this.bRESET.text = lang.RESET;
      this.bRESET.onPress = function() {
        for (var b = 0; b < allStrips.length; b++) allStrips[b].setNameValue("safe", 0);
        masterWidget.setNameValue("safe",
          0);
        for (b = 0; b < a.buttons.length; b++) a.buttons[b].setState(0);
        setValue("var.unsaved.chsafes", 1);
        regUpdate(a)
      };
      this.bSAVE = new MENUBUTTON(this);
      this.bSAVE.setAnchors(b + 400, 19, null, null);
      this.bSAVE.setSize(190, 40);
      this.bSAVE.text = lang.SAVE_TO_SHOW;
      this.bSAVE.textColor = color.yellow;
      this.bSAVE.regKey("var.unsaved.chsafes");
      this.bSAVE.getState = function() {
        this.disabled = 0 == getValue("var.unsaved.chsafes")
      };
      this.bSAVE.onPress = function() {
        if (isBlocked("shows")) showPopupMsg(lang.LOCKED, 1E3);
        else {
          var b = getValue("var.currentShow");
          b && (sendMessage(E_COMMANDS.SAVESHOW + "^" + b), setValue("var.unsaved.chsafes", 0), regUpdate(a.bSAVE))
        }
      };
      var c = 50,
        d = 0,
        f = 0;
      this.BUTTONS = [];
      this.B1 = [];
      this.B2 = [];
      this.B3 = [];
      this.B4 = [];
      this.B5 = [];
      this.B6 = [];
      this.regKey("iso.ch");
      this.regKey("iso.bus");
      this.regKey("iso.mtx");
      this.regKey("iso.m");
      this.regKey("iso.fx");
      this.regKey("iso.gr");
      for (var e = 0; e < allStrips.length; e++) {
        var g = new CHECKBUTTON(this);
        g.setSize(90, 40);
        0 == e % 8 && 0 != e && d++;
        var h = 80 + c * d,
          f = h;
        g.setPos(b + (g.w + 10) * (e - 8 * d), h);
        g.key = allStrips[e].name +
          "safe";
        g.id = allStrips[e].id;
        g.text = allStrips[e].text;
        g.textColor = allStrips[e].color;
        g.getState = function() {
          this.state = 1 == this.state
        };
        g.onToggle = function() {
          isBlocked("shows") || (setValue("var.unsaved.chsafes", 1), regUpdate(a.bSAVE))
        };
        this.BUTTONS.push(g)
      }
      g = new CHECKBUTTON(this);
      g.setSize(90, 40);
      0 == e % 8 && 0 != e && d++;
      f = h = 80 + c * d;
      g.setPos(b + (g.w + 10) * (e - 8 * d), h);
      g.key = "m.safe";
      g.id = masterWidget.id;
      g.text = lang.MASTER;
      g.textColor = masterWidget.color;
      g.getState = function() {
        this.state = 1 == this.state
      };
      g.onToggle = function() {
        isBlocked("shows") ||
          (setValue("var.unsaved.chsafes", 1), regUpdate(a.bSAVE))
      };
      this.BUTTONS.push(g);
      if (HAVE_ISOLATION) {
        for (var l = "iso.ch", m = [lang.MIC_GAIN, "+48V", lang.PHASE, lang.DELAY, lang.NAME, lang.HPF, lang.DIGITECH, lang.EQ, lang.DEESSER, lang.COMP, lang.GATE, lang.PANNING, lang.ROUTING, lang.MUTES, lang.FADER_POSITION, lang.FX_SEND_LEVELS, lang.AUX_MTX_SEND_LEVELS], n = "micgain 48v phase delay names hpf digi eq deesser comp gate pan routing mutes mix fxsends auxmtxlvls".split(" "), b = 40, c = 60, f = f + 110, e = d = 0; e < m.length; e++) g = new CHECKBUTTON(this),
          0 == e % 8 && 0 != e && d++, g.setSize(90, 46), g.setPos(b + e % 8 * 100, f + c * d), g.font = "12pt open_sans_condensedbold", g.idx = e, g.text = formatButtonText(m[e]), g.id = n[e], g.key2 = l, g.getState = function() {
            this.state = (getValue(this.key2) || "").split(",").contains(this.id)
          }, g.onToggle = function() {
            var b = getValue(this.key2) || "",
              c = b.split(","),
              d = c.contains(this.id);
            this.state ? d || setValue(this.key2, b ? b + "," + this.id : this.id) : d && (c.deleteItem(this.id), setValue(this.key2, c.join(",")));
            setValue("var.unsaved.chsafes", 1);
            regUpdate(a.bSAVE)
          },
          this.buttons.push(g), this.B1.push(g);
        d++;
        d++;
        l = "iso.bus";
        m = [lang.PHASE, lang.DELAY, lang.NAME, lang.GEQ, lang.COMP, lang.GATE, lang.CONTRIB_PANNING, lang.CONTRIB_BUS_POINTS, lang.MUTES, lang.AUX_CONTRIB, lang.MATRIX_CONTRIB, lang.MATRIX_CONTRIB_PANNING];
        n = "phase delay name geq comp gate pan buspoints mutes aux mtxcontrib mtxcontribpan".split(" ");
        for (e = 0; e < m.length; e++) g = new CHECKBUTTON(this), 0 == e % 8 && 0 != e && d++, g.setSize(90, 46), g.setPos(b + e % 8 * 100, f + c * d), g.idx = e, g.text = formatButtonText(m[e]), g.id = n[e], g.key2 =
          l, g.getState = function() {
            this.state = (getValue(this.key2) || "").split(",").contains(this.id)
          }, g.onToggle = function() {
            var b = getValue(this.key2) || "",
              c = b.split(","),
              d = c.contains(this.id);
            this.state ? d || setValue(this.key2, b ? b + "," + this.id : this.id) : d && (c.deleteItem(this.id), setValue(this.key2, c.join(",")));
            setValue("var.unsaved.chsafes", 1);
            regUpdate(a.bSAVE)
          }, this.buttons.push(g), this.B2.push(g);
        d++;
        d++;
        l = "iso.m";
        m = [lang.GEQ, lang.COMP, lang.GATE, lang.BALANCE, lang.MUTES, lang.MASTER_LEVEL];
        n = "geq comp gate balpan mutes mix".split(" ");
        for (e = 0; e < m.length; e++) g = new CHECKBUTTON(this), 0 == e % 8 && 0 != e && d++, g.setSize(90, 46), g.setPos(b + e % 8 * 100, f + c * d), g.idx = e, g.text = formatButtonText(m[e]), g.id = n[e], g.key2 = l, g.getState = function() {
            this.state = (getValue(this.key2) || "").split(",").contains(this.id)
          }, g.onToggle = function() {
            var b = getValue(this.key2) || "",
              c = b.split(","),
              d = c.contains(this.id);
            this.state ? d || setValue(this.key2, b ? b + "," + this.id : this.id) : d && (c.deleteItem(this.id), setValue(this.key2, c.join(",")));
            setValue("var.unsaved.chsafes", 1);
            regUpdate(a.bSAVE)
          },
          this.buttons.push(g), this.B4.push(g);
        d++;
        d++;
        l = "iso.fx";
        m = [lang.FX + " 1", lang.FX + " 2", lang.FX + " 3", lang.FX + " 4"];
        n = ["fx1", "fx2", "fx3", "fx4"];
        for (e = 0; e < m.length; e++) g = new CHECKBUTTON(this), 0 == e % 8 && 0 != e && d++, g.setSize(90, 46), g.setPos(b + e % 8 * 100, f + c * d), g.idx = e, g.text = m[e], g.id = n[e], g.key2 = l, g.getState = function() {
          this.state = (getValue(this.key2) || "").split(",").contains(this.id)
        }, g.onToggle = function() {
          var b = getValue(this.key2) || "",
            c = b.split(","),
            d = c.contains(this.id);
          this.state ? d || setValue(this.key2, b ? b +
            "," + this.id : this.id) : d && (c.deleteItem(this.id), setValue(this.key2, c.join(",")));
          setValue("var.unsaved.chsafes", 1);
          regUpdate(a.bSAVE)
        }, this.buttons.push(g), this.B5.push(g), h = f + c * d, this.hh = h + 80;
        d++;
        d++;
        l = "iso.gr";
        m = [lang.MUTE_GROUPS];
        n = ["mg"];
        for (e = 0; e < m.length; e++) g = new CHECKBUTTON(this), 0 == e % 8 && 0 != e && d++, g.setSize(90, 46), g.setPos(b + e % 8 * 100, f + c * d), g.idx = e, g.text = m[e].replace(" ", "\n"), g.id = n[e], g.key2 = l, g.getState = function() {
            this.state = (getValue(this.key2) || "").split(",").contains(this.id)
          }, g.onToggle =
          function() {
            var b = getValue(this.key2) || "",
              c = b.split(","),
              d = c.contains(this.id);
            this.state ? d || setValue(this.key2, b ? b + "," + this.id : this.id) : d && (c.deleteItem(this.id), setValue(this.key2, c.join(",")));
            setValue("var.unsaved.chsafes", 1);
            regUpdate(a.bSAVE)
          }, this.buttons.push(g), this.B6.push(g), h = f + c * d, this.hh = h + 80
      }
    },
    calcGeometry: function() {
      this.w = this.parent.w - this.x;
      this.h = this.parent.h - this.y;
      this.maxY = this.hh - this.h;
      0 > this.maxY && (this.maxY = 0);
      this.offsetY = bound(this.offsetY, 0, this.maxY)
    },
    paint: function() {
      ctx.fillStyle =
        color.eqBg;
      ctx.fillRect(0, this.offsetY, this.w, this.h);
      ctx.font = font.editbox;
      ctx.textAlign = "left";
      ctx.fillStyle = color.yellow;
      ctx.fillText(lang.CHANNEL_SAFES, 42, this.BUTTONS[0].y + -12);
      HAVE_ISOLATION && (ctx.fillText(lang.CHANNELS, 42, this.B1[0].y + -12), ctx.fillText(lang.BUSSES, 42, this.B2[0].y + -12), ctx.fillText(lang.MASTER, 42, this.B4[0].y + -12), ctx.fillText(lang.FX, 42, this.B5[0].y + -12), ctx.fillText(lang.GROUPS, 42, this.B6[0].y + -12));
      if (1 < this.maxY) {
        ctx.fillStyle = "rgba(255,255,255,0.07)";
        ctx.fillRoundRect(this.w -
          11, this.offsetY + 2, 10, this.h - 4, 4);
        ctx.fillStyle = "rgba(255,255,255,0.4)";
        var a = this.h / (this.h + this.maxY) * (this.h - 4);
        ctx.fillRoundRect(this.w - 11, this.offsetY + (2 + this.offsetY / this.maxY * (this.h - 4 - a) | 0), 10, a, 4)
      }
    }
  }),
  SHOWS_PAGE = Class.create(SETTINGS_SUBPAGE, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "SHOWS_PAGE";
      this.color = color.red;
      this.initWidgets();
      showsPage = this
    },
    updLists: function() {
      this.showsListUpdate();
      this.snapsListUpdate()
    },
    onShow: function() {
      if (EMULATE) this.SHOWS.setItems($A($R("SHOW A",
        "SHOW Z"))), this.SNAPS.setItems($A($R("SNAPSHOT A", "SNAPSHOT Z")));
      else {
        this.showsListUpdate();
        var a = getValue("var.currentShow");
        a && sendMessage(E_COMMANDS.SNAP_LIST + "^" + a)
      }
    },
    showsListUpdate: function() {
      EMULATE || sendMessage(E_COMMANDS.SHOW_LIST)
    },
    snapsListUpdate: function() {
      if (!EMULATE) {
        var a = this.SHOWS.selItem();
        null == a && (a = getValue("var.currentShow"));
        null != a && 0 != a.length && sendMessage(E_COMMANDS.SNAP_LIST + "^" + a)
      }
    },
    refresh: function() {},
    initWidgets: function() {
      var a = this;
      this.bSAFES = new MENUBUTTON(this);
      this.bSAFES.setPos(250, 20);
      this.bSAFES.setSize(130, 40);
      this.bSAFES.color = color.green;
      this.bSAFES.text = IS_UI_24 ? lang.ISOLATE : lang.CHANNEL_SAFES;
      this.bSAFES.onPress = function() {
        a.parent.showIsoPage()
      };
      this.SHOWS = new LIST(this);
      this.SHOWS.setPos(40, 80);
      this.SHOWS.setSize(340, 320);
      this.SHOWS.showList = !0;
      this.SHOWS.getActiveItem = function() {
        var a = getValue("var.currentShow");
        this.activeItemIdx = this.items.indexOf(a)
      };
      this.SHOWS.onDClick = function() {
        a.bSHOWLOAD.click()
      };
      this.SHOWS.onSelect = function() {
        if (!EMULATE)
          if (isBlocked("shows")) showPopupMsg(lang.LOCKED,
            800);
          else {
            var b = this.selItem();
            null == b ? 0 <= this.activeItemIdx && this.select(this.activeItemIdx) : (a.SNAPS.clear(), a.SNAPS.showName = b, sendMessage(E_COMMANDS.SNAP_LIST + "^" + b))
          }
      };
      this.bNEWSHOW = new MENUBUTTON(this);
      this.bNEWSHOW.setPos(390, 130);
      this.bNEWSHOW.text = lang.NEW;
      this.bNEWSHOW.onPress = function() {
        EMULATE ? showPopupMsg(lang.DEMO_VERSION) : isBlocked("shows") ? showPopupMsg(lang.LOCKED, 800) : (editOk.valueFunc = function() {
          var b = editBox2.value;
          null != b && 0 != b.length && (b = b.replace(/\^/g, "_"), -1 != a.SHOWS.items.indexOf(b) ?
            showPopupMsg(lang.SHOW_ALREADY_EXISTS, 800) : (sendMessage(E_COMMANDS.SHOW_CREATE + "^" + b), sendMessage(E_COMMANDS.SHOW_LOAD + "^" + b), a.showsListUpdate(), a.SHOWS.clearSelection()))
        }, showEditBox2(lang.SAVE_SHOW_WITH_NAME, ""))
      };
      this.bSHOWLOAD = new MENUBUTTON(this);
      this.bSHOWLOAD.text = lang.LOAD;
      this.bSHOWLOAD.setPos(390, 80);
      this.bSHOWLOAD.onPress = function() {
        if (EMULATE) showPopupMsg(lang.DEMO_VERSION);
        else if (isBlocked("shows")) showPopupMsg(lang.LOCKED, 800);
        else {
          var b = a.SHOWS.selItem();
          null != b && (a.SNAPS.clear(),
            sendMessage(E_COMMANDS.SHOW_LOAD + "^" + b), sendMessage(E_COMMANDS.SNAP_LIST + "^" + b), regUpdate(topWidget))
        }
      };
      this.bSHOWREN = new MENUBUTTON(this);
      this.bSHOWREN.text = lang.RENAME;
      this.bSHOWREN.setPos(390, 180);
      this.bSHOWREN.onPress = function() {
        if (EMULATE) showPopupMsg(lang.DEMO_VERSION);
        else if (isBlocked("shows")) showPopupMsg(lang.LOCKED, 800);
        else {
          var b = a.SHOWS.selItem();
          null != b && (editOk.valueFunc = function() {
            var c = editBox2.value;
            null != c && 0 != c.length && (c = c.replace(/\^/g, "_"), sendMessage(E_COMMANDS.SHOW_RENAME +
              "^" + b + "^" + c), b == getValue("var.currentShow") && setValue("var.currentShow", c), a.showsListUpdate(), a.SHOWS.onSetItems = function() {
              this.selectByName(c)
            })
          }, showEditBox2(lang.NEW_SHOW_NAME, b))
        }
      };
      this.bSHOWIMPORT = new MENUBUTTON(this);
      this.bSHOWIMPORT.setPos(390, 250);
      this.bSHOWIMPORT.text = lang.IMPORT;
      this.bSHOWIMPORT.onPress = function() {
        if (isBlocked("shows")) showPopupMsg(lang.LOCKED, 800);
        else {
          var a = new MODAL_LIST(null, E_COMMANDS.IMPORT_LIST);
          a.title = lang.IMPORT_SHOW_FROM_USB;
          a.valueFunc = function(a) {
            sendMessage(E_COMMANDS.IMPORT_SHOW +
              "^" + a)
          }
        }
      };
      this.bSHOWEXPORT = new MENUBUTTON(this);
      this.bSHOWEXPORT.setPos(390, 300);
      this.bSHOWEXPORT.text = lang.EXPORT;
      this.bSHOWEXPORT.onPress = function() {
        if (isBlocked("shows")) showPopupMsg(lang.LOCKED, 800);
        else {
          var b = a.SHOWS.selItem();
          if (null == b) showPopupMsg(lang.NO_SHOW_SELECTED);
          else {
            var d = new MODAL_LIST(null, E_COMMANDS.USB_LIST);
            d.title = lang.EXPORT_SHOW_TO_USB.format(b);
            d.valueFunc = function(a) {
              sendMessage(E_COMMANDS.EXPORT_SHOW + "^" + a + "^" + b)
            }
          }
        }
      };
      this.bSHOWDEL = new MENUBUTTON(this);
      this.bSHOWDEL.text =
        lang.DELETE;
      this.bSHOWDEL.setPos(390, 370);
      this.bSHOWDEL.onPress = function() {
        if (EMULATE) showPopupMsg(lang.DEMO_VERSION);
        else if (isBlocked("shows")) showPopupMsg(lang.LOCKED, 800);
        else {
          var b = a.SHOWS.selItem();
          null != b && (confOk.valueFunc = function() {
            sendMessage(E_COMMANDS.SHOW_DEL + "^" + b);
            a.showsListUpdate();
            a.SHOWS.clearSelection()
          }, confCancel.valueFunc = function() {}, showConfBox(lang.DELETE_SHOW.format(b)))
        }
      };
      var b = 1020 > screenWidth ? 756 : 810;
      this.SNAPS = new LIST(this);
      this.SNAPS.setPos(1020 > screenWidth ? 470 : 490,
        80);
      this.SNAPS.setSize(1020 > screenWidth ? 280 : 310, 320);
      this.SNAPS.snapList = !0;
      this.SNAPS.showName = "";
      this.SNAPS.getActiveItem = function() {
        var a = getValue("var.currentShow");
        this.showName != a ? this.activeItemIdx = -1 : (a = getValue("var.currentSnapshot"), this.activeItemIdx = this.items.indexOf(a))
      };
      this.SNAPS.onDClick = function() {
        a.bSNAPLOAD.click()
      };
      this.bSNAPLOAD = new MENUBUTTON(this);
      this.bSNAPLOAD.text = lang.LOAD;
      this.bSNAPLOAD.setPos(b, 80);
      this.bSNAPLOAD.onPress = function() {
        if (EMULATE) showPopupMsg(lang.DEMO_VERSION);
        else if (isBlocked("shows")) showPopupMsg(lang.LOCKED, 800);
        else {
          var b = a.SNAPS.selItem();
          if (null != b) {
            var d = a.SHOWS.selItem();
            null == d && (d = getValue("var.currentShow"));
            null != d && (getValue("var.currentShow") != d && sendMessage(E_COMMANDS.SHOW_LOAD + "^" + d), sendMessage(E_COMMANDS.SNAP_LOAD + "^" + d + "^" + b))
          }
        }
      };
      this.bSNAPSAVE = new MENUBUTTON(this);
      this.bSNAPSAVE.text = lang.SAVE;
      this.bSNAPSAVE.setPos(b, 130);
      this.bSNAPSAVE.onPress = function() {
        if (EMULATE) showPopupMsg(lang.DEMO_VERSION);
        else if (isBlocked("shows")) showPopupMsg(lang.LOCKED,
          800);
        else {
          var b = a.SNAPS.selItem();
          null == b && (b = "");
          var d = getValue("var.currentShow");
          null == d || 0 == d.length ? showPopupMsg(lang.NO_ACTIVE_SHOW) : (editOk.valueFunc = function() {
            var a = editBox2.value;
            null != a && 0 != a.length && (a = a.replace(/\^/g, "_"), -1 != showsPage.SNAPS.items.indexOf(a) ? (confOk.valueFunc = function() {
                sendMessage(E_COMMANDS.SNAP_SAVE + "^" + d + "^" + a);
                showsPage.snapsListUpdate();
                showsPage.SNAPS.clearSelection();
                showPopupMsg(lang.SAVED, 800)
              }, confCancel.valueFunc = function() {}, showConfBox(lang.REPLACE_SNAPSHOT.format(a))) :
              (sendMessage(E_COMMANDS.SNAP_SAVE + "^" + d + "^" + a), setValue("var.currentSnapshot", a), regUpdate(topWidget), showsPage.SHOWS.select(d), showsPage.snapsListUpdate(), showsPage.SNAPS.clearSelection(), showPopupMsg(lang.SAVED, 800)))
          }, showEditBox2(lang.SAVE_SNAPSHOT_WITH_NAME, b))
        }
      };
      this.bSNAPREN = new MENUBUTTON(this);
      this.bSNAPREN.text = lang.RENAME;
      this.bSNAPREN.setPos(b, 180);
      this.bSNAPREN.onPress = function() {
        if (EMULATE) showPopupMsg(lang.DEMO_VERSION);
        else if (isBlocked("shows")) showPopupMsg(lang.LOCKED, 800);
        else {
          var b =
            a.SNAPS.selItem();
          if (null != b) {
            var d = a.SHOWS.selItem();
            null == d && (d = getValue("var.currentShow"));
            null != d && 0 != d.length && (editOk.valueFunc = function() {
              var c = editBox2.value;
              null != c && 0 != c.length && (c = c.replace(/\^/g, "_"), sendMessage(E_COMMANDS.SNAP_RENAME + "^" + d + "^" + b + "^" + d + "^" + c), b == getValue("var.currentSnapshot") && d == getValue("var.currentShow") && setValue("var.currentSnapshot", c), a.snapsListUpdate(), regUpdate(topWidget))
            }, showEditBox2(lang.NEW_SNAPSHOT_NAME, b))
          }
        }
      };
      this.bSNAPDEL = new MENUBUTTON(this);
      this.bSNAPDEL.text =
        lang.DELETE;
      this.bSNAPDEL.setPos(b, 370);
      this.bSNAPDEL.onPress = function() {
        if (EMULATE) showPopupMsg(lang.DEMO_VERSION);
        else if (isBlocked("shows")) showPopupMsg(lang.LOCKED, 800);
        else {
          var b = a.SNAPS.selItem();
          if (b) {
            var d = getValue("var.currentShow");
            confOk.valueFunc = function() {
              sendMessage(E_COMMANDS.SNAP_DEL + "^" + d + "^" + b);
              a.snapsListUpdate();
              a.SNAPS.clearSelection()
            };
            confCancel.valueFunc = function() {};
            showConfBox(lang.DELETE_SNAPSHOT.format(b))
          }
        }
      };
      this.MRESET = new MENUBUTTON(this);
      this.MRESET.setPos(40, this.SHOWS.y +
        this.SHOWS.h + 10);
      this.MRESET.w = 110;
      this.MRESET.text = lang.MIXER_RESET;
      this.MRESET.onPress = function() {
        EMULATE ? showPopupMsg(lang.DEMO_VERSION) : isBlocked() ? showPopupMsg(lang.LOCKED, 800) : (confOk.valueFunc = function() {
          sendMessage(E_COMMANDS.MIXER_RESET)
        }, showConfBox(lang.LOAD_THE_INITIAL_MIXER_STATE))
      }
    },
    calcGeometry: function($super) {
      $super()
    },
    paint: function() {
      ctx.fillStyle = color.eqBg;
      ctx.fillRect(0, 0, this.w, this.h);
      ctx.font = font.editbox;
      ctx.textAlign = "left";
      ctx.fillStyle = color.tabTextSel;
      ctx.fillText(lang.SHOWS,
        40, 46);
      ctx.fillText(lang.SNAPSHOTS, 490, 46)
    }
  }),
  CONFIG_PAGE = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "CONFIG";
      this.y = 40;
      this.enabled = !1;
      this.offsetY = 0;
      this.hh = this.maxY = 900;
      this.needMoveEvt = this.needClip = !0;
      this.color = color.red;
      this.scrollID = -1;
      this.mouseCaptured = !1;
      this.initWidgets()
    },
    setOffset: function(a) {
      this.offsetY = bound(a | 0, 0, this.maxY);
      regUpdate(this)
    },
    onShow: function() {
      this.setOffset(0)
    },
    onDown: function(a, b, c) {
      2 < mouseTargets.length || isDefined(tHash[c]) && 2 <
        tHash[c].length || (this.mouseCaptured = !0, this.lastPressPoint = this.pressPoint, this.pressPoint = [a, b + this.offsetY], this.ppy = this.offsetY + b, this.d = this.offsetY, this.scrollID = c)
    },
    onMove: function(a, b, c) {
      this.scrollID == c && this.mouseCaptured && this.setOffset(this.ppy - b)
    },
    onUp: function(a) {
      if (this.mouseCaptured) {
        this.mouseCaptured = !1;
        var b = Date.now(),
          c = Math.abs(this.lastPressPoint[0] - this.pressPoint[0]),
          d = Math.abs(this.lastPressPoint[1] - this.pressPoint[1]),
          f = Math.abs(this.d - this.offsetY);
        2 < mouseTargets.length ||
          isDefined(tHash[a]) && 2 < tHash[a].length || (10 > f && 30 > c && 30 > d && b - this.lastClickTime < DBL_CLK_TIME ? (this.onDouble(), this.lastClickTime = b - DBL_CLK_TIME) : this.lastClickTime = b)
      }
    },
    onDouble: function() {
      setMode(E_MODE.MIX)
    },
    onWheel: function(a, b) {
      clearInterval(ticker);
      this.setOffset(this.offsetY - Math.round(a / 3))
    },
    initWidgets: function() {
      var a = 0,
        b = this;
      HAVE_HP && (this.HPOUT = new SWITCHBOX(this), this.HPOUT.label = lang.HEADPHONES_OUT + ":", this.HPOUT.setPos(250, 50 + 50 * a++), this.HPOUT.setItemWidth(120), this.HPOUT.setItems([lang.MASTER +
        "/" + lang.SOLO, lang.AUX
      ]), this.HPOUT.getState = function() {
        this.state = getValue("var.hpaux")
      }, this.HPOUT.valueFunc = function() {
        isBlocked("gsettings") ? showPopupMsg(lang.LOCKED, 800) : (setValue("var.hpaux", this.state), syncHPAUX())
      });
      this.SOLOROUTE = new SWITCHBOX(this);
      this.SOLOROUTE.label = lang.SOLO_ROUTING + ":";
      this.SOLOROUTE.setPos(250, 50 + 50 * a++);
      this.SOLOROUTE.setItemWidth(120);
      this.SOLOROUTE.setItems([lang.HEADPHONES, lang.MASTER + " + " + lang.HP]);
      this.SOLOROUTE.getState = function() {
        this.state = getValue("settings.soloMode");
        1 != getValue("var.hpaux") && IS_UI_24 ? this.items = [lang.HEADPHONES, lang.MASTER + " + " + lang.HP] : this.items = [lang.DISABLED, lang.MASTER]
      };
      this.SOLOROUTE.valueFunc = function() {
        isBlocked("gsettings") ? showPopupMsg(lang.LOCKED, 800) : setValue("settings.soloMode", this.state)
      };
      IS_UI_24 && (this.HPSIGNAL = new SWITCHBOX(this), this.HPSIGNAL.label = lang.HEADPHONE_SIGNAL_DIRECTION + ":", this.HPSIGNAL.setPos(250, 50 + 50 * a++), this.HPSIGNAL.setItems([lang.L + " / " + lang.R, lang.R + " / " + lang.L]), this.HPSIGNAL.setItemWidth(120), this.HPSIGNAL.getState =
        function() {
          this.state = getValue("settings.hpswap")
        }, this.HPSIGNAL.valueFunc = function() {
          isBlocked("gsettings") ? showPopupMsg(lang.LOCKED, 800) : setValue("settings.hpswap", this.state)
        });
      this.SOLOMODE = new SWITCHBOX(this);
      this.SOLOMODE.label = lang.SOLO_MODE + ":";
      this.SOLOMODE.setPos(250, 50 + 50 * a++);
      this.SOLOMODE.setItems([lang.SINGLE, lang.MULTIPLE]);
      this.SOLOMODE.setItemWidth(120);
      this.SOLOMODE.getState = function() {
        this.state = getValue("settings.multiplesolo")
      };
      this.SOLOMODE.valueFunc = function() {
        isBlocked("gsettings") ?
          showPopupMsg(lang.LOCKED, 800) : setValue("settings.multiplesolo", this.state)
      };
      this.SOLOTYPE = new SWITCHBOX(this);
      this.SOLOTYPE.label = lang.SOLO_TYPE + ":";
      this.SOLOTYPE.setPos(250, 50 + 50 * a++);
      this.SOLOTYPE.setItems([lang.AFL, lang.PFL]);
      this.SOLOTYPE.setItemWidth(120);
      this.SOLOTYPE.getState = function() {
        this.state = getValue("settings.solotype")
      };
      this.SOLOTYPE.valueFunc = function() {
        isBlocked("gsettings") ? showPopupMsg(lang.LOCKED, 800) : setValue("settings.solotype", this.state)
      };
      curSetup.rec && (this.RECMODE = new SWITCHBOX(this),
        this.RECMODE.label = lang.RECORD_MODE + ":", this.RECMODE.setPos(250, 50 + 50 * a++), this.RECMODE.setItems([lang.BIT_32, lang.BIT_24, lang.BIT_16]), this.RECMODE.setItemWidth(80), this.RECMODE.getState = function() {
          this.state = getValue("settings.recordMode")
        }, this.RECMODE.valueFunc = function() {
          isBlocked("gsettings") ? showPopupMsg(lang.LOCKED, 800) : setValue("settings.recordMode", this.state)
        }, IS_UI_24 && (this.MTKMODE = new SWITCHBOX(this), this.MTKMODE.label = lang.MULTITRACK_MODE + ":", this.MTKMODE.setPos(250, 50 + 50 * a++), this.MTKMODE.setItems(["FLAC 24",
          "FLAC 16", "WAV 24", "WAV 16"
        ]), this.MTKMODE.setItemWidth(80), this.MTKMODE.getState = function() {
          this.state = getValue("settings.mtk.format")
        }, this.MTKMODE.valueFunc = function() {
          isBlocked("gsettings") ? showPopupMsg(lang.LOCKED, 800) : setValue("settings.mtk.format", this.state)
        }));
      this.AUXMUTE = new SWITCHBOX(this);
      this.AUXMUTE.label = lang.AUX_SEND_MUTE_INHERITANCE + ":";
      this.AUXMUTE.setPos(250, 50 + 50 * a++);
      this.AUXMUTE.setItems([lang.OFF, lang.ON]);
      this.AUXMUTE.setItemWidth(120);
      this.AUXMUTE.getState = function() {
        this.state =
          getValue("settings.auxmutelink")
      };
      this.AUXMUTE.valueFunc = function() {
        isBlocked("gsettings") ? showPopupMsg(lang.LOCKED, 800) : setValue("settings.auxmutelink", this.state)
      };
      IS_UI_24 ? (this.MTXSENDP = new SWITCHBOX(this), this.MTXSENDP.label = lang.MASTER_MTX_SEND_POINT + ":", this.MTXSENDP.setPos(250, 50 + 50 * a++), this.MTXSENDP.setItems([lang.PRE, lang.POST]), this.MTXSENDP.setItemWidth(120), this.MTXSENDP.getState = function() {
        this.state = getValue("settings.mtxsendpoint")
      }, this.MTXSENDP.valueFunc = function() {
        isBlocked("gsettings") ?
          showPopupMsg(lang.LOCKED, 800) : setValue("settings.mtxsendpoint", this.state)
      }) : (this.PREPROC = new SWITCHBOX(this), this.PREPROC.label = lang.GLOBAL_PRE_FADE_AUX_SEND_POINT + ":", this.PREPROC.setPos(250, 50 + 50 * a++), this.PREPROC.setItems([lang.PRE_PROCESSING, lang.POST_PROCESSING]), this.PREPROC.setItemWidth(120), this.PREPROC.getState = function() {
        this.state = getValue("settings.auxsendpoint")
      }, this.PREPROC.valueFunc = function() {
        isBlocked("gsettings") ? showPopupMsg(lang.LOCKED, 800) : setValue("settings.auxsendpoint",
          this.state)
      });
      var c = [0, 1, 2, 3, 4],
        d = [lang.MUTE_FX, lang.MUTE_ALL, lang.PLAY, lang.RECORD, lang.TAP_TEMPO];
      IS_UI_24 && (d.push(lang.MTK_PLAY), d.push(lang.MTK_RECORD), c.push(5), c.push(6));
      this.PEDAL = new RADIO(this);
      this.PEDAL.setPos(728, 50);
      this.PEDAL.setLabels(d);
      this.PEDAL.setKey("settings.footswitchfunc");
      this.PEDAL.regKey("settings.footswitchfunc");
      this.PEDAL.setItems(c);
      IS_UI_24 && (this.SOLO_VOL = new EQHSlider2(this), this.SOLO_VOL.disableWheel = !0, this.SOLO_VOL.w = 570, this.SOLO_VOL.defaultValue = -1, this.SOLO_VOL.haveMarks = !0, this.SOLO_VOL.setKey("settings.solovol"), this.SOLO_VOL.regKey("settings.solovol"), this.SOLO_VOL.setAnchors(250, 50 + 50 * a++, null, null), this.HP_L = new EQHSlider2(this), this.HP_L.disableWheel = !0, this.HP_L.w = 570, this.HP_L.defaultValue = -1, this.HP_L.haveMarks = !0, this.HP_L.setKey("settings.hpvol.0"), this.HP_L.regKey("settings.hpvol.0"), this.HP_L.setAnchors(250, 50 * a++ + 56, null, null), this.HP_R = new EQHSlider2(this), this.HP_R.disableWheel = !0, this.HP_R.w = 570, this.HP_R.defaultValue = -1, this.HP_R.haveMarks = !0, this.HP_R.setKey("settings.hpvol.1"),
        this.HP_R.regKey("settings.hpvol.1"), this.HP_R.setAnchors(250, 50 * a++ + 62, null, null));
      a += 1;
      HAVE_SYNC && (this.SYNC = new SWITCHBOX(this), this.SYNC.setPos(640, 50 + 50 * (a + (IS_UI_24 ? 1 : 0))), this.SYNC.setItems([lang.OFF, lang.ON]), this.SYNC.setItemWidth(90), this.SYNC.getState = function() {
          this.state = settings.sync ? 1 : 0
        }, this.SYNC.valueFunc = function() {
          settingsStorage.set("sync", 1 == this.state)
        }, this.SYNC_ID = new INPUTBOX(this), this.SYNC_ID.setPos(640, 50 + 50 * (a + 1 + (IS_UI_24 ? 1 : 0))), this.SYNC_ID.label = lang.SYNC_ID + ":", this.SYNC_ID.w =
        this.SYNC.w, this.SYNC_ID.getState = function() {
          this.text = settings.sync_id
        }, this.SYNC_ID.valueFunc = function(a) {
          settingsStorage.set("sync_id", a);
          regUpdate(this)
        });
      this.DRAWRATE = new SWITCHBOX(this);
      this.DRAWRATE.label = lang.FRAME_RATE + ":";
      this.DRAWRATE.setPos(250, 50 + 50 * a++);
      this.DRAWRATE.setItems([lang.FULL, "1/2", "1/3", "1/4"]);
      this.DRAWRATE.getState = function() {
        this.state = settings.drawRate - 1 | 0
      };
      this.DRAWRATE.valueFunc = function() {
        settingsStorage.set("drawRate", this.state + 1)
      };
      1.5 <= window.devicePixelRatio &&
        (this.DISABLERETINA = new SWITCHBOX(this), this.DISABLERETINA.label = lang.DISABLE_RETINA + ":", this.DISABLERETINA.setPos(250, 50 + 50 * a++), this.DISABLERETINA.setItems([lang.OFF, lang.ON]), this.DISABLERETINA.setItemWidth(90), this.DISABLERETINA.getState = function() {
          this.state = settings.disableRetina ? 1 : 0
        }, this.DISABLERETINA.valueFunc = function() {
          settingsStorage.set("disableRetina", 1 == this.state);
          confOk.valueFunc = function() {
            location.reload()
          };
          showConfBox(lang.RELOAD_UI)
        });
      this.DISABLESCALE = new SWITCHBOX(this);
      this.DISABLESCALE.label =
        lang.DISABLE_RESCALING + ":";
      this.DISABLESCALE.setPos(250, 50 + 50 * a++);
      this.DISABLESCALE.setItems([lang.OFF, lang.ON]);
      this.DISABLESCALE.getState = function() {
        this.state = settings.disableScaling ? 1 : 0
      };
      this.DISABLESCALE.valueFunc = function() {
        settingsStorage.set("disableScaling", 1 == this.state);
        settingsStorage.save();
        confOk.valueFunc = function() {
          location.reload()
        };
        showConfBox(lang.RELOAD_UI)
      };
      this.DISABLEVU = new SWITCHBOX(this);
      this.DISABLEVU.label = lang.DISABLE_LED_METERS + ":";
      this.DISABLEVU.setPos(250, 50 + 50 * a++);
      this.DISABLEVU.setItems([lang.OFF, lang.ON]);
      this.DISABLEVU.getState = function() {
        this.state = settings.disableVUs ? 1 : 0
      };
      this.DISABLEVU.valueFunc = function() {
        settingsStorage.set("disableVUs", 1 == this.state);
        regUpdate(masterWidget)
      };
      a += .5;
      this.MASTERLOCK = new SWITCHBOX(this);
      this.MASTERLOCK.label = lang.MASTER_LOCK + ":";
      this.MASTERLOCK.setPos(250, 50 + 50 * a++);
      this.MASTERLOCK.setItems([lang.OFF, lang.ON]);
      this.MASTERLOCK.setItemWidth(90);
      this.MASTERLOCK.getState = function() {
        this.state = settings.masterLock ? 1 : 0
      };
      this.MASTERLOCK.valueFunc =
        function() {
          settingsStorage.set("masterLock", 1 == this.state);
          masterWidget.sl.locked = 1 == this.state;
          regUpdate(masterWidget)
        };
      IS_UI_24 && (this.BIGSO = new SWITCHBOX(this), this.BIGSO.label = lang.BIGGER_SLIDEOUT + ":", this.BIGSO.setPos(250, 50 + 50 * a++), this.BIGSO.setItems([lang.OFF, lang.ON]), this.BIGSO.setItemWidth(120), this.BIGSO.getState = function() {
        this.state = settings.bigSlideOut ? 1 : 0
      }, this.BIGSO.valueFunc = function() {
        settingsStorage.set("bigSlideOut", 1 == this.state);
        settingsStorage.save();
        confOk.valueFunc = function() {
          location.reload()
        };
        showConfBox(lang.RELOAD_UI)
      });
      this.NUDGE = new SWITCHBOX(this);
      this.NUDGE.label = lang.HOLD_FADER_FOR_FINE_TUNING + ":";
      this.NUDGE.setPos(250, 50 + 50 * a++);
      this.NUDGE.setItems([lang.OFF, lang.ON]);
      this.NUDGE.getState = function() {
        this.state = settings.nudge ? 1 : 0
      };
      this.NUDGE.valueFunc = function() {
        settingsStorage.set("nudge", 1 == this.state)
      };
      this.VUQUANTIZE = new SWITCHBOX(this);
      this.VUQUANTIZE.label = lang.METER_QUANTISATION + ":";
      this.VUQUANTIZE.setPos(250, 50 + 50 * a++);
      this.VUQUANTIZE.setItems([lang.OFF, lang.ON]);
      this.VUQUANTIZE.getState =
        function() {
          this.state = settings.vuquantise ? 1 : 0
        };
      this.VUQUANTIZE.valueFunc = function() {
        settingsStorage.set("vuquantise", 1 == this.state)
      };
      this.LANES = new SWITCHBOX(this);
      this.LANES.label = lang.FADER_GLOW + ":";
      this.LANES.setPos(250, 50 + 50 * a++);
      this.LANES.setItems([lang.OFF, lang.THIN, lang.NORM]);
      this.LANES.getState = function() {
        this.state = settings.lanes
      };
      this.LANES.valueFunc = function() {
        settingsStorage.set("lanes", this.state);
        regUpdate(masterWidget);
        allStrips.forEach(function(a) {
          a.UPDATE_CACHE()
        })
      };
      this.DISABLEVUGHOST =
        new SWITCHBOX(this);
      this.DISABLEVUGHOST.label = lang.DISABLE_VU_INPUT_LEVEL + ":";
      this.DISABLEVUGHOST.setPos(250, 50 + 50 * a++);
      this.DISABLEVUGHOST.setItems([lang.OFF, lang.ON]);
      this.DISABLEVUGHOST.getState = function() {
        this.state = settings.disableVUghost ? 1 : 0
      };
      this.DISABLEVUGHOST.valueFunc = function() {
        settingsStorage.set("disableVUghost", 1 == this.state)
      };
      this.DISABLEVUPEAK = new SWITCHBOX(this);
      this.DISABLEVUPEAK.label = lang.DISABLE_VU_PEAK + ":";
      this.DISABLEVUPEAK.setPos(250, 50 + 50 * a++);
      this.DISABLEVUPEAK.setItems([lang.OFF,
        lang.ON
      ]);
      this.DISABLEVUPEAK.getState = function() {
        this.state = settings.disableVUpeak ? 1 : 0
      };
      this.DISABLEVUPEAK.valueFunc = function() {
        settingsStorage.set("disableVUpeak", 1 == this.state)
      };
      this.DISABLEVU2 = new SWITCHBOX(this);
      this.DISABLEVU2.label = lang.HIDE_COMP_GATE + ":";
      this.DISABLEVU2.setPos(250, 50 + 50 * a++);
      this.DISABLEVU2.setItems([lang.OFF, lang.ON]);
      this.DISABLEVU2.getState = function() {
        this.state = settings.disableVUs2 ? 1 : 0
      };
      this.DISABLEVU2.valueFunc = function() {
        settingsStorage.put("disableVUs2", 1 == this.state);
        confOk.valueFunc = function() {
          location.reload()
        };
        showConfBox(lang.RELOAD_UI)
      };
      this.DIMVU = new SWITCHBOX(this);
      this.DIMVU.label = lang.DIM_LED_METERS + ":";
      this.DIMVU.setPos(250, 50 + 50 * a++);
      this.DIMVU.setItems([lang.OFF, lang.ON]);
      this.DIMVU.getState = function() {
        this.state = settings.dimVUs ? 1 : 0
      };
      this.DIMVU.valueFunc = function() {
        settingsStorage.set("dimVUs", 1 == this.state);
        regUpdate(masterWidget)
      };
      this.PINSO = new SWITCHBOX(this);
      this.PINSO.label = lang.PIN_SLIDEOUT_IN_MIX_MODE + ":";
      this.PINSO.setPos(250, 50 + 50 * a++);
      this.PINSO.setItems([lang.OFF,
        lang.ON
      ]);
      this.PINSO.getState = function() {
        this.state = settings.pinSlideOut ? 1 : 0
      };
      this.PINSO.valueFunc = function() {
        settingsStorage.set("pinSlideOut", 1 == this.state)
      };
      this.PINSOX = new SWITCHBOX(this);
      this.PINSOX.label = lang.PIN_SO_FOR_AUX_FX_SENDS + ":";
      this.PINSOX.setPos(250, 50 + 50 * a++);
      this.PINSOX.setItems([lang.OFF, lang.ON]);
      this.PINSOX.getState = function() {
        this.state = settings.pinSlideOutX ? 1 : 0
      };
      this.PINSOX.valueFunc = function() {
        settingsStorage.set("pinSlideOutX", 1 == this.state)
      };
      this.KINETIC = new SWITCHBOX(this);
      this.KINETIC.label = lang.KINETIC_SCROLL + ":";
      this.KINETIC.setPos(250, 50 + 50 * a++);
      this.KINETIC.setItems([lang.OFF, lang.ON]);
      this.KINETIC.getState = function() {
        this.state = settings.kinetic ? 0 : 1
      };
      this.KINETIC.valueFunc = function() {
        settingsStorage.set("kinetic", 0 == this.state)
      };
      this.SWIPE = new SWITCHBOX(this);
      this.SWIPE.label = lang.MIXER_SCROLLING + ":";
      this.SWIPE.setPos(250, 50 + 50 * a++);
      this.SWIPE.setItems([lang.ONE_FINGER, lang.TWO_FINGERS]);
      this.SWIPE.setItemWidth(90);
      this.SWIPE.getState = function() {
        this.state = settings.oneFingerScroll ?
          0 : 1
      };
      this.SWIPE.valueFunc = function() {
        settingsStorage.set("oneFingerScroll", 0 == this.state)
      };
      isLocal || (this.PATTERNED = new SWITCHBOX(this), this.PATTERNED.label = lang.PATTERNED_BACKGROUND + ":", this.PATTERNED.setPos(250, 50 + 50 * a++), this.PATTERNED.setItems([lang.OFF, lang.ON]), this.PATTERNED.getState = function() {
        this.state = settings.patterned ? 1 : 0
      }, this.PATTERNED.valueFunc = function() {
        settingsStorage.set("patterned", 1 == this.state);
        settingsStorage.save();
        confOk.valueFunc = function() {
          location.reload()
        };
        showConfBox(lang.RELOAD_UI)
      });
      this.MOREMEPORTRAIT = new SWITCHBOX(this);
      this.MOREMEPORTRAIT.label = lang.MOREME_PORTRAIT_MODE + ":";
      this.MOREMEPORTRAIT.setPos(250, 50 + 50 * a++);
      this.MOREMEPORTRAIT.setItems([lang.OFF, lang.ON]);
      this.MOREMEPORTRAIT.getState = function() {
        this.state = settings.moremeportrait ? 1 : 0
      };
      this.MOREMEPORTRAIT.valueFunc = function() {
        settingsStorage.set("moremeportrait", 1 == this.state);
        settingsStorage.save()
      };
      d = [this.DRAWRATE, this.DISABLESCALE, this.DISABLERETINA, this.DISABLEVU, this.MASTERLOCK, this.NUDGE, this.VUQUANTIZE, this.LANES,
        this.DISABLEVU2, this.DISABLEVUGHOST, this.DISABLEVUPEAK, this.DIMVU, this.PINSO, this.PINSOX, this.KINETIC, this.SWIPE, this.PATTERNED, this.MOREMEPORTRAIT
      ];
      for (c = 0; c < d.length; c++) isDefined(d[c]) && d[c].setItemWidth(120);
      this.DRAWRATE.setItemWidth(60);
      this.LANES.setItemWidth(80);
      for (c = 0; c < this.widgets.length; c++) this.widgets[c].labelColor = "hsl(" + 20 * c + ",20%,78%)";
      var d = [lang.NEW_SNAPSHOT, lang.UPDATE_CURRENT_SNAPSHOT, lang.NEXT_SNAPSHOT, lang.PREVIOUS_SNAPSHOT, lang.PLAY],
        f = [E_FFUNC.NEWSNAP, E_FFUNC.UPDCURSNAP,
          E_FFUNC.NEXT_SNAP, E_FFUNC.PREV_SNAP, E_FFUNC.PLAY
        ];
      curSetup.rec && (d.push(lang.RECORD), f.push(E_FFUNC.REC));
      HAVE_MTK && (d.push(lang.MTK_PLAY, lang.MTK_RECORD), f.push(E_FFUNC.MTK_PLAY, E_FFUNC.MTK_REC));
      d.push(lang.MUTE_ALL, lang.DIM);
      f.push(E_FFUNC.MUTE_ALL, E_FFUNC.DIM);
      for (var e = [], c = 0; c < d.length; c++) e.push("");
      this.F1FUNC = new RADIO(this);
      this.F1FUNC.setPos(720, this.MASTERLOCK.y + 11 + 60);
      this.F1FUNC.setLabels(d);
      this.F1FUNC.getState = function() {
        var a = f.indexOf(settings.f1func); - 1 == a && (settingsStorage.set("f1func",
          E_FFUNC.PLAY), a = f.indexOf(settings.f1func));
        this.state = a
      };
      this.F1FUNC.onSelect = function() {
        settingsStorage.set("f1func", f[this.state]);
        prepareF1F2()
      };
      this.F2FUNC = new RADIO(this);
      this.F2FUNC.setPos(780, this.MASTERLOCK.y + 11 + 60);
      this.F2FUNC.setLabels(e);
      this.F2FUNC.getState = function() {
        var a = f.indexOf(settings.f2func); - 1 == a && (settingsStorage.set("f1func", E_FFUNC.PLAY), a = f.indexOf(settings.f2func));
        this.state = a
      };
      this.F2FUNC.onSelect = function() {
        settingsStorage.set("f2func", f[this.state]);
        prepareF1F2()
      };
      this.LANG = new RADIO(this);
      this.LANG.setPos(720, this.F1FUNC.y + 40 * d.length + 70);
      c = [langBase.en.lang, langBase.cn.lang];
      ENGLISH_ONLY && c.pop();
      this.LANG.setLabels(c);
      this.LANG.getState = function() {
        switch (settings.lang) {
          case "en":
            this.state = 0;
            break;
          case "cn":
            this.state = 1;
            break;
          case "de":
            this.state = 2;
            break;
          case "fr":
            this.state = 3;
            break;
          case "es":
            this.state = 4;
            break;
          case "ru":
            this.state = 5
        }
      };
      this.LANG.onSelect = function() {
        var a = "en";
        switch (this.state) {
          case 0:
            a = "en";
            break;
          case 1:
            a = "cn";
            break;
          case 2:
            a = "de";
            break;
          case 3:
            a = "fr";
            break;
          case 4:
            a = "es";
            break;
          case 5:
            a = "ru"
        }
        settingsStorage.set("lang", a);
        settingsStorage.save();
        confOk.valueFunc = function() {
          location.reload()
        };
        showConfBox(lang.RELOAD_UI)
      };
      a += .5;
      this.IMPORTPRESETS = new MENUBUTTON(this);
      this.IMPORTPRESETS.setPos(250, 50 + 50 * a++);
      this.IMPORTPRESETS.w = 180;
      this.IMPORTPRESETS.text = lang.IMPORT_ALL_PRESETS;
      this.IMPORTPRESETS.onPress = function() {
        confOk.valueFunc = function() {
          sendMessage(E_COMMANDS.IMPORT_PRESETS)
        };
        showConfBox(lang.IMPORT_ALL_PRESETS + "?")
      };
      this.EXPORTPRESETS =
        new MENUBUTTON(this);
      this.EXPORTPRESETS.setPos(250, 50 + 50 * a++);
      this.EXPORTPRESETS.w = 180;
      this.EXPORTPRESETS.text = lang.EXPORT_ALL_PRESETS;
      this.EXPORTPRESETS.onPress = function() {
        var a = new MODAL_LIST(null, E_COMMANDS.USB_LIST);
        a.title = lang.EXPORT_ALL_PRESETS;
        a.valueFunc = function(a) {
          a ? sendMessage(E_COMMANDS.EXPORT_PRESETS + "^" + a) : showPopupMsg(lang.NO_USB_DEVICE_SELECTED)
        }
      };
      this.preset = new MENUBUTTON(this);
      this.preset.setSize(180, 29);
      this.preset.setAnchors(250, 50 + 50 * a++);
      this.preset.text = lang.LOCAL_SETTINGS_PRESETS;
      this.preset.color = color.red;
      this.preset.onPress = function() {
        b.showPresets()
      };
      this.reset = new MENUBUTTON(this);
      this.reset.setSize(180, 29);
      this.reset.setAnchors(250, 50 + 50 * a++);
      this.reset.text = lang.RESET_LOCAL_SETTINGS;
      this.reset.color = color.red;
      this.reset.onPress = function() {
        isBlocked("gsettings") ? showPopupMsg(lang.LOCKED, 700) : (localStorage.clear(), confOk.valueFunc = function() {
          location.reload()
        }, showConfBox(lang.RELOAD_UI))
      };
      this.hh = 50 + 50 * a++
    },
    showPresets: function() {
      this.menu = new PRESET_MENU2(null, "ux",
        this, this.color);
      regUpdate(this.menu)
    },
    savePreset: function(a) {
      a = JSON.stringify(settings);
      log(a);
      return a
    },
    loadPreset: function(a, b) {
      settings = JSON.parse(a);
      settingsStorage.save();
      confOk.valueFunc = function() {
        location.reload()
      };
      showConfBox(lang.RELOAD_UI);
      drawAll()
    },
    calcGeometry: function() {
      this.w = this.parent.w - this.x;
      this.h = this.parent.h - this.y;
      this.maxY = this.hh - this.h;
      0 > this.maxY && (this.maxY = 0);
      this.offsetY = bound(this.offsetY, 0, this.maxY)
    },
    paint: function() {
      ctx.fillStyle = color.eqBg;
      ctx.fillRect(0, this.offsetY,
        this.w, this.h);
      ctx.textAlign = "right";
      var a = {
        shadow: Shadow.main
      };
      IS_UI_24 && (ctx.font = font.settings, ctx.fillStyle = "#aba", this.SOLO_VOL && ctx.drawText(lang.SOLO_LEVEL + ":", this.SOLO_VOL.x - 25, this.SOLO_VOL.y + 29, a), ctx.drawText(lang.HP_VOLUME.format(1) + ":", this.HP_L.x - 25, this.HP_L.y + 29, a), ctx.drawText(lang.HP_VOLUME.format(2) + ":", this.HP_R.x - 25, this.HP_R.y + 29, a));
      ctx.font = font.editbox;
      ctx.fillStyle = color.yellow;
      this.PEDAL && ctx.drawText(lang.PEDAL_FUNCTION, this.PEDAL.x + 34, this.PEDAL.y - 11, a);
      ctx.drawText(lang.BUTTON_FUNCTION,
        this.F1FUNC.x - 26, this.F1FUNC.y - 18, a);
      ctx.drawText(lang.LANGUAGE, this.LANG.x - 26, this.LANG.y - 18, a);
      ctx.drawText(lang.GUI_PERFORMANCE + ":", this.DRAWRATE.x - 25, this.DRAWRATE.y - 11, a);
      ctx.drawText(lang.SYNC_SELECTED_CH, this.SYNC.x + this.SYNC.w, this.SYNC.y - 11, a);
      ctx.drawText(lang.GLOBAL + ":", 225, 39, a);
      ctx.drawText(lang.LOCAL + ":", this.MASTERLOCK.x - 25, this.MASTERLOCK.y - 13, a);
      ctx.drawText(lang.UTILITY + ":", this.IMPORTPRESETS.x - 25, this.IMPORTPRESETS.y - 13, a);
      ctx.textAlign = "left";
      ctx.fillStyle = color.tabText;
      ctx.drawText("F1",
        this.F1FUNC.x + 7, this.F1FUNC.y - 18, a);
      ctx.drawText("F2", this.F2FUNC.x + 7, this.F2FUNC.y - 18, a);
      ctx.fillStyle = "rgba(255,255,255,0.07)";
      ctx.fillRoundRect(this.w - 11, this.offsetY + 2, 10, this.h - 4, 4);
      ctx.fillStyle = "rgba(255,255,255,0.4)";
      a = this.h / (this.h + this.maxY) * (this.h - 4);
      ctx.fillRoundRect(this.w - 11, this.offsetY + (2 + this.offsetY / this.maxY * (this.h - 4 - a) | 0), 10, a, 4)
    }
  }),
  PERM_PAGE = Class.create(SETTINGS_SUBPAGE, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "PERM_PAGE";
      this.color = color.red;
      this.buttons = [];
      this.auxs = [];
      this.initWidgets()
    },
    onShow: function() {},
    initWidgets: function() {
      var a = this,
        b = 0;
      this.SETPASS = new CHECKBUTTON(this);
      this.SETPASS.setSize(160, 40);
      this.SETPASS.setPos(60, 70);
      this.SETPASS.getState = function() {
        this.text = (this.state = !!getValue("settings.block.pass")) ? lang.DISABLE : lang.ENABLE
      };
      this.SETPASS.onToggleUp = function() {
        editOk.valueFunc = function() {
          var b = editBox2.value;
          b && (setValue("settings.block.pass", b), settingsStorage.set("master_pass", b), regUpdate(a))
        };
        showEditBox2(lang.SET_MASTER_PASS,
          "")
      };
      this.SETPASS.onToggleDown = function() {
        editOk.valueFunc = function() {
          var b = editBox2.value;
          b && (getValue("settings.block.pass") == b ? (setValue("settings.block.pass", ""), setValue("settings.block.mode", 0), settingsStorage.set("master_pass", ""), showPopupMsg(lang.UNLOCKED)) : showPopupMsg(lang.WRONG_PASSWORD), regUpdate(a))
        };
        showEditBox2(lang.ENTER_PASS_TO_UNLOCK, "")
      };
      this.LOGIN = new CHECKBUTTON(this);
      this.LOGIN.setSize(160, 40);
      this.LOGIN.setPos(250, 70);
      this.LOGIN.text = lang.LOG_IN;
      this.LOGIN.color = color.green;
      this.LOGIN.getState = function() {
        var a = getValue("settings.block.pass");
        this.disabled = !a;
        this.text = lang.LOG_IN;
        if (a) {
          if (this.state = a == settings.master_pass) this.text = lang.LOG_OUT
        } else this.state = 0
      };
      this.LOGIN.onToggleUp = function() {
        editOk.valueFunc = function() {
          var b = editBox2.value;
          b && (getValue("settings.block.pass") == b ? (settingsStorage.set("master_pass", b), showPopupMsg(lang.LOGGED_IN)) : showPopupMsg(lang.WRONG_PASSWORD), regUpdate(a))
        };
        showEditBox2(lang.ENTER_PASS, "")
      };
      this.LOGIN.onToggleDown = function() {
        settingsStorage.set("master_pass",
          "");
        regUpdate(a);
        showPopupMsg(lang.LOGGED_OUT)
      };
      for (var c = [lang.AUX_LEVELS, lang.AUX_PROCESSING, lang.MIX_LEVELS, lang.MIX_PROCESSING, lang.MIX_GAIN, lang.PLAYER, lang.MASTER_LEVEL, lang.MASTER_PROCESSING, lang.SHOWS, lang.GLOBAL_SETTINGS], d = "auxlvl auxproc mixlvl mixproc mixgain player mlvl mproc shows gsettings".split(" "), f = 0; f < c.length; f++) {
        var e = new SCheckBox(this);
        e.setSize(111, 50);
        e.setPos(60 + f % 5 * (e.w + 15), 180 + 80 * (b + (5 <= f) ? 1 : 0));
        e.font = "14pt open_sans_condensedbold";
        e.mline = !0;
        e.text = c[f].replace(" ",
          "<br>");
        e.kkk = "settings.block." + d[f];
        e.color = color.green;
        e.getState = function() {
          this.state = getValue(this.kkk) || 0;
          var a = getValue("settings.block.pass");
          this.disabled = !a || a != settings.master_pass
        };
        e.onToggle = function() {
          setValue(this.kkk, this.state)
        };
        this.buttons.push(e)
      }
      for (f = b = 0; f < curSetup.aux; f++) e = new SCheckBox(this), e.setSize(90, 50), e.font = "14pt open_sans_condensedbold", 8 == f && b++, e.setPos(60 + f % 8 * (e.w + 15), 390 + 80 * b), e.text = lang.AUX + " " + (f + 1), e.idx = f, e.kkk = "perm_aux" + (f + 1), e.color = color.green, e.getState =
        function() {
          this.state = settingsStorage.get("perm_aux" + (this.idx + 1));
          var a = getValue("settings.block.pass"),
            b = getValue("settings.block.auxlvl"),
            c = getValue("settings.block.auxproc");
          this.disabled = !(a && (b || c))
        }, e.onToggle = function() {
          settingsStorage.set("perm_aux" + (this.idx + 1), this.state);
          switch (auxStrips[this.idx].getNameValue("stereoIndex")) {
            case 0:
              this.idx < auxStrips.length && settingsStorage.set("perm_aux" + (this.idx + 2), this.state);
              regUpdate(a);
              break;
            case 1:
              0 < this.idx && settingsStorage.set("perm_aux" + this.idx,
                this.state), regUpdate(a)
          }
        }, this.buttons.push(e), this.auxs.push(e)
    },
    paint: function() {
      ctx.fillStyle = color.eqBg;
      ctx.fillRect(0, 0, this.w, this.h);
      ctx.font = font.editbox;
      ctx.textAlign = "left";
      ctx.fillStyle = color.white;
      ctx.fillText(lang.MASTER_PASSWORD_PROTECTION, 60, 50);
      ctx.fillStyle = color.yellow;
      ctx.fillText(lang.ALLOW_CLIENT_ACCESS_FOR + ":", 60, 160);
      ctx.fillText(lang.LOCAL_AUX_CONTROL + ":", 60, 370)
    }
  }),
  CASCADE_SUBPAGE = Class.create(SETTINGS_SUBPAGE, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "CASCADE_SUBPAGE";
      this.initWidgets()
    },
    initWidgets: function() {
      var a = 0;
      this.cascade = new SWITCHBOX(this);
      this.cascade.label = lang.CASCADE + ":";
      this.cascade.setPos(250, 50 + 50 * a++);
      this.cascade.setItemWidth(100);
      this.cascade.setItems([lang.DISABLE, lang.ENABLE]);
      a++;
      this.locate1 = new MENUBUTTON(this);
      this.locate1.setAnchors(590, 50 + 50 * a, null, null);
      this.locate1.w = 200;
      this.locate1.text = "LOCATE UNIT 1";
      this.locate1.onPress = function() {};
      this.master = new SWITCHBOX(this);
      this.master.label = lang.CASCADE_MASTER + ":";
      this.master.setPos(250,
        50 + 50 * a++);
      this.master.setItemWidth(100);
      this.master.setItems(["UNIT 1", "UNIT 2"]);
      this.locate2 = new MENUBUTTON(this);
      this.locate2.setAnchors(590, 50 + 50 * a, null, null);
      this.locate2.w = 200;
      this.locate2.text = "LOCATE UNIT 2";
      this.locate2.onPress = function() {};
      this.range = new SWITCHBOX(this);
      this.range.label = lang.MASTER_CHANNEL_RANGE + ":";
      this.range.setPos(250, 50 + 50 * a++);
      this.range.setItemWidth(100);
      this.range.setItems(["1 - 24", "25 - 48"])
    }
  }),
  ABOUTPage = Class.create(SETTINGS_SUBPAGE, {
    initialize: function($super,
      b) {
      $super(b);
      this.widgetName = "ABOUT";
      this.clickNum = 0;
      this.CPY = new SButton(this);
      this.CPY.text = lang.COPY_TO_CLIPBOARD;
      this.CPY.w = 150;
      this.CPY.onPress = function() {
        window.prompt("UNIQUE ID:", netConfig.uid || "unknown")
      }
    },
    onDown: function(a, b) {
      var c = a - this.globalX(),
        d = b - this.globalY(),
        f = res.about.w(),
        e = res.about.h();
      isInRect((this.w - f) / 2 + 3, (this.h - e) / 2 - 100, f, e, c, d) && (this.clickNum++, this.clickNum % 10 || window.open("/img1x/ui_about.png"), b = a = -1);
      this.lastPressPoint = this.pressPoint;
      this.pressPoint = [a, b]
    },
    onUp: function(a) {
      if (-1 !=
        this.pressPoint[0]) {
        var b = Date.now(),
          c = Math.abs(this.lastPressPoint[0] - this.pressPoint[0]),
          d = Math.abs(this.lastPressPoint[1] - this.pressPoint[1]);
        2 < mouseTargets.length || isDefined(tHash[a]) && 2 < tHash[a].length || (30 > c && 30 > d && b - this.lastClickTime < DBL_CLK_TIME ? (this.onDouble(), this.lastClickTime = b - DBL_CLK_TIME) : this.lastClickTime = b)
      }
    },
    calcGeometry: function() {
      this.w = this.parent.w - this.x;
      this.h = this.parent.h - this.y;
      var a = this.w,
        b = res.about.w(),
        c = res.about.h(),
        d = (this.h - c) / 2 - 100 + c + 80;
      2 < a ? (this.grd = ctx.createRadialGradient(a /
        2, d, 10, a / 2, d, a / 2), this.grd.addColorStop(0, "#0b1735"), this.grd.addColorStop(1, "#020203")) : this.grd = "#0b1735";
      a = (this.w - b) / 2 + 3;
      d = (this.h - c) / 2 - 100;
      this.CPY.setPos(a + 207, d + (c + 116))
    },
    paint: function() {
      ctx.fillStyle = "#020203";
      ctx.fillRect(0, 0, this.w, this.h);
      ctx.fillStyle = this.grd;
      ctx.fillRect(0, 0, this.w, this.h);
      var a = res.about.w(),
        b = res.about.h(),
        c = (this.h - b) / 2 - 100;
      drawImage(res.about, (this.w - a) / 2 + 3, c);
      ctx.textAlign = "right";
      ctx.fillStyle = color.tabText;
      ctx.font = "12pt open_sans_condensedbold";
      drawText("MODEL: " +
        (netConfig.model || "unknown") + "<br>SERIAL: " + (netConfig.serial || "unknown") + "<br>FIRMWARE: " + (netConfig.firmware || "unknown") + "<br><br>UNIQUE ID: " + (netConfig.uid || "unknown"), this.w / 2 | 0, c + (b + 20), {
          align: "center",
          color: color.white
        });
      c = this.h - 120;
      a = lang.COPYRIGHT_MSG;
      b = ctx.measureText("All third party marks are the trademarks of their respective owners. These marks are used to identify").width;
      drawText(a, (this.w - b) / 2 | 0, c, {
        align: "left",
        color: color.white
      })
    }
  }),
  ROUTING_PAGE = Class.create(SETTINGS_SUBPAGE, {
    initialize: function($super,
      b) {
      $super(b);
      this.widgetName = "SETTINGS_SUBPAGE";
      this.color = color.red;
      this.offsetY = this.mode = 0;
      this.hh = this.maxY = 900;
      this.needMoveEvt = this.needClip = !0;
      this.initWidgets()
    },
    setOffset: function(a) {
      this.offsetY = bound(a | 0, 0, this.maxY);
      regUpdate(this)
    },
    onShow: function() {
      this.setOffset(0)
    },
    onDown: function(a, b, c) {
      2 < mouseTargets.length || isDefined(tHash[c]) && 2 < tHash[c].length || (this.lastPressPoint = this.pressPoint, this.pressPoint = [a, b + this.offsetY], this.ppy = this.offsetY + b, this.d = this.offsetY)
    },
    onMove: function(a,
      b, c) {
      2 < mouseTargets.length || isDefined(tHash[c]) && 2 < tHash[c].length || this.setOffset(this.ppy - b)
    },
    onUp: function(a) {
      if (!(2 < mouseTargets.length || isDefined(tHash[a]) && 2 < tHash[a].length)) {
        a = Date.now();
        var b = Math.abs(this.lastPressPoint[0] - this.pressPoint[0]),
          c = Math.abs(this.lastPressPoint[1] - this.pressPoint[1]);
        10 > Math.abs(this.d - this.offsetY) && 30 > b && 30 > c && a - this.lastClickTime < DBL_CLK_TIME ? (this.onDouble(), this.lastClickTime = a - DBL_CLK_TIME) : this.lastClickTime = a
      }
    },
    onDouble: function() {
      setMode(E_MODE.MIX)
    },
    onWheel: function(a) {
      clearInterval(ticker);
      this.setOffset(this.offsetY - Math.round(a / 3))
    },
    setMode: function(a) {
      this.mode = a;
      this.grid.setMode(a);
      this.updateGeometry();
      regUpdate(this)
    },
    setSrc: function(a) {
      this.grid.setSrc(a);
      regUpdate(this)
    },
    initWidgets: function() {
      var a = this;
      this.back = new MENUBUTTON(this);
      this.back.text = "< " + lang.EDIT_CHANNEL;
      this.back.setAnchors(20, 10, null, null);
      this.back.color = color.purple;
      this.back.w = 200;
      this.back.h = 40;
      this.back.onPress = function() {
        modeHistory.last() != E_MODE.EDIT && modeHistory.last() !=
          E_MODE.PLAYER ? (editWidget.setMode(editWidget.E_MODE.misc), setMode(E_MODE.EDIT)) : modeBack()
      };
      this.clrArr = [color.orange, color.green, color.yellow];
      this.modes = new SWITCHBOX(this);
      this.modes.setItems([lang.INPUTS, lang.SOUNDCHECK]);
      this.modes.setItemWidth(180);
      this.modes.setAnchors(null, 10, null, null);
      this.modes.h = 40;
      this.modes.colors = this.clrArr;
      this.modes.font = "18px open_sans_condensedbold";
      this.modes.getState = function() {
        this.state = a.grid.mode
      };
      this.modes.valueFunc = function() {
        a.setMode(this.state);
        regUpdate(a)
      };
      this.grid = new R_GRID(this);
      this.grid.setAnchors(120, 60, 20, null);
      this.local = new CHECKBUTTON(this);
      this.local.setAnchors(20, 81, null, null);
      this.local.color = this.local.textColor = color.LOCAL;
      this.local.mode = 0;
      this.local.setSize(90, 60);
      this.local.text = lang.LOCAL;
      this.local.getState = function() {
        this.state = a.grid.src == this.mode
      };
      this.local.onToggleUp = function() {
        a.grid.setSrc(this.mode);
        regUpdate(a)
      };
      this.usb = new CHECKBUTTON(this);
      this.usb.setAnchors(20, 151, null, null);
      this.usb.color = this.usb.textColor = color.USB;
      this.usb.mode = 1;
      this.usb.setSize(90, 60);
      this.usb.w = 90;
      this.usb.text = lang.USB_A;
      this.usb.getState = function() {
        this.state = a.grid.src == this.mode
      };
      this.usb.onToggleUp = function() {
        a.grid.setSrc(this.mode);
        regUpdate(a)
      };
      ROUTING_TEST_MODE && this.usb.hide();
      this.sd = new CHECKBUTTON(this);
      this.sd.setAnchors(20, 221, null, null);
      this.sd.color = this.sd.textColor = color.SD;
      this.sd.mode = 2;
      this.sd.setSize(90, 60);
      this.sd.w = 90;
      this.sd.text = lang.USB_B;
      this.sd.getState = function() {
        this.state = a.grid.src == this.mode
      };
      this.sd.onToggleUp =
        function() {
          a.grid.setSrc(this.mode);
          regUpdate(a)
        };
      this.reset11 = new MENUBUTTON(this);
      this.reset11.text = lang.PATCH_1_1;
      this.reset11.setAnchors(20, 431, null, null);
      this.reset11.color = color.purple;
      this.reset11.w = 90;
      this.reset11.h = 40;
      this.reset11.onPress = function() {
        confOk.parSrc = a.grid.src;
        confOk.parMode = a.grid.mode;
        confOk.par1 = a;
        confOk.valueFunc = function() {
          for (var a = 0; a < this.par1.grid.channels.length; a++) {
            var c = this.par1.grid.channels[a];
            if (1 == this.parMode) switch (this.parSrc) {
              case 0:
                c.type == E_STRIP_TYPE.IN &&
                  c.setNameValue("scsrc", "hw." + c.subId);
                c.type == E_STRIP_TYPE.LINEIN && c.setNameValue("scsrc", "li." + c.subId);
                break;
              case 1:
                c.setNameValue("scsrc", "ua." + a);
                break;
              case 2:
                c.setNameValue("scsrc", "ub." + a)
            } else switch (this.parSrc) {
              case 0:
                c.type == E_STRIP_TYPE.IN && c.setNameValue("src", "hw." + c.subId);
                c.type == E_STRIP_TYPE.LINEIN && c.setNameValue("src", "li." + c.subId);
                break;
              case 1:
                c.setNameValue("src", "ua." + a);
                break;
              case 2:
                c.setNameValue("src", "ub." + a)
            }
          }
          drawAll()
        };
        showConfBox(lang.PATCH_1_1)
      };
      this.reset = new MENUBUTTON(this);
      this.reset.text = lang.RESET;
      this.reset.setAnchors(20, 361, null, null);
      this.reset.color = color.purple;
      this.reset.w = 90;
      this.reset.h = 40;
      this.reset.onPress = function() {
        confOk.parSrc = a.grid.src;
        confOk.parMode = a.grid.mode;
        confOk.par1 = a;
        confOk.valueFunc = function() {
          for (var a = 0; a < this.par1.grid.channels.length; a++) {
            var c = this.par1.grid.channels[a];
            1 == this.parMode ? c.setNameValue("scsrc", "") : (c.type == E_STRIP_TYPE.IN && c.setNameValue("src", "hw." + c.subId), c.type == E_STRIP_TYPE.LINEIN && c.setNameValue("src", "li." + c.subId))
          }
          drawAll()
        };
        showConfBox(lang.RESET)
      };
      this.scheck = new CHECKBUTTON(this);
      this.scheck.setAnchors(null, 10, 20, null);
      this.scheck.setSize(101, 40);
      this.scheck.text = formatButtonText(lang.ACTIVATE_SOUNDCHECK);
      this.scheck.textColor = this.scheck.color = color.green;
      this.scheck.textColor2 = color.white;
      this.scheck.setKey("var.mtk.soundcheck");
      this.scheck.regKey("var.mtk.soundcheck");
      this.scheck.onToggle = function() {
        updateByKey("var.mtk.soundcheck")
      }
    },
    calcGeometry: function() {
      this.w = this.parent.w - this.x;
      this.h = this.parent.h - this.y;
      this.modes.x = 220 + (this.w - 110 - 220 - 360) / 2 | 0;
      this.hh = this.grid.y + this.grid.h + 10;
      this.maxY = this.hh - this.h;
      0 > this.maxY && (this.maxY = 0);
      this.offsetY = bound(this.offsetY, 0, this.maxY)
    },
    paint: function() {
      ctx.fillStyle = color.eqBg;
      ctx.fillRect(0, this.offsetY, this.w, this.h);
      if (this.hh > this.h) {
        ctx.fillStyle = "rgba(255,255,255,0.02)";
        ctx.fillRoundRect(this.w - 10, this.offsetY + 2, 10, this.h - 4, 5);
        ctx.fillStyle = "rgba(255,255,255,0.1)";
        var a = this.h / (this.h + this.maxY) * (this.h - 4);
        ctx.fillRoundRect(this.w - 10, this.offsetY + (2 +
          this.offsetY / this.maxY * (this.h - 4 - a) | 0), 10, a, 5)
      }
    }
  }),
  R_GRID = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "R_GRID";
      this.needMoveEvt = !0;
      this.w = 500;
      this.h = 580;
      this.xHeight = 21;
      this.yWidth = 80;
      this.cols = 20;
      this.rowH = this.rows = 22;
      this.src = this.mode = 0;
      this.topColor = color.LOCAL;
      this.clrArr = [color.LOCAL, color.USB, color.SD];
      this.haveSubs = !0;
      this.haveEth = !1;
      this.channels = inStrips;
      this.upd()
    },
    setMode: function(a) {
      this.mode = a;
      this.upd();
      regUpdate(this)
    },
    setSrc: function(a) {
      this.src =
        a;
      this.upd();
      regUpdate(this)
    },
    upd: function() {
      var a = 0;
      switch (this.mode) {
        case 0:
        case 1:
          this.channels = inStrips.concat(lineinStrips);
          break;
        case 2:
          this.channels = [];
          for (var b = 0; b < inStrips.length; b++) this.channels.push(inStrips[b]);
          for (b = 0; b < lineinStrips.length; b++) this.channels.push(lineinStrips[b]);
          for (b = 0; b < mediaStrips.length; b++) this.channels.push(mediaStrips[b]);
          if (this.haveSubs)
            for (b = 0; b < subStrips.length; b++) this.channels.push(subStrips[b]);
          for (b = 0; b < auxStrips.length; b++) this.channels.push(auxStrips[b]);
          this.channels.push(masterWidget)
      }
      switch (this.src) {
        case 0:
          a = curSetup.input + 2;
          this.topColor = color.LOCAL;
          break;
        case 1:
          a = CASCADE_MODE ? 44 : 22;
          this.topColor = color.USB;
          break;
        case 2:
          a = CASCADE_MODE ? 64 : 32, this.topColor = color.SD
      }
      this.rows = this.channels.length;
      this.cols = a;
      this.h = this.xHeight + this.rows * this.rowH
    },
    onDown: function(a, b) {
      this.onMove(a, b)
    },
    onMove: function(a, b) {
      var c = b - this.globalY(),
        c = c - this.xHeight,
        c = c / this.rowH | 0;
      0 > c || c >= this.channels.length || (setSelected(this.channels[c].id), regUpdate(this.parent))
    },
    paint: function() {
      var a = 22;
      switch (this.src) {
        case 0:
          a = 22;
          break;
        case 1:
          a = 22;
          break;
        case 2:
          a = 32
      }
      this.cols = a;
      var b = this.w,
        c = this.h;
      ctx.fillStyle = color.eqBg;
      ctx.fillRect(0, 0, b, c);
      var d = this.yWidth,
        f = this.xHeight,
        b = (b - d) / this.cols | 0,
        c = (c - f) / this.rows | 0;
      ctx.fillStyle = color.black;
      ctx.fillRect(d, f, b * this.cols, c * this.rows);
      if (CASCADE_MODE) {
        var e, g;
        ctx.fillStyle = "rgba(255,255,100,0.04)";
        ctx.fillRect(d, f, b * a, c * a)
      }
      ctx.lineWidth = 1;
      ctx.strokeStyle = "rgba(255,255,255,0.1)";
      ctx.beginPath();
      for (var h = 0; h <= this.rows; h++) g =
        f + c * h + .5, ctx.moveTo(0, g), ctx.lineTo(this.w, g);
      for (h = 0; h <= this.cols; h++) e = d + b * h + .5, ctx.moveTo(e, 0), ctx.lineTo(e, this.h);
      ctx.stroke();
      ctx.strokeStyle = "#28292A";
      ctx.strokeRect(.5, .5, this.w, this.h);
      ctx.fillStyle = this.topColor;
      ctx.textAlign = "center";
      ctx.textBaseline = "middle";
      ctx.font = "16px open_sans_condensedbold";
      800 > this.w && 24 < this.cols && (ctx.font = "13px open_sans_condensedbold");
      for (h = 0; h < this.cols; h++) e = "" + (h % a + 1), 0 == this.src && (20 == h && (e = "LI L"), 21 == h && (e = "LI R")), ctx.drawText(e, d + (h + .5) * b, 12, {
        max: b,
        shadow: ["#000", 0, 1, 1]
      });
      ctx.textAlign = "right";
      ctx.textBaseline = "middle";
      ctx.font = (c - 4 | 0) + "px open_sans_condensedbold";
      for (h = 0; h < this.rows; h++) e = h, ctx.fillStyle = this.channels[e].color, ctx.drawText(this.channels[e].getLabel(), this.yWidth - 4, f + (h + .5) * c, {
        max: this.yWidth,
        shadow: ["#111", 0, 1, 1]
      });
      ctx.lineWidth = 2;
      for (h = 0; h < this.channels.length; h++) {
        a = this.channels[h];
        ctx.strokeStyle = "hsla(" + 10 * h + ",50%,30%,0.8)";
        e = -1;
        switch (this.mode) {
          case 0:
            if ((g = a.getNameValue("src")) && isString(g)) {
              g = g.split(".");
              var l = "hw" ==
                g[0] || "li" == g[0] ? 0 : "ua" == g[0] ? 1 : 2;
              e = parseInt(g[1]);
              "li" == g[0] && (e += 20)
            }
            break;
          case 1:
            if ((g = a.getNameValue("scsrc")) && isString(g)) {
              g = g.split(".");
              var m = "hw" == g[0] || "li" == g[0] ? 0 : "ua" == g[0] ? 1 : 2;
              e = parseInt(g[1]);
              "li" == g[0] && (e += 20)
            }
            break;
          case 2:
            if ((g = getValue("ua." + h)) && isString(g)) {
              g = g.split(".");
              var n = parseInputStr(g[0]);
              e = parseInt(g[1])
            }(g = getValue("ub." + h)) && isString(g) && (g = g.split("."), n = parseInputStr(g[0]), e = parseInt(g[1]));
            (g = getValue("uc." + h)) && isString(g) && (g = g.split("."), n = parseInputStr(g[0]),
              e = parseInt(g[1]));
            (g = getValue("ud." + h)) && isString(g) && (g = g.split("."), n = parseInputStr(g[0]), e = parseInt(g[1]))
        } - 1 != e && (a.id == selectedStrip.id && (ctx.fillStyle = "rgba(244,255,255,0.1)", ctx.fillRect(0, (h + 1) * c - 1, d + 1, c + 1)), 0 > e || 0 == this.mode && l != this.src || 1 == this.mode && m != this.src || 2 == this.mode && 0 == n || 2 == this.mode && n != this.src || (a.id == selectedStrip.id && (ctx.fillStyle = "rgba(244,255,255,0.1)", ctx.fillRect(d + 1, (h + 1) * c - 1, e * b + b | 0, c + 1), 0 <= e && ctx.fillRect(d + e * b, 0, b + 1, f + h * c | 0)), e = Math.floor(d + e * b + b / 2) + .5, g = Math.floor(f +
          h * c + c / 2) + .5, ctx.beginPath(), ctx.moveTo(d + 1, g), ctx.lineTo(e, g), ctx.lineTo(e, f + 1), ctx.stroke()))
      }
    },
    drawLines: function(a, b, c) {}
  });

function parseInputStr(a) {
  switch (a) {
    case "hw":
      return 0;
    case "usb":
      return 1;
    case "sd":
      return 2
  }
  return -1
}
var netConfig = null,
  NET_CFG = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "NET_CFG_PAGE";
      this.y = measures.topWidgetHeight;
      this.needClip = !0;
      this.mode = -1;
      this.color = color.blue;
      this.tabButtons = [];
      this.initWidgets();
      this.setMode(0)
    },
    onShow: function() {
      var a = this.pages[this.mode];
      if (isDefined(a)) a.onShow()
    },
    setMode: function(a) {
      this.mode = a;
      for (a = 0; a < this.pages.length; a++) this.pages[a].hide();
      this.mode < this.pages.length && this.pages[this.mode].show();
      regUpdate(this)
    },
    nextMode: function() {
      this.mode ==
        this.pages.length - 1 ? this.setMode(0) : this.setMode(this.mode + 1)
    },
    initWidgets: function() {
      for (var a = ["HOTSPOT", "WI-FI", "LAN", "ADMIN PASS", "STATE"], b = 0; b < a.length; b++) {
        var c = new TabButton(this);
        c.color = c.textColor = "hsl(" + 32 * (b + 1) + ",50%,45%)";
        c.mode = b;
        c.text = a[b];
        c.setSize(100, 30);
        this.tabButtons.push(c)
      }
      this.pages = [];
      this.pages.push(new HOTSPOT_PAGE(this));
      this.pages.push(new SETTINGS_SUBPAGE(this));
      this.pages.push(new SETTINGS_SUBPAGE(this));
      this.pages.push(new SETTINGS_SUBPAGE(this));
      this.pages.push(new SETTINGS_SUBPAGE(this))
    },
    calcGeometry: function() {
      this.w = screenWidth - measures.mixerRightMargin;
      this.h = screenHeight - this.y;
      for (var a = 0; a < this.tabButtons.length; a++) this.tabButtons[a].setPos(this.w - (this.tabButtons[a].w + 1) * (this.tabButtons.length - a), 5)
    },
    paint: function() {
      ctx.fillStyle = color.eqBg;
      ctx.fillRect(0, 0, this.w, this.h);
      ctx.fillStyle = this.tabButtons[this.mode].color;
      ctx.fillRect(4, 35, this.w - 4, 4)
    }
  });

function getNetValue(a) {
  return netConfig[a]
}

function setNetValue(a, b) {
  netConfig[a] = b;
  regUpdate(networkWidget)
}
var HOTSPOT_PAGE = Class.create(SETTINGS_SUBPAGE, {
  initialize: function($super, b) {
    $super(b);
    this.widgetName = "HOTSPOT_PAGE";
    this.initWidgets()
  },
  initWidgets: function() {
    var a = 0;
    this.onoff = new SWITCHBOX(this);
    this.onoff.setPos(100, 60 + 80 * a++);
    this.onoff.setItems([lang.OFF, lang.ON]);
    this.onoff.setItemWidth(100);
    this.onoff.h = 40;
    this.onoff.getState = function() {
      this.state = getNetValue("ap_enabled") ? 1 : 0
    };
    this.onoff.valueFunc = function() {
      isBlocked("gsettings") ? showPopupMsg(lang.LOCKED, 800) : setNetValue("ap_enabled",
        this.state)
    };
    this.ssid = new INPUTBOX(this);
    this.ssid.setAnchors(100, 60 + 80 * a++);
    this.ssid.getState = function() {
      this.text = getNetValue("ap_ssid")
    };
    this.ssid.valueFunc = function(a) {
      setNetValue("ap_ssid", a)
    };
    this.ssid_br = new SWITCHBOX(this);
    this.ssid_br.setPos(100, 60 + 80 * a++);
    this.ssid_br.setItems([lang.OFF, lang.ON]);
    this.ssid_br.setItemWidth(100);
    this.ssid_br.h = 40;
    this.ssid_br.getState = function() {
      this.state = getNetValue("ap_ssid_mode") ? 1 : 0
    };
    this.ssid_br.valueFunc = function() {
      isBlocked("gsettings") ? showPopupMsg(lang.LOCKED,
        800) : setNetValue("ap_ssid_mode", this.state)
    };
    var b = {
        AL: "Albania",
        DZ: "Algeria",
        AR: "Argentina",
        AM: "Armenia",
        AW: "Aruba",
        AU: "Australia",
        AT: "Austria",
        AZ: "Azerbaijan",
        BH: "Bahrain",
        BD: "Bangladesh",
        BB: "Barbados",
        BY: "Belarus",
        BE: "Belgium",
        BZ: "Belize",
        BO: "Bolivia",
        BA: "Bosnia and Herzegovina",
        BR: "Brazil",
        BN: "Brunei Darussalam",
        BG: "Bulgaria",
        KH: "Cambodia",
        CA: "Canada",
        CL: "Chile",
        CN: "China",
        CO: "Colombia",
        CR: "Costa Rica",
        HR: "Croatia",
        CY: "Cyprus",
        CZ: "Czech Republic",
        DK: "Denmark",
        DO: "Dominican Republic",
        EC: "Ecuador",
        EG: "Egypt",
        SV: "El Salvador",
        EE: "Estonia",
        FI: "Finland",
        FR: "France",
        GE: "Georgia",
        DE: "Germany",
        GR: "Greece",
        GL: "Greenland",
        GD: "Grenada",
        GU: "Guam",
        GT: "Guatemala",
        HT: "Haiti",
        HN: "Honduras",
        HK: "Hong Kong",
        HU: "Hungary",
        IS: "Iceland",
        IN: "India",
        ID: "Indonesia",
        IR: "Iran",
        IE: "Ireland",
        IL: "Israel",
        IT: "Italy",
        JM: "Jamaica",
        JP: "Japan",
        JO: "Jordan",
        KZ: "Kazakhstan",
        KE: "Kenya",
        KR: "Korea",
        KW: "Kuwait",
        LV: "Latvia",
        LB: "Lebanon",
        LR: "Liberia",
        LI: "Liechtenstein",
        LT: "Lithuania",
        LU: "Luxembourg",
        MO: "Macao",
        MK: "Macedonia",
        MY: "Malaysia",
        MT: "Malta",
        MX: "Mexico",
        MC: "Monaco",
        MA: "Morocco",
        NP: "Nepal",
        NL: "Netherlands",
        NZ: "New Zealand",
        NO: "Norway",
        OM: "Oman",
        PK: "Pakistan",
        PA: "Panama",
        PG: "Papua New Guinea",
        PE: "Peru",
        PH: "Philippines",
        PL: "Poland",
        PT: "Portugal",
        PR: "Puerto Rico",
        QA: "Qatar",
        RO: "Romania",
        RU: "Russian Federation",
        RW: "Rwanda",
        BL: "Saint Barthelemy",
        SA: "Saudi Arabia",
        SG: "Singapore",
        SK: "Slovakia",
        SI: "Slovenia",
        SB: "Solomon Islands",
        ZA: "South Africa",
        ES: "Spain",
        LK: "Sri Lanka",
        SE: "Sweden",
        CH: "Switzerland",
        SY: "Syrian Arab Republic",
        TW: "Taiwan",
        TH: "Thailand",
        TT: "Trinidad and Tobago",
        TN: "Tunisia",
        TR: "Turkey",
        UA: "Ukraine",
        AE: "United Arab Emirates",
        GB: "United Kingdom",
        US: "United States",
        UY: "Uruguay",
        UZ: "Uzbekistan",
        VE: "Venezuela",
        VN: "Vietnam",
        YE: "Yemen",
        ZW: "Zimbabwe",
        "00": "Other / Unlisted"
      },
      c = Object.keys(b),
      d = Object.keys(b).map(function(a) {
        return b[a]
      });
    this.apcountry = new LIST(this);
    this.apcountry.setPos(100, 60 + 80 * a);
    this.apcountry.setItems(d);
    this.apcountry.h = 240;
    this.apcountry.values = c;
    this.apcountry.getActiveItem = function() {
      var a = getNetValue("ap_country");
      this.activeItemIdx = this.values.indexOf(a)
    };
    this.apchannel = new LIST(this);
    this.apchannel.setPos(500, 60 + 80 * a);
    this.apchannel.setItems(d);
    this.apchannel.h = 240;
    this.apchannel.getActiveItem = function() {
      var a = getNetValue("ap_channel");
      this.activeItemIdx = this.items.indexOf(a)
    };
    a++;
    a++;
    a++;
    a++;
    this.apmode = new SWITCHBOX(this);
    this.apmode.setPos(100, 60 + 80 * a++);
    this.apmode.setItems(["NONE", "WPA2"]);
    this.apmode.setItemWidth(100);
    this.apmode.h = 40;
    this.apmode.getState = function() {
      this.state = getNetValue("ap_mode") ?
        1 : 0
    };
    this.apmode.valueFunc = function() {
      isBlocked("gsettings") ? showPopupMsg(lang.LOCKED, 800) : setNetValue("ap_mode", this.state)
    }
  },
  drawLabel: function(a, b) {
    ctx.drawText(a, b.x, b.y - 16, {
      color: color.white,
      align: "left",
      valign: "middle",
      font: font.editbox,
      shadow: Shadow.main
    })
  },
  paint: function() {
    ctx.fillStyle = color.eqBg;
    ctx.fillRect(0, 0, this.w, this.h);
    this.drawLabel("Enable the Ui's internal Hotspot (AP)", this.onoff);
    this.drawLabel("SSID", this.ssid);
    this.drawLabel("SSID Broadcast", this.ssid_br);
    this.drawLabel("Wireless Regulatory Domain",
      this.apcountry);
    this.drawLabel("Channel (ignored when remote WiFi is configured)", this.apchannel);
    this.drawLabel("Security", this.apmode)
  }
});
tvWidget = null;
var MODALS = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "MODALS";
      this.y = measures.topWidgetHeight;
      this.needClip = !0;
      this.mode = 0;
      this.color = color.modal;
      this.initWidgets();
      this.setMode(0)
    },
    setMode: function(a) {
      this.mode = a;
      this.pages.each(function(a) {
        a.hide()
      });
      switch (a) {
        case E_MODAL_MODE.TOTALVIEW:
          this.pages[0].show();
          break;
        case E_MODAL_MODE.MOREME:
          this.pages[1].show();
          break;
        case E_MODAL_MODE.MUTES:
          this.pages[2].show();
          break;
        case E_MODAL_MODE.VIEWS:
          this.pages[3].show();
          break;
        case E_MODAL_MODE.SUBS:
          this.pages[4].show();
          break;
        case E_MODAL_MODE.VCA:
          this.pages[5].show()
      }
      this.color = this.clr[a];
      regUpdate(this)
    },
    nextMode: function() {
      this.mode == this.pages.length - 1 ? this.setMode(0) : this.setMode(this.mode + 1)
    },
    onShow: function() {
      for (var a = 0; a < this.pages.length; a++)
        if (this.pages[a].enabled) this.pages[a].onShow()
    },
    onHide: function() {
      for (var a = 0; a < this.pages.length; a++)
        if (this.pages[a].enabled) this.pages[a].onHide()
    },
    initWidgets: function() {
      this.pages = [];
      this.pages.push(new METERS_PAGE(this));
      var a = new MOREME(this);
      a.setAnchors(0, 40, 0, 0);
      a.calcGeometry = function() {
        var a = this.w - 40;
        this.ME_VU.w = .35 * a | 0;
        this.BAND_VU.w = .35 * a | 0;
        this.WHEEL.x = 10 + this.ME_VU.w + 10;
        this.WHEEL.w = .3 * a | 0
      };
      this.pages.push(a);
      this.pages.push(new MUTESPAGE(this));
      this.pages.push(new VIEWSPAGE(this));
      this.pages.push(new SUBSPAGE(this));
      IS_UI_24 && this.pages.push(new VCAPAGE(this));
      tvWidget = this.pages[0];
      a = [lang.METERS, lang.MORE_ME, lang.MUTES, lang.VIEWS, lang.SUBS];
      this.clr = [color.yellow, color.orange, color.red, color.modal,
        color.sub
      ];
      IS_UI_24 && (a.push(lang.VCA), this.clr.push(color.green));
      for (var b = 0; b < this.clr.length; b++) this.clr[b] = LightenDarkenColor(this.clr[b], 16);
      this.tabButtons = [];
      for (b = 0; b < a.length; b++) {
        var c = new TabButton(this);
        c.mode = b;
        c.text = a[b];
        c.color = c.textColor = this.clr[b];
        c.setSize(112, 30);
        this.tabButtons.push(c)
      }
    },
    calcGeometry: function() {
      this.w = screenWidth - measures.mixerRightMargin;
      this.h = screenHeight - this.y;
      for (var a = 0; a < this.tabButtons.length; a++) this.tabButtons[a].setPos(this.w - (this.tabButtons[a].w +
        1) * (this.tabButtons.length - a), 5)
    },
    paint: function() {
      ctx.fillStyle = color.eqBg;
      ctx.fillRect(0, 0, this.w, this.h);
      ctx.fillStyle = this.color;
      ctx.fillRect(4, 35, this.w - 4, 4)
    }
  }),
  EMPTY_PAGE = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "EMPTY";
      this.y = 40;
      this.enabled = !1;
      this.initWidgets()
    },
    initWidgets: function() {},
    calcGeometry: function() {
      this.w = this.parent.w - this.x;
      this.h = this.parent.h - this.y - 5
    },
    paint: function() {
      ctx.fillStyle = color.eqBg;
      ctx.fillRect(0, 0, this.w, this.h);
      ctx.font = font.editbox;
      ctx.textAlign = "right";
      ctx.fillStyle = color.tabText;
      ctx.fillText(lang.EMPTY, 214, 50)
    }
  }),
  MUTESPAGE = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "MUTESPAGE";
      this.y = 40;
      this.enabled = !1;
      this.color = color.red;
      this.mode = 0;
      this.initWidgets();
      this.setMode(0)
    },
    sync: function() {
      if (this.rename) {
        var a = "mg." + this.mode + ".";
        this.rename.unRegAllKeys();
        this.rename.regKey(a + "name")
      }
    },
    onShow: function() {
      var a = this.BUTTONS.length;
      hideHPAUX ? (this.BUTTONS[a - 1].hide(), this.BUTTONS[a - 2].hide()) :
        (this.BUTTONS[a - 1].show(), this.BUTTONS[a - 2].show())
    },
    onHide: function() {},
    onDown: function(a, b) {
      this.lastPressPoint = this.pressPoint;
      this.pressPoint = [a, b]
    },
    onUp: function(a) {
      var b = Date.now(),
        c = Math.abs(this.lastPressPoint[0] - this.pressPoint[0]),
        d = Math.abs(this.lastPressPoint[1] - this.pressPoint[1]);
      2 < mouseTargets.length || isDefined(tHash[a]) && 2 < tHash[a].length || (30 > c && 30 > d && b - this.lastClickTime < DBL_CLK_TIME ? (this.onDouble(), this.lastClickTime = b - DBL_CLK_TIME) : this.lastClickTime = b)
    },
    onDouble: function() {
      setMode(E_MODE.MIX)
    },
    setMode: function(a) {
      5 < a || (this.mode = a, this.sync(), regUpdate(this))
    },
    initWidgets: function() {
      var a = this;
      this.VGB = [];
      for (var b = 0; 6 > b; b++) {
        var c = new TabButton(this);
        c.setPos(240 + 50 * b, 100);
        c.setSize(40, 30);
        c.mode = b;
        c.text = "" + (b + 1);
        this.VGB.push(c)
      }
      this.bRESET = new MENUBUTTON(this);
      this.bRESET.setPos(40, 38);
      this.bRESET.setSize(90, 30);
      this.bRESET.text = lang.RESET;
      this.bRESET.onPress = function() {
        muteGroupReset(a.mode)
      };
      IS_UI_24 && (this.rename = new INPUTBOX(this), this.rename.setAnchors(340, 38), this.rename.labelDX =
        10, this.rename.w = 190, this.rename.label = lang.GROUP_NAME + ":", this.rename.getState = function() {
          this.text = getValue("mg." + a.mode + ".name") || ""
        }, this.rename.valueFunc = function(b) {
          setValue("mg." + a.mode + ".name", b)
        });
      this.BUTTONS = [];
      var d = 60,
        f = 0,
        e = 46;
      24 < inStrips.length && 690 > this.h && (e = 44, d = 54);
      for (var g = mixerWidget.strips, b = 0; b < g.length; b++) c = new CHECKBUTTON(this), 0 == b % 8 && 0 != b && f++, c.setSize(90, e), c.setPos(40 + 100 * (b - 8 * f), 100 + d * f), c.idx = b, c.st = g[b], c.text = g[b].text, c.textColor = g[b].color, c.getState = function() {
        this.state =
          0 != (this.st.getNameValue("mgmask") & 1 << this.parent.mode) ? 1 : 0;
        this.text = this.st.getName();
        this.textColor = this.st.getColor()
      }, c.onToggleUp = function() {
        var b = 1 << a.mode,
          c = mixerWidget.strips[this.idx].getNameValue("mgmask");
        mixerWidget.strips[this.idx].setNameValue("mgmask", c | b)
      }, c.onToggleDown = function() {
        var b = 1 << a.mode,
          c = mixerWidget.strips[this.idx].getNameValue("mgmask");
        mixerWidget.strips[this.idx].setNameValue("mgmask", c & ~b);
        if (getValue("mgmask") & b) {
          for (var d = c = 0; d < mixerWidget.strips.length; d++) g[d].getNameValue("mgmask") &
            b && c++;
          0 == c && muteGroupOFF(a.mode)
        }
      }, c.onToggle = function() {
        setValue("var.unsaved.mutegroups", 1);
        regUpdate(a.bSAVE)
      }, this.BUTTONS.push(c);
      f++;
      f += .5;
      this.bSAVE = new MENUBUTTON(this);
      this.bSAVE.setAnchors(640, 100 + d * f, null, null);
      this.bSAVE.setSize(190, 40);
      this.bSAVE.text = lang.SAVE_TO_SHOW;
      this.bSAVE.textColor = color.yellow;
      this.bSAVE.color = color.green;
      this.bSAVE.getState = function() {
        this.disabled = 0 == getValue("var.unsaved.mutegroups")
      };
      this.bSAVE.onPress = function() {
        if (isBlocked("shows")) showPopupMsg(lang.LOCKED,
          1E3);
        else {
          var a = getValue("var.currentShow");
          0 != a.length && (sendMessage(E_COMMANDS.SAVESHOW + "^" + a), setValue("var.unsaved.mutegroups", 0))
        }
      }
    },
    calcGeometry: function() {
      this.w = this.parent.w - this.x;
      this.h = this.parent.h - this.y;
      for (var a = 0; a < this.VGB.length; a++) this.VGB[a].setPos(this.w - 326 + 50 * a, 38)
    },
    paint: function() {
      ctx.fillStyle = color.eqBg;
      ctx.fillRect(0, 0, this.w, this.h);
      ctx.font = font.editbox;
      ctx.textAlign = "right";
      ctx.fillStyle = color.white;
      ctx.fillText(lang.MUTE_GROUP_BUTTON_ASSIGN, this.w - 80, 26);
      for (var a =
          getValue("mgmask"), b = 0; 6 > b; b++) a & 1 << b && (ctx.fillStyle = this.color, ctx.fillRect(this.VGB[b].x, this.VGB[b].y + this.VGB[b].h + 4, this.VGB[b].w, 2))
    }
  }),
  VIEWSPAGE = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "VIEWSPAGE";
      this.y = 40;
      this.enabled = !1;
      this.color = color.modal;
      this.viewNum = 6;
      this.mode = 0;
      this.initWidgets();
      this.setMode(0)
    },
    onShow: function() {
      var a = this.BUTTONS.length;
      this.BUTTONS.length && (hideHPAUX ? (this.BUTTONS[a - 1].hide(), this.BUTTONS[a - 2].hide()) : (this.BUTTONS[a - 1].show(),
        this.BUTTONS[a - 2].show()))
    },
    onDown: function(a, b) {
      this.lastPressPoint = this.pressPoint;
      this.pressPoint = [a, b]
    },
    onUp: function(a) {
      var b = Date.now(),
        c = Math.abs(this.lastPressPoint[0] - this.pressPoint[0]),
        d = Math.abs(this.lastPressPoint[1] - this.pressPoint[1]);
      2 < mouseTargets.length || isDefined(tHash[a]) && 2 < tHash[a].length || (30 > c && 30 > d && b - this.lastClickTime < DBL_CLK_TIME ? (this.onDouble(), this.lastClickTime = b - DBL_CLK_TIME) : this.lastClickTime = b)
    },
    onDouble: function() {
      setMode(E_MODE.MIX)
    },
    setMode: function(a) {
      a >= this.viewNum ||
        (this.mode = a, regUpdate(this))
    },
    initWidgets: function() {
      var a = this;
      this.VGB = [];
      for (var b = 0; b < this.viewNum; b++) {
        var c = new TabButton(this);
        c.setPos(240 + 50 * b, 100);
        c.setSize(40, 30);
        c.mode = b;
        c.text = "" + (b + 1);
        this.VGB.push(c)
      }
      this.bRESET = new MENUBUTTON(this);
      this.bRESET.setPos(40, 38);
      this.bRESET.setSize(90, 30);
      this.bRESET.text = lang.RESET;
      this.bRESET.onPress = function() {
        var b = a.mode;
        settings.viewGroups[b] = [];
        settingsStorage.put("viewGroups", settings.viewGroups);
        0 <= b && activeViewGroup == b && mixerWidget.showViewGroup(activeViewGroup);
        regUpdate(a)
      };
      IS_UI_24 && (this.rename = new INPUTBOX(this), this.rename.setAnchors(340, 38), this.rename.labelDX = 10, this.rename.w = 190, this.rename.label = lang.GROUP_NAME + ":", this.rename.getState = function() {
        this.text = settings.viewGroupsNames[a.mode]
      }, this.rename.valueFunc = function(b) {
        settings.viewGroupsNames[a.mode] = (b || "").trim();
        settingsStorage.put("viewGroupsNames", settings.viewGroupsNames)
      });
      this.BUTTONS = [];
      var d = 60,
        f = 0,
        e = 46;
      24 < inStrips.length && 690 > this.h && (e = 44, d = 54);
      for (var g = mixerWidget.strips, b = 0; b <
        g.length; b++) c = new SLOTBUTTON(this), c.showIndex = !0, 0 == b % 8 && 0 != b && f++, c.setSize(90, e), c.setPos(40 + (c.w + 10) * (b - 8 * f), 100 + d * f), c.idx = b, c.st = g[b], c.id = g[b].id, c.text = g[b].text, c.textColor = g[b].color, c.getState = function() {
        var b = settings.viewGroups[a.mode] || [];
        this.state = -1 != b.indexOf(this.id);
        this.text = this.st.getName();
        this.textColorMain = this.textColor = this.st.getColor();
        b = b.indexOf(this.id);
        this.idxText = "" + (-1 == b ? "" : b + 1)
      }, c.onToggleUp = function() {
        var b = settings.viewGroups[a.mode] || []; - 1 == b.indexOf(this.id) &&
          b.push(this.id);
        settingsStorage.put("viewGroups", settings.viewGroups);
        activeViewGroup == a.mode && mixerWidget.showViewGroup(a.mode);
        regUpdate(a)
      }, c.onToggleDown = function() {
        var b = settings.viewGroups[a.mode] || [],
          c = b.indexOf(this.id); - 1 != c && b.splice(c, 1);
        settingsStorage.put("viewGroups", settings.viewGroups);
        activeViewGroup == a.mode && mixerWidget.showViewGroup(a.mode);
        regUpdate(a)
      }, this.BUTTONS.push(c)
    },
    calcGeometry: function() {
      this.w = this.parent.w - this.x;
      this.h = this.parent.h - this.y;
      for (var a = 0; a < this.VGB.length; a++) this.VGB[a].setPos(this.w -
        326 + 50 * a, 38)
    },
    paint: function() {
      ctx.fillStyle = color.eqBg;
      ctx.fillRect(0, 0, this.w, this.h);
      ctx.font = font.editbox;
      ctx.textAlign = "right";
      ctx.fillStyle = color.white;
      ctx.fillText(lang.VIEW_GROUP_BUTTON_ASSIGN, this.w - 80, 26);
      if (0 <= activeViewGroup && 10 > activeViewGroup) {
        var a = activeViewGroup;
        ctx.fillStyle = this.color;
        isDefined(this.VGB[a]) && ctx.fillRect(this.VGB[a].x, this.VGB[a].y + this.VGB[a].h + 4, this.VGB[a].w, 2)
      }
    }
  }),
  SUBSPAGE = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "SUBSPAGE";
      this.y = 40;
      this.enabled = !1;
      this.color = color.sub;
      this.mode = -1;
      this.initWidgets();
      this.setMode(0)
    },
    sync: function() {
      if (this.rename) {
        var a = "s." + this.mode + ".";
        this.rename.unRegAllKeys();
        this.rename.regKey(a + "name")
      }
    },
    setMode: function(a) {
      a >= curSetup.sub || (this.mode = a, this.sync(), regUpdate(this))
    },
    onDown: function(a, b) {
      this.lastPressPoint = this.pressPoint;
      this.pressPoint = [a, b]
    },
    onUp: function(a) {
      var b = Date.now(),
        c = Math.abs(this.lastPressPoint[0] - this.pressPoint[0]),
        d = Math.abs(this.lastPressPoint[1] - this.pressPoint[1]);
      2 < mouseTargets.length || isDefined(tHash[a]) && 2 < tHash[a].length || (30 > c && 30 > d && b - this.lastClickTime < DBL_CLK_TIME ? (this.onDouble(), this.lastClickTime = b - DBL_CLK_TIME) : this.lastClickTime = b)
    },
    onDouble: function() {
      setMode(E_MODE.MIX)
    },
    initWidgets: function() {
      var a = this;
      this.VGB = [];
      for (var b = 0; b < curSetup.sub; b++) {
        var c = new TabButton(this);
        c.setPos(240 + 50 * b, 100);
        c.setSize(40, 30);
        c.mode = b;
        c.text = "" + (b + 1);
        this.VGB.push(c)
      }
      this.bRESET = new MENUBUTTON(this);
      this.bRESET.setPos(40, 38);
      this.bRESET.setSize(90, 30);
      this.bRESET.text =
        lang.RESET;
      this.bRESET.onPress = function() {
        for (var b = 0; b < allStrips.length; b++) allStrips[b].type != E_STRIP_TYPE.AUX && allStrips[b].type != E_STRIP_TYPE.FX && allStrips[b].type != E_STRIP_TYPE.SUB && allStrips[b].getNameValue("subgroup") == a.mode && allStrips[b].setNameValue("subgroup", -1);
        activeSubGroup == a.mode && mixerWidget.showSG(a.mode)
      };
      IS_UI_24 && (this.rename = new INPUTBOX(this), this.rename.setAnchors(340, 38), this.rename.labelDX = 10, this.rename.w = 190, this.rename.label = lang.GROUP_NAME + ":", this.rename.getState = function() {
        this.text =
          getValue("s." + a.mode + ".name") || ""
      }, this.rename.valueFunc = function(b) {
        setValue("s." + a.mode + ".name", b)
      });
      this.BUTTONS = [];
      var d = 60,
        f = 0,
        e = 46;
      24 < inStrips.length && 690 > this.h && (e = 44, d = 54);
      for (b = 0; b < allStrips.length; b++) {
        switch (allStrips[b].type) {
          case E_STRIP_TYPE.IN:
          case E_STRIP_TYPE.LINEIN:
          case E_STRIP_TYPE.MEDIA:
            break;
          default:
            continue
        }
        c = new CHECKBUTTON(this);
        0 == b % 8 && 0 != b && f++;
        c.setSize(90, e);
        c.setPos(40 + (c.w + 10) * (b - 8 * f), 100 + d * f);
        c.idx = b;
        c.id = allStrips[b].id;
        c.text = allStrips[b].text;
        c.textColor = allStrips[b].color;
        c.getState = function() {
          this.state = allStrips[this.idx].getNameValue("subgroup") == a.mode;
          this.text = allStrips[this.idx].getName()
        };
        c.onToggleUp = function() {
          setValue(allStrips[this.id].name + "subgroup", a.mode);
          activeSubGroup == a.mode && mixerWidget.showSG(a.mode)
        };
        c.onToggleDown = function() {
          setValue(allStrips[this.id].name + "subgroup", -1);
          activeSubGroup == a.mode && mixerWidget.showSG(a.mode)
        };
        this.BUTTONS.push(c)
      }
    },
    calcGeometry: function() {
      this.w = this.parent.w - this.x;
      this.h = this.parent.h - this.y;
      for (var a = 0; a < this.VGB.length; a++) this.VGB[a].setPos(this.w -
        326 + 50 * a, 38)
    },
    paint: function() {
      ctx.fillStyle = color.eqBg;
      ctx.fillRect(0, 0, this.w, this.h);
      ctx.font = font.editbox;
      ctx.textAlign = "right";
      ctx.fillStyle = color.white;
      ctx.fillText(lang.SUB_GROUP_FADER_ASSIGN, this.w - 90, 26);
      0 <= activeSubGroup && (ctx.fillStyle = this.color, ctx.fillRect(this.w - 325 + 50 * activeSubGroup, 74, 38, 2))
    }
  }),
  VCAPAGE = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "VCAPAGE";
      this.y = 40;
      this.enabled = !1;
      this.color = color.green;
      this.mode = 0;
      this.initWidgets();
      this.setMode(0)
    },
    sync: function() {
      var a = "v." + this.mode + ".";
      this.rename.unRegAllKeys();
      this.rename.regKey(a + "name")
    },
    onShow: function() {},
    onHide: function() {},
    onDown: function(a, b) {
      this.lastPressPoint = this.pressPoint;
      this.pressPoint = [a, b]
    },
    onUp: function(a) {
      var b = Date.now(),
        c = Math.abs(this.lastPressPoint[0] - this.pressPoint[0]),
        d = Math.abs(this.lastPressPoint[1] - this.pressPoint[1]);
      2 < mouseTargets.length || isDefined(tHash[a]) && 2 < tHash[a].length || (30 > c && 30 > d && b - this.lastClickTime < DBL_CLK_TIME ? (this.onDouble(), this.lastClickTime =
        b - DBL_CLK_TIME) : this.lastClickTime = b)
    },
    onDouble: function() {
      setMode(E_MODE.MIX)
    },
    setMode: function(a) {
      5 < a || (this.mode = a, this.sync(), regUpdate(this))
    },
    initWidgets: function() {
      var a = this;
      this.VGB = [];
      for (var b = 0; 6 > b; b++) {
        var c = new TabButton(this);
        c.setPos(240 + 50 * b, 100);
        c.setSize(40, 30);
        c.mode = b;
        c.text = "" + (b + 1);
        this.VGB.push(c)
      }
      this.BUTTONS = [];
      this.bRESET = new MENUBUTTON(this);
      this.bRESET.setPos(40, 38);
      this.bRESET.setSize(90, 30);
      this.bRESET.text = lang.RESET;
      this.bRESET.onPress = function() {
        for (var b = 0; b < allStrips.length; b++) {
          var c =
            allStrips[b];
          c.haveVCA && c.getNameValue("vca") == a.mode && c.setNameValue("vca", -1)
        }
        regUpdate(a)
      };
      this.rename = new INPUTBOX(this);
      this.rename.setAnchors(340, 38);
      this.rename.labelDX = 10;
      this.rename.w = 190;
      this.rename.label = lang.GROUP_NAME + ":";
      this.rename.getState = function() {
        this.text = getValue("v." + a.mode + ".name") || ""
      };
      this.rename.valueFunc = function(b) {
        setValue("v." + a.mode + ".name", b)
      };
      var d = 60,
        f = 0,
        e = 46;
      24 < inStrips.length && 690 > this.h && (e = 44, d = 54);
      for (b = 0; b < allStrips.length; b++) {
        var g = allStrips[b];
        g.haveVCA &&
          (c = new CHECKBUTTON(this), 0 == b % 8 && 0 != b && f++, c.setSize(90, e), c.setPos(40 + 100 * (b - 8 * f), 100 + d * f), c.idx = b, c.text = g.text, c.st = g, c.textColor = g.color, c.regKey(g.name + "vca"), c.getState = function() {
            var a = this.st;
            this.state = a.getNameValue("vca") == this.parent.mode ? 1 : 0;
            this.text = a.getName()
          }, c.onToggleUp = function() {
            this.st.setNameValue("vca", this.parent.mode);
            regUpdate(a)
          }, c.onToggleDown = function() {
            this.st.setNameValue("vca", -1);
            regUpdate(a)
          }, this.BUTTONS.push(c))
      }
      f++
    },
    calcGeometry: function() {
      this.w = this.parent.w -
        this.x;
      this.h = this.parent.h - this.y;
      for (var a = 0; a < this.VGB.length; a++) this.VGB[a].setPos(this.w - 326 + 50 * a, 38)
    },
    paint: function() {
      ctx.fillStyle = color.eqBg;
      ctx.fillRect(0, 0, this.w, this.h);
      ctx.font = font.editbox;
      ctx.textAlign = "right";
      ctx.fillStyle = color.white;
      ctx.fillText(lang.VCA_GROUP_BUTTON_ASSIGN, this.w - 80, 26)
    }
  }),
  INPUTBOX = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "INPUTBOX";
      this.text = "";
      this.w = 200;
      this.h = 30;
      this.bg = color.eqBg;
      this.border = color.tabText;
      this.color = "#fefefe";
      this.label = null;
      this.info = "";
      this.readOnly = this.passMode = !1;
      this.labelColor = "#ccc";
      this.borderColor = "#535457";
      this.labelDX = 28
    },
    valueFunc: function(a) {
      showPopupMsg(a)
    },
    onUp: function() {
      if (!this.readOnly) {
        var a = this;
        editOk.valueFunc = function() {
          var b = editBox2.value;
          null != b && (a.valueFunc(b), regUpdate(a))
        };
        showEditBox2(this.info, this.passMode ? "" : this.text)
      }
    },
    getState: function() {},
    paint: function() {
      this.getState();
      ctx.fillStyle = "#111";
      ctx.fillRect(0, 0, this.w, this.h);
      ctx.strokeStyle = this.borderColor;
      ctx.strokeRect(.5,
        .5, this.w, this.h);
      ctx.font = font.settings;
      ctx.textAlign = "center";
      ctx.textBaseline = "middle";
      ctx.fillStyle = this.color;
      ctx.fillText(this.passMode ? "*****" : this.text, this.w / 2, this.h / 2);
      this.label && this.label.length && (ctx.fillStyle = this.bg, ctx.fillRect(0, 0, -(ctx.measureText(this.label).width + this.labelDX), this.h), ctx.fillStyle = this.labelColor, ctx.textAlign = "right", ctx.drawText(this.label, -this.labelDX, this.h / 2 | 0, {
        max: 220,
        shadow: Shadow.main
      }))
    }
  }),
  RADIO = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "RADIO";
      this.state = 0;
      this.h = this.w = 26;
      this.bg = color.eqBg;
      this.border = color.tabText;
      this.labels = [];
      this.items = null;
      this.label = "";
      this.rh = 40;
      this.d = 14;
      this.readOnly = !1
    },
    setItems: function(a) {
      this.items = a
    },
    setLabels: function(a) {
      this.h = a.length * this.rh;
      this.labels = a
    },
    onDown: function(a, b) {
      if (!this.readOnly) {
        var c = (b - this.globalY()) / this.rh | 0;
        this.state != c && (this.state = c, this.onSelect(), regUpdate(this.parent))
      }
    },
    onSelect: function() {
      this.key && this.setVal(this.items ? this.items[this.state] :
        this.state)
    },
    getState: function() {
      this.key && (this.state = this.getVal(), this.items && (this.state = this.items.indexOf(this.state)))
    },
    paint: function() {
      this.getState();
      ctx.fillStyle = color.eqBg;
      ctx.fillRect(0, 0, this.w, this.h);
      for (var a = 0; a < this.labels.length; a++) {
        var b = Math.round(this.rh * a);
        ctx.strokeStyle = this.border;
        ctx.lineWidth = 2;
        ctx.beginPath();
        ctx.arc(15, b + 15, this.d, 0, 2 * Math.PI);
        ctx.stroke();
        ctx.closePath();
        this.state == a && (ctx.beginPath(), ctx.arc(15, b + 15, this.d - 6, 0, 2 * Math.PI), ctx.fillStyle = color.red,
          ctx.fill(), ctx.lineWidth = 2, ctx.strokeStyle = "#ccc", ctx.stroke());
        this.labels[a] && (ctx.fillStyle = color.eqBg, ctx.fillRect(0, b, -(ctx.measureText(this.labels[a]).width + 30), this.rh), ctx.font = font.settings, ctx.fillStyle = color.tabText, ctx.textAlign = "right", ctx.drawText(this.labels[a], -26, b + .5 * this.rh, {
          shadow: Shadow.main
        }))
      }
    }
  }),
  LOCK = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "LOCK";
      this.w = 120;
      this.h = 40;
      this.bg = color.eqBg;
      this.border = color.tabText;
      this.color = color.red;
      this.label =
        lang.LOCK + ":";
      this.borderColor = "#535457";
      this.state = !1
    },
    onDown: function() {
      this.state = !this.state;
      this.valueFunc();
      regUpdate(this.parent)
    },
    valueFunc: function() {
      log(this.widgetName + ": " + this.state)
    },
    getState: function() {},
    paint: function() {
      this.getState();
      var a = this.w / 2 | 0;
      ctx.fillStyle = this.bg;
      ctx.fillRect(0, 0, this.w, this.h);
      ctx.fillStyle = "rgba(255,255,255,0.1)";
      ctx.fillRect(0, this.h, this.w, -10);
      ctx.fillStyle = this.color;
      this.state ? ctx.fillRect(this.w / 2, 0, this.w / 2, this.h) : ctx.fillRect(0, 0, this.w / 2, this.h);
      ctx.font = "18px open_sans_condensedbold";
      ctx.fillStyle = color.tabText;
      ctx.setShadow(color.black, 3, 1, 1);
      ctx.textAlign = "center";
      ctx.fillStyle = 1 == this.state ? color.tabTextSel : color.tabText;
      ctx.fillText(lang.ON, this.w / 4 * 3, this.h - 12, a - 4);
      ctx.fillStyle = 0 == this.state ? color.tabTextSel : color.tabText;
      ctx.fillText(lang.OFF, this.w / 4, this.h - 12, a - 4);
      ctx.shadowColor = "transparent";
      ctx.strokeStyle = this.borderColor;
      ctx.strokeRect(.5, .5, this.w, this.h);
      this.label.length && (ctx.fillStyle = color.tabText, ctx.textAlign = "right",
        ctx.fillText(this.label, -26, this.h - 9))
    }
  }),
  SWITCHBOX = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "SWITCHBOX";
      this.w = 100;
      this.h = 30;
      this.bg = color.eqBg;
      this.border = color.tabText;
      this.color = color.red;
      this.colors = null;
      this.borderColor = "#535457";
      this.textColor = "black";
      this.labelColor = color.tabText;
      this.label = "";
      this.font = font.settings;
      this.state = 0;
      this.disabled = !1;
      this.items = [lang.ON, lang.OFF];
      this.itemW = 50;
      this.readOnly = !1;
      this.disableOnNegative = !0
    },
    setState: function(a) {
      this.state =
        bound(a, 0, this.items.length - 1);
      this.key && setValue(this.key, this.state);
      this.valueFunc();
      this.onValue();
      regUpdate(this)
    },
    setItems: function(a) {
      this.w = a.length * this.itemW;
      this.items = a
    },
    setItemWidth: function(a) {
      this.itemW = a;
      this.w = this.items.length * this.itemW
    },
    checkNewState: function(a) {
      return !0
    },
    onDown: function(a, b) {
      if (!(this.disableOnNegative && 0 > this.state || this.readOnly || this.disabled)) {
        var c = (a - this.globalX()) / this.itemW | 0,
          c = bound(c, 0, this.items.length - 1);
        if (this.state == c && 2 == this.items.length) switch (this.state) {
          case 0:
            this.setState(1);
            break;
          case 1:
            this.setState(0)
        } else this.setState(c);
        this.key && setValue(this.key, this.state);
        this.valueFunc();
        this.onValue();
        regUpdate(this)
      }
    },
    valueFunc: function() {},
    onValue: function() {},
    calcGeometry: function() {
      this.grd = ctx.createLinearGradient(0, 0, 0, this.h);
      this.grd.addColorStop(0, "rgba(0,0,0,0)");
      this.grd.addColorStop(.5, "rgba(0,0,0,0.3)");
      this.grd.addColorStop(1, "rgba(0,0,0,0)")
    },
    getState: function() {},
    paint: function() {
      this.key && (this.state = getValue(this.key));
      this.getState(); - 1 == this.state && (ctx.globalAlpha =
        .3);
      this.disabled && (ctx.globalAlpha = .3);
      ctx.fillStyle = this.bg;
      ctx.fillRect(0, 0, this.w, this.h);
      ctx.font = this.font;
      ctx.textAlign = "center";
      ctx.textBaseline = "middle";
      for (var a = 0; a < this.items.length; a++) a === this.state ? (ctx.beginPath(), ctx.fillStyle = this.color, this.colors && (ctx.fillStyle = this.colors[a]), ctx.rect(a * this.itemW + 1, 1, this.itemW - 1, this.h - 2), ctx.fill(), ctx.fillStyle = this.grd, ctx.fill(), ctx.strokeStyle = this.borderColor, ctx.strokeRect(.5 + a * this.itemW, .5, this.itemW, this.h - 1)) : (ctx.strokeStyle = this.borderColor,
        ctx.strokeRect(.5 + a * this.itemW, .5, this.itemW, this.h - 1), ctx.fillStyle = "rgba(255,255,255,0.1)", ctx.fillRect(1 + a * this.itemW, this.h, this.itemW - 1, -10)), ctx.fillStyle = color.white, this.colors && a !== this.state && (ctx.fillStyle = this.colors[a]), ctx.drawText(this.items[a], (a + .5) * this.itemW | 0, this.h / 2 | 0, {
        max: this.itemW - 4,
        shadow: Shadow.main
      });
      this.label && this.label.length && (ctx.fillStyle = color.eqBg, ctx.fillRect(0, 0, -(ctx.measureText(this.label).width + 28), this.h), ctx.fillStyle = this.labelColor, ctx.textAlign = "right",
        ctx.drawText(this.label, -26, this.h / 2 | 0, {
          max: 220,
          shadow: Shadow.main
        }))
    }
  }),
  HSWITCHBOX = Class.create(Widget, {}),
  CHECKBUTTON = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "MENU_CHECKBUTTON";
      this.w = 70;
      this.h = 30;
      this.state = !1;
      this.color = null;
      this.text = "TEXT";
      this.font = font.tabText;
      this.needBG = !0;
      this.bgColor = color.eqBg;
      this.strokeColor = color.tabStroke;
      this.textColor = color.tabText;
      this.textColor2 = null;
      this.hidden = this.disabled = !1;
      this.dy = 18
    },
    onDown: function() {
      if (!this.disabled &&
        !this.hidden && this.check()) {
        if (this.state = !this.state) this.onToggleUp();
        else this.onToggleDown();
        null != this.key && this.setVal(fromBool(this.state));
        this.onToggle();
        this.valueFunc();
        regUpdate(this)
      }
    },
    check: function() {
      return !0
    },
    setState: function(a, b) {
      isDefined(b) || (b = !0);
      null != this.key && (this.state = this.getVal());
      this.getState();
      if (this.state != a) {
        if (this.state = a) this.onToggleUp();
        else this.onToggleDown();
        null != this.key && this.setVal(fromBool(this.state));
        this.onToggle();
        this.valueFunc();
        b && regUpdate(this)
      }
    },
    onToggle: function() {},
    onToggleUp: function() {},
    onToggleDown: function() {},
    valueFunc: function() {},
    getState: function() {},
    paint: function() {
      null != this.key && (this.state = this.getVal());
      this.getState();
      this.hidden || (ctx.fillStyle = this.bgColor, ctx.fillRect(-1, -1, this.w + 2, this.h + 2), this.disabled && (ctx.globalAlpha = .3), this.state ? (ctx.fillStyle = hexToRGBA(this.color ? this.color : this.parent.color, .5), ctx.fillRect(0, 0, this.w, this.h), ctx.lineWidth = 1, ctx.strokeStyle = this.color ? this.color : this.parent.color, ctx.strokeRect(.5,
        .5, this.w - 1, this.h - 1), ctx.fillStyle = "rgba(255,255,255,0.1)", ctx.fillRect(1, this.h, this.w - 2, -10), ctx.font = this.font, ctx.drawText(this.text, this.w / 2, this.h / 2, {
        align: "center",
        valign: "middle",
        max: this.w - 4,
        dy: this.dy,
        color: this.textColor2 || this.textColor,
        shadow: [color.black, 0, 1, 1]
      })) : (ctx.strokeStyle = this.strokeColor, ctx.strokeRect(.5, .5, this.w - 1, this.h - 1), ctx.fillStyle = "rgba(255,255,255,0.1)", ctx.fillRect(1, this.h, this.w - 2, -10), ctx.font = this.font, ctx.drawText(this.text, this.w / 2, this.h / 2, {
        align: "center",
        valign: "middle",
        max: this.w - 4,
        color: this.textColor,
        dy: this.dy,
        shadow: [color.black, 0, 1, 1]
      })))
    }
  }),
  MENUBUTTON = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "MENU_BUTTON";
      this.w = 70;
      this.h = 30;
      this.state = 0;
      this.color = null;
      this.bg = color.eqBg;
      this.text = "TEXT";
      this.textColor = color.tabText;
      this.needBG = !0;
      this.dimmed = this.disabled = !1
    },
    onDown: function() {
      this.disabled || this.dimmed || (this.state = 1, regUpdate(this.parent))
    },
    onUp: function() {
      this.disabled || this.dimmed || (this.state = 0, regUpdate(this.parent),
        this.onPress())
    },
    onPress: function() {},
    valueFunc: function() {},
    getState: function() {},
    paint: function() {
      this.getState();
      this.disabled || (ctx.fillStyle = this.bg, ctx.fillRect(0, 0, this.w, this.h), 0 == this.state ? (this.dimmed && (ctx.globalAlpha = .4), ctx.fillStyle = "rgba(255,255,255,0.1)", ctx.fillRect(1, this.h, this.w - 2, -10), ctx.lineWidth = 1, ctx.strokeStyle = color.tabStroke, ctx.strokeRect(.5, .5, this.w - 1, this.h - 2), ctx.font = font.tabText, ctx.fillStyle = this.textColor, ctx.textAlign = "center") : (ctx.globalAlpha = .5, ctx.fillStyle =
        this.color ? this.color : this.parent.color, ctx.fillRect(0, 0, this.w, this.h), ctx.globalAlpha = 1, this.dimmed && (ctx.globalAlpha = .4), ctx.lineWidth = 1, ctx.strokeStyle = this.color ? this.color : this.parent.color, ctx.strokeRect(.5, .5, this.w - 1, this.h - 2), ctx.fillStyle = "rgba(255,255,255,0.1)", ctx.fillRect(1, this.h, this.w - 2, -10), ctx.font = font.tabText, ctx.textAlign = "center", ctx.fillStyle = color.black, ctx.fillText(this.text, this.w / 2 + 1 | 0, this.h / 2 + 7 | 0, this.w - 4), ctx.fillStyle = color.tabTextSel), ctx.fillText(this.text, this.w /
        2 | 0, (this.h / 2 | 0) + 6, this.w - 4), this.dimmed && (ctx.globalAlpha = 1))
    }
  }),
  SLOTBUTTON = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "SLOTBUTTON";
      this.w = 70;
      this.h = 30;
      this.state = !1;
      this.color = null;
      this.text = "TEXT";
      this.idxText = "";
      this.font = font.tabText;
      this.font2 = "10pt open_sans_condensedbold";
      this.needBG = !0;
      this.textColor = color.tabText;
      this.textColor2 = null;
      this.textColorMain = color.white;
      this.indexColor = "#ccd";
      this.hidden = this.disabled = !1;
      this.showIndex = !0
    },
    onDown: function() {
      if (!this.disabled &&
        !this.hidden) {
        if (this.state = !this.state) this.onToggleUp();
        else this.onToggleDown();
        null != this.key && this.setVal(fromBool(this.state));
        this.onToggle();
        this.valueFunc();
        regUpdate(this)
      }
    },
    onToggle: function() {},
    onToggleUp: function() {},
    onToggleDown: function() {},
    valueFunc: function() {},
    getState: function() {},
    paint: function() {
      null != this.key && (this.state = this.getVal());
      this.getState();
      this.hidden || (ctx.fillStyle = color.eqBg, ctx.fillRect(-1, -1, this.w + 2, this.h + 2), this.disabled && (ctx.globalAlpha = .3), this.state ?
        (ctx.fillStyle = hexToRGBA(this.color ? this.color : this.parent.color, .5), ctx.fillRect(0, 0, this.w, this.h), ctx.lineWidth = 1, ctx.strokeStyle = this.color ? this.color : this.parent.color, ctx.strokeRect(.5, .5, this.w - 1, this.h - 1), ctx.fillStyle = "rgba(255,255,255,0.1)", ctx.fillRect(1, this.h, this.w - 2, -10), ctx.drawText(this.text, this.w / 2, this.h / 2, {
          align: "center",
          valign: "middle",
          max: this.w - 4,
          font: this.font,
          color: this.textColor2 || this.textColor,
          shadow: [color.black, 0, 1, 1]
        })) : (ctx.lineWidth = 1, ctx.strokeStyle = color.tabStroke,
          ctx.strokeRect(.5, .5, this.w - 1, this.h - 1), ctx.fillStyle = "rgba(255,255,255,0.1)", ctx.fillRect(1, this.h, this.w - 2, -10), ctx.drawText(this.text, this.w / 2, this.h / 2, {
            align: "center",
            valign: "middle",
            max: this.w - 4,
            font: this.font,
            color: this.textColorMain,
            shadow: [color.black, 0, 1, 1]
          })), this.showIndex && ctx.drawText("" + this.idxText, this.w - 3, 9, {
          align: "right",
          valign: "middle",
          font: this.font2,
          color: this.indexColor,
          shadow: [color.black, 0, 1, 1]
        }))
    }
  });
scrollingWidget = null;
var LIST = Class.create(Widget, {
  initialize: function($super, b) {
    $super(b);
    this.widgetName = "MENU_LIST";
    this.h = this.w = 300;
    this.needMoveEvt = this.needClip = !0;
    this.lastClickTime = 0;
    this.items = ["  Loading..."];
    this.items2 = [];
    this.selectedIdx = this.selected = -1;
    this.selectedItem = null;
    this.prevSelected = this.hoverIdx = this.activeItemIdx = -1;
    this.filterValue = "f:";
    this.filter = !1;
    this.font = "16pt open_sans_condensedbold";
    this.itemH = 40;
    this.maxVOffset = this.vOffsetOld = this.vOffset = 0;
    this.vScrollEnabled = !0;
    this.vScrollWidth =
      8;
    this.borderColor = "#666";
    this.bgColor = color.presetBg;
    this.textColor = color.white;
    this.selTextColor = "#111";
    this.selItemColor = "#eee";
    this.activeTextColor = "#e33";
    this.selectCanceled = this.snapList = this.showList = !1;
    this.listsOffsets = {};
    this.scrollByScroller = !1
  },
  setFilter: function(a) {
    clearInterval(ticker);
    null != this.filterValue && (this.listsOffsets[this.filterValue] = this.vOffset);
    this.filterValue = a;
    this.setItems(this.items2);
    this.filterValue in this.listsOffsets ? this.setOffset(this.listsOffsets[this.filterValue]) :
      this.setOffset(0);
    regUpdate(this)
  },
  onSetItems: function() {},
  setItems: function(a) {
    if (Array.isArray(a)) {
      if (this.filter) {
        this.items2 = a;
        var b = this.filterValue;
        this.items = a.filter(function(a) {
          return a.startsWith(b)
        })
      } else this.items = a;
      this.maxVOffset = this.items.length * this.itemH - this.h;
      0 > this.maxVOffset && (this.maxVOffset = 0);
      this.vOffset > this.maxVOffset && this.setOffset(this.maxVOffset);
      this.onSetItems();
      this.onSetItems = function() {};
      regUpdate(this)
    }
  },
  addItem: function(a) {
    this.items.push(a);
    regUpdate(this)
  },
  clear: function() {
    this.items.clear();
    this.clearSelection()
  },
  getActiveItem: function() {},
  selItem: function() {
    return 0 > this.selected || this.selected >= this.items.length ? null : this.items[this.selected]
  },
  select: function(a, b) {
    if (!(a >= this.items.length)) {
      0 > a ? (this.selectedIdx = this.selected = -1, this.selectedItem = null) : (this.selectedIdx = this.selected = a, this.selectedItem = this.items[a]);
      if (!isDefined(b)) this.onSelect();
      regUpdate(this)
    }
  },
  selectByName: function(a) {
    a = this.items.indexOf(a);
    0 <= a && this.select(a);
    regUpdate(this)
  },
  selectLast: function() {
    0 != this.items.length && this.select(this.items.length - 1)
  },
  clearSelection: function() {
    this.select(-1)
  },
  setOffset: function(a) {
    this.vOffsetOld = this.vOffset = bound(a | 0, 0, this.maxVOffset);
    regUpdate(this)
  },
  onResize: function() {
    this.maxVOffset = this.items.length * this.itemH - this.h;
    0 > this.maxVOffset && (this.maxVOffset = 0);
    this.vOffset > this.maxVOffset && this.setOffset(this.maxVOffset)
  },
  onDown: function(a, b) {
    var c = b - this.globalY(),
      d = a - this.globalX();
    this.pressPoint = [d, c];
    this.selectCanceled = !1;
    this.vScrollEnabled &&
      d > this.w - this.vScrollWidth - 2 ? this.selectCanceled = this.scrollByScroller = !0 : (this.scrollByScroller = !1, this.hoverIdx = Math.floor((this.pressPoint[1] + this.vOffset) / this.itemH));
    !this.scrollByScroller && 0 < this.maxVOffset && this.velStart();
    regUpdate(this);
    this.onMove(a, b)
  },
  onMove: function(a, b) {
    var c = b - this.globalY();
    this.globalX();
    var d = c - this.pressPoint[1];
    this.vOffset = this.scrollByScroller ? bound(c / this.h * this.maxVOffset, 0, this.maxVOffset) : bound(this.vOffsetOld - d, 0, this.maxVOffset);
    regUpdate(this);
    !this.selectCanceled &&
      5 < Math.abs(d) && (this.selectCanceled = !0)
  },
  onUp: function() {
    if (!this.selectCanceled) {
      var a = Math.floor((this.pressPoint[1] + this.vOffset) / this.itemH);
      this.selected != a && this.select(a)
    }
    this.onPress();
    var a = Date.now(),
      b = this.items.length * this.itemH;
    if (!this.selectCanceled && this.pressPoint[1] + this.vOffset <= b && this.prevSelected == this.selectedIdx && a - this.lastClickTime < DBL_CLK_TIME) this.onDClick();
    this.lastClickTime = a;
    this.prevSelected = this.selectedIdx;
    this.hoverIdx = -1;
    this.vOffsetOld = this.vOffset;
    this.pressPoint = [-1, -1];
    !this.scrollByScroller && 0 < this.maxVOffset && this.velRelease();
    regUpdate(this)
  },
  onWheel: function(a) {
    clearInterval(ticker);
    this.setOffset(this.vOffset - Math.round(a / 6))
  },
  velStart: function() {
    velocity = amplitude = 0;
    timestamp = Date.now();
    clearInterval(ticker);
    frame = this.vOffset;
    scrollingWidget = this;
    ticker = setInterval(this.velTrack, 20)
  },
  velTrack: function() {
    var a, b;
    a = Date.now();
    b = a - timestamp;
    timestamp = a;
    a = scrollingWidget.vOffset - frame;
    frame = scrollingWidget.vOffset;
    velocity = 1E3 * a / (1 + b) * .8 + .2 * velocity
  },
  velRelease: function() {
    clearInterval(ticker);
    10 < Math.abs(velocity) && this.mScroll(velocity)
  },
  mScroll: function(a) {
    if (!settings.kinetic) {
      position = this.vOffset;
      amplitude = .3 * a;
      step = 0;
      var b = this;
      clearInterval(ticker);
      ticker = setInterval(function() {
        var a = amplitude / 20;
        position += a;
        amplitude -= a;
        step += 1;
        80 < step && clearInterval(ticker);
        (0 >= position || position > b.maxVOffset) && clearInterval(ticker);
        scrollingWidget.vOffset != (position | 0) && scrollingWidget.setOffset(position | 0)
      }, 20)
    }
  },
  gotoSelected: function() {
    0 > this.selected ||
      this.selected >= this.items.length || this.setOffset(this.selected * this.itemH - this.h / 2)
  },
  gotoActive: function() {
    0 > this.activeItemIdx || this.activeItemIdx >= this.items.length || this.setOffset(this.activeItemIdx * this.itemH - this.h / 2)
  },
  onDClick: function() {},
  onSelect: function() {},
  onPress: function() {},
  valueFunc: function() {},
  calcGeometry: function() {
    this.maxVOffset = this.items.length * this.itemH - this.h;
    0 > this.maxVOffset && (this.maxVOffset = 0);
    this.vOffset > this.maxVOffset && this.setOffset(this.maxVOffset)
  },
  calcSize: function() {
    this.h =
      this.items.length * this.itemH;
    this.parent && regUpdate(this.parent)
  },
  paint: function() {
    ctx.fillStyle = this.bgColor;
    ctx.fillRect(0, 0, this.w, this.h);
    this.getActiveItem();
    var a = this.items.length * this.itemH;
    this.vScrollEnabled = a > this.h ? !0 : !1;
    var b = this.w - 1;
    ctx.font = this.font;
    ctx.textAlign = "left";
    ctx.shadowColor = "transparent";
    ctx.textBaseline = "middle";
    var c = this.itemH / 2 | 0;
    ctx.setShadow(color.black, 0, 1, 1);
    for (var d = 0; d < this.items.length; d++) {
      var f = d * this.itemH - this.vOffset;
      if (!(f < -this.itemH || f > this.h)) {
        this.selected ==
          d && (ctx.fillStyle = this.selItemColor, ctx.fillRect(0, f, b, this.itemH));
        this.hoverIdx == d && (ctx.fillStyle = "rgba(255,255,255,0.05)", ctx.fillRect(0, f, b, this.itemH));
        ctx.fillStyle = this.selected == d ? this.selTextColor : this.textColor;
        this.activeItemIdx == d && (ctx.fillStyle = this.activeTextColor);
        var e = this.items[d];
        this.filter && (e = e.substr(2));
        ctx.fillText(e, 8, f + c, b);
        ctx.shadowColor = "transparent";
        ctx.fillStyle = "#444";
        ctx.fillRect(0, f + this.itemH, b, -1)
      }
    }
    this.vScrollEnabled && (a < this.h && (a = this.h), b = this.h / a * this.h,
      a = 2 + this.vOffset / (a - this.h) * (this.h - 4 - b), ctx.fillStyle = "rgba(0,0,0,0.4)", ctx.fillRoundRect(this.w - this.vScrollWidth - 2 + 1, a + 1 | 0, this.vScrollWidth - 2, b - 2 | 0, 5), ctx.fillStyle = "rgba(255,255,255,0.6)", ctx.fillRoundRect(this.w - this.vScrollWidth - 2, a, this.vScrollWidth, b | 0, 7));
    ctx.lineWidth = 1 + (isSmall ? 1 : 0);
    ctx.strokeStyle = this.borderColor;
    ctx.strokeRect(.5, .5, this.w - 1, this.h - 1);
    ctx.textBaseline = "alphabetic"
  }
});
currentPresetWindow = null;
cuurentPresetDir = 0;
var PRESET_MENU2 = Class.create(Widget, {
    initialize: function($super, b, c, d, f, e) {
      $super(b);
      this.widgetName = "PRESET_MENU";
      this.h = this.w = 500;
      this.sy = 58;
      this.title = "PRESETS";
      this.color = "#eee";
      this.bg = "#262728";
      this.borderColor = "#676869";
      this.type = c;
      this.t = null;
      this.target = d;
      this.center = !1;
      this.currentPreset = e || "";
      this.user = 0;
      switch (this.type) {
        case "ch":
          this.title = lang.CHANNEL_PRESETS;
          break;
        case "chm":
          this.title = lang.MASTER_PRESETS;
          break;
        case "eqch":
          this.title = lang.CHANNEL_EQ_PRESETS;
          break;
        case "eqaux":
          this.title =
            lang.AUX_EQ_PRESETS;
          break;
        case "eqm":
          this.title = lang.MASTER_EQ_PRESETS;
          break;
        case "dynch":
          this.title = lang.CHANNEL_DYN_PRESETS;
          break;
        case "dynaux":
          this.title = lang.AUX_DYN_PRESETS;
          break;
        case "dynm":
          this.title = lang.MASTER_DYN_PRESETS;
          break;
        case "fxcho":
          this.title = lang.CHORUS_FX_PRESETS;
          break;
        case "fxdel":
          this.title = lang.DELAY_FX_PRESETS;
          break;
        case "fxrev":
          this.title = lang.REVERB_FX_PRESETS;
          break;
        case "fxroom":
          this.title = lang.ROOM_PRESETS;
          break;
        case "digi":
          this.title = lang.DIGITECH_PRESETS;
          break;
        case "gate":
          this.title =
            lang.GATE_PRESETS;
          break;
        case "afs":
          this.title = lang.AFS_PRESETS;
          break;
        case "ux":
          this.title = lang.UX_PRESETS, cuurentPresetDir = 1
      }
      isDefined(f) ? this.color = f : this.type.contains("chm") ? this.color = color.red : this.type.contains("afs") ? this.color = "#888" : this.type.contains("ch") ? this.color = color.yellow : this.type.contains("eq") ? this.color = color.purple : this.type.contains("dyn") ? this.color = color.orange : this.type.contains("fx") ? this.color = color.blue : this.type.contains("gate") ? this.color = color.GATE : (this.type.contains("ux"),
        this.color = color.red);
      this.initWidgets();
      this.refreshList();
      this.calcGeometry();
      mWidgets.push(widgets.pop());
      currentPresetWindow = this
    },
    refreshList: function() {
      if (EMULATE) {
        var a = $A($R("f:FACTORY PRESET A", "f:FACTORY PRESET Z")),
          a = a.concat($A($R("u:USER PRESET A", "u:USER PRESET Z")));
        this.LIST.setItems(a)
      } else widgetReqList = this.LIST, sendMessage(E_COMMANDS.PRESET_LIST + "^" + this.type)
    },
    checkDir: function() {
      0 == cuurentPresetDir ? (this.RENAME.hide(), this.DEL.hide()) : (this.RENAME.show(), this.DEL.show())
    },
    initWidgets: function() {
      var a =
        this;
      this.LIST = new LIST(this);
      this.LIST.filter = !0;
      this.LIST.filterValue = 1 == cuurentPresetDir ? "u:" : "f:";
      this.LIST.setPos(10, this.sy);
      this.LIST.setSize(100, 100);
      this.LOAD = new MENUBUTTON(this);
      this.LOAD.text = lang.LOAD;
      this.LOAD.bg = this.bg;
      this.LOAD.setPos(200, 20);
      this.LOAD.onPress = function() {
        if (EMULATE) showPopupMsg(lang.DEMO_VERSION), a.close();
        else {
          var b = a.LIST.selItem();
          null != b && (widgetReqPreset = a.target, sendMessage(E_COMMANDS.PRESET_READ + "^" + a.type + "^" + b), a.close())
        }
      };
      var b = this.LOAD;
      this.LIST.onDClick =
        function() {
          b.click()
        };
      this.SAVE = new MENUBUTTON(this);
      this.SAVE.text = lang.SAVE;
      this.SAVE.bg = this.bg;
      this.SAVE.setPos(200, 50);
      this.SAVE.onPress = function() {
        if (EMULATE) showPopupMsg(lang.DEMO_VERSION), a.close();
        else {
          editOk.valueFunc = function() {
            var b = editBox2.value;
            if (null != b && 0 != b.length) {
              var b = b.replace(/\^/g, "_"),
                c = JSON.stringify(a.target.savePreset(b)); - 1 != a.LIST.items.indexOf("u:" + b) ? (confOk.valueFunc = function() {
                sendMessage(E_COMMANDS.PRESET_WRITE + "^" + a.type + "^u:" + b + "^" + c);
                a.close();
                showPopupMsg(lang.SAVED,
                  800)
              }, confCancel.valueFunc = function() {}, showConfBox(lang.REPLACE_PRESET.format(b))) : (sendMessage(E_COMMANDS.PRESET_WRITE + "^" + a.type + "^u:" + b + "^" + c), a.close(), showPopupMsg(lang.SAVED, 800))
            }
          };
          var b = a.LIST.selItem(),
            b = null != b ? b.substr(2) : "";
          showEditBox2(lang.SAVE_PRESET_WITH_NAME, b)
        }
      };
      this.RENAME = new MENUBUTTON(this);
      this.RENAME.text = lang.RENAME;
      this.RENAME.bg = this.bg;
      this.RENAME.setPos(200, 110);
      this.RENAME.onPress = function() {
        if (EMULATE) showPopupMsg(lang.DEMO_VERSION), a.close();
        else {
          var b = a.LIST.selItem();
          null == b || b.startsWith("f:") || (editOk.valueFunc = function() {
            var c = editBox2.value;
            null != c && 0 != c.length && (c = c.replace(/\^/g, "_"), c != b && (sendMessage(E_COMMANDS.PRESET_RENAME + "^" + a.type + "^" + b + "^u:" + c), a.refreshList()))
          }, showEditBox2(lang.RENAME_PRESET, b.substr(2)))
        }
      };
      this.DEL = new MENUBUTTON(this);
      this.DEL.text = lang.DELETE;
      this.DEL.bg = this.bg;
      this.DEL.setPos(200, 80);
      this.DEL.onPress = function() {
        if (EMULATE) showPopupMsg(lang.DEMO_VERSION), a.close();
        else {
          var b = a.LIST.selItem();
          null == b || b.startsWith("f:") || (confOk.valueFunc =
            function() {
              sendMessage(E_COMMANDS.PRESET_DEL + "^" + a.type + "^" + b);
              a.refreshList()
            }, confCancel.valueFunc = function() {}, showConfBox(lang.DELETE_PRESET.format(b.substr(2))))
        }
      };
      this.FACUSER = new SWITCHBOX(this);
      this.FACUSER.setItems([lang.FACTORY, lang.USER]);
      this.FACUSER.setItemWidth(80);
      this.FACUSER.state = cuurentPresetDir;
      this.FACUSER.bg = this.bg;
      this.FACUSER.setPos(10, 15);
      this.FACUSER.color = this.color;
      this.FACUSER.borderColor = this.borderColor;
      this.FACUSER.valueFunc = function() {
        cuurentPresetDir = a.user = this.state;
        a.LIST.setFilter(0 == this.state ? "f:" : "u:");
        a.checkDir()
      };
      "ux" == this.type && this.FACUSER.hide();
      this.checkDir()
    },
    close: function() {
      currentPresetWindow = null;
      this.enabled = !1;
      clearModals();
      regUpdate(this.target)
    },
    onDelete: function() {
      currentPresetWindow = null
    },
    calcPos: function() {},
    calcGeometry: function() {
      if (!this.center && null != this.target && isDefined(this.target.x)) {
        var a = this.target;
        this.setPos(116 + Math.round((a.w - 116 - this.w) / 2), a.globalY() + Math.round((a.h - this.h) / 2))
      }
      this.center && this.setPos(Math.round((screenWidth -
        this.w) / 2) | 0, (screenHeight - this.h) / 2 | 0);
      var a = this.sy,
        b = 0;
      this.LIST.setSize(this.w - this.LIST.x - this.DEL.w - 20, this.h - this.LIST.y - 15 - 50);
      var c = this.DEL.w + 10;
      this.DEL.setPos(this.w - c, this.h - this.DEL.h - 15 - 50);
      this.LOAD.setPos(this.w - c, a + 45 * b++);
      this.SAVE.setPos(this.w - c, a + 45 * b++);
      this.RENAME.setPos(this.w - c, a + 45 * b++);
      this.grd = ctx.createLinearGradient(0, 0, 0, 40);
      this.grd.addColorStop(0, "rgba(255,255,255,0.2)");
      this.grd.addColorStop(1, "rgba(255,255,255,0.0)")
    },
    paint: function() {
      ctx.fillStyle = this.bg;
      ctx.strokeStyle =
        this.borderColor;
      ctx.lineWidth = 1;
      ctx.roundRect(0, 0, this.w, this.h, 14);
      ctx.fill();
      ctx.stroke();
      ctx.fillStyle = this.grd;
      ctx.fillTopRoundRect(0, 0, this.w, 40, 14);
      ctx.fillStyle = color.white;
      ctx.font = "16pt open_sans_condensedbold";
      ctx.setShadow(color.black, 3, 1, 1);
      "ux" != this.type ? (ctx.textAlign = "right", ctx.fillText(this.title, this.LIST.x + this.LIST.w, 38)) : (ctx.textAlign = "center", ctx.fillText(this.title, this.w / 2, 38));
      ctx.setShadow(null);
      ctx.fillStyle = this.color;
      ctx.fillBotRoundRect(10, this.h - 59, this.w - 20, 50, 10);
      switch (this.type) {
        case "ch":
        case "chm":
        case "eqch":
        case "eqaux":
        case "eqm":
        case "dynch":
        case "dynaux":
        case "dynm":
        case "gate":
        case "afs":
          drawImage(res.dbx_logo, 20, this.h - 53);
          break;
        case "fxrev":
          drawImage(res.lex_rev, 20, this.h - 53);
          break;
        case "fxroom":
          drawImage(res.lex_rmlogo, 20, this.h - 53);
          break;
        case "fxcho":
          drawImage(res.lex_cho, 20, this.h - 53);
          break;
        case "fxdel":
          drawImage(res.lex_dly, 20, this.h - 53);
          break;
        case "digi":
          drawImage(res.DIGI_PRE, 22, this.h - 45);
          break;
        case "ux":
          drawText(lang.CONFIG_WARNING, 20,
            this.h - 40, {
              color: color.white,
              align: "left",
              font: "14px open_sans_condensedbold"
            })
      }
    }
  }),
  SHOW_MENU = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "SHOW_MENU";
      this.w = 510;
      this.h = 420;
      this.color = "black";
      showsPopup = this;
      this.initWidgets();
      this.refreshList();
      this.calcGeometry();
      mWidgets.push(widgets.pop())
    },
    refreshList: function() {
      if (EMULATE) this.SHOWS.setItems($A($R("SHOW A", "SHOW Z"))), this.SNAPS.showName = getValue("var.currentShow"), this.SNAPS.setItems($A($R("SNAPSHOT A", "SNAPSHOT Z")));
      else {
        widgetReqList = this.LIST;
        sendMessage(E_COMMANDS.SHOW_LIST);
        var a = getValue("var.currentShow");
        0 != a.length && sendMessage(E_COMMANDS.SNAP_LIST + "^" + a)
      }
    },
    initWidgets: function() {
      var a = this;
      this.SHOWS = new LIST(this);
      this.SHOWS.setPos(10, 34);
      this.SHOWS.setSize(240, this.h - 34 - 10);
      this.SHOWS.getActiveItem = function() {
        var a = getValue("var.currentShow");
        this.activeItemIdx = this.items.indexOf(a)
      };
      this.SHOWS.onDClick = function() {
        if (EMULATE) showPopupMsg(lang.DEMO_VERSION), a.close();
        else if (isBlocked("shows")) showPopupMsg(lang.LOCKED,
          800);
        else {
          var b = this.selItem();
          null != b && sendMessage(E_COMMANDS.SHOW_LOAD + "^" + b)
        }
      };
      this.SHOWS.onSelect = function() {
        if (!EMULATE) {
          var b = this.selItem();
          null != b && (a.SNAPS.clear(), a.SNAPS.showName = b, sendMessage(E_COMMANDS.SNAP_LIST + "^" + b))
        }
      };
      this.SNAPS = new LIST(this);
      this.SNAPS.setPos(260, 34);
      this.SNAPS.setSize(240, this.h - 34 - 10);
      this.SNAPS.showName = "";
      this.SNAPS.getActiveItem = function() {
        var a = getValue("var.currentShow");
        this.showName != a ? this.activeItemIdx = -1 : (a = getValue("var.currentSnapshot"), this.activeItemIdx =
          this.items.indexOf(a))
      };
      this.SNAPS.onDClick = function() {
        if (EMULATE) showPopupMsg(lang.DEMO_VERSION), a.close();
        else if (isBlocked("shows")) showPopupMsg(lang.LOCKED, 800);
        else {
          var b = this.selItem();
          if (null != b) {
            var c = a.SHOWS.selItem();
            null == c && (c = getValue("var.currentShow"));
            null != c && (getValue("var.currentShow") != c && sendMessage(E_COMMANDS.SHOW_LOAD + "^" + c), sendMessage(E_COMMANDS.SNAP_LOAD + "^" + c + "^" + b), a.close())
          }
        }
      }
    },
    onDelete: function() {
      clearInterval(ticker);
      this.hide();
      log("SHOW_MENU ONDELETE");
      for (var a =
          0; a < this.widgets.length; a++) delete this.widgets[a];
      showsPopup = null
    },
    close: function() {
      log("SHOW_MENU CLOSE");
      this.enabled = !1;
      clearModals()
    },
    calcGeometry: function() {
      this.setPos(screenWidth - this.w - 10, 60);
      this.grd = ctx.createLinearGradient(0, 0, 0, 40);
      this.grd.addColorStop(0, "rgba(255,255,255,0.2)");
      this.grd.addColorStop(1, "rgba(255,255,255,0.0)")
    },
    paint: function() {
      ctx.fillStyle = "#262728";
      ctx.strokeStyle = "#676869";
      ctx.lineWidth = 1;
      ctx.roundRect(0, 0, this.w, this.h, 14);
      ctx.fill();
      ctx.stroke();
      ctx.fillStyle =
        this.grd;
      ctx.fillTopRoundRect(0, 0, this.w, 40, 14);
      ctx.font = font.editbox;
      ctx.textAlign = "center";
      ctx.fillStyle = color.tabTextSel;
      ctx.fillText(lang.SHOWS, 130, 24);
      ctx.fillText(lang.SNAPSHOTS, 380, 24)
    }
  }),
  MODAL_LIST = Class.create(Widget, {
    initialize: function($super, b, c) {
      $super(b);
      this.widgetName = "MODAL_LIST";
      this.h = this.w = 400;
      this.sy = 58;
      this.command = c;
      this.title = "TITLE";
      this.color = "#eee";
      this.bg = "#262728";
      this.borderColor = "#676869";
      this.initWidgets();
      this.updateGeometry();
      mWidgets.push(widgets.pop());
      this.refreshList()
    },
    refreshList: function() {
      widgetReqList = this.LIST;
      sendMessage(this.command)
    },
    valueFunc: function(a) {
      showPopupMsg(a)
    },
    initWidgets: function() {
      var a = this;
      this.LIST = new LIST(this);
      this.LIST.setAnchors(10, this.sy, 10, 50);
      this.LOAD = new MENUBUTTON(this);
      this.LOAD.text = lang.OK;
      this.LOAD.bg = this.bg;
      this.LOAD.w = 90;
      this.LOAD.setAnchors(10, null, null, 10);
      this.LOAD.onPress = function() {
        var b = a.LIST.selItem();
        a.valueFunc(b);
        a.close()
      };
      this.LIST.onDClick = function() {
        a.LOAD.click()
      };
      this.CANCEL = new MENUBUTTON(this);
      this.CANCEL.text =
        lang.CANCEL;
      this.CANCEL.bg = this.bg;
      this.CANCEL.w = 90;
      this.CANCEL.setAnchors(null, null, 10, 10);
      this.CANCEL.onPress = function() {
        a.close()
      }
    },
    close: function() {
      this.enabled = !1;
      clearModals()
    },
    onDelete: function() {},
    calcGeometry: function() {
      this.x = (screenWidth - this.w) / 2 | 0;
      this.y = (screenHeight - this.h) / 2 | 0;
      this.grd = ctx.createLinearGradient(0, 0, 0, 40);
      this.grd.addColorStop(0, "rgba(255,255,255,0.2)");
      this.grd.addColorStop(1, "rgba(255,255,255,0.0)")
    },
    paint: function() {
      ctx.fillStyle = this.bg;
      ctx.strokeStyle = this.borderColor;
      ctx.lineWidth = 1;
      ctx.roundRect(0, 0, this.w, this.h, 14);
      ctx.fill();
      ctx.stroke();
      ctx.fillStyle = this.grd;
      ctx.fillTopRoundRect(0, 0, this.w, 40, 14);
      ctx.fillStyle = color.white;
      ctx.font = "16pt open_sans_condensedbold";
      ctx.textAlign = "center";
      ctx.setShadow(color.black, 3, 1, 1);
      ctx.fillText(this.title, this.w / 2 | 0, 38)
    }
  }),
  METERS_PAGE = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "METERS_PAGE";
      this.y = 40;
      this.compact = this.enabled = !1;
      1024 > screenWidth && (this.compact = !0);
      this.initWidgets()
    },
    initWidgets: function() {
      this.mi =
        new METERS_IND(this);
      metersWidget = this.m = new METERS(this);
      var a = this;
      this.MGS = [];
      for (var b = 0; 6 > b; b++) {
        var c = new SCheckBox(this);
        c.text = lang.red;
        c.mline = !0;
        c.color = c.textColor = color.red;
        c.textColor = color.white;
        c.setSize(70, 42);
        c.text = lang.MUTE_GROUP_X.format(b + 1).replace(" ", "<br>");
        c.idx = b;
        c.getState = function() {
          this.state = getMGroupState(this.idx)
        };
        c.onToggleUp = function() {
          muteGroupON(this.idx)
        };
        c.onToggleDown = function() {
          muteGroupOFF(this.idx)
        };
        c.setAnchors(20 + 80 * b, null, null, 8);
        this.MGS.push(c)
      }
      this.tap =
        new SButton(this);
      this.tap.text = lang.TAP_TEMPO.replace(" ", "<br>");
      this.tap.color = color.white;
      this.tap.textColor = color.white;
      this.tap.mline = !0;
      this.tap.setSize(100, 42);
      this.tap.longClickMark = !0;
      this.tap.setAnchors(null, null, null, 8);
      this.tap.valueFunc = bpmTapHandler;
      this.tap.regKey("f.0.bpm");
      this.tap.regKey("f.1.bpm");
      this.tap.regKey("f.2.bpm");
      this.tap.regKey("f.3.bpm");
      this.tap.getState = function() {
        var a = getGlobalBpm();
        this.text = lang.TAP_X_BPM.format(a)
      };
      this.tap.onHold = function() {
        askBpm()
      };
      this.mutefx =
        new SCheckBox(this);
      this.mutefx.text = lang.MUTE_FX.replace(" ", "<br>");
      this.mutefx.mline = !0;
      this.mutefx.color = this.mutefx.textColor = color.tvMuteFX;
      this.mutefx.setSize(70, 42);
      this.mutefx.setAnchors(null, null, 40, 8);
      this.mutefx.getState = function() {
        this.state = checkBit(getValue("mgmask"), MUTEFX_BIT_IDX) ? 1 : 0
      };
      this.mutefx.onToggleUp = function() {
        mixerWidget.muteFX()
      };
      this.mutefx.onToggleDown = function() {
        mixerWidget.unMuteFX()
      };
      this.muteall = new SCheckBox(this);
      this.muteall.text = lang.MUTE_ALL.replace(" ", "<br>");
      this.muteall.color = this.muteall.textColor = color.tvMuteALL;
      this.muteall.mline = !0;
      this.muteall.setSize(70, 42);
      this.muteall.setAnchors(null, null, 120, 8);
      this.muteall.getState = function() {
        this.state = checkBit(getValue("mgmask"), MUTEALL_BIT_IDX) ? 1 : 0
      };
      this.muteall.onToggleUp = function() {
        mixerWidget.muteAll()
      };
      this.muteall.onToggleDown = function() {
        mixerWidget.cancelMuteAll()
      };
      this.clearsolo = new SButton(this);
      this.clearsolo.text = lang.CLEAR_SOLO.replace(" ", "<br>");
      this.clearsolo.mline = !0;
      this.clearsolo.color =
        this.clearsolo.textColor = color.tvClearSolo;
      this.clearsolo.setSize(70, 42);
      this.clearsolo.setAnchors(null, null, 200, 8);
      this.clearsolo.onPress = function() {
        mixerWidget.clearSolos();
        regUpdate(a)
      }
    },
    onShow: function() {},
    onHide: function() {},
    onDown: function(a, b) {
      this.lastPressPoint = this.pressPoint;
      this.pressPoint = [a, b]
    },
    onUp: function(a) {
      var b = Date.now(),
        c = Math.abs(this.lastPressPoint[0] - this.pressPoint[0]),
        d = Math.abs(this.lastPressPoint[1] - this.pressPoint[1]);
      2 < mouseTargets.length || isDefined(tHash[a]) && 2 < tHash[a].length ||
        (30 > c && 30 > d && b - this.lastClickTime < DBL_CLK_TIME ? (this.onDouble(), this.lastClickTime = b - DBL_CLK_TIME) : this.lastClickTime = b)
    },
    onDouble: function() {
      setMode(E_MODE.MIX)
    },
    calcGeometry: function() {
      this.w = this.parent.w - this.x;
      this.h = this.parent.h - this.y;
      this.mi.setAnchors(20, 0, 0, null);
      this.m.setAnchors(20, 120, 0, 101);
      this.tap.x = 490 + (this.w - 490 - 270 - this.tap.w) / 2 | 0
    },
    paint: function() {
      ctx.fillStyle = color.eqBg;
      ctx.fillRect(0, 0, this.w, this.h);
      var a = 20,
        b = this.m.y + this.m.h,
        c = (this.w - a) / allStripsNoVca.length - 1 | 0,
        d;
      ctx.textAlign =
        "center";
      ctx.font = font.botChLabel;
      ctx.fillStyle = color.INPUT;
      var f = inStrips.length * (c + 1) - 2;
      ctx.fillRect(a, b, f, 20);
      if (!HAVE_ROUTING)
        for (d = 0; 4 > d; d++) inStrips[d].getNameValue("hiz") && (ctx.fillStyle = color.INPUT, ctx.font = "14px open_sans_condensedbold", ctx.fillBotRoundRect(a + (c + 1) * d, b + 20, c, 20, 4), ctx.fillStyle = "#eee", ctx.drawText("Z", a + (c + 1) * d + c / 2 | 0, b + 20 + 10 + 5 | 0, {
          shadow: [color.black, 0, 1, 1]
        }));
      ctx.font = font.botChLabel;
      ctx.fillStyle = "#eee";
      ctx.drawText(lang.INPUT, a + f / 2 | 0, b + 38, {
        shadow: [color.black, 0, 1, 1]
      });
      a +=
        f + 1;
      ctx.fillStyle = color.LINEIN;
      f = lineinStrips.length * (c + 1) - 1;
      ctx.fillRect(a, b, f, 20);
      ctx.fillStyle = "#eee";
      ctx.drawText(lang.LINE, a + f / 2 | 0, b + 38, {
        shadow: [color.black, 0, 1, 1]
      });
      a += f + 1;
      ctx.fillStyle = color.media;
      f = mediaStrips.length * (c + 1) - 1;
      ctx.fillRect(a, b, f, 20);
      ctx.fillStyle = "#eee";
      d = a + f / 2 | 0;
      ctx.fillTriangle2(d - 6, b + 38 - 15, d + 6, b + 38 + 8 - 15, d - 6, b + 38 + 16 - 15);
      a += f + 1;
      ctx.fillStyle = color.FX;
      f = fxStrips.length * (c + 1) - 1;
      ctx.fillRect(a, b, f, 20);
      ctx.fillStyle = "#eee";
      ctx.drawText(lang.FX, a + f / 2 | 0, b + 38, f, {
        shadow: [color.black,
          0, 1, 1
        ]
      });
      a += f + 1;
      ctx.fillStyle = color.sub;
      f = subStrips.length * (c + 1) - 1;
      ctx.fillRect(a, b, f, 20);
      ctx.fillStyle = "#eee";
      ctx.drawText(lang.SUB, a + f / 2 | 0, b + 38, f, {
        shadow: [color.black, 0, 1, 1]
      });
      a += f + 1;
      ctx.fillStyle = color.AUX;
      f = auxStrips.length * (c + 1);
      if (HAVE_MATRIX)
        for (d = 0; d < auxStrips.length; d++) ctx.fillStyle = auxStrips[d].getNameValue("matrix") ? color.MATRIX : color.AUX, ctx.fillRect(a + (c + 1) * d, b, c + 1, 20);
      else ctx.fillRect(a, b, f - 1, 20);
      ctx.fillStyle = "#eee";
      d = lang.AUX;
      HAVE_MATRIX && (d += " / " + lang.MTX);
      ctx.drawText(d, a + f / 2 |
        0, b + 38, {
          shadow: [color.black, 0, 1, 1]
        });
      ctx.font = "14px open_sans_condensedbold";
      CASCADE_MODE && 1E3 > this.w && (ctx.font = "13px open_sans_condensedbold");
      ctx.textAlign = "center";
      ctx.setShadow(color.black, 0, 1, 1);
      for (d = 0; d < allStripsNoVca.length; d++) {
        var a = 20 + (c + 1) * d | 0,
          f = 20 + c / 2 + (c + 1) * d | 0,
          e = "" + (allStripsNoVca[d].subId + 1),
          g = c;
        if (24 < inStrips.length && (d < inStrips.length || d >= auxStrips[0].id))
          if (0 == d % 8) f = d + 1, d >= auxStrips[0].id && (f -= auxStrips[0].id), e = "" + f + " - " + (f + 7), f = 20 + (c + 1) * (d + 4) | 0, g = 9999, d / 8 % 2 && (ctx.fillStyle = "rgba(255,255,255,0.08)",
            ctx.fillRect(a - 1, b, 8 * (c + 1), 20));
          else continue;
        d % 2 && (ctx.fillStyle = "rgba(255,255,255,0.07)", ctx.fillRect(a, b, c - 1, 20));
        allStripsNoVca[d].type == E_STRIP_TYPE.LINEIN && (e = 0 == allStripsNoVca[d].subId % 2 ? "L" : "R");
        allStripsNoVca[d].type == E_STRIP_TYPE.MEDIA && (e = 0 == allStripsNoVca[d].subId % 2 ? "L" : "R");
        if (!hideHPAUX || d != auxStrips[curSetup.aux - 2].id && d != auxStrips[curSetup.aux - 1].id) ctx.fillStyle = "#000", ctx.fillText(e, f + 1, b + 15 + 1, g), ctx.fillStyle = "#eee", ctx.fillText(e, f, b + 15, g)
      }
      a = 12;
      d = this.mi.hh / 2 | 0;
      b = this.mi.hh;
      ctx.font =
        "13px open_sans_condensedbold";
      ctx.textBaseline = "middle";
      ctx.fillStyle = color.tvPhantom;
      ctx.fillText("48V", a - 2, d, 17);
      ctx.fillStyle = color.tvInvert;
      d += b;
      drawImage(res.inv_pic, a - 8, d - 7);
      ctx.fillStyle = color.tvMute;
      ctx.fillText("M", a, d += b, 16);
      ctx.fillStyle = color.tvSolo;
      ctx.fillText("S", a, d + b, 16);
      ctx.fillStyle = "#999";
      ctx.fillText("№", a - 1, this.h - 92, 16);
      ctx.fillText("G", a, this.h - 200 - c / 2, 16);
      ctx.fillText("C", a, this.h - 200 + 20, 16);
      ctx.fillText("O", a, this.h - 200 + 40, 16);
      ctx.fillText("M", a, this.h - 200 + 60, 16);
      ctx.fillText("P",
        a, this.h - 200 + 80, 16);
      ctx.textAlign = "right";
      ctx.font = "10px open_sans_condensedbold";
      b = [-96, -90, -80, -70, -60, -50, -40, -24, -12, -6, 0];
      f = this.mi.h;
      c = this.h - f - c - 200 - 11;
      for (d = 0; d < b.length; d++) b[d] < -VU_RANGE || (e = f + 5 + vuPosMark(b[d], c), ctx.fillText("" + b[d], a + 4, e))
    }
  }),
  METERS_IND = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "METERS_IND";
      this.hh = 30;
      this.rows = 4;
      this.h = this.hh * this.rows
    },
    calcGeometry: function() {
      this.grd = ctx.createLinearGradient(0, 0, 0, this.h);
      this.grd.addColorStop(0,
        "rgba(0,0,0,0.00)");
      this.grd.addColorStop(.12, "rgba(0,0,0,0.4)");
      this.grd.addColorStop(.25, "rgba(0,0,0,0.00)");
      this.grd.addColorStop(.251, "rgba(0,0,0,0.00)");
      this.grd.addColorStop(.37, "rgba(0,0,0,0.4)");
      this.grd.addColorStop(.5, "rgba(0,0,0,0.00)");
      this.grd.addColorStop(.501, "rgba(0,0,0,0.00)");
      this.grd.addColorStop(.62, "rgba(0,0,0,0.4)");
      this.grd.addColorStop(.75, "rgba(0,0,0,0.00)");
      this.grd.addColorStop(.751, "rgba(0,0,0,0.00)");
      this.grd.addColorStop(.87, "rgba(0,0,0,0.4)");
      this.grd.addColorStop(1,
        "rgba(0,0,0,0.00)")
    },
    paint: function() {
      var a = this.w,
        b = this.h,
        c = a / allStripsNoVca.length - 1 | 0;
      ctx.fillStyle = color.eqBg;
      ctx.fillRect(0, 0, a, b);
      ctx.fillStyle = "rgba(255,255,255,0.02)";
      ctx.fillRect(0, 1 * this.hh, (c + 1) * inStrips.length - 1, this.hh);
      var d = getValue("mgmask"),
        a = checkBit(d, MUTEALL_BIT_IDX),
        d = checkBit(d, MUTEFX_BIT_IDX);
      ctx.font = "12px open_sans_condensedbold";
      24 < inStrips.length && (ctx.font = "9px open_sans_condensedbold");
      ctx.textAlign = "center";
      ctx.textBaseline = "middle";
      for (var f = 0, e = allStripsNoVca.length; f <
        e; f++) {
        var g = (c + 1) * f,
          h = allStripsNoVca[f],
          l = hideHPAUX && (f == auxStrips[curSetup.aux - 2].id || f == auxStrips[curSetup.aux - 1].id);
        ctx.globalAlpha = f % 2 ? .09 : .07;
        l && (ctx.globalAlpha = .04);
        ctx.fillStyle = allStripsNoVca[f].color;
        h.type == E_STRIP_TYPE.IN ? ctx.fillRect(g, 0, c, b) : ctx.fillRect(g, b / 2, c, b / 2);
        ctx.globalAlpha = 1;
        var m = h.getNameValue("solo"),
          n = h.getNameValue("mute"),
          p = h.getNameValue("forceunmute"),
          r = h.getMuteState(!0, !0);
        ctx.strokeStyle = "rgba(0,0,0,0.3)";
        if (n || r) ctx.fillStyle = p ? color.tvMuteUn : r && !n ? color.tvMuteMG :
          color.tvMute, l && (ctx.fillStyle = color.tvGray), ctx.roundRect(g, 2 * this.hh, c - 1, this.hh - 1, 4), ctx.fill(), ctx.fillStyle = this.grd, ctx.fill(), ctx.fillStyle = "#eee", ctx.fillText(p ? "-M" : n ? "M" : a ? "MA" : h.type == E_STRIP_TYPE.FX && d ? "MF" : r ? "MG" : "M", g + c / 2 | 0, 2 * this.hh + this.hh / 2 | 0, c);
        m && (ctx.fillStyle = color.tvSolo, l && (ctx.fillStyle = color.tvGray), ctx.roundRect(g, 3 * this.hh, c - 1, this.hh - 1, 4), ctx.fill(), ctx.fillStyle = this.grd, ctx.fill());
        h.type == E_STRIP_TYPE.IN && (m = h.getNameValue("invert"), n = !1, HAVE_ROUTING ? (p = h.getNameValue("src"),
          p.startsWith("hw.") && (n = getValue(p + ".phantom"))) : n = h.getNameValue("phantom"), n && (ctx.fillStyle = color.tvPhantom, l && (ctx.fillStyle = color.tvGray), ctx.roundRect(g, 0 * this.hh, c - 1, this.hh - 1, 4), ctx.fill(), ctx.fillStyle = this.grd, ctx.fill()), m && (ctx.fillStyle = color.tvInvert, l && (ctx.fillStyle = color.tvGray), ctx.roundRect(g, 1 * this.hh, c - 1, this.hh - 1, 4), ctx.fill(), ctx.fillStyle = this.grd, ctx.fill()));
        ctx.fillStyle = "#111";
        h.type == E_STRIP_TYPE.IN ? ctx.fillRect(g + c - 1, 0, 1, b) : ctx.fillRect(g + c - 1, b / 2, 1, b / 2)
      }
      ctx.fillStyle =
        "#111";
      ctx.fillRect(0, 1 * this.hh - 1, (c + 1) * inStrips.length, 1);
      ctx.fillRect(0, 2 * this.hh - 1, (c + 1) * allStripsNoVca.length, 1);
      ctx.fillRect(0, 3 * this.hh - 1, (c + 1) * allStripsNoVca.length, 1);
      ctx.fillRect(0, 4 * this.hh - 1, (c + 1) * allStripsNoVca.length, 1)
    }
  }),
  METERS = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "METERS";
      this.w = 500;
      this.grh = this.h = 100;
      this.v = [];
      this.v2 = [];
      this.vfall = [];
      this.vg = [];
      this.vg2 = [];
      this.vgfall = [];
      this.comp = [];
      this.clip = [];
      this.clipReleasing = [];
      this.gate = [];
      this.timers = [];
      this.ptimers = [];
      this.peak = [];
      this.peakfall = [];
      this.ltt = 0;
      for (var c = allStripsNoVca, d = 0; d < c.length; d++) this.v.push(0), this.v2.push(0), this.vfall.push(0), this.vg.push(0), this.vg2.push(0), this.vgfall.push(0), this.peak.push(0), this.peakfall.push(0), this.comp.push(0), this.gate.push(!0), this.clip.push(!1), this.clipReleasing.push(!1), this.timers.push(null), c[d].stereo && (this.v.push(0), this.v2.push(0), this.vfall.push(0), this.vg.push(0), this.vg2.push(0), this.vgfall.push(0), this.peak.push(0), this.peakfall.push(0),
        this.comp.push(0), this.gate.push(!0), this.clip.push(!1), this.clipReleasing.push(!1), this.timers.push(null));
      regTick(this)
    },
    setValue: function(a, b, c, d, f, e, g) {
      var h = this;
      this.comp[d] = bound(b / COMP_SCALE, 0, 1);
      this.gate[d] = c;
      this.v2[d] = bound(a, 0, 4);
      1 <= a ? (this.clip[d] = !0, this.clipReleasing[d] = !1) : this.clip[d] && !this.clipReleasing[d] && (this.clipReleasing[d] = !0, clearTimeout(this.timers[d]), this.timers[d] = setTimeout(function() {
        h.clip[d] = !1
      }, CLIP_HOLD_TIME));
      this.v[d] < this.v2[d] ? this.v[d] = this.v2[d] : this.vfall[d] =
        GLOBAL_VU_FALL_SPEED;
      this.peak[d] <= this.v2[d] ? (this.peak[d] = this.v2[d], this.peakfall[d] = 0, clearTimeout(this.ptimers[d]), this.ptimers[d] = null) : null == this.ptimers[d] && (this.ptimers[d] = setTimeout(function() {
        h.peakfall[d] = GLOBAL_PEAK_FALL_SPEED;
        h.ptimers[d] = null
      }, PEAK_HOLD_TIME));
      if (isDefined(f) && d >= fxStrips[0].id && d < auxStrips[0].id) {
        var l = d - fxStrips[0].id + allStripsNoVca.length;
        this.comp[l] = bound(e / COMP_SCALE, 0, 1);
        this.gate[l] = g;
        this.v2[l] = bound(f, 0, 4);
        1 <= a ? (this.clip[l] = !0, this.clipReleasing[l] = !1) :
          this.clip[l] && !this.clipReleasing[l] && (this.clipReleasing[l] = !0, clearTimeout(this.timers[l]), this.timers[l] = setTimeout(function() {
            h.clip[l] = !1
          }, CLIP_HOLD_TIME));
        this.v[l] < this.v2[l] ? this.v[l] = this.v2[l] : this.vfall[l] = GLOBAL_VU_FALL_SPEED;
        this.peak[l] <= this.v2[l] ? (this.peak[l] = this.v2[l], this.peakfall[l] = 0, clearTimeout(this.ptimers[l]), this.ptimers[l] = null) : null == this.ptimers[l] && (this.ptimers[l] = setTimeout(function() {
          h.peakfall[l] = GLOBAL_PEAK_FALL_SPEED;
          h.ptimers[l] = null
        }, PEAK_HOLD_TIME))
      }
    },
    tick: function(a) {
      for (var b =
          0; b < this.v.length; b++) this.v[b] <= this.v2[b] ? this.v[b] = this.v2[b] : (this.v[b] -= this.vfall[b] * a, this.vfall[b] += .04 * GLOBAL_VU_FALL_SPEED * a, this.v[b] < this.v2[b] && (this.v[b] = this.v2[b])), this.peak[b] <= this.v2[b] ? this.peak[b] = this.v2[b] : 0 < this.peak[b] && 0 < this.peakfall[b] && (this.peak[b] -= this.peakfall[b] * a, this.peakfall[b] += GLOBAL_PEAK_FALL_ACC * a, this.peak[b] < this.v2[b] && (this.peak[b] = this.v2[b]));
      regTick(this);
      this.globalEnabled() && regUpdate(this)
    },
    onDown: function(a, b) {
      var c = a - this.globalX(),
        c = bound(c / (this.w /
          allStripsNoVca.length | 0) | 0, 0, allStripsNoVca.length - 1);
      setSelected(c);
      null != inView && (mixerWidget.showAll(), slideOutWidget.clearGotoButtons());
      setMode(E_MODE.MIX);
      bottomWidget.gotoIDmid(c)
    },
    calcGeometry: function() {
      this.grd = ctx.createLinearGradient(0, this.h - (this.w / allStripsNoVca.length - 1 | 0) - 100, 0, 0);
      this.grd.addColorStop(0, "#0C630A");
      this.grd.addColorStop(.7, "#BDBC0A");
      this.grd.addColorStop(1, "#d0130A");
      this.grd2 = ctx.createLinearGradient(0, this.h - 100, 0, this.h);
      this.grd2.addColorStop(0, "#711");
      this.grd2.addColorStop(1,
        "#e11");
      this.grd3 = ctx.createLinearGradient(0, 0, 0, this.h);
      this.grd3.addColorStop(0, "rgba(255,255,255,0.0)");
      this.grd3.addColorStop(1, "rgba(255,255,255,1)");
      this.clipColor = "#d22222"
    },
    paint: function() {
      var a = this.w,
        b = this.h,
        c = a / allStripsNoVca.length - 1 | 0;
      ctx.fillStyle = color.eqBg;
      ctx.fillRect(0, 0, a, b);
      ctx.strokeStyle = "rgba(0,0,0,0.1)";
      ctx.lineWidth = 1;
      a = b - c - this.grh;
      ctx.strokeStyle = "rgba(0,0,0,0.9)";
      ctx.lineWidth = 2;
      for (var d = 0; d < allStripsNoVca.length; d++) {
        var f = (c + 1) * d,
          e = hideHPAUX && (d == auxStrips[curSetup.aux -
            2].id || d == auxStrips[curSetup.aux - 1].id);
        ctx.globalAlpha = d % 2 ? .11 : .09;
        e && (ctx.globalAlpha = .05);
        ctx.fillStyle = allStripsNoVca[d].color;
        ctx.fillRect(f, 0, c, b);
        ctx.globalAlpha = 1;
        if (allStripsNoVca[d].stereo) {
          .001 < this.peak[d] && (ctx.fillStyle = this.grd, ctx.fillRect(f, b - this.grh - c - bound(this.peak[d] * a | 0, 1, a) | 0, c / 2, 1));
          if (.001 < this.v[d]) {
            ctx.fillStyle = this.clip[d] ? this.clipColor : this.grd;
            var g = bound(this.v[d], 0, 1),
              h = b - this.grh - c,
              g = -(g * a) | 0;
            ctx.fillRect(f, h, c / 2, g);
            ctx.fillStyle = "rgba(255,255,255,0.07)";
            ctx.fillRect(f,
              h, 1, g);
            ctx.fillStyle = "rgba(0,0,0,0.07)";
            ctx.fillRect(f + c / 2, h, -1, g)
          }
          this.clip[d] && (ctx.fillStyle = "#a11", ctx.fillRect(f, 0, c / 2, 4), ctx.fillStyle = "#f11", ctx.fillRect(f + 1, 1, c / 2 - 2, 2));
          .001 < this.comp[d] && (ctx.fillStyle = this.grd2, h = this.h - this.grh, g = this.comp[d] * (this.grh - 1) | 0, ctx.fillRect(f, h, c / 2, g), ctx.fillStyle = "rgba(255,255,255,0.04)", ctx.fillRect(f, h, 1, g), ctx.fillStyle = "rgba(0,0,0,0.08)", ctx.fillRect(f + c / 2, h, -1, g));
          this.gate[d] || (ctx.fillStyle = "#b11", e && (ctx.fillStyle = color.tvGray), ctx.fillRect(f, this.h -
            this.grh - c, c / 2, c), h = 2, ctx.beginPath(), ctx.moveTo(f + h - 1, this.h - this.grh - c / 2 | 0), ctx.lineTo(f + c / 2 - h, this.h - this.grh - c / 2 | 0), ctx.stroke());
          var l = d - fxStrips[0].id + allStripsNoVca.length;
          .001 < this.peak[l] && (ctx.fillStyle = this.grd, ctx.fillRect(f + c / 2, b - this.grh - c - bound(this.peak[l] * a | 0, 1, a) | 0, c / 2, 1));
          .001 < this.v[l] && (ctx.fillStyle = this.clip[l] ? this.clipColor : this.grd, g = bound(this.v[l], 0, 1), h = b - this.grh - c, g = -(g * a) | 0, ctx.fillRect(f + c / 2, h, c / 2, g), ctx.fillStyle = "rgba(255,255,255,0.07)", ctx.fillRect(f + c / 2, h, 1, g),
            ctx.fillStyle = "rgba(0,0,0,0.07)", ctx.fillRect(f + c - 1, h, -1, g));
          this.clip[l] && (ctx.fillStyle = "#a11", ctx.fillRect(f + c / 2, 0, c / 2, 4), ctx.fillStyle = "#f11", ctx.fillRect(f + c / 2 + 1, 1, c / 2 - 3, 2));
          .001 < this.comp[l] && (ctx.fillStyle = this.grd2, h = this.h - this.grh, g = this.comp[l] * (this.grh - 1) | 0, ctx.fillRect(f + c / 2, h, c / 2, g), ctx.fillStyle = "rgba(255,255,255,0.04)", ctx.fillRect(f + c / 2, h, 1, g), ctx.fillStyle = "rgba(0,0,0,0.08)", ctx.fillRect(f + c - 1, h, -1, g));
          this.gate[l] || (ctx.fillStyle = "#b11", e && (ctx.fillStyle = color.tvGray), ctx.fillRect(f +
            c / 2, this.h - this.grh - c, c / 2, c), h = 2, ctx.beginPath(), ctx.moveTo(f + c / 2 + h - 1, this.h - this.grh - c / 2 | 0), ctx.lineTo(f + c - h, this.h - this.grh - c / 2 | 0), ctx.stroke())
        } else .001 < this.peak[d] && (ctx.fillStyle = this.grd, e && (ctx.fillStyle = color.tvGray), ctx.fillRect(f, b - this.grh - c - bound(this.peak[d] * a | 0, 1, a) | 0, c, 1)), .001 < this.v[d] && (ctx.fillStyle = this.clip[d] ? this.clipColor : this.grd, e && (ctx.fillStyle = color.tvGray), g = bound(this.v[d], 0, 1), h = b - this.grh - c, g = -(g * a) | 0, ctx.fillRect(f, h, c, g), ctx.fillStyle = "rgba(255,255,255,0.08)", ctx.fillRect(f,
            h, 1, g), ctx.fillStyle = "rgba(0,0,0,0.08)", ctx.fillRect(f + c - 1, h, -1, g)), this.clip[d] && (ctx.fillStyle = "#a11", e && (ctx.fillStyle = color.tvGray), ctx.fillRect(f, 0, c, 4), ctx.fillStyle = "#f11", e && (ctx.fillStyle = color.tvGray), ctx.fillRect(f + 1, 1, c - 3, 2)), .001 < this.comp[d] && (ctx.fillStyle = this.grd2, e && (ctx.fillStyle = color.tvGray), h = this.h - this.grh, g = this.comp[d] * (this.grh - 1) | 0, ctx.fillRect(f, h, c, g), ctx.fillStyle = "rgba(255,255,255,0.04)", ctx.fillRect(f, h, 1, g), ctx.fillStyle = "rgba(0,0,0,0.08)", ctx.fillRect(f + c, h, -1, g)),
          this.gate[d] || (ctx.fillStyle = "#b11", e && (ctx.fillStyle = color.tvGray), ctx.fillRect(f, this.h - this.grh - c, c, c), h = 2, ctx.beginPath(), ctx.moveTo(f + h - 1, this.h - this.grh - c / 2 | 0), ctx.lineTo(f + c - h, this.h - this.grh - c / 2 | 0), ctx.stroke());
        ctx.fillStyle = "#111";
        ctx.fillRect(f + c - 1, 0, 1, b)
      }
      ctx.fillRect(0, this.h - this.grh - c, (c + 1) * allStripsNoVca.length, 1);
      ctx.fillRect(0, this.h - this.grh, (c + 1) * allStripsNoVca.length, 1);
      ctx.globalAlpha = 1
    }
  }),
  SButton = Class.create(Button, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "SButton";
      this.w = 90;
      this.h = 30;
      this.text = "TEXT";
      this.color = color.white;
      this.longClickMark = !1;
      this.font = "12pt open_sans_condensedbold";
      this.textColor = color.tabText;
      this.borderColor = color.tabStroke;
      this.grd = null;
      this.mline = !1;
      this.mdy = 18;
      this.bgColor = color.eqBg
    },
    calcGeometry: function() {
      this.grd = ctx.createLinearGradient(0, 0, 0, this.h);
      this.grd.addColorStop(0, "rgba(255,255,255,0)");
      this.grd.addColorStop(.5, "rgba(255,255,255,0.1)");
      this.grd.addColorStop(1, "rgba(255,255,255,0)")
    },
    paint: function() {
      this.getState();
      ctx.fillStyle =
        this.bgColor;
      ctx.fillRect(0, 0, this.w, this.h);
      if (this.pressed) ctx.globalAlpha = .5, ctx.fillStyle = this.color, ctx.fillRect(0, 0, this.w, this.h), ctx.globalAlpha = 1, ctx.font = this.font, ctx.fillStyle = color.tabTextSel, ctx.textAlign = "center", ctx.textBaseline = "middle", ctx.setShadow(color.shadow, 3, 1, 1), a = this.h / 2, this.mline && (a -= this.mdy * (this.text.split("<br>").length - 1) / 2), drawText(this.text, this.w / 2 | 0, a | 0, {
        max: this.w - 2,
        dy: this.mdy
      }), ctx.setShadow(null), ctx.lineWidth = 1, ctx.strokeStyle = this.color;
      else {
        ctx.fillStyle =
          "rgba(255,255,255,0.1)";
        ctx.fillRect(1, this.h, this.w - 2, -10);
        ctx.font = this.font;
        ctx.fillStyle = this.textColor;
        ctx.textAlign = "center";
        ctx.textBaseline = "middle";
        ctx.setShadow(color.black, 3, 2, 2);
        var a = this.h / 2;
        this.mline && (a -= this.mdy * (this.text.split("<br>").length - 1) / 2);
        drawText(this.text, this.w / 2 | 0, a | 0, {
          max: this.w - 2,
          dy: this.mdy
        });
        ctx.setShadow(null);
        ctx.lineWidth = 1;
        ctx.strokeStyle = this.borderColor
      }
      ctx.strokeRect(.5, .5, this.w - 1, this.h - 1);
      this.longClickMark && (ctx.strokeStyle = "rgba(255,255,255,0.25)",
        ctx.beginPath(), ctx.moveTo(this.w - 9, 2), ctx.lineTo(this.w - 3, 9), ctx.moveTo(this.w - 12, 2), ctx.lineTo(this.w - 3, 12), ctx.stroke())
    }
  }),
  SCheckBox = Class.create(CheckBox, {
    initialize: function($super, b) {
      $super(b);
      this.name = "SCheckBox";
      this.w = 70;
      this.h = 30;
      this.textColor = color.tabText;
      this.textColor2 = color.tabTextSel;
      this.color = color.white;
      this.text = "TEXT";
      this.font = font.tabText;
      this.longClickMark = !1;
      this.grd = null;
      this.mline = !1;
      this.mdy = 20;
      this.bgColor = color.eqBg
    },
    calcGeometry: function() {
      this.grd = ctx.createLinearGradient(0,
        0, 0, this.h);
      this.grd.addColorStop(0, "rgba(255,255,255,0)");
      this.grd.addColorStop(.5, "rgba(255,255,255,0.1)");
      this.grd.addColorStop(1, "rgba(255,255,255,0)")
    },
    paint: function() {
      null != this.key && (this.state = this.getVal());
      this.getState();
      this.disabled && (ctx.globalAlpha = .3);
      ctx.fillStyle = this.bgColor;
      ctx.fillRect(0, 0, this.w, this.h);
      switch (this.state) {
        case 0:
        case !1:
          ctx.fillStyle = "rgba(255,255,255,0.1)";
          ctx.fillRect(1, this.h, this.w - 2, -10);
          ctx.lineWidth = 1;
          ctx.strokeStyle = color.tabStroke;
          ctx.strokeRect(.5,
            .5, this.w - 1, this.h - 1);
          ctx.font = this.font;
          ctx.fillStyle = this.textColor;
          var a = this.h / 2;
          ctx.drawText(this.text, this.w / 2 | 0, a | 0, {
            max: this.w - 2,
            shadow: ["#000", 0, 1, 1],
            align: "center",
            valign: "middle",
            dy: this.mdy
          }, "<br>");
          ctx.shadowColor = "transparent";
          break;
        case 1:
        case !0:
          ctx.globalAlpha = this.disabled ? .15 : .5;
          ctx.fillStyle = this.color;
          ctx.fillRect(0, 0, this.w, this.h);
          ctx.globalAlpha = this.disabled ? .3 : 1;
          ctx.lineWidth = 1;
          ctx.strokeStyle = this.color;
          ctx.strokeRect(.5, .5, this.w - 1, this.h - 1);
          ctx.font = this.font;
          ctx.fillStyle =
            this.textColor2;
          a = this.h / 2;
          ctx.drawText(this.text, this.w / 2 | 0, a | 0, {
            max: this.w - 2,
            shadow: ["#000", 0, 1, 1],
            align: "center",
            valign: "middle",
            dy: this.mdy
          }, "<br>");
          ctx.shadowColor = "transparent";
          break;
        default:
          ctx.fillStyle = "#0ff", ctx.fillRect(0, 0, this.w, this.h)
      }
      this.longClickMark && (ctx.strokeStyle = "rgba(255,255,255,0.2)", ctx.lineWidth = 1, ctx.beginPath(), ctx.moveTo(this.w - 11, 2), ctx.lineTo(this.w - 2, 11), ctx.moveTo(this.w - 8, 2), ctx.lineTo(this.w - 2, 8), ctx.stroke());
      this.disabled && (ctx.globalAlpha = 1)
    }
  }),
  PONG = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "SETTINGS";
      this.y = measures.topWidgetHeight;
      this.needMoveEvt = this.needClip = !0;
      this.pw = 10;
      this.ph = .15;
      this.by = this.bx = this.p2 = this.p1 = .5;
      this.ba = this.bsy = this.bsx = 0;
      this.br = 7;
      this.s2 = this.s1 = 0;
      this.started = this.play = !1;
      this.speed = .01;
      this.yourTime = this.timeStart = 0;
      this.newRecord = !1;
      this.zza = this.zzz = this.ltt = 0
    },
    onShow: function() {
      this.play = !0
    },
    onHide: function() {
      this.play = !1
    },
    onDown: function(a, b, c) {
      this.started || this.randomBallStart();
      this.onMove(a,
        b, c)
    },
    onMove: function(a, b, c) {
      this.globalX();
      a = b - this.globalY();
      this.p2 = this.p1 = a = bound(a / this.h, 0, 1)
    },
    ballStop: function() {
      this.by = this.bx = .5;
      this.bsy = this.bsx = 0;
      this.started = !1
    },
    randomBallStart: function() {
      this.by = this.bx = .5;
      this.speed = .01;
      this.timeStart = Date.now();
      this.ph = .15;
      this.bsx = .5 > Math.random() ? -this.speed : this.speed;
      this.bsy = (2 * Math.random() - 1) * this.speed;
      this.started = !0;
      this.newRecord = !1
    },
    gameEnd: function() {
      this.play = !1;
      var a = Date.now() - this.timeStart;
      this.yourTime = a = precision(a / 1E3, 3);
      var b =
        getValue("var.pongtime") || 0;
      a > b && (setValue("var.pongtime", a), this.newRecord = !0)
    },
    tick: function(a) {
      this.bx += this.bsx * a;
      this.by += this.bsy * a;
      this.bx = bound(this.bx, -1, this.w + 1);
      this.by = bound(this.by, -1, this.h + 1);
      this.speed += 1E-4 * a;
      this.ph -= 1E-5;
      0 > this.bx && (this.by <= this.ph + this.p1 * (1 - this.ph) && this.by >= this.p1 * (1 - this.ph) ? 0 > this.bsx && (this.bsx *= -1, this.bsy = .01 * (2 * Math.random() - 1)) : (this.s2++, this.ballStop(), this.gameEnd()));
      1 < this.bx && (this.by <= this.ph + this.p2 * (1 - this.ph) && this.by >= this.p2 * (1 - this.ph) ?
        0 < this.bsx && (this.bsx *= -1, this.bsy = .01 * (2 * Math.random() - 1)) : (this.s1++, this.ballStop(), this.gameEnd()));
      if (0 > this.by && 0 > this.bsy || 1 < this.by && 0 < this.bsy) this.bsy *= -1;
      regUpdate(this)
    },
    calcGeometry: function() {
      this.w = screenWidth - measures.mixerRightMargin;
      this.h = screenHeight - this.y
    },
    paint: function() {
      var a = this.w,
        b = this.h,
        c = b * this.ph;
      this.play ? (ctx.fillStyle = "hsl(" + this.zzz % 360 + "," + this.zza + "%," + this.zza + "%)", this.zza += .02) : ctx.fillStyle = "#000";
      ctx.fillRect(0, 0, a, b);
      var d = b - c,
        f = a - 2 * this.pw - 2 * this.br;
      ctx.fillStyle =
        "#fff";
      ctx.fillRect(0, this.p1 * d, this.pw, c, 10);
      ctx.fillRect(a - this.pw, this.p2 * d, this.pw, c, 10);
      a = this.pw + this.br + this.bx * f;
      b = this.br + this.by * (b - this.br);
      ctx.fillStyle = "hsl(" + (this.zzz + 100) + ",60%,60%)";
      ctx.fillCircle(a, b, this.br);
      ctx.font = "26pt open_sans_condensedbold";
      ctx.textAlign = "center";
      ctx.fillStyle = "rgba(255,255,255,0.7)";
      this.started ? (b = Date.now() - this.timeStart, b = precision(b / 1E3, 1), ctx.fillStyle = "rgba(255,255,255,1)", ctx.textAlign = "left", drawText(b + "s", this.w - 100, this.h - 20)) : (drawText("TOUCH TO START THE CHALLENGE",
        this.w / 2, 50), ctx.fillStyle = "rgba(255,255,255,1)", 0 < this.yourTime && drawText("YOUR TIME: " + this.yourTime + "s", this.w / 2, 92), b = getValue("var.pongtime") || 0, drawText("BEST TIME: " + b + "s", this.w / 2, this.h - 90), ctx.fillStyle = "rgba(255,0,0,0.6)", this.newRecord && drawText("NEW RECORD!", this.w / 2, 134));
      this.zzz++;
      regTick(this)
    }
  }),
  SUBPAGE = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "SETTINGS";
      this.x = 0;
      this.y = measures.topWidgetHeight;
      this.bgColor = color.eqBg;
      this.initWidgets()
    },
    initWidgets: function() {},
    calcGeometry: function() {
      this.y = topWidget.enabled ? topWidget.h : 0;
      this.w = screenWidth - this.x;
      masterWidget.enabled && (this.w -= masterWidget.w);
      auxoutWidget.enabled && (this.w -= auxoutWidget.w);
      fxoutWidget.enabled && (this.w -= fxoutWidget.w);
      slideOutWidget.enabled && (this.w -= slideOutWidget.w);
      this.h = screenHeight - this.y;
      bottomWidget.enabled && (this.h -= bottomWidget.h)
    },
    paint: function() {
      ctx.fillStyle = this.bgColor;
      ctx.fillRect(0, 0, this.w, this.h)
    }
  });
MOREME_CUTOFF = -120;
var MOREME = Class.create(SUBPAGE, {
    onShow: function() {
      checkMoreMe(); - 1 != settings.meout && auxoutWidget.setAux(settings.meout);
      auxoutWidget.MIXTOAUX.hide()
    },
    onHide: function() {
      auxoutWidget.MIXTOAUX.show()
    },
    initWidgets: function() {
      this.widgetName = "MOREME";
      var a = this;
      this.ME_VU = new MM_SLIDER(this);
      this.ME_VU.setAnchors(10, 10, null, 43);
      this.ME_VU.text = lang.ME;
      this.ME_VU.color = color.me;
      this.ME_VU.ondown = function() {
        var a = settings.meout,
          c = settings.me;
        if (0 > a || a > curSetup.aux) this.value = 0;
        else if (0 == c.length) this.value =
          0;
        else {
          a = "aux." + a + ".value";
          this.pressMix_dB = [];
          for (var d = 0; d < c.length; d++) {
            var f = c[d];
            if (!(f >= allStrips.length)) {
              switch (allStrips[f].type) {
                case E_STRIP_TYPE.AUX:
                case E_STRIP_TYPE.FX:
                case E_STRIP_TYPE.SUB:
                  continue
              }
              this.pressMix_dB[d] = VtoDBf(allStrips[f].getNameValue(a))
            }
          }
        }
      };
      this.ME_VU.getState = function() {
        var a = settings.meout,
          c = settings.me,
          d = "aux." + a + ".value";
        if (0 > a || a > curSetup.aux) this.value = 0;
        else if (0 == c.length) this.value = 0;
        else {
          for (var a = [], f = 0; f < c.length; f++) {
            var e = c[f];
            if (!(e >= allStrips.length)) {
              switch (allStrips[e].type) {
                case E_STRIP_TYPE.AUX:
                case E_STRIP_TYPE.FX:
                case E_STRIP_TYPE.SUB:
                  continue
              }
              a.push(allStrips[e].getNameValue(d))
            }
          }
          this.value =
            a.max()
        }
      };
      this.ME_VU.onValue = function(a) {
        if (!(.003787517547607422 > a)) {
          var b = settings.meout,
            d = settings.me;
          if (0 > b || b > curSetup.aux) this.value = 0;
          else if (0 == d.length) this.value = 0;
          else {
            a = VtoDBf(a);
            var f = VtoDBf(this.start);
            a -= f;
            b = "aux." + b + ".value";
            for (f = 0; f < d.length; f++) {
              var e = d[f];
              if (!(e >= allStrips.length)) {
                e = allStrips[e];
                switch (e.type) {
                  case E_STRIP_TYPE.AUX:
                  case E_STRIP_TYPE.FX:
                  case E_STRIP_TYPE.SUB:
                    continue
                }
                var g = this.pressMix_dB[f];
                g < MOREME_CUTOFF || (g = DBtoVf(g + a), e.setNameValue(b, bound(g, 0, 1)))
              }
            }
          }
        }
      };
      this.BAND_VU = new MM_SLIDER(this);
      this.BAND_VU.color = color.blue;
      this.BAND_VU.text = lang.BAND;
      this.BAND_VU.setAnchors(null, 10, 10, 43);
      this.BAND_VU.ondown = function() {
        var a = settings.meout,
          c = settings.me;
        if (0 > a || a > curSetup.aux) this.value = 0;
        else if (0 == c.length) this.value = 0;
        else {
          a = "aux." + a + ".value";
          this.pressMix_dB = [];
          for (var d = 0; d < allStrips.length; d++)
            if (!c.contains(d)) {
              switch (allStrips[d].type) {
                case E_STRIP_TYPE.AUX:
                case E_STRIP_TYPE.FX:
                case E_STRIP_TYPE.SUB:
                  continue
              }
              this.pressMix_dB[d] = VtoDBf(allStrips[d].getNameValue(a))
            }
        }
      };
      this.BAND_VU.getState = function() {
        var a = settings.meout,
          c = settings.me;
        if (-1 == a) this.value = 0;
        else if (0 == c.length) this.value = 0;
        else {
          for (var a = "aux." + a + ".value", d = [], f = 0; f < allStrips.length; f++)
            if (!c.contains(f)) {
              switch (allStrips[f].type) {
                case E_STRIP_TYPE.AUX:
                case E_STRIP_TYPE.FX:
                case E_STRIP_TYPE.SUB:
                  continue
              }
              d.push(allStrips[f].getNameValue(a))
            }
          this.value = d.max()
        }
      };
      this.BAND_VU.onValue = function(a) {
        if (!(.003787517547607422 > a)) {
          var b = settings.meout,
            d = settings.me;
          if (0 > b || b > curSetup.aux) this.value = 0;
          else if (0 ==
            d.length) this.value = 0;
          else {
            a = VtoDBf(a);
            var f = VtoDBf(this.start);
            a -= f;
            b = "aux." + b + ".value";
            for (f = 0; f < allStrips.length; f++)
              if (!d.contains(f)) {
                switch (allStrips[f].type) {
                  case E_STRIP_TYPE.AUX:
                  case E_STRIP_TYPE.FX:
                  case E_STRIP_TYPE.SUB:
                    continue
                }
                var e = allStrips[f],
                  g = this.pressMix_dB[f];
                g < MOREME_CUTOFF || (g = DBtoVf(g + a), e.setNameValue(b, bound(g, 0, 1)))
              }
          }
        }
      };
      this.WHEEL = new MM_WHEEL(this);
      this.WHEEL.setAnchors(null, 10, null, 43);
      this.WHEEL.ondown = function() {
        var a = settings.meout,
          c = settings.me;
        if (0 > a || a > curSetup.aux) this.value =
          0;
        else if (0 == c.length) this.value = 0;
        else {
          a = "aux." + a + ".value";
          this.db_me = [];
          this.db_band = [];
          for (var d = 0; d < allStrips.length; d++) {
            switch (allStrips[d].type) {
              case E_STRIP_TYPE.AUX:
              case E_STRIP_TYPE.FX:
              case E_STRIP_TYPE.SUB:
                continue
            }
            c.contains(d) ? this.db_me[c.indexOf(d)] = VtoDBf(allStrips[d].getNameValue(a)) : this.db_band[d] = VtoDBf(allStrips[d].getNameValue(a))
          }
          this.max1 = 10 - this.db_me.max();
          this.max2 = 10 - this.db_band.max()
        }
      };
      this.WHEEL.onValue = function(b) {
        b = -20 * (b - .5);
        b > this.max1 || -b > this.max2 || (applyMEdelta(this.db_me,
          b), applyBANDdelta(this.db_band, -b), regUpdate(a))
      }
    },
    calcGeometry: function($super) {
      $super();
      var b = this.w - 40;
      this.ME_VU.w = .35 * b | 0;
      this.BAND_VU.w = .35 * b | 0;
      this.WHEEL.x = 10 + this.ME_VU.w + 10;
      this.WHEEL.w = .3 * b | 0
    },
    paint: function() {
      ctx.fillStyle = color.eqBg;
      ctx.fillRect(0, 0, this.w, this.h);
      ctx.fillStyle = "rgba(255,255,255,0.1)";
      ctx.fillRect(0, this.h, this.w, -measures.bottomWidgetHeight);
      ctx.fillStyle = color.me;
      ctx.fillRect(0, this.h - measures.bottomWidgetHeight, this.w, -3);
      var a = -1 == settings.meout,
        b = "";
      0 == settings.me.length &&
        (b += "(" + lang.NO_ME_CHANNELS + ") ");
      a && (b += "(" + lang.NO_AUX_OUT + ")");
      drawText(b, this.w / 2, this.h - 18, {
        color: color.white,
        font: "15pt open_sans_condensedbold",
        align: "center",
        baseLine: "middle",
        sColor: "#000",
        sBlur: 4,
        sX: 2,
        sY: 2
      })
    }
  }),
  MM_SLIDER = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "MM_SLIDER";
      this.color = color.green;
      this.needMoveEvt = !0;
      this.value = .5;
      this.w = 40;
      this.h = 100;
      this.d = 0;
      this.text = "";
      this.grd = null
    },
    ondown: function() {},
    onDown: function(a, b) {
      this.start = this.value;
      0 ==
        this.start ? showPopupMsg(lang.NO_SEND_LEVELS) : (this.sy = b - this.globalY(), this.ondown(), this.onMove(a, b))
    },
    onMove: function(a, b) {
      if (0 != this.start) {
        var c = (b - this.globalY() - this.sy) / this.h,
          c = bound(this.start - c, 0, 1);
        this.onValue(c);
        regUpdate(this)
      }
    },
    onValue: function(a) {},
    onwheel: function(a) {
      this.start = this.value;
      this.onDown();
      var b = this.value,
        b = bound(b + a / 120 / 30, 0, 1);
      this.onValue(b);
      regUpdate(this)
    },
    calcGeometry: function() {
      this.grd = ctx.createLinearGradient(0, 0, 0, this.h);
      this.grd.addColorStop(0, "rgba(255,255,255,0.1)");
      this.grd.addColorStop(1, "rgba(0,0,0,0.4)")
    },
    getState: function() {},
    paint: function() {
      this.getState();
      ctx.fillStyle = color.black;
      ctx.fillRoundRect(0, 0, this.w, this.h, 6);
      var a = (1 - zeroDbPos) * this.h | 0;
      ctx.strokeStyle = "rgba(255,255,255,0.1)";
      ctx.lineWidth = 2;
      ctx.beginPath();
      ctx.dashedLine(1, a + 1, this.w - 1, a + 1, 10);
      ctx.stroke();
      var a = this.value,
        b = this.h - 2;
      ctx.fillStyle = this.color;
      ctx.fillRoundRect(1, this.h - 1, this.w - 2, -b * a, 6);
      ctx.fillStyle = this.grd;
      ctx.fillRoundRect(1, 1, this.w - 2, this.h - 2, 6);
      ctx.drawText(this.text,
        this.w / 2 | 0, 22, {
          maxW: this.w - 2,
          color: 1.3E-4 > a ? "#555" : "#eee",
          font: "13pt open_sans_condensedbold",
          align: "center",
          shadow: Shadow.main
        });
      ctx.drawText(VtoDB(a).replace("@", "∞"), this.w / 2 | 0, 41, {
        color: 1.3E-4 > a ? "#f11" : "#ddd",
        maxW: this.w - 2,
        shadow: Shadow.main
      });
      ctx.lineWidth = 1;
      ctx.strokeStyle = "#46474A";
      ctx.roundRect(.5, .5, this.w - 1, this.h - 1, 6);
      ctx.stroke()
    }
  }),
  MM_WHEEL = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "MM_WHEEL";
      this.needClip = this.needMoveEvt = !0;
      this.w = 50;
      this.h = 200;
      this.v =
        .5
    },
    onDown: function(a, b) {
      var c = a - this.globalX(),
        d = b - this.globalY();
      this.pressPoint = [c, d];
      this.ondown()
    },
    onMove: function(a, b) {
      this.globalX();
      var c = b - this.globalY();
      this.v = c = bound(.5 - (this.pressPoint[1] - c) / this.h, 0, 1);
      this.onValue(c);
      regUpdate(this)
    },
    onUp: function() {
      this.v = .5;
      regUpdate(this)
    },
    ondown: function() {},
    calcGeometry: function() {
      this.grd = ctx.createLinearGradient(0, 0, 0, this.h);
      this.grd.addColorStop(0, "rgba(255,255,255,0.1)");
      this.grd.addColorStop(.5, "rgba(255,255,255,0.2)");
      this.grd.addColorStop(1,
        "rgba(255,255,255,0.1)")
    },
    paint: function() {
      ctx.fillStyle = "#000";
      ctx.fillRoundRect(0, 0, this.w, this.h, 6);
      ctx.fillStyle = this.grd;
      ctx.fillRoundRect(0, 0, this.w, this.h, 6);
      ctx.fillStyle = "#444";
      ctx.fillRect(1, this.h / 2 - 1 | 0, this.w - 2, 2);
      var a = this.h - 12,
        b = 6 + (this.v * a | 0);
      ctx.fillStyle = "rgba(200,136,40,0.06)";
      ctx.fillRect(8, this.h / 2 | 0, this.w - 16, (this.v - .5) * a | 0);
      ctx.fillStyle = "#CB8F4F";
      ctx.fillRoundRect(8, b - 5, this.w - 16, 10, 4);
      ctx.fillStyle = "#CB8F4F";
      ctx.fillCircle(this.w / 2, b, 26);
      ctx.fillStyle = "rgba(0,0,0,0.15)";
      ctx.fillTriangle(this.w / 2 - 14, b + 12, 14, 8);
      ctx.fillTriangle(this.w / 2 - 14, b - 12, 14, -8);
      .5 != this.v && (a = formatValue(20 * this.v - 10, 2, lang.DB, !0), ctx.drawText(a, this.w / 2, b, {
        font: "14px open_sans_condensedbold",
        align: "center",
        valign: "middle",
        color: "rgba(0,0,0,0.5)"
      }));
      ctx.lineWidth = 1;
      ctx.strokeStyle = "#46474A";
      ctx.roundRect(.5, .5, this.w - 1, this.h - 1, 6);
      ctx.stroke()
    }
  });

function checkMoreMe() {
  var a = settings.me.clone();
  log(JSON.stringify(a));
  for (var a = a.uniq(), b = [], c = 0; c < a.length; c++) {
    var d = a[c];
    if (!(0 > d || d >= fxStrips[0].id)) switch (b.push(d), allStrips[d].getNameValue("stereoIndex")) {
      case 0:
        a.contains(d + 1) || b.push(d + 1);
        break;
      case 1:
        a.contains(d - 1) || b.push(d - 1)
    }
  }
  b.sort(function(a, b) {
    return a - b
  });
  log(JSON.stringify(b));
  settingsStorage.set("me", b);
  a = settings.meout;
  isDefined(a) && null != a || (a = -1);
  settingsStorage.set("meout", bound(a, -1, curSetup.aux - 1))
}

function applyMEdelta(a, b) {
  var c = settings.meout,
    d = settings.me;
  if (0 > c || c > curSetup.aux) this.value = 0;
  else if (0 == d.length) this.value = 0;
  else
    for (var c = "aux." + c + ".value", f = 0; f < d.length; f++) {
      var e = d[f];
      if (!(e >= allStrips.length)) {
        switch (allStrips[e].type) {
          case E_STRIP_TYPE.AUX:
          case E_STRIP_TYPE.FX:
          case E_STRIP_TYPE.SUB:
            continue
        }
        var e = allStrips[e],
          g = a[f];
        g < MOREME_CUTOFF || (g = DBtoVf(g + b), e.setNameValue(c, bound(g, 0, 1)))
      }
    }
}

function applyBANDdelta(a, b) {
  var c = settings.meout,
    d = settings.me;
  if (0 > c || c > curSetup.aux) this.value = 0;
  else if (0 == d.length) this.value = 0;
  else
    for (var c = "aux." + c + ".value", f = 0; f < allStrips.length; f++)
      if (!d.contains(f)) {
        var e = allStrips[f];
        switch (e.type) {
          case E_STRIP_TYPE.AUX:
          case E_STRIP_TYPE.FX:
          case E_STRIP_TYPE.SUB:
            continue
        }
        var g = a[f];
        g < MOREME_CUTOFF || (g = DBtoVf(g + b), e.setNameValue(c, bound(g, 0, 1)))
      }
}

function secToTime(a) {
  var b = parseInt(a / 3600) % 24,
    c = parseInt(a / 60) % 60;
  a %= 60;
  return (0 < b ? b + ":" : "") + (10 > c ? "0" + c : c) + ":" + (10 > a ? "0" + a : a)
}
mtkPlay = mtkRec = player2track = null;
var EMPTY_SUBPAGE = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "EMPTY";
      this.y = 40;
      this.setAnchors(0, 40, 0, 0);
      this.enabled = !1
    },
    initWidgets: function() {},
    paint: function() {
      ctx.fillStyle = color.eqBg;
      ctx.fillRect(0, 0, this.w, this.h);
      ctx.font = font.editbox;
      ctx.textAlign = "right";
      ctx.fillStyle = color.tabText;
      ctx.fillText(lang.EMPTY, 214, 50)
    }
  }),
  PLAYER_PAGE = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "PLAYER_PAGE";
      this.buttons = [];
      this.pages = [];
      this.y =
        measures.topWidgetHeight;
      this.mode = 0;
      this.color = color.yellow;
      this.arr = [];
      this.initWidgets();
      this.setMode(0)
    },
    updateLists: function() {},
    setItems: function() {},
    nextMode: function() {
      for (var a = this.mode + 1; a < this.buttons.length; a++)
        if (this.buttons[a].enabled) {
          this.buttons[a].click();
          return
        }
      for (a = 0; a < this.mode; a++) this.buttons[a].enabled && this.buttons[a].click()
    },
    setMode: function(a) {
      this.mode = a;
      0 == a ? (playerStrips.show(), playerLabels.show()) : (playerStrips.hide(), playerLabels.hide());
      for (var b = 0; b < this.pages.length; b++) this.pages[b].hide();
      this.updateGeometry();
      this.pages[a].show();
      drawAll(this)
    },
    initWidgets: function() {
      if (IS_UI_24) {
        this.pages.push(new PLAYER(this));
        this.pages.push(new MTK_PLAY(this));
        this.pages.push(new MTK_REC(this));
        for (var a = [lang.TWO_TRACK_USB, lang.MULTITRACK, lang.MULTITRACK_CONFIG], b = [color.yellow, color.yellow, color.yellow], c = [color.yellow, color.yellow, color.yellow], d = 0; d < a.length; d++) {
          var f = new TabButton(this);
          f.color = b[d];
          f.textColor = c[d];
          f.mode = mode++;
          f.font = "13pt open_sans_condensedbold";
          f.text = a[d];
          f.setSize(150,
            30);
          f.setAnchors(null, 5, 1 + 151 * (a.length - d - 1), null);
          this.buttons.push(f)
        }
      } else this.page = new PLAYER
    },
    calcGeometry: function() {
      this.x = playerStrips.enabled ? 2 * measures.mixerStripWidth : 0;
      this.w = screenWidth - measures.mixerRightMargin - this.x;
      this.h = screenHeight - this.y
    },
    paint: function() {
      ctx.fillStyle = color.eqBg;
      ctx.fillRect(0, 0, this.w, this.h);
      ctx.fillStyle = this.color;
      ctx.fillRect(4, 35, this.w - 4, 4)
    }
  }),
  PLAYER = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.name = "PLAYER";
      this.y = measures.topWidgetHeight;
      this.color = color.media;
      this.mode = 0;
      this.initWidgets();
      player2track = this
    },
    setMode: function(a) {
      this.mode = a;
      regUpdate(this)
    },
    initWidgets: function() {
      this.regKey("settings.playMode");
      this.regKey("settings.cue");
      this.regKey("var.present");
      var a = this;
      this.SWITCH = new SWITCHBOX(this);
      this.SWITCH.setItems([lang.PLAYER, lang.PADS]);
      this.SWITCH.setItemWidth(70);
      this.SWITCH.color = color.media;
      this.SWITCH.hide();
      this.ORDER = new SWITCHBOX(this);
      this.ORDER.setAnchors(10, null, null, 5);
      this.ORDER.color = color.media;
      this.ORDER.setItems([lang.MANUAL,
        lang.AUTO
      ]);
      this.ORDER.setItemWidth(90);
      this.ORDER.getState = function() {
        switch (getValue("settings.playMode")) {
          case 0:
            this.state = 0;
            break;
          case 1:
            this.state = 0;
            break;
          case 2:
            this.state = 1;
            break;
          case 3:
            this.state = 1
        }
        this.text = this.state ? lang.AUTO : lang.MANUAL
      };
      this.ORDER.valueFunc = function() {
        isBlocked("player") ? showPopupMsg(lang.LOCKED, 800) : (setValue("settings.playMode", 0 == this.state ? 0 : 3), regUpdate(a))
      };
      this.TIME = new TIME_LABEL(this);
      this.TIME.regKey("var.currentTrackPos");
      this.SEEKBAR = new SEEKBAR(this);
      this.SEEKBAR.setPos(10,
        66);
      this.SEEKBAR.regKey("var.currentTrackPos");
      this.SEEKBAR.ondown = function() {
        a.TIME.setMode(1)
      };
      this.SEEKBAR.onup = function() {
        a.TIME.setMode(0)
      };
      this.SEEKBAR.onmove = function(b) {
        a.TIME.setValue2(b);
        regUpdate(a.TIME)
      };
      this.SEEKBAR.onChange = function(a) {
        isBlocked("player") ? showPopupMsg(lang.LOCKED, 800) : sendMessage(E_COMMANDS.MEDIA_JUMP_TO + "^" + a)
      };
      this.PREV = new Button(this);
      this.PREV.setImages(res.player_prev_off, res.player_prev_on);
      this.PREV.opaque = !1;
      this.PREV.disabledHide = !1;
      this.PREV.getState = function() {
        this.disabled =
          0 == getValue("var.present")
      };
      this.PREV.valueFunc = function() {
        EMULATE ? showPopupMsg(lang.DEMO_VERSION) : isBlocked("player") ? showPopupMsg(lang.LOCKED, 800) : sendMessage(E_COMMANDS.MEDIA_PREV)
      };
      this.PLAY = new CheckBox(this);
      this.PLAY.setImages(res.player_play, res.player_pause);
      this.PLAY.opaque = !1;
      this.PLAY.disabledHide = !1;
      this.PLAY.getState = function() {
        this.state = 2 == getValue("var.currentState") ? 1 : 0;
        this.disabled = 0 == getValue("var.present")
      };
      this.PLAY.onToggleUp = function() {
        if (EMULATE) showPopupMsg(lang.DEMO_VERSION);
        else if (isBlocked("player")) showPopupMsg(lang.LOCKED, 800);
        else {
          var b = a.FLIST.selItem(),
            d = a.PLISTS.selItem(),
            f = getValue("var.currentTrack"),
            e = getValue("var.currentPlaylist");
          if (null != b && b != f) {
            if (null == d || 0 == d.length) d = e;
            null != d && 0 != d.length && null != b && 0 != b.length && sendMessage(E_COMMANDS.MEDIA_SWITCH_TRACK + "^" + d + "^" + b)
          } else getValue("settings.cue") && sendMessage(E_COMMANDS.MEDIA_NEXT);
          sendMessage(E_COMMANDS.MEDIA_PLAY)
        }
      };
      this.PLAY.onToggleDown = function() {
        isBlocked("player") ? showPopupMsg(lang.LOCKED, 800) :
          sendMessage(E_COMMANDS.MEDIA_PAUSE)
      };
      this.NEXT = new Button(this);
      this.NEXT.setImages(res.player_next_off, res.player_next_on);
      this.NEXT.opaque = !1;
      this.NEXT.disabledHide = !1;
      this.NEXT.getState = function() {
        this.disabled = 0 == getValue("var.present")
      };
      this.NEXT.onPress = function() {
        EMULATE ? showPopupMsg(lang.DEMO_VERSION) : isBlocked("player") ? showPopupMsg(lang.LOCKED, 800) : sendMessage(E_COMMANDS.MEDIA_NEXT)
      };
      this.STOP = new Button(this);
      this.STOP.setImages(res.player_stop_off, res.player_stop_on);
      this.STOP.opaque = !1;
      this.STOP.disabledHide = !1;
      this.STOP.getState = function() {
        this.disabled = 0 == getValue("var.present")
      };
      this.STOP.onPress = function() {
        EMULATE ? showPopupMsg(lang.DEMO_VERSION) : isBlocked("player") ? showPopupMsg(lang.LOCKED, 800) : sendMessage(E_COMMANDS.MEDIA_STOP)
      };
      HAVE_REC && (this.REC = new CheckBox(this), this.REC.setImages(res.player_rec_off, res.player_rec_on), this.REC.opaque = !1, this.REC.disabledHide = !1, this.REC.getState = function() {
        this.state = getValue("var.isRecording");
        this.disabled = 0 == getValue("var.present") ||
          .5 < getValue("var.recBusy")
      }, this.REC.onToggle = function() {
        toggleRec()
      });
      this.PLISTS = new PLISTS(this);
      this.PLISTS.setPos(10, 100);
      this.PLISTS.setSize(200, 400);
      this.PLISTS.onSelect = function() {
        if (!EMULATE) {
          var b = this.selItem();
          sendMessage(E_COMMANDS.MEDIA_GET_PLIST_TRACKS + "^" + b);
          a.FLIST.clearSelection()
        }
      };
      this.PLISTS.onDClick = function() {
        if (isBlocked("player")) showPopupMsg(lang.LOCKED, 800);
        else {
          var a = this.selItem();
          null != a && 0 != a.length && sendMessage(E_COMMANDS.MEDIA_SWITCH_PLIST + "^" + a)
        }
      };
      this.PLISTS.getActiveItem =
        function() {
          var a = getValue("var.currentPlaylist"),
            a = this.items.indexOf(a);
          this.activeItemIdx = 0 <= a ? a : -1
        };
      this.FLIST = new PLISTS(this);
      this.FLIST.label = lang.FILES;
      this.FLIST.setPos(410, 100);
      this.FLIST.setSize(400, 400);
      this.FLIST.plistName = "";
      this.FLIST.onDClick = function() {
        if (isBlocked("player")) showPopupMsg(lang.LOCKED, 800);
        else {
          var b = this.selItem();
          if (null != b && 0 != b.length) {
            var d = a.PLISTS.selItem();
            if (null == d || 0 == d.length) d = getValue("var.currentPlaylist");
            null != d && 0 != d.length && sendMessage(E_COMMANDS.MEDIA_SWITCH_TRACK +
              "^" + d + "^" + b)
          }
        }
      };
      this.FLIST.getActiveItem = function() {
        var a = getValue("var.currentPlaylist");
        this.plistName != a ? this.activeItemIdx = -1 : (a = getValue("var.currentTrack"), this.activeItemIdx = this.items.indexOf(a))
      };
      if (EMULATE) {
        var b = $A($R("TRACK A", "TRACK Z"));
        this.PLISTS.setItems($A($R("PLIST A", "PLIST Z")));
        this.FLIST.setItems(b)
      }
      this.mutefx = new CHECKBUTTON(this);
      this.mutefx.text = lang.MUTE_FX;
      this.mutefx.color = this.mutefx.textColor = color.tvMuteFX;
      this.mutefx.w = 90;
      this.mutefx.setAnchors(null, null, 210, 5);
      this.mutefx.getState =
        function() {
          this.state = checkBit(getValue("mgmask"), MUTEFX_BIT_IDX) ? 1 : 0
        };
      this.mutefx.onToggleUp = function() {
        mixerWidget.muteFX()
      };
      this.mutefx.onToggleDown = function() {
        mixerWidget.unMuteFX()
      };
      this.muteall = new CHECKBUTTON(this);
      this.muteall.text = lang.MUTE_ALL;
      this.muteall.color = this.muteall.textColor = color.tvMuteALL;
      this.muteall.w = 90;
      this.muteall.setAnchors(null, null, 110, 5);
      this.muteall.getState = function() {
        this.state = checkBit(getValue("mgmask"), MUTEALL_BIT_IDX) ? 1 : 0
      };
      this.muteall.onToggleUp = function() {
        mixerWidget.muteAll()
      };
      this.muteall.onToggleDown = function() {
        mixerWidget.cancelMuteAll()
      };
      this.CUE = new CHECKBUTTON(this);
      this.CUE.setAnchors(null, null, 10, 5);
      this.CUE.text = lang.CUE;
      this.CUE.w = 90;
      this.CUE.getState = function() {
        this.state = getValue("settings.cue") ? 1 : 0
      };
      this.CUE.onToggle = function() {
        isBlocked("player") ? showPopupMsg(lang.LOCKED, 800) : setValue("settings.cue", this.state ? 1 : 0)
      };
      IS_UI_24 && (this.SHUFFLE = new CHECKBUTTON(this), this.SHUFFLE.setAnchors(200, null, null, 5), this.SHUFFLE.text = lang.SHUFFLE, this.SHUFFLE.w = 90, this.SHUFFLE.regKey("settings.shuffle"),
        this.SHUFFLE.regKey("settings.playMode"), this.SHUFFLE.getState = function() {
          this.disabled = 2 > getValue("settings.playMode");
          this.state = getValue("settings.shuffle") ? 1 : 0
        }, this.SHUFFLE.onToggle = function() {
          isBlocked("player") ? showPopupMsg(lang.LOCKED, 800) : setValue("settings.shuffle", this.state ? 1 : 0)
        }, this.SHUFFLE.hide())
    },
    onShow: function() {
      this.updateLists()
    },
    updateLists: function() {
      if (!EMULATE) {
        sendMessage(E_COMMANDS.MEDIA_GET_PLISTS);
        var a = this.PLISTS.selItem();
        null == a && (a = getValue("var.currentPlaylist"));
        log("curPLIST: " + a);
        a && sendMessage(E_COMMANDS.MEDIA_GET_PLIST_TRACKS + "^" + a)
      }
    },
    onHide: function() {},
    setStrip: function() {
      null != this.strip && this.unStrip();
      this.strip = mediaStrips[0];
      this.saveX = this.strip.x;
      this.saveEnabled = this.strip.enabled;
      this.strip.parent = this;
      this.strip.updateGeometry();
      this.strip.enabled = !0;
      this.strip.x = 0;
      this.strip.needClip = !0;
      this.widgets.push(this.strip)
    },
    unStrip: function() {
      null != this.strip && (this.widgets.pop(), this.strip.parent = mixerWidget, this.strip.enabled = this.saveEnabled,
        this.strip.needClip = !1, this.strip.calcGeometry = function() {
          this.h = this.parent.h
        }, this.strip.updateGeometry(), this.strip.x = this.saveX, this.strip = null)
    },
    calcGeometry: function() {
      this.x = 2 * measures.mixerStripWidth;
      this.w = screenWidth - measures.mixerRightMargin - this.x;
      this.h = screenHeight - this.y;
      IS_UI_24 && (this.x = 0, this.y = 40, this.h = this.parent.h - this.y, this.w = this.parent.w);
      this.needClip = 670 > this.w;
      this.SWITCH.setPos(10, 21);
      this.SEEKBAR.w = this.w - this.SEEKBAR.x - 10;
      var a = (this.w - this.PREV.w - this.PLAY.w - this.NEXT.w -
        this.STOP.w - this.REC.w - 6) / 2 | 0;
      this.TIME.setPos(this.w - this.TIME.w - 10, 10);
      this.PREV.setPos(a, 15);
      this.PLAY.setPos(this.PREV.x + this.PREV.w + 2, 15);
      this.STOP.setPos(this.PLAY.x + this.PLAY.w + 2, 15);
      this.NEXT.setPos(this.STOP.x + this.STOP.w + 2, 15);
      HAVE_REC && this.REC.setPos(this.NEXT.x + this.NEXT.w + 2 + 6, 15);
      a = this.h - this.PLISTS.y - 10 - 32;
      this.PLISTS.setSize(700 < this.w ? 300 : 270, a);
      this.FLIST.x = this.PLISTS.x + this.PLISTS.w + 2;
      this.FLIST.setSize(this.w - this.FLIST.x - 10, a)
    },
    paint: function() {
      ctx.fillStyle = color.eqBg;
      ctx.fillRect(0,
        0, this.w, this.h)
    }
  }),
  MTK_REC = Class.create(EMPTY_SUBPAGE, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "MTK_REC";
      this.color = color.yellow;
      this.initWidgets();
      mtkRec = this
    },
    initWidgets: function() {
      var a = this;
      this.BUTTONS = [];
      var b = 60,
        c = 0,
        d = 46;
      24 < inStrips.length && 690 > this.h && (d = 44, b = 54);
      for (var f = 0, e = 0; e < allStrips.length; e++) {
        var g = allStrips[e];
        switch (g.type) {
          case E_STRIP_TYPE.IN:
          case E_STRIP_TYPE.LINEIN:
            break;
          default:
            continue
        }
        var h = new CHECKBUTTON(this);
        0 == f % 8 && 0 != f && c++;
        h.setSize(90, d);
        h.setPos(40 +
          100 * (f - 8 * c), 100 + b * c);
        h.st = g;
        h.text = g.text;
        h.textColor = g.color;
        h.setKey(g.name + "mtkrec", !0);
        h.regKey(g.name + "mtkrec");
        h.k = "mtkrec";
        h.getState = function() {
          this.state = this.st.getNameValue("mtkrec");
          this.text = this.st.getName();
          this.textColor = this.st.getColor()
        };
        h.onToggle = function() {
          regUpdate(a)
        };
        this.BUTTONS.push(h);
        f++
      }
      this.MTKMODE = new SWITCHBOX(this);
      this.MTKMODE.setAnchors(240, 22);
      this.MTKMODE.setItems(["FLAC 24", "FLAC 16", "WAV 24", "WAV 16"]);
      this.MTKMODE.setItemWidth(80);
      this.MTKMODE.h = 40;
      this.MTKMODE.regKey("settings.mtk.format");
      this.MTKMODE.getState = function() {
        this.state = getValue("settings.mtk.format")
      };
      this.MTKMODE.valueFunc = function() {
        isBlocked("gsettings") ? showPopupMsg(lang.LOCKED, 800) : setValue("settings.mtk.format", this.state)
      };
      this.selectall = new MENUBUTTON(this);
      this.selectall.setAnchors(640, 22);
      this.selectall.setSize(90, 40);
      this.selectall.text = lang.SELECT_ALL;
      this.selectall.onPress = function() {
        a.BUTTONS.each(function(a) {
          a.setState(0, !1)
        });
        a.BUTTONS.each(function(a) {
          a.st.type != E_STRIP_TYPE.IN && a.st.type != E_STRIP_TYPE.LINEIN ||
            a.setState(1, !1)
        });
        regUpdate(a)
      };
      this.clearall = new MENUBUTTON(this);
      this.clearall.setAnchors(740, 22);
      this.clearall.setSize(90, 40);
      this.clearall.text = lang.CLEAR_ALL;
      this.clearall.onPress = function() {
        a.BUTTONS.each(function(a) {
          a.setState(0, !1)
        });
        regUpdate(a)
      }
    },
    paint: function() {
      ctx.fillStyle = color.eqBg;
      ctx.fillRect(0, 0, this.w, this.h);
      ctx.font = font.editbox;
      ctx.textAlign = "left";
      ctx.fillStyle = color.white;
      ctx.drawText(lang.RECORD_CHANNELS, 40, 50, {
        shadow: Shadow.main
      })
    }
  });

function keyToName(a) {
  a.endsWith(".") || (a += ".");
  for (var b = 0, c = allStrips.length; b < c; b++)
    if (allStrips[b].name == a) return allStrips[b].getLabel();
  return a
}
var MTK_PLAY = Class.create(EMPTY_SUBPAGE, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "MTK_REC";
      this.color = color.yellow;
      this.regKey("var.mtk.present");
      this.initWidgets();
      mtkPlay = this
    },
    onShow: function() {
      this.updateLists()
    },
    updateLists: function() {
      EMULATE || (sendMessage(E_COMMANDS.MTK_GET_SESSIONS), sendMessage(E_COMMANDS.MTK_GET_FILES))
    },
    initWidgets: function() {
      var a = this;
      this.regKey("var.mtk.rec.busy");
      this.overview = new MENUBUTTON(this);
      this.overview.text = lang.OVERVIEW;
      this.overview.color =
        this.overview.textColor = "#e44";
      this.overview.setPos(10, 15);
      this.overview.setSize(100, 40);
      this.overview.onPress = function() {
        settingsWidget.setMode(4);
        setMode(E_MODE.SETTINGS);
        settingsWidget.pages[4].setSrc(2);
        settingsWidget.pages[4].setMode(0)
      };
      this.scheck = new CHECKBUTTON(this);
      this.scheck.setAnchors(120, 15);
      this.scheck.setSize(101, 40);
      this.scheck.text = formatButtonText(lang.ACTIVATE_SOUNDCHECK);
      this.scheck.textColor = this.scheck.color = color.green;
      this.scheck.textColor2 = color.white;
      this.scheck.setKey("var.mtk.soundcheck");
      this.scheck.regKey("var.mtk.soundcheck");
      this.scheck.onToggle = function() {
        updateByKey("var.mtk.soundcheck");
        regUpdate(a)
      };
      this.PLAY = new CheckBox(this);
      this.PLAY.setImages(res.player_play, res.player_pause);
      this.PLAY.setAnchors(null, 15, 266, null);
      this.PLAY.regKey("var.mtk.currentState");
      this.PLAY.regKey("var.mtk.rec.currentState");
      this.PLAY.regKey("var.mtk.present");
      this.PLAY.opaque = !1;
      this.PLAY.disabledHide = !1;
      this.PLAY.getState = function() {
        this.state = 2 == getValue("var.mtk.currentState") ? 1 : 0;
        this.disabled =
          0 == getValue("var.mtk.present") || .5 < getValue("var.mtk.rec.busy") || .5 < getValue("var.mtk.rec.currentState")
      };
      this.PLAY.onToggleUp = function() {
        if (isBlocked("player")) showPopupMsg(lang.LOCKED, 800);
        else {
          var a = getValue("var.mtk.rec.busy");
          .5 < a && 2 > a ? showPopupMsg(lang.ERR_BUSYBUFFER) : sendMessage(E_COMMANDS.MTK_PLAY)
        }
      };
      this.PLAY.onToggleDown = function() {
        isBlocked("player") ? showPopupMsg(lang.LOCKED, 800) : sendMessage(E_COMMANDS.MTK_PAUSE)
      };
      this.STOP = new Button(this);
      this.STOP.setImages(res.player_stop_off, res.player_stop_on);
      this.STOP.setAnchors(null, 15, 194, null);
      this.STOP.regKey("var.mtk.rec.currentState");
      this.STOP.regKey("var.mtk.present");
      this.STOP.opaque = !1;
      this.STOP.disabledHide = !1;
      this.STOP.getState = function() {
        this.disabled = 0 == getValue("var.mtk.present") || .5 < getValue("var.mtk.rec.busy") || .5 < getValue("var.mtk.rec.currentState")
      };
      this.STOP.onPress = function() {
        if (isBlocked("player")) showPopupMsg(lang.LOCKED, 800);
        else {
          var a = getValue("var.mtk.rec.busy");
          .5 < a && 2 > a ? showPopupMsg(lang.ERR_BUSYBUFFER) : sendMessage(E_COMMANDS.MTK_STOP)
        }
      };
      this.REC = new CheckBox(this);
      this.REC.setImages(res.player_rec_off, res.player_rec_on);
      this.REC.setAnchors(null, 15, 116, null);
      this.REC.regKey("var.mtk.rec.currentState");
      this.REC.regKey("var.mtk.currentState");
      this.REC.regKey("var.mtk.present");
      this.REC.opaque = !1;
      this.REC.disabledHide = !1;
      this.REC.getState = function() {
        this.state = getValue("var.mtk.rec.currentState");
        this.disabled = 0 == getValue("var.mtk.present") || .5 < getValue("var.mtk.rec.busy") || 0 != getValue("var.mtk.currentState")
      };
      this.REC.onToggle = toggleMTKRec;
      this.TIME = new MTK_TIME(this);
      this.TIME.setAnchors(null, 10, 10, null);
      this.SEEKBAR = new SEEKBAR(this);
      this.SEEKBAR.setAnchors(10, 66, 10, null);
      this.SEEKBAR.setKey("var.mtk.currentTrackPos", !0);
      this.SEEKBAR.onChange = function(a) {
        isBlocked("player") ? showPopupMsg(lang.LOCKED, 800) : sendMessage(E_COMMANDS.MTK_JUMP_TO + "^" + a)
      };
      this.cap_a = new Label(this);
      this.cap_a.font = "15px open_sans_condensedbold";
      this.cap_a.color = "#88b";
      this.cap_a.setAnchors(390, 19, null, null);
      this.cap_a.w = 110;
      this.cap_a.align = "center";
      this.cap_a.regKey("var.mtk.freespace");
      this.cap_a.getState = function() {
        var a = getValue("var.mtk.freespace");
        this.text = 0 > a ? lang.NOT_AVAILABLE : "" + formatValue(a, 2, " " + lang.GB, !1)
      };
      this.buffer = new BufferLine(this);
      this.buffer.setAnchors(390, 46, null, null);
      this.buffer.setKey("var.mtk.bufferfill", !0);
      this.sessions = new PLISTS(this);
      this.sessions.setAnchors(10, 100, null, 52);
      this.sessions.setSize(160, 400);
      this.sessions.label = lang.SESSIONS;
      this.sessions.regKey("var.mtk.playsession");
      this.sessions.regKey("var.mtk.session");
      this.sessions.activeTextColor =
        "#2a2";
      EMULATE && (this.sessions.setItems($A($R("SESSION A", "SESSION C"))), this.sessions.select(0));
      this.sessions.onSelect = function() {
        if (!isBlocked("player")) {
          var a = this.selItem();
          a && sendMessage(E_COMMANDS.MTK_SET_SESSION + "^" + a)
        }
      };
      this.sessions.getState = function() {
        var a = getValue("var.mtk.session");
        this.selectedIdx = this.selected = a = this.items.indexOf(a);
        this.selectedItem = this.items[a]
      };
      this.sessions.getActiveItem = function() {
        var a = getValue("var.mtk.playsession");
        this.activeItemIdx = this.items.indexOf(a)
      };
      this.delet = new MENUBUTTON(this);
      this.delet.text = lang.DELETE_SESSION;
      this.delet.setAnchors(10, null, null, 10);
      this.delet.setSize(160, 40);
      this.delet.regKey("var.mtk.currentState");
      this.delet.regKey("var.mtk.rec.currentState");
      this.delet.opaque = !1;
      this.delet.getState = function() {
        this.dimmed = !!getValue("var.mtk.rec.currentState") || !!getValue("var.mtk.currentState")
      };
      this.delet.onPress = function() {
        var b = a.sessions.selItem();
        b && (confOk.valueFunc = function() {
          sendMessage(E_COMMANDS.MTK_DEL_SESSION + "^" + b)
        }, showConfBox(lang.DELETE +
          " '" + b + "'?"))
      };
      this.patch = new PLISTS(this);
      this.patch.setAnchors(172, 100, null, 10);
      this.patch.setSize(160, 400);
      this.patch.regKey("var.mtk.soundcheck");
      this.patch.label = lang.MIXER_PATCH;
      this.patch.maxTextLengthAuto = !1;
      this.patch.font = "12pt open_sans_condensedbold";
      this.patch.setItems(Array(22));
      ROUTING_TEST_MODE ? (this.patch.getState = function() {
        for (var a = getValue("var.mtk.soundcheck"), b = [], c = 0; 22 > c; c++) {
          var g = "---",
            h = getValue((a ? "mtk.scout." : "mtk.out.") + c);
          "none" != h && (g = keyToName(h));
          b.push(lang.SLOT +
            (9 > c ? "  " : " ") + (c + 1) + (9 > c ? " " : "") + " : " + g)
        }
        this.items = b
      }, this.patch.onDClick = function() {
        var a = new CH_SEL_POPUP(inStrips.concat(lineinStrips));
        a.slot = this.selectedIdx;
        a.valueFunc = function(a) {
          var b = getValue("var.mtk.soundcheck") ? "mtk.scout." : "mtk.out.",
            c = this.slot; - 1 == a ? setValue(b + c, "none") : setValue(b + c, chopLastDot(this.arr[a].name))
        }
      }) : (this.patch.getState = function() {
        for (var a = getValue("var.mtk.soundcheck"), b = [], c = 0; 22 > c; c++) {
          for (var g = "", h = "ua." + c, l = 0, m = allStrips.length; l < m; l++) {
            var n = allStrips[l];
            n.getNameValue(a ? "scsrc" : "src") == h && (g += n.getLabel() + " ")
          }
          g || (g = "---");
          b.push(lang.SLOT + (9 > c ? "  " : " ") + (c + 1) + (9 > c ? " " : "") + " : " + g)
        }
        this.items = b
      }, this.patch.onDClick = function() {
        var a = new CH_SEL_POPUP(inStrips.concat(lineinStrips));
        a.slot = this.selectedIdx;
        a.valueFunc = function(a) {
          var b = "src";
          getValue("var.mtk.soundcheck") && (b = "scsrc");
          for (var c = 0; c < this.arr.length; c++) {
            var d = this.arr[c];
            d.getNameValue("src") == "ua." + this.slot && d.setNameValue(b, "none")
          } - 1 != a && this.arr[a].setNameValue(b, "ua." + this.slot)
        }
      });
      this.files = new PLISTS(this);
      this.files.setAnchors(334, 100, 10, 10);
      this.files.label = lang.FILES;
      this.files.noSelection = !0;
      if (EMULATE) {
        for (var b = [], c = 0; 22 > c; c++) b.push("Track_" + (c + 1) + ".wav");
        this.files.setItems(b, !1)
      }
    },
    paint: function() {
      ctx.fillStyle = color.eqBg;
      ctx.fillRect(0, 0, this.w, this.h);
      var a = this.cap_a.x - 10;
      ctx.drawText(lang.SPACE_REMAINING + ":", a, 29, {
        font: "15px open_sans_condensedbold",
        color: color.white,
        align: "right",
        valign: "middle"
      });
      ctx.drawText(lang.BUFFER + ":", a, 50, {
        font: "15px open_sans_condensedbold",
        color: color.white,
        align: "right",
        valign: "middle"
      });
      CASCADE_MODE && ctx.drawText(lang.SLAVE + ":", a, 50, {
        font: "15px open_sans_condensedbold",
        color: color.white,
        align: "right",
        valign: "middle"
      })
    }
  }),
  BufferLine = Class.create(Widget, {
    initialize: function($super, b, c, d, f) {
      $super(b);
      this.widgetName = "BufferLine";
      this.ignoreEvents = !0;
      this.blockEvent = !1;
      this.w = 110;
      this.h = 10;
      this.value = 0
    },
    paint: function() {
      this.value = this.getVal();
      var a = .9 <= this.value ? "#e11" : .6 <= this.value ? "#e81" : .2 <= this.value ? "#ee1" : 0 > this.value ? "#777" :
        "#4a4";
      this.value = bound(this.value, 0, 1);
      ctx.fillStyle = a;
      ctx.fillRect(0, 0, this.w, this.h);
      ctx.fillStyle = color.eqBg2;
      ctx.fillRect(1, 1, this.w - 2, this.h - 2);
      ctx.fillStyle = a;
      ctx.fillRect(0, 0, this.w * this.value | 0, this.h)
    }
  }),
  MTK_TIME = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.w = 100;
      this.h = 50;
      this.name = "MTK_TIME";
      this.color = "#67C266";
      this.len = this.pos = this.v2 = this.mode = 0;
      this.timer = null;
      this.regKey("var.mtk.rec.time");
      this.regKey("var.mtk.rec.currentState");
      this.regKey("var.mtk.currentTrackPos");
      this.regKey("var.mtk.currentLength")
    },
    setMode: function(a) {
      this.mode = a;
      regUpdate(this)
    },
    setValue2: function(a) {
      this.v2 = bound(a, 0, 1)
    },
    calcGeometry: function() {},
    getState: function() {
      (this.vmode = getValue("var.mtk.rec.currentState") ? 1 : 0) ? this.len = getValue("var.mtk.rec.time"): (this.pos = getValue("var.mtk.currentTrackPos"), this.len = getValue("var.mtk.currentLength"))
    },
    paint: function() {
      this.getState();
      ctx.fillStyle = color.eqBg;
      ctx.fillRect(0, 0, this.w, this.h);
      if (!(0 > this.len))
        if (this.vmode) {
          ctx.font = "17pt open_sans_condensedbold, monospace";
          ctx.fillStyle = "#c44";
          var a = secToTime(this.len | 0);
          ctx.drawText(a, this.w - 2, 21, {
            align: "right",
            valign: "middle",
            shadow: Shadow.main
          })
        } else {
          var b = this.pos;
          1 == this.mode && (b = this.v2);
          a = this.len * b;
          b = secToTime(this.len | 0);
          a = secToTime(a | 0);
          ctx.font = "17pt open_sans_condensedbold, monospace";
          ctx.textAlign = "right";
          ctx.fillStyle = 1 == this.mode ? "#ccc" : this.color;
          ctx.drawText(a, this.w - 2, 20, {
            shadow: Shadow.main
          });
          ctx.fillStyle = "#FFC777";
          ctx.drawText(b, this.w - 2, 44, {
            shadow: Shadow.main
          })
        }
    }
  }),
  Label = Class.create(Widget, {
    initialize: function($super,
      b, c, d, f) {
      $super(b);
      this.widgetName = "Label";
      this.ignoreEvents = !0;
      this.bg = this.blockEvent = !1;
      this.bgColor = "rgba(255,255,255,0.1)";
      this.w = 55;
      this.h = 20;
      this.opaque = !1;
      this.font = isDefined(c) ? c : "bold 16px Arial";
      this.color = isDefined(f) ? f : "#fff";
      this.textParam = {
        shadow: Shadow.main
      };
      this.text = isDefined(d) ? d : "Label";
      isDefined(d) && this.recalc();
      this.align = "center"
    },
    setFont: function(a) {
      this.font = a;
      this.recalc();
      regUpdate(this)
    },
    recalc: function() {
      ctx.font = this.font;
      var a = ctx.measureText(this.text).width;
      a > this.w &&
        (this.w = a + 2)
    },
    setText: function(a) {
      this.text = a;
      this.recalc();
      regUpdate(this)
    },
    getState: function() {},
    paint: function() {
      this.getState();
      this.bg && (ctx.fillStyle = this.bgColor, ctx.fillRoundRect(0, 0, this.w, this.h, 6));
      ctx.fillStyle = this.color;
      ctx.font = this.font;
      var a = this.w / 2 | 0,
        b = this.h / 2 | 0;
      ctx.textBaseline = "middle";
      ctx.textAlign = this.align;
      this.textParam.max = this.w;
      switch (this.align) {
        case "center":
          ctx.drawText(this.text, a, b, this.textParam);
          break;
        case "left":
          ctx.drawText(this.text, 0, b, this.textParam);
          break;
        case "right":
          ctx.drawText(this.text, this.w, b, this.textParam)
      }
    }
  }),
  TIME_LABEL = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.w = 100;
      this.h = 52;
      this.name = "TIME_LABEL";
      this.color2 = this.color = color.white;
      this.max = this.text = "";
      this.vmode = this.mode = 0;
      this.text2 = "";
      this.timer = null;
      this.len = this.pos = this.v2 = 0
    },
    setMax: function(a) {
      this.max = secToTime(a | 0);
      regUpdate(this)
    },
    setTime: function(a) {
      this.text = secToTime(a | 0);
      regUpdate(this)
    },
    setMode: function(a) {
      this.mode = a;
      regUpdate(this)
    },
    setValue2: function(a) {
      this.v2 =
        bound(a, 0, 1)
    },
    calcGeometry: function() {},
    getState: function() {
      this.vmode = 0;
      this.len = getValue("var.currentLength");
      this.pos = getValue("var.currentTrackPos")
    },
    paint: function() {
      this.getState();
      ctx.fillStyle = color.eqBg;
      ctx.fillRect(0, 0, this.w, this.h);
      ctx.font = "17pt open_sans_condensedbold, monospace";
      ctx.textAlign = "right";
      if (!(0 > this.len)) {
        var a = this.pos;
        1 == this.mode && (a = this.v2);
        a *= this.len;
        this.max = secToTime(this.len | 0);
        this.text = secToTime(a | 0);
        ctx.fillStyle = this.color;
        1 == this.mode && (ctx.fillStyle = "#ccc");
        ctx.drawText(this.text, this.w - 2, 20, {
          shadow: Shadow.main
        });
        ctx.fillStyle = "#FFC777";
        ctx.drawText(this.max, this.w - 2, 44, {
          shadow: Shadow.main
        })
      }
    }
  }),
  SEEKBAR = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.name = "SEEKBAR";
      this.color = "white";
      this.w = 100;
      this.h = 26;
      this.position = .4;
      this.hw = 0;
      this.needMoveEvt = !0;
      this.pos = EMULATE ? .3 : 0;
      this.step = 1E3;
      this.timer = null;
      this.curTime = 0;
      this.trackLength = 30;
      this.key = "var.currentTrackPos";
      this.move = !1
    },
    setTrackTime: function(a) {
      this.curTime = 0;
      this.trackLength =
        a
    },
    onDown: function(a, b) {
      isBlocked("player") ? showPopupMsg(lang.LOCKED, 800) : (this.move = !0, this.ondown(), this.onMove(a, b))
    },
    onMove: function(a, b) {
      var c = bound(a - this.globalX(), 0, this.w);
      this.pos = c = bound(c / this.w, 0, 1);
      this.onmove(c);
      regUpdate(this)
    },
    onUp: function() {
      this.move = !1;
      this.onChange(this.pos);
      this.onup();
      regUpdate(this)
    },
    ondown: function() {},
    onmove: function(a) {},
    onup: function() {},
    onChange: function(a) {
      sendMessage(E_COMMANDS.MEDIA_JUMP_TO + "^" + a)
    },
    paint: function() {
      this.position = this.move || EMULATE ?
        this.pos : bound(getValue(this.key), 0, 1);
      var a = (this.w - this.hw - 6) * this.position | 0;
      ctx.fillStyle = "#131415";
      ctx.fillRect(0, 0, this.w, this.h);
      ctx.fillStyle = color.media;
      ctx.fillRect(3, 3, a, this.h - 6);
      ctx.fillStyle = this.grd;
      ctx.fillRect(3, 3, a, this.h - 6);
      ctx.fillStyle = "#eee";
      ctx.fillRect(3 + a - 1, 3, 2, this.h - 6);
      ctx.strokeStyle = "#3D3E41";
      ctx.strokeRect(.5, .5, this.w - 1, this.h - 1)
    }
  }),
  PLISTS = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "PLAYER_LIST";
      this.label = lang.PLAYLISTS;
      this.bg = "#212226";
      this.needMoveEvt = !0;
      this.lastClickTime = 0;
      this.items = [];
      this.noSelection = !1;
      this.selectedIdx = this.selected = -1;
      this.selectedItem = null;
      this.hoverIdx = this.activeItemIdx = -1;
      this.font = "12pt open_sans_condensedbold";
      this.itemH = 30;
      this.vOffsetOld = this.vOffset = 0;
      this.vScrollEnabled = !0;
      this.vScrollWidth = 8;
      this.textColor = color.white;
      this.selTextColor = color.black;
      this.selItemColor = "#eee";
      this.activeTextColor = "#e33";
      this.selectCanceled = !1;
      this.OY = 29;
      this.linkSelectedWith = this.linkOffsetsWith = null;
      this.maxTextLength =
        999;
      this.maxTextLengthAuto = !0
    },
    setItems: function(a, b) {
      Array.isArray(a) && (isDefined(b) || (b = !0), this.items = a, this.maxVOffset = this.items.length * this.itemH - this.h + this.OY, 0 > this.maxVOffset && (this.maxVOffset = 0), b && this.setOffset(0), regUpdate(this))
    },
    clear: function() {
      this.items.clear();
      this.clearSelection()
    },
    getActiveItem: function() {},
    selItem: function() {
      return 0 <= this.selectedIdx && this.selectedIdx < this.items.length ? this.items[this.selectedIdx] : null
    },
    selected: function() {
      return 0 <= this.selectedIdx && this.selectedIdx <
        this.items.length ? this.items[this.selectedIdx] : null
    },
    select: function(a, b) {
      a >= this.items.length || (isDefined(b) || (b = !1), 0 > a ? (this.selectedIdx = this.selected = -1, this.selectedItem = null) : (this.selectedIdx = this.selected = a, this.selectedItem = this.items[a]), !b && this.linkSelectedWith && this.linkSelectedWith.select(a, !0), this.onSelect(), regUpdate(this))
    },
    selectByName: function(a) {
      a = this.items.indexOf(a);
      0 <= a && this.select(a);
      regUpdate(this)
    },
    selectLast: function() {
      0 != this.items.length && this.select(this.items.length -
        1)
    },
    clearSelection: function() {
      this.select(-1)
    },
    setOffset: function(a) {
      this.vOffsetOld = this.vOffset = bound(a, 0, this.maxVOffset);
      regUpdate(this);
      this.linkOffsetsWith && (this.linkOffsetsWith.vOffsetOld = this.linkOffsetsWith.vOffset = bound(a, 0, this.linkOffsetsWith.maxVOffset), regUpdate(this.linkOffsetsWith))
    },
    onDown: function(a, b) {
      var c = b - this.globalY(),
        d = a - this.globalX();
      c < this.OY || (this.pressPoint = [d, c], this.selectCanceled = !1, this.noSelection && (this.selectCanceled = !0), this.vScrollEnabled && d > this.w - this.vScrollWidth ?
        this.selectCanceled = !0 : this.hoverIdx = Math.floor((this.pressPoint[1] + this.vOffset - this.OY) / this.itemH), 0 < this.maxVOffset && this.velStart(), regUpdate(this))
    },
    onMove: function(a, b) {
      var c = b - this.globalY();
      this.globalX();
      c -= this.pressPoint[1];
      this.vOffset = this.vOffsetOld - c;
      this.vOffset = bound(this.vOffset, 0, this.maxVOffset);
      this.linkOffsetsWith && (this.linkOffsetsWith.vOffsetOld = this.linkOffsetsWith.vOffset = bound(this.vOffset, 0, this.linkOffsetsWith.maxVOffset), regUpdate(this.linkOffsetsWith));
      regUpdate(this);
      5 < Math.abs(c) && (this.selectCanceled = !0)
    },
    onUp: function() {
      if (!this.selectCanceled) {
        var a = Math.floor((this.pressPoint[1] + this.vOffset - this.OY) / this.itemH);
        this.selected != a && this.select(a)
      }
      this.onPress();
      a = Date.now();
      if (250 > a - this.lastClickTime) this.onDClick();
      this.lastClickTime = a;
      this.hoverIdx = -1;
      this.vOffsetOld = this.vOffset;
      this.pressPoint = [-1, -1];
      0 < this.maxVOffset && this.velRelease();
      regUpdate(this)
    },
    onWheel: function(a) {
      clearInterval(ticker);
      this.setOffset(this.vOffset - Math.round(a / 6))
    },
    velStart: function() {
      velocity =
        amplitude = 0;
      timestamp = Date.now();
      clearInterval(ticker);
      frame = this.vOffset;
      scrollingWidget = this;
      ticker = setInterval(this.velTrack, 20)
    },
    velTrack: function() {
      var a, b;
      a = Date.now();
      b = a - timestamp;
      timestamp = a;
      a = scrollingWidget.vOffset - frame;
      frame = scrollingWidget.vOffset;
      velocity = 1E3 * a / (1 + b) * .8 + .2 * velocity
    },
    velRelease: function() {
      clearInterval(ticker);
      10 < Math.abs(velocity) && this.mScroll(velocity)
    },
    mScroll: function(a) {
      settings.kinetic || (position = this.vOffset, amplitude = .3 * a, step = 0, clearInterval(ticker), ticker =
        setInterval(function() {
          var a = amplitude / 20;
          position += a;
          amplitude -= a;
          step += 1;
          80 < step && clearInterval(ticker);
          scrollingWidget.vOffset != (position | 0) && scrollingWidget.setOffset(position | 0)
        }, 20))
    },
    calcGeometry: function() {
      this.maxVOffset = this.items.length * this.itemH - this.h + this.OY;
      this.maxTextLengthAuto && (this.maxTextLength = this.w / 8);
      0 > this.maxVOffset && (this.maxVOffset = 0);
      this.vOffset > this.maxVOffset && this.setOffset(this.maxVOffset)
    },
    onDClick: function() {},
    onSelect: function() {},
    onPress: function() {},
    valueFunc: function() {},
    getState: function() {},
    paint: function() {
      this.getState();
      ctx.fillStyle = this.bg;
      ctx.fillRect(0, 0, this.w, this.h);
      ctx.fillStyle = "#16171B";
      ctx.fillRect(0, 0, this.w, this.OY - 1);
      ctx.fillStyle = color.white;
      ctx.font = "14pt open_sans_condensedbold";
      ctx.textAlign = "left";
      ctx.fillText(this.label, 8, 21);
      ctx.lineWidth = 1;
      ctx.strokeStyle = "#3D3E41";
      ctx.strokeRect(.5, .5, this.w - 1, this.h - 1);
      ctx.strokeRect(.5, .5, this.w - 1, 28);
      this.getActiveItem();
      var a = this.items.length * this.itemH;
      this.vScrollEnabled = a > this.h - this.OY;
      ctx.beginPath();
      ctx.rect(0, this.OY, this.w, this.h - this.OY);
      ctx.clip();
      ctx.font = this.font;
      ctx.textAlign = "left";
      ctx.shadowColor = "transparent";
      ctx.textBaseline = "middle";
      for (var b = this.w - 2, c = 0; c < this.items.length; c++) {
        var d = c * this.itemH - this.vOffset + this.OY;
        if (!(d < -this.itemH || d > this.h)) {
          var f = this.selected == c,
            e = this.activeItemIdx == c;
          f && (ctx.fillStyle = this.selItemColor, ctx.fillRect(0, d, b, this.itemH));
          this.hoverIdx == c && (ctx.fillStyle = "rgba(255,255,255,0.03)", ctx.fillRect(0, d, b, this.itemH));
          ctx.fillStyle = f ? this.selTextColor :
            this.textColor;
          e && (ctx.fillStyle = this.activeTextColor);
          (f = this.items[c] || "") && this.maxTextLength && (f = f.truncate(this.maxTextLength));
          ctx.fillText(f, 8, d + this.itemH / 2 | 0, b - 9);
          ctx.fillStyle = "rgba(255,255,255,0.1)";
          ctx.fillRect(0, d + this.itemH, b, -1)
        }
      }
      this.vScrollEnabled && (c = this.h - this.OY, a < c && (a = c), b = c / a * c, a = this.OY + 2 + this.vOffset / (a - c) * (c - 4 - b), ctx.fillStyle = "rgba(0,0,0,0.3)", ctx.fillRoundRect(this.w - this.vScrollWidth - 2 + 1, a + 1 | 0, this.vScrollWidth - 2, b - 2 | 0, 5), ctx.fillStyle = "rgba(255,255,255,0.5)", ctx.fillRoundRect(this.w -
        this.vScrollWidth - 2, a, this.vScrollWidth, b | 0, 7))
    }
  }),
  FLIST = Class.create(PLISTS, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "PLAYER_LIST";
      this.items2 = [10, 1E3, 2E4, 300];
      this.col2 = 65;
      this.activeItemIdx = -1;
      this.label = lang.FILES
    }
  }),
  MEDIA_STRIPS = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "MEDIA_STRIP";
      this.holdTimer = this.strip2 = this.strip = this.buff2 = this.buff = null
    },
    onShow: function() {
      this.setStrip()
    },
    onHide: function() {
      this.unStrip()
    },
    onDown: function() {
      regUpdate(playerLabels)
    },
    setStrip: function() {
      null != this.strip && this.unStrip();
      this.strip = mediaStrips[0];
      this.strip2 = mediaStrips[1];
      this.strip.parent = this;
      this.strip2.parent = this;
      this.buff = [this.strip.x, this.strip.enabled];
      this.buff2 = [this.strip2.x, this.strip2.enabled];
      this.strip.x = 0;
      this.strip2.x = measures.mixerStripWidth;
      this.strip.enabled = this.strip2.enabled = !0;
      this.strip.updateGeometry();
      this.strip2.updateGeometry();
      this.widgets.push(this.strip);
      this.widgets.push(this.strip2)
    },
    unStrip: function() {
      null != this.strip && (this.widgets.pop(),
        this.widgets.pop(), this.strip.parent = mixerWidget, this.strip2.parent = mixerWidget, this.buff && (this.strip.x = this.buff[0], this.strip.enabled = this.buff[1]), this.buff2 && (this.strip2.x = this.buff2[0], this.strip2.enabled = this.buff2[1]), this.buff2 = this.buff = this.strip2 = this.strip = null)
    },
    calcGeometry: function() {
      this.x = 0;
      this.y = measures.topWidgetHeight;
      this.w = 2 * measures.mixerStripWidth;
      this.h = screenHeight - this.y - bottomWidget.h
    },
    paint: function() {
      null != this.strip ? (ctx.fillStyle = color.botBG, ctx.fillRect(0, 0, this.w,
        this.h)) : (fillVertPattern(res.blStripTile, this.h), drawImage(res.blStripBottom, 0, this.h - res.blStripBottom.h()), drawImage(res.blStripLabel, 0, this.h - res.blStripLabel.h()), drawImage(res.blStripTop, 0, 0))
    }
  }),
  MEDIA_LABELS = Class.create(Widget, {
    initialize: function($super, b) {
      $super(b);
      this.widgetName = "MEDIA_LABELS";
      this.w = 2 * measures.mixerStripWidth;
      this.h = measures.bottomWidgetHeight;
      this.lastClickTime = 0;
      this.prevSelected = -2
    },
    onDown: function(a, b) {
      this.globalY();
      a - this.globalX() < measures.mixerStripWidth ? setSelected(mediaStrips[0].id) :
        setSelected(mediaStrips[1].id);
      var c = this;
      this.holdTimer = setTimeout(function() {
        c.onHold()
      }, HOLD_TIME);
      regUpdate(this)
    },
    onUp: function() {
      clearTimeout(this.holdTimer);
      var a = Date.now();
      a - this.lastClickTime < DBL_CLK_TIME ? this.prevSelected == selectedChannel && (mode != E_MODE.EDIT ? (editWidget.setMode(3), setMode(E_MODE.EDIT)) : setMode(lastMode), bottomWidget.gotoIDmid(selectedChannel)) : (this.lastClickTime = a, this.prevSelected = selectedChannel)
    },
    onHold: function() {
      bottomWidget.move = !1;
      if (-1 != selectedChannel) {
        var a =
          new STRIPMENU(null, selectedStrip);
        a.x = selectedStrip.id == mediaStrips[0].id ? 0 : measures.mixerStripWidth - 20;
        a.x = bound(a.x, 0, screenWidth - a.w);
        a.y = screenHeight - a.h - measures.bottomWidgetHeight;
        mWidgets.push(widgets.pop());
        regUpdate(a)
      }
    },
    calcGeometry: function() {
      this.x = 0;
      this.y = screenHeight - this.h
    },
    paint: function() {
      ctx.fillStyle = color.bg;
      ctx.fillRect(0, 0, this.w, this.h);
      var a = measures.mixerStripWidth;
      drawImage(res.stripLabel, 0, 0);
      drawImage(res.stripLabel, a, 0);
      selectedStrip.id == mediaStrips[0].id && (ctx.fillStyle =
        mediaStrips[0].color, ctx.fillRect(2, 0, a - 4, bottomWidget.h - 2));
      selectedStrip.id == mediaStrips[1].id && (ctx.fillStyle = mediaStrips[1].color, ctx.fillRect(a + 2, 0, a - 4, bottomWidget.h - 2));
      ctx.font = font.botChLabel;
      ctx.textAlign = "center";
      var b = mediaStrips[0].getName();
      ctx.fillStyle = color.black;
      ctx.fillText(b, a / 2 + 2 | 0, 25, a - 6);
      ctx.fillStyle = color.labelText;
      ctx.fillText(b, a / 2 | 0, 24, a - 6);
      b = mediaStrips[1].getName();
      ctx.fillStyle = color.black;
      ctx.fillText(b, a + (a / 2 + 2 | 0), 25, a - 6);
      ctx.fillStyle = color.labelText;
      ctx.fillText(b,
        a + (a / 2 | 0), 24, a - 6)
    }
  }),
  CH_SEL_POPUP = Class.create(Widget, {
    initialize: function($super, b) {
      $super(-1);
      this.widgetName = "CH_SEL_POPUP";
      this.w = 650;
      this.h = 400;
      this.slot = -1;
      this.arr = b;
      this.initWidgets();
      this.calcGeometry();
      regUpdate(this)
    },
    initWidgets: function() {
      var a = 0,
        b = 0,
        c = this;
      this.buttons = [];
      for (var d = 0; d < this.arr.length; d++) {
        var f = this.arr[d],
          e = new SButton(this);
        e.idx = d;
        e.text = f.getLabel() + (f.stereo ? " " + lang.L : "");
        e.textColor = f.getColor();
        e.setPos(10 + 80 * b, 10 + 60 * a);
        e.setSize(70, 50);
        e.onPress = function() {
          c.valueFunc(this.idx);
          c.close()
        };
        this.buttons.push(e);
        b++;
        7 < b && (b = 0, a++);
        f.stereo && (e = new SButton(this), e.idx = d, e.text = f.getLabel() + " " + lang.R, e.textColor = f.getColor(), e.setPos(10 + 80 * b, 10 + 60 * a), e.setSize(70, 50), e.onPress = function() {
          c.valueFunc(this.idx, !0);
          c.close()
        }, this.buttons.push(e), b++, 7 < b && (b = 0, a++))
      }
      e = new SButton(this);
      e.idx = -1;
      e.text = lang.NO_PATCH;
      e.textColor = color.white;
      e.setPos(10 + 80 * b, 10 + 60 * a);
      e.setSize(70, 50);
      e.onPress = function() {
        c.valueFunc(this.idx);
        c.close()
      };
      this.buttons.push(e);
      b++;
      7 < b && (b = 0, a++);
      0 < b &&
        a++;
      this.h = 10 + 60 * a
    },
    valueFunc: function() {},
    calcGeometry: function() {
      this.x = (screenWidth - this.w) / 2 | 0;
      this.y = (screenHeight - this.h) / 2 | 0
    },
    onDelete: function() {},
    paint: function() {
      ctx.fillStyle = "#28292D";
      ctx.fillRoundRect(0, 0, this.w, this.h, 10);
      var a = ctx.createLinearGradient(0, 0, this.w, this.h);
      a.addColorStop(0, "rgba(255,255,255,0)");
      a.addColorStop(.2, "rgba(255,255,255,0)");
      a.addColorStop(.5, "rgba(255,255,255,0.15)");
      a.addColorStop(.8, "rgba(255,255,255,0)");
      a.addColorStop(1, "rgba(255,255,255,0)");
      ctx.fillStyle =
        a;
      ctx.fillRoundRect(0, 0, this.w, this.h, 10);
      ctx.roundRect(0, 0, this.w, this.h, 10);
      ctx.strokeStyle = "#333";
      ctx.lineWidth = 2;
      ctx.stroke()
    }
  });
